!function(m,L,n){"use strict";function p(){this.el=[1,0,0,0,1,0,0,0,1]}function y(S){var m={};return{get:function(W){if(m[W]!==n)return m[W];var _;switch(W){case"WEBGL_depth_texture":_=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":_=S.getExtension("WEBGL_compressed_texture_etc1");break;default:_=S.getExtension(W)}return m[W]=_,_}}}function Q(q,u,p){function B(){if(H!==n)return H;var L=u.get("EXT_texture_filter_anisotropic");return H=null!==L?q.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function R(m){if("highp"===m){if(q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.HIGH_FLOAT).precision>0&&q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.HIGH_FLOAT).precision>0)return"highp";m="mediump"}return"mediump"===m&&q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.MEDIUM_FLOAT).precision>0&&q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var H;p=p||{};var P="undefined"!=typeof WebGL2RenderingContext&&q instanceof WebGL2RenderingContext,g=p.precision!==n?p.precision:"highp",X=R(g);X!==g&&(console.warn("WebGL:",g,"not supported, using",X,"instead."),g=X);var c=p.logarithmicDepthBuffer===!0,_=q.getParameter(q.MAX_TEXTURE_IMAGE_UNITS),E=q.getParameter(q.MAX_VERTEX_TEXTURE_IMAGE_UNITS),U=q.getParameter(q.MAX_TEXTURE_SIZE),x=q.getParameter(q.MAX_CUBE_MAP_TEXTURE_SIZE),b=q.getParameter(q.MAX_VERTEX_ATTRIBS),L=q.getParameter(q.MAX_VERTEX_UNIFORM_VECTORS),D=q.getParameter(q.MAX_VARYING_VECTORS),z=q.getParameter(q.MAX_FRAGMENT_UNIFORM_VECTORS),f=E>0,d=P||!!u.get("OES_texture_float"),h=f&&d,G=P?q.getParameter(q.MAX_SAMPLES):0;return{getMaxAnisotropy:B,getMaxPrecision:R,precision:g,logarithmicDepthBuffer:c,maxTextures:_,maxVertexTextures:E,maxTextureSize:U,maxCubemapSize:x,maxAttributes:b,maxVertexUniforms:L,maxVaryings:D,maxFragmentUniforms:z,vertexTextures:f,floatFragmentTextures:d,floatVertexTextures:h,maxSamples:G}}var F="ht";if(!m[F]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),m.performance&&m.performance.now||function(){var T=Date.now();m.performance||(m.performance={}),m.performance.now=function(){return Date.now()-T}}();for(var P=Date.now(),b=16,E=["ms","moz","webkit","o"],t=0;t<E.length&&!m.requestAnimationFrame;++t)m.requestAnimationFrame=m[E[t]+"RequestAnimationFrame"],m.cancelAnimationFrame=m[E[t]+"CancelAnimationFrame"]||m[E[t]+"CancelRequestAnimationFrame"];m.requestAnimationFrame||(m.requestAnimationFrame=function(y){var k=Date.now(),h=b+P-k;return 0>h&&(h=0),P=k,m.setTimeout(function(){P=Date.now(),y(performance.now())},h)}),m.cancelAnimationFrame||(m.cancelAnimationFrame=function(H){return m.clearTimeout(H)}),L.assign===n&&(L.assign=function(E){if(E===n||null===E)throw new TypeError("Cannot convert undefined or null to object");for(var q=L(E),H=1;H<arguments.length;H++){var I=arguments[H];if(I!==n&&null!==I)for(var z in I)L.prototype.hasOwnProperty.call(I,z)&&(q[z]=I[z])}return q})}();var d=m.document,O=null,Y=m[F]={},B=m[F+"config"],j=Y.Default=B&&B.Default||{},v=Y.Style=B&&B.Style||{},C=Y.Attr=B&&B.Attr||{},R=Y.Color=B&&B.Color||{},g=Y.IsGetter=B&&B.IsGetter||{};!function(){var d=!1;try{var E=L.defineProperty({},"passive",{get:function(){return d=!0,n}});m.addEventListener("test",E,E),m.removeEventListener("test",E,E)}catch(G){d=!1}j.passiveSupported=d}();var W,s,h,f,o=j.passiveSupported,H=j.eventListenerOptionsFalse=o?{passive:!1,capture:!1}:!1,z=j.eventListenerOptionsTrue=o?{passive:!1,capture:!0}:!0,q=function(d,D,s,v){d.addEventListener(D,s,v?z:H)},X=function(X,R,d,I){X.removeEventListener(R,d,I?z:H)},k=Math,i=k.round,J=k.floor,$=k.ceil,e=k.sqrt,P=k.max,u=k.min,w=k.abs,c=k.cos,l=k.acos,N=k.sin,b=k.pow,S=k.asin,G=k.exp,t=k.PI,A=2*t,M=t/2,D=k.tan,E=k.atan2,U=k.random,K=k.log,a=!1,x=!1,I=m.parseInt||global.parseInt,Z="2021-3-15",V=m.navigator?m.navigator.platform.indexOf("Win")>-1:!1,_=function(v){return v*v},T=m.setTimeout,r=m.clearTimeout,Bk=m.location,Vh=m.navigator?m.navigator.userAgent.toLowerCase():"",lp=function(h){return h.test(Vh)},ts=lp(/msie/),kr=lp(/msie/)||lp(/trident/),Xp=lp(/msie 10/),Xo=lp(/edge/),Tp=lp(/firefox/),Bl=lp(/mac/),Lr=j.isTouchable===n?V?!1:d?"ontouchend"in d:!1:j.isTouchable,ol="default",Li="single",ys="multiple",pj="front",qp="back",dj="left",xq="right",nh="top",$c="bottom",vr="center",vh="eye",Te="middle",lk="east",tr="west",Fl="north",Jj="none",Qj="px",wg="absolute",hc="border",hk="triangle",Dl="rect",Oj="circle",xr="cylinder",ml="shape",Em="items",xm="normal",Mp="remove",zq="clear",Ml="width",rj="height",sp="ingroup",Ol="check",Sg="uncheck",Ug="radio",In="radioOn",qn="radioOff",Nj="points",bg="values",Oe="series",Yp="body",Tk="label",Oo="label2",Fb="note",mb="note2",sq="icons",Vk="labelFont",Br="labelColor",vd="labelSelectColor",Pd="note.expanded",Zi="note2.expanded",Yi="edge.expanded",tn="edge.points",Jq="edge.type",Sk="rotation",Uk="hidden",Hn="visible",pd="tuv",si="no",Gh="draw",$r="select",Eb="currentSubGraph",jl="selectBackground",kj="autoMakeVisible",oc="autoHideScrollBar",_l="scrollBarColor",Fh="scrollBarSize",Kb="indent",Pm="rowHeight",Rn="columnLineColor",$o="rowLineColor",cm="columnLineVisible",ni="rowLineVisible",qo="visibleFunc",Kj="expandIcon",Kf="collapseIcon",bm="checkMode",bl="sortFunc",tm="editable",gj="batchEditable",nj="tristate",Yk="asc",js="desc",mj="position",Ee="elevation",pn="children",jq="translateX",Ko="translateY",Rp="dataModel",vs="maxSize",jk="state",Ij="shape3d",Sh="shape3d.resolution",zs="shape3d.visible",zn="shape3d.from.visible",Jc="shape3d.to.visible",yf="shape3d.top.visible",yq="shape3d.bottom.visible",an="repeat.uv.length",Zp="serializeValue",Jn="deserializeValue",Wr="centerUniform",_i="uniform",lb="rgba(255,255,255,0)",qc="style",qb="attr",Lh="field",yb="string",sf="boolean",ib="color",Hk="int",fc="number",gp="ew-resize",Md="ns-resize",bi="pointer",Bn="auto",fm="mousedown",sm="mousemove",Dh="mouseup",rd="mouseout",Kd="touchstart",is="touchmove",hj="touchend",Ud="keydown",vq="keyup",Fn=["DOMMouseScroll","mousewheel"],Od=Tp?Fn[0]:Fn[1],ad=[Kd,is,hj],Gp=[fm,sm,Dh,rd,Od,"wheel","mouseenter","mouseleave","mouseover"],tk=[Ud,vq,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Je=Lr?ad.concat(tk):Gp.concat(tk),Mm=O,Ok=O,Yf=O,yr=Dh.length,_k=function(){Yf&&(r(Yf.timeout),Yf=O)},bn=function(){Yf&&Co(Yf.e,Yf.info)};m.addEventListener&&(Lr||(q(m,rd,function(){_k()}),q(m,Od,function(){Km()})),q(m,vq,function(C){91===C.keyCode?Ej={}:delete Ej[C.keyCode]},!0),q(m,Ud,function(r){Ej[r.keyCode]=!0},!0),q(m,"blur",function(){Ej={}}));var rl,ap,_g,fe=0,Yq=O,sl=function(M,$){var q=T(function(){delete Yq[q],sn(Yq)&&(Yq=O),M()},$);return q},vm=O,Rr=O,Eh={},Kp={},db={},pf={},mq={},Ej={},hb={},Wb={},br={},Ce={},Gm=/.json$/,ko=/^data:image\/svg\+xml/,ob={},Ul=[],Ac={},vj=O,zj=O,Bh=function(){},yp=function(){throw"Oops!"},Lp=[0,0,0],yk={x:0,y:0,width:0,height:0},zm=O,gf=O,pm=O,Bb=function(B,p){Kp[B]=p,p&&p.comps&&!p.uuid&&(p.uuid=Y.Math.generateUUID()),Ld[B]&&(p.cacheRule=Ld[B],delete Ld[B])},bh=function(T){gf&&!T._72O&&(pm||(pm={}),pm[T._72O=Xn()]=T),rl!=O?zb()<.05&&f&&!ap&&(Qh=_k):Qh=Hi},Ff=function(Y,n,m,i){gf||(gf={});var x=gf[Y];if(x){if(x.url===n)return;x.image?(x.image.onload=Bh,x.image.onerror=Bh):x.request&&(x.request.onload=Bh,x.request.onerror=Bh)}if(Gm.test(n)){var U=new de;if(gf[Y]={request:U,url:n},n=j.beforeLoadURL(n,Y),n.data){var E=j.parse(n.data);Sp(Y,E),j.handleImageLoaded(Y,E)}else{U.onload=function(){if(200===this.status||0===this.status){var d=j.parse(U.getResponseText());Sp(Y,d),j.handleImageLoaded(Y,d)}else Sp(Y,j.handleUnfoundImage(Y,n)||O)},U.onerror=function(){Sp(Y,j.handleUnfoundImage(Y,n)||O)};var F={};F.url=encodeURI(n),F.sync=!1,U.send(F)}}else{var E=new Image;gf[Y]={image:E,url:n},/^data:image/.test(n)||(n=j.beforeLoadURL(n,Y),n=j.appendTimeStamp(n),n=encodeURI(n),E.crossOrigin=j.crossOrigin),j.convertImageSrc(n,function(a){kr&&(n.toLowerCase().indexOf(".svg")>0||ko.test(n))?(d.body.appendChild(E),E.style.visibility="hidden",E.onload=function(){T(function(){if(m&&(E.width=m),i&&(E.height=i),!E.width||!E.height){var B=E.width||E.clientWidth,Z=E.height||E.clientHeight;E.width=B,E.height=Z}j.handleImageLoaded(Y,E),Sp(Y,E),d.body.removeChild(E),E.style.visibility=""},180)},E.onerror=function(){Sp(Y,j.handleUnfoundImage(Y,n)||O),d.body.removeChild(E),E.style.visibility=""}):(E.onload=function(){m&&(E.width=m),i&&(E.height=i),j.handleImageLoaded(Y,E),Sp(Y,E)},E.onerror=function(){Sp(Y,j.handleUnfoundImage(Y,n)||O)}),E.src=a})}},Sp=function(E,Y){if(Bb(E,Y),delete gf[E],sn(gf)&&(gf=O,pm)){for(var z in pm){var T=pm[z];T._2O&&T._2O[E]&&(T.deleteTexture(E),delete T._2O[E]),T.invalidateAll&&T.invalidateAll(n,"imageLoaded",E),T.redraw&&T.redraw(),T.iv(),delete T._72O}pm=O}if(Y&&pm)for(var z in pm){var T=pm[z];T.invalidateAll&&T.invalidateAll(n,"imageLoading",E),T.redraw&&T.redraw(),T.iv()}},Af=function(){return K=k&&Date,function(){return m.performance&&m.performance.now?m.performance.now():Date.now()}}(),Gg=function(E,b,c){return{width:E,height:b,comps:Hr(c)?c:[c]}},Qq=function(i,U){return{type:Oj,rect:[i,U,1.6,1.6],borderWidth:1,borderColor:Pb,gradient:Cp,gradientColor:xb,background:Pb}},Xf=function(S,r){return Gg(16,16,{type:hk,rect:[4,4,10,8],background:S,rotation:r?1.57:3.14})},Nk=function(s,j){return Gg(16,16,{type:hk,rect:[4,4,8,7],background:s,rotation:j?3.14:0})},Qc=function(M){var U=M._orientation;return"horizontal"===U||"h"===U},Vg=function(Z,l){var J=O||4,V=O||1,v=O||1;0>J?J=0:J>.25&&(J=.25);var Y,o,T,S,w,z,r,b=.5,i=[],$=[],g=[],H=A/v,d=A/V,y=b-J;for(o=0;V>=o;o++)for(S=-t+o*d,z=c(S),w=N(S),Y=0;v>=Y;Y++)T=Y*H,r=y+J*z,i.push(c(T)*r,w*J,-N(T)*r),(s=[Z,l])&&$.push(Y/v,1-o/V);for(o=0;V>o;o++){var E=o*(v+1),u=(o+1)*(v+1);for(Y=0;v>Y;Y++)g.push(E+Y,u+Y+1,u+Y,E+Y,E+Y+1,u+Y+1),_d.z=Nf.z=[Z,l]}},bj=function(L){var J=2,n=0;for(var M in L)M.length===J&&I(M,32)===nq&&(vj=zj=L[M]),n++;return n},Vp=function(b,D,w,g){return w||(w=Lr?5:3,w/=g||1),{x:b-w,y:D-w,width:2*w,height:2*w}},Ki=function(V,u,h,C){var B=this;u||(u=Lr?5:3,h=20,C=20);var I={x:V,y:u,width:h,height:C};if(h)for(var s=0;h>s;s++)if(3===h)C=20;else for(var S=0;C>S;S++)B=m?m:h;var e={x:t,y:2*t};if(Mg(I,e)){var l=rj[0]+nh[0]+zq[1]+Yk.length,J=Uk[0]+nj[0]+zq[1]+Yp.length;Zm[vh]=[B[l],B[J]],B[l]=Qg[vh],B[J]=Qg[Ij]}},An=function(U){return(/ble$/.test(U)||/ed$/.test(U)||g[U]?"is":"get")+U.charAt(0).toUpperCase()+U.slice(1)},Qg=function(J){return"set"+J.charAt(0).toUpperCase()+J.slice(1)},xh=function(B){return typeof B===yb||B instanceof String},Sd=function(s){return typeof s===fc},Hi=function(i){return typeof i===sf},Xj=function(R){return R&&"object"==typeof R},er=function(X){return"function"==typeof X},Hr=function(z){return z instanceof Array},re=function(w){return w instanceof zf},Sm=function(C){return Hr(C)?new zf(C):C},De=function(W){return W instanceof Vj},_n=function(T){return T instanceof Fm},mh=function(T){return T instanceof ye},Yn=function(y,j){if(!(y instanceof Y.Group))return!1;if(!j)return y.isExpanded();var X=j.getDataUI(y);return X&&X._88I?!0:!1},Ti=function(c){return c instanceof nk},ks=function(y){return y&&"IFRAME"===y.tagName},Mc=function(Z){return Z==O||j.numberDigits==O?Z:parseFloat(Z.toFixed(j.numberDigits))},zr=function(I,z,l){var s,y=z.length;if(l)for(var H=0;l>H;H++)if(3===y)I.push(z[0]),I.push(z[1]),I.push(z[2]);else for(s=0;y>s;s++)I.push(z[s]);else if(3===y)I.push(z[0]),I.push(z[1]),I.push(z[2]);else for(s=0;y>s;s++)I.push(z[s])},vo=function(j){return j?Xj(j)?j:{}:!1},Dq=function(E,g,K){var x,$=Xj(E)?E:E.prototype;for(x in g)K&&x in $?$[x]===n&&console.warn("class",$,"has own undefined property",x,", keep exist!"):$[x]=g[x];return E},Om=function(n,a){if(!("wheelDelta"in a)){var E=a.deltaMode;a.wheelDelta=E===a.DOM_DELTA_PIXEL?-a.deltaY:E===a.DOM_DELTA_LINE?40*-a.deltaY:120*-a.deltaY}n.handle_mousewheel(a)},Ai=function(b){return String.fromCharCode(b)},$g=function(T){for(var b,C=0,y="";C<T.length;C++)b=T[T.length-1-C],"%"===b?b="'":"a"===b?b='"':"]"===b&&(b="\\"),y+=Ai(b.charCodeAt(0)-1);return y},Ck=function(C,E,D){C.superClass.constructor.apply(E,D)},sn=function(T){for(var B in T)return!1;return!0},te=function(R){return R?0===R.length:!0},Xd=function(){var i="";return[Sg[0],$o[0],Tk[0]].forEach(function(t){i+=Qg(t).slice(3)}),_i=d&&d[i]||Wr,function(o,y){return o===y?!0:o.x===y.x&&o.y===y.y&&o.width===y.width&&o.height===y.height}}(),am=function(B,C,S){return C>B?C:B>S?S:B},uf=function(Z){return 0>Z?-1:Z>0?1:0},zb=function(){var Z=1e4*N(yr++);return Z-J(Z)},lm=function(s,C,c){return Cr(s.x,s.y,C.x,C.y,c.x,c.y,c.x+c.width,c.y,!0)||Cr(s.x,s.y,C.x,C.y,c.x+c.width,c.y,c.x+c.width,c.y+c.height,!0)||Cr(s.x,s.y,C.x,C.y,c.x+c.width,c.y+c.height,c.x,c.y+c.height,!0)||Cr(s.x,s.y,C.x,C.y,c.x,c.y+c.height,c.x,c.y,!0)},Cr=function(i,L,S,e,j,E,W,H,d){var t=(W-j)*(L-E)-(H-E)*(i-j),v=(H-E)*(S-i)-(W-j)*(e-L);if(0!==v){var n=t/v,I=i+n*(S-i),U=L+n*(e-L);return d&&(I+Wg<u(i,S)||I-Wg>P(i,S)||I+Wg<u(j,W)||I-Wg>P(j,W)||U+Wg<u(L,e)||U-Wg>P(L,e)||U+Wg<u(E,H)||U-Wg>P(E,H))?O:[I,U]}return O},Bm=function(X,g,l){if(X&&l)if(g){if(g===qc)return X.getStyle(l);if(g===qb)return X.getAttr(l);if(g===Lh)return X[l]}else if(l=An(l),X[l])return X[l]();return n},fr=function(o,g,C,H){if(o&&C)if(g){if(g===qc)o.s(C,H);else if(g===qb)o.a(C,H);else if(g===Lh){var B=o[C];o[C]=H,o.fp("f:"+C,B,H)}}else C=Qg(C),o[C]&&o[C](H)},Ji=function(l,E,g){return E&&"top"!==E?"bottom"===E?{x:l.x,y:l.y,width:l.width,height:l.height*g}:"right"===E?{x:l.x,y:l.y,width:l.width*g,height:l.height}:"left"===E?{x:l.x+l.width*(1-g),y:l.y,width:l.width*g,height:l.height}:void 0:{x:l.x,y:l.y+l.height*(1-g),width:l.width,height:l.height*g}},bp=function(x,b,m,N){if(0>N)return null;var T=Math.floor(b.x),F=Math.floor(b.y),K=Math.ceil(b.width)+1,f=Math.ceil(b.height)+1,S=N,Q=N;1>=N&&(S=N*K,Q=N*f);var X,q;m&&"top"!==m?"bottom"===m?(X={x:T,y:F+f-Q},q={x:T,y:F+f}):"right"===m?(X={x:T+K-S,y:F},q={x:T+K,y:F}):"left"===m&&(X={x:T+S,y:F},q={x:T,y:F}):(X={x:T,y:F+Q},q={x:T,y:F});var N=x.createLinearGradient(X.x,X.y,q.x,q.y);return N.addColorStop(0,"rgba(0,0,0,0)"),N.addColorStop(1,"rgba(0,0,0,1)"),{gradient:N,rect:{x:Math.min(X.x,q.x),y:Math.min(X.y,q.y),width:Math.abs(X.x-q.x)||K,height:Math.abs(X.y-q.y)||f}}},dq=function(I,e,x,v,z){e&&hd(I,x,v,1,z,e)},Aj=function($,A,h,e){var m=1-$;return m*m*A+2*$*m*h+$*$*e},_d=function(z,E,w,n,j){var t=1-z;return t*t*t*E+3*t*t*z*w+3*t*z*z*n+z*z*z*j},jb=function(K){var G,S,A,L,t=0;return K.forEach(function(E){if(G=E.length,G>0)for(S=E[0],L=1;G>L;L++)A=E[L],t+=rs(S,A),S=A}),t},Zb=function(j,O,G){var D="__"+j,c=function(C){G.disabled||G["handle_"+j](C)};G[D]||(G[D]=c,q(O,j,c))},Qp=function(R,_,q){var C="__"+R,A=q[C];A&&(X(_,R,A),delete q[C])},mf=function(E,h){var D="_"+h;E[An(h)]=function(){return this[D]},E[Qg(h)]=function(X){var k=this[D];this[D]=X,this.fp(h,k,X)}},kd=function(f){return L.create(f)},Hb=function(l){if(!l.element){var c,p;(c=l.textField)?p=cq(Ao.TextField,c):(c=l.textArea)?p=cq(Ao.TextArea,c):(c=l.button)?p=cq(Ao.Button,c):(c=l.comboBox)?p=cq(Ao.ComboBox,c):(c=l.checkBox)?p=cq(Ao.CheckBox,c):(c=l.radioButton)?p=cq(Ao.RadioButton,c):(c=l.slider)?p=cq(Ao.Slider,c):(c=l.colorPicker)?p=cq(Ao.ColorPicker,c):(c=l.image)&&(p=cq(Ao.Image,c)),p&&(l.element=p)}},Cd=function(x,Q){var P=Tj(x);return P._ht=Q,P},zo=m.top===m?m.top:m||m.document,Tj=function(I,W){var k=d.createElement("div"),L=k.style;return k.tabIndex=-1,k.onkeydown=zh,L.msTouchAction=Jj,th(k,O,0),Lr&&L.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",O),I&&(L.overflow=Uk),W&&cr(W,k),k},Uq=function(j,A){var o=d.createElement("canvas"),L=o.style;return L.msTouchAction=Jj,A||(L.pointerEvents=Jj),th(o,O,0),j&&cr(j,o),o},th=function(s,N,i){var x=s.style;x.border=N?N+" solid 1px":0,x.outline=0,x.padding=i?"0 "+i+Qj:0,Fc(s)},Fc=function(S){var R=S.style;R.position=wg,R.margin=0,R.setProperty("box-sizing","border-box",O),R.setProperty("-moz-box-sizing","border-box",O)},Xr=function(G,p,Z,i){i||(i=Vd),p!=O&&(G.width=p*i,G.style.width=p+Qj),Z!=O&&(G.height=Z*i,G.style.height=Z+Qj)},cr=function(Y,F,s){Y.appendChild(F),s&&(F.style.position=wg)},Wc=function(d,O){O.split||(O+="");for(var v,C=O.split("\n"),S=0,Y=C.length,B=0;Y>B;B++){var K=Pi(d.font,C[B]);K.width>S&&(S=K.width),v||(v=K.height)}return d.ss=C,{width:S,height:v*Y}},Lc=function(j,w,v,f,p,s){var U=w.length;if(1===U)kq(j,w[0],v,f,p);else for(var y=v.height/U,O={x:v.x,y:v.y,width:v.width,height:y},m=0;m<w.length;m++)s?om(j,w[m],f,p,O.x,O.y,O.width,O.height,s):kq(j,w[m],O,f,p),O.y+=y},kq=function(H,B,p,S,g){H.font=S?S:Go,H.fillStyle=g?g:zl,H.textAlign=vr,H.textBaseline=Te;var Z,M;p?p.width===n?(Z=p.x,M=p.y):(Z=p.x+p.width/2,M=p.y+p.height/2):(Z=0,M=0),H.fillText(B,i(Z),i(M))},Kh=function(a){a.getView&&(a=a.getView());var L=a.offsetWidth||a.scrollWidth;return!L&&a.style.width&&(L=I(a.style.width)),L},Tn=function(l){l.getView&&(l=l.getView());var k=l.offsetHeight||l.scrollHeight;return!k&&l.style.height&&(k=I(l.style.height)),k},Cb=function(U,W,E){var h=W[0].toUpperCase()+W.substring(1,W.length);U["webkit"+h]=E,U["moz"+h]=E,U["ms"+h]=E,U["o"+h]=E,U[W]=E},Wq=function(){var k=function(G){zh(G),G.stopPropagation()},c=function(E){zh(E)},g=[Kd,Ud,fm];return function(K,R){var V=Tj(),n=V.style;return n.backgroundColor=j.disabledBackground,K&&(n.backgroundImage="url("+K+")",n.backgroundPosition="50% 50%",n.backgroundRepeat="no-repeat no-repeat"),R===!1?g.forEach(function(u){q(V,u,c)}):g.forEach(function(n){q(V,n,k)}),V}}(),Kn=function(Y){var C=Y.getContext("2d");return C.save(),C.lineCap=Ae,C.lineJoin=gr,C},Qh=function(S,u,Z,o){cl(S,u*Vd,Z*Vd),o*=Vd,1!==o&&S.scale(o,o)},cl=function(o,j,i){o.translate(j,i)},gc=function(h,N){N&&h.rotate(N)},eb=function(z,J,M){J===n&&(J=1),M===n&&(M=1),(1!==J||1!==M)&&z.scale(J,M)},Eo=!1,G=zo[Ol[1]+jq[0]],eh=function(u){var _=d.activeElement;if(d.activeElement!==u){_&&_.forceOnblur&&_.forceOnblur();for(var Z=[],j=u.parentNode;j;)Z.push([j,j.scrollLeft,j.scrollTop]),j=j.parentNode;if(!Eo){var z=[],F=[];try{for(var n=m.parent,Y=m;n!==Y;)z.push([n,n.scrollX,n.scrollY]),Y=n,n=m.parent;var x=m.frameElement;if(x)for(var M=x.parentNode;M;)F.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode}catch(P){Eo=!0}}if(Lr)u.focus();else{var U=Db(),f=U.target;u.focus(),f.scrollLeft=U.left,f.scrollTop=U.top}Z.forEach(function(Y){Y[0].scrollLeft=Y[1],Y[0].scrollTop=Y[2]}),Eo||(z.forEach(function(Z){Z[0].scrollTo(Z[1],Z[2])}),F.forEach(function(I){I[0].scrollLeft=I[1],I[0].scrollTop=I[2]}))}},mp=function(o){return o&&o.getView?o.getView():o},dg=function(e,T,l,f,m){if(2===arguments.length&&(l=T.y,f=T.width,m=T.height,T=T.x),e.isSelfViewEvent)e.setX(T),e.setY(l),e.setWidth(f),e.setHeight(m);else{var O=mp(e),R=O.style;if((d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement)!==O)T!==n&&(R.left=T+Qj),l!==n&&(R.top=l+Qj),f!==n&&(R.width=f+Qj),m!==n&&(R.height=m+Qj);else{var $=j.getWindowInfo();R.left=(T=$.left)+Qj,R.top=(l=$.top)+Qj,R.width=(f=$.width)+Qj,R.height=(m=$.height)+Qj}e.endEditing&&!Lr&&e.endEditing(),e.redraw&&e.redraw(),e.invalidate&&e.invalidate(),e.onLayouted&&e.onLayouted(T,l,f,m),e.fireViewEvent&&e.fireViewEvent("layout")}},pl=function(U){if(!U.touches)return U;var N=U.touches[0];return N?N:U.changedTouches[0]},Ed=function(P){return Hh(P)?pl(P).target:P.target},Hh=function(C){return"touches"in C},Qm=function(A){j.popup&&j.popup.close(),j.popup=A},_q=O,Yd=function(Q){_q.handleWindowTouchMove(Q)},Zh=function(A){_q.handleWindowTouchEnd(A),X(m,is,Yd),X(m,hj,Zh),_q=O},tq=function(a){_q.handleWindowMouseMove(a)},fh=function(p){_q.handleWindowMouseUp(p),X(m,sm,tq),X(m,Dh,fh),_q=O},yj=function(D){return 1===Am(D)},Wn=function(R,b){return b?b.keyCode===R:Ej[R]},hl=function(k){return _e(k)&&Wn(65,k)},Zr=function(t){return Wn(46,t)||Wn(8,t)},ep=function(u){return function(d){return d?d.keyCode===u:Ej[u]}},nq=573,vp=[65,83,68,87,37,38,39,40,32,13,27],Zg=ep(vp[0]),af=ep(vp[1]),Ap=ep(vp[2]),Cm=ep(vp[3]),Fk=ep(vp[4]),fb=ep(vp[5]),tc=ep(vp[6]),dc=ep(vp[7]),ym=ep(vp[8]),Vm=ep(vp[9]),Le=ep(vp[10]),fj={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Lf=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,28051],Ie=O,fn=O,$h=function(N,k){Ie||(Ie=Uq()),Xr(Ie,N,k,1);var W=Kn(Ie);return W.clearRect(0,0,N,k),W},Cc=function(){var c,H={};for(var d in m){var Q=ys.length;if(d.length==Q&&d[0]===ys[2]&&d[1]===Jj[1]&&d[4]===ys[3]&&d[5]===ys[4]&&d.substr(Q-2)===Jj[1]+Jj[2]){var M=m[d];for(var U in M)U.length===Q&&U.substr(0,3)===xq[3]+Mp[3]+$r[0]&&U.substr(Q-2)===ys[0]+Fb[3]&&(Fn=M[U])}}return function(B){var z,A=H[B];return A||(c||(c=Uq(),Xr(c,1,1,1)),z=c.getContext("2d"),z.clearRect(0,0,1,1),hd(z,0,0,1,1,B),A=z.getImageData(0,0,1,1).data,A=H[B]=[A[0],A[1],A[2],A[3]]),A}}(),Yr=function(H){if(!xh(H))return H;var k=Cc(H);return k.CA||(k.CA=[k[0]/255,k[1]/255,k[2]/255,k[3]/255]),k.CA},Tg=function(I,O,H,u,V){var Y=Uq();Y.width=H,Y.height=u;var R=Y.getContext("2d");R.drawImage(I,0,0,H,u);try{for(var r=R.getImageData(0,0,H,u),x=r.data,d=0,m=x.length;m>d;d+=4){var w=x[d+0],h=x[d+1],E=x[d+2],i=x[d+3];"override_a"===V?x[d+3]=255*O[3]:"override_rgb"===V?(x[d+0]=255*O[0],x[d+1]=255*O[1],x[d+2]=255*O[2]):"override"===V?(x[d+0]=255*O[0],x[d+1]=255*O[1],x[d+2]=255*O[2],x[d+3]=255*O[3]):(x[d+0]=O[0]*w,x[d+1]=O[1]*h,x[d+2]=O[2]*E,x[d+3]=O[3]*i)}R.putImageData(r,0,0)}catch(B){return I}return Y},Zm=function(u,X,p){return X&&(X="miter"===p?8*X+20:X+1,u&&gn(u,X)),X},uk=function(n,t){if(t){var w=new eg(t),r=n.width/2,x=n.height/2,z=pr([w.tf(-r,-x),w.tf(r,-x),w.tf(r,x),w.tf(-r,x)]);return z.x+=n.x+r,z.y+=n.y+x,z}return n},Rl=function(x,_,u,F,j,E,Q,k){F*=Math.PI/180;var I={x:Math.cos(F)*(x.x-Q.x)/2+Math.sin(F)*(x.y-Q.y)/2,y:-Math.sin(F)*(x.x-Q.x)/2+Math.cos(F)*(x.y-Q.y)/2},X=Math.pow(I.x,2)/Math.pow(_,2)+Math.pow(I.y,2)/Math.pow(u,2);X>1&&(_*=Math.sqrt(X),u*=Math.sqrt(X));var m=(j==E?-1:1)*Math.sqrt((Math.pow(_,2)*Math.pow(u,2)-Math.pow(_,2)*Math.pow(I.y,2)-Math.pow(u,2)*Math.pow(I.x,2))/(Math.pow(_,2)*Math.pow(I.y,2)+Math.pow(u,2)*Math.pow(I.x,2)));isNaN(m)&&(m=0);var U={x:m*_*I.y/u,y:m*-u*I.x/_},o={x:(x.x+Q.x)/2+Math.cos(F)*U.x-Math.sin(F)*U.y,y:(x.y+Q.y)/2+Math.sin(F)*U.x+Math.cos(F)*U.y},C=function(Z){return Math.sqrt(Math.pow(Z[0],2)+Math.pow(Z[1],2))},y=function(k,$){return(k[0]*$[0]+k[1]*$[1])/(C(k)*C($))},t=function(u,F){return(u[0]*F[1]<u[1]*F[0]?-1:1)*Math.acos(y(u,F))},Y=t([1,0],[(I.x-U.x)/_,(I.y-U.y)/u]),w=[(I.x-U.x)/_,(I.y-U.y)/u],i=[(-I.x-U.x)/_,(-I.y-U.y)/u],h=t(w,i);y(w,i)<=-1&&(h=Math.PI),y(w,i)>=1&&(h=0);var y=_>u?_:u,g=_>u?1:_/u,B=_>u?u/_:1;if(null==k){var Z={x:0,y:0,width:0,height:0};gn(Z,y),Z.x*=g,Z.width*=g,Z.y*=B,Z.height*=B;var G=new eg(F);return Z=pr([G.tf(Z.x,Z.y),G.tf(Z.x+Z.width,Z.y),G.tf(Z.x+Z.width,Z.y+Z.height),G.tf(Z.x,Z.y+Z.height)]),Z.x+=o.x,Z.y+=o.y,[{x:Z.x,y:Z.y},{x:Z.x+Z.width,y:Z.y},{x:Z.x+Z.width,y:Z.y+Z.height},{x:Z.x,y:Z.y+Z.height}]}k.translate(o.x,o.y),k.rotate(F),k.scale(g,B),k.arc(0,0,y,Y,Y+h,1-E),k.scale(1/g,1/B),k.rotate(-F),k.translate(-o.x,-o.y)},rr=function(p,B){p&&p.beginPath();for(var f,A,e,i=[],q=function(N){for(var E,z=/(\-{0,1}[\d\.]+)/gi,g=[];E=z.exec(N);)g.push(parseFloat(E[0]));return g},V=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,C={x:0,y:0};f=V.exec(B);){var I=f[0],S=I.substr(0,1);if("M"===S||"m"===S){for(var h=q(I),Z=0;Z<h.length;Z+=2){var K=h[Z],s=h[Z+1];"m"===S&&(K+=C.x,s+=C.y),p&&p.moveTo(K,s),i.push({x:K,y:s}),C.x=K,C.y=s}A=e=null}else if("H"===S||"h"===S){for(var h=q(I),Z=0;Z<h.length;Z+=1){var K=h[Z];"h"===S&&(K+=C.x),p&&p.lineTo(K,C.y),i.push({x:K,y:C.y}),C.x=K}A=e=null}else if("C"===S||"c"===S){for(var h=q(I),Z=0;Z<h.length;Z+=6){var z=h[Z],P=h[Z+1],M=h[Z+2],t=h[Z+3],K=h[Z+4],s=h[Z+5];"c"===S&&(z+=C.x,P+=C.y,M+=C.x,t+=C.y,K+=C.x,s+=C.y),p&&p.bezierCurveTo(z,P,M,t,K,s),i.push({x:z,y:P}),i.push({x:M,y:t}),i.push({x:K,y:s}),C.x=K,C.y=s}A=[z,P,M,t,K,s],e=null}else if("S"===S||"s"===S){for(var h=q(I),Z=0;Z<h.length;Z+=4){var z,P;A?(z=2*A[4]-A[2],P=2*A[5]-A[3]):(z=C.x,P=C.y);var M=h[Z],t=h[Z+1],K=h[Z+2],s=h[Z+3];"s"===S&&(M+=C.x,t+=C.y,K+=C.x,s+=C.y),p&&p.bezierCurveTo(z,P,M,t,K,s),i.push({x:z,y:P}),i.push({x:M,y:t}),i.push({x:K,y:s}),C.x=K,C.y=s}A=[z,P,M,t,K,s],e=null}else if("Q"===S||"q"===S){for(var h=q(I),Z=0;Z<h.length;Z+=4){var z=h[Z],P=h[Z+1],K=h[Z+2],s=h[Z+3];"q"===S&&(z+=C.x,P+=C.y,K+=C.x,s+=C.y),p&&p.quadraticCurveTo(z,P,K,s),i.push({x:z,y:P}),i.push({x:K,y:s}),C.x=K,C.y=s}A=null,e=[z,P,K,s]}else if("T"===S||"t"===S){for(var h=q(I),Z=0;Z<h.length;Z+=2){var z,P;e?(z=2*e[2]-e[0],P=2*e[3]-e[1]):(z=C.x,P=C.y);var K=h[Z],s=h[Z+1];"t"===S&&(K+=C.x,s+=C.y),p&&p.quadraticCurveTo(z,P,K,s),i.push({x:z,y:P}),i.push({x:K,y:s}),C.x=K,C.y=s}A=null,e=[z,P,K,s]}else if("V"===S||"v"===S){for(var h=q(I),Z=0;Z<h.length;Z+=1){var s=h[Z];"v"===S&&(s+=C.y),p&&p.lineTo(C.x,s),i.push({x:C.x,y:s}),C.y=s}A=e=null}else if("L"===S||"l"===S){for(var h=q(I),Z=0;Z<h.length;Z+=2){var K=h[Z],s=h[Z+1];"l"===S&&(K+=C.x,s+=C.y),p&&p.lineTo(K,s),i.push({x:K,y:s}),C.x=K,C.y=s}A=e=null}else if("A"===S||"a"===S){for(var h=q(I),Z=0;Z<h.length;Z+=7){var G=h[Z],w=h[Z+1],D=h[Z+2],H=h[Z+3],n=h[Z+4],K=h[Z+5],s=h[Z+6];"a"===S&&(K+=C.x,s+=C.y);var b=Rl(C,G,w,D,H,n,{x:K,y:s},p);b&&(i=i.concat(b)),C.x=K,C.y=s}A=e=null}var $=I.substr(I.length-1);("z"===$||"Z"===$)&&p&&p.closePath()}return i},oh=function(_,m){var n,P,c="L"===m[0],A=m.length;_.save(),c?(_.transform(m[5],m[6],m[7],m[8],m[9],m[10]),n=_.createLinearGradient(m[1],m[2],m[3],m[4]),P=11):(_.transform(m[7],m[8],m[9],m[10],m[11],m[12]),n=_.createRadialGradient(m[1],m[2],m[3],m[4],m[5],m[6]),P=13);for(var H=_.compGray;A>P;)n.addColorStop(m[P],H?j.toGrayColor(m[P+1]):m[P+1]),P+=2;_.fillStyle=n},Nf=function(h,l){var Q=h.s("shape.gradient.pack");if(Q){for(var c=Q.length,q=new Array(c),g=0;c>g;g++)q[g]=Q[g];var u,b,d,t,C,W,A,N,U,S,_,s,v,I="L"===q[0];u=I?5:7,b=q[u],d=q[u+1],t=q[u+2],C=q[u+3],W=q[u+4],A=q[u+5],N=l[0],U=l[1],S=l[2],_=l[3],s=l[4],v=l[5],q[u]=N*b+S*d,q[u+1]=U*b+_*d,q[u+2]=N*t+S*C,q[u+3]=U*t+_*C,q[u+4]=N*W+S*A+s,q[u+5]=U*W+_*A+v,h.s("shape.gradient.pack",q)}},Ri=function(N,z,k,M){var g=!1;if(N.beginPath?N.beginPath():g=!0,re(z)&&(z=z._as),re(k)&&(k=k._as),k&&k.length){for(var w,S,q,p,x=0,v=0,I=k.length;I>v;v++)w=k[v],1===w?(S=z[x++],N.moveTo(S.x,g?-S.y:S.y)):2===w?(S=z[x++],N.lineTo(S.x,g?-S.y:S.y)):3===w?(S=z[x++],q=z[x++],N.quadraticCurveTo(S.x,g?-S.y:S.y,q.x,g?-q.y:q.y)):4===w?(S=z[x++],q=z[x++],p=z[x++],N.bezierCurveTo(S.x,g?-S.y:S.y,q.x,g?-q.y:q.y,p.x,g?-p.y:p.y)):5===w&&N.closePath();M&&5!==w&&N.closePath()}else{var H,X,A,l=z.length;if(l>0){for(H=z[0],N.moveTo(H.x,g?-H.y:H.y),X=1;l>X;X++)A=z[X],N.lineTo(A.x,g?-A.y:A.y);M&&N.closePath()}}},wj=function(u,b,J,A){if(re(u)&&(u=u._as),re(b)&&(b=b._as),b&&b.length){J=J||ns;for(var B,G,T,i,H,d,L,U,S=[],C=O,q=0,Q=0,m=b.length;m>Q;Q++)if(B=b[Q],1===B)S.push(C=[]),C.push(u[q++]);else if(2===B)C.push(u[q++]);else if(3===B){for(G=C[C.length-1],T=u[q++],i=u[q++],d=1;J>d;d++)L=Aj(d/J,G.x,T.x,i.x),U=Aj(d/J,G.y,T.y,i.y),C.push({x:L,y:U,b:!0});C.push(i)}else if(4===B){for(G=C[C.length-1],T=u[q++],i=u[q++],H=u[q++],d=1;J>d;d++)L=_d(d/J,G.x,T.x,i.x,H.x),U=_d(d/J,G.y,T.y,i.y,H.y),C.push({x:L,y:U,b:!0});C.push(H)}else 5===B&&C.push(C[0]);return A&&5!==B&&C&&C.length>2&&C.push(C[0]),S}return A&&u.length>2&&(u=u.slice(),u.push(u[0])),u?[u]:[]},kn=function(f,x,H,e,l,n){var P,A,S,M=Cc(x),v=e,U=M[0],y=M[1],m=M[2];if(H){var L=Cc(H);P=L[0]-U,A=L[1]-y,S=L[2]-m}else P=255-U,A=255-y,S=255-m;for(n||(n=e>10?1:.5,n=1>l?u(n/l,2):n),f.save(),f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=0,f.shadowColor=0;(e-=n)>0;){var j=1-e/v,N=U+P*j,J=y+A*j,Y=m+S*j;N=u($(N),255),J=u($(J),255),Y=u($(Y),255),f.strokeStyle="rgb("+N+","+J+","+Y+")",f.lineWidth=e,f.stroke()}f.restore()},ji=function(){var R={};return function(r,i){var A=r+"-"+i,G=R[A];if(G)return G;var w,M,q,Y=Cc(r);return 0>i?(i=(100+i)/100,w=$(Y[0]*i),M=$(Y[1]*i),q=$(Y[2]*i)):(i/=100,w=Y[0],M=Y[1],q=Y[2],w+=(255-w)*i,M+=(255-M)*i,q+=(255-q)*i,w=u($(w),255),M=u($(M),255),q=u($(q),255)),R[A]="rgb("+w+","+M+","+q+")"}}(),hd=function(q,I,e,C,E,y){y&&(q.fillStyle=y),q.beginPath(),q.rect(I,e,C,E),q.fill()},Ql=function(l,z,S,N,f,P,c){l.beginPath(),id[z](l,S.x,S.y,S.width,S.height,N,f,P,c)},mi=function(T,p,y,K,w){var M=id[y];T.fillStyle=M?M(T,p,K?K:xb,w.x,w.y,w.width,w.height):p},Zo=function(s,n,_,P,C,y){try{if(!n.tagName&&n.comps){n._cacheImage_||(n._cacheImage_={});var f;f="override"===P?"colors_override":"override_rgb"===P?"colors_override_rgb":"override_a"===P?"colors_override_a":"colors",n._cacheImage_[f]||(n._cacheImage_[f]={__count__:0});var R=n._cacheImage_[f][_];R||(n._cacheImage_[f].__count__>j.imageCacheThreshold&&(n._cacheImage_[f]={__count__:0}),R=Y.Default.toCanvas(n,Ne(n),Jf(n),null,C,y,_,null,P),n._cacheImage_[f][_]=R,n._cacheImage_[f].__count__++),n=R}s.fillStyle=s.createPattern(n,"repeat")}catch(t){s.fillStyle="black"}},bo=function(X,g,H,z,o,m,$){X.save(),X.translate(g,H),X.scale(1,$/m),X.arc(0,0,m,z,o),X.restore()},yo=function(V,Y,Q,q,v,_,B,z){var P,U,m,R,A,Z,x,C,h,L,O;if(w(v)>2*t&&(v=2*t),A=$(w(v)/(t/4)),P=v/A,U=-P,m=-q,A>0){Z=Y+c(q)*_,x=Q+N(-q)*B,z?V.lineTo(Z,x):V.moveTo(Z,x);for(var g=0;A>g;g++)m+=U,R=m-U/2,C=Y+c(m)*_,h=Q+N(m)*B,L=Y+c(R)*(_/c(U/2)),O=Q+N(R)*(B/c(U/2)),V.quadraticCurveTo(L,O,C,h)}},zi=function(m,v,U,i,R,Z,p,g,e){6===arguments.length&&(p=Z,g=Z,e=Z);var B=v+i,l=U+R,x=R>i?2*i:2*R;Z=x>Z?Z:x,p=x>p?p:x,g=x>g?g:x,e=x>e?e:x;var K=.29*e,d=.58*e;m.moveTo(B,l-e),m.quadraticCurveTo(B,l-d,B-K,l-K),m.quadraticCurveTo(B-d,l,B-e,l),K=.29*g,d=.58*g,m.lineTo(v+g,l),m.quadraticCurveTo(v+d,l,v+K,l-K),m.quadraticCurveTo(v,l-d,v,l-g),K=.29*Z,d=.58*Z,m.lineTo(v,U+Z),m.quadraticCurveTo(v,U+d,v+K,U+K),m.quadraticCurveTo(v+d,U,v+Z,U),K=.29*p,d=.58*p,m.lineTo(B-p,U),m.quadraticCurveTo(B-d,U,B-K,U+K),m.quadraticCurveTo(B,U+d,B,U+p),m.lineTo(B,l-e)},Vi=function(l,X,v,u,G,D,y){X&&(v=i(v),u=i(u),y||(y=1),l.fillStyle=X,l.beginPath(),l.rect(v,u,y,D),l.rect(v,u,G,y),D-y>0&&l.rect(v,u+D-y,G,y),G-y>0&&l.rect(v+G-y,u,y,D),l.fill())},ri=function(q,F,J,p){var V=p.x,f=p.y,o=p.width,Z=p.height;if(!(!F||!J||0>=o||0>=Z)){var $,A=Io(F),P=uo(F),B=J>0;1===J||-1===J?(q.fillStyle=B?A:P,q.beginPath(),q.rect(V,f,1,Z),q.rect(V,f,o,1),q.fill(),q.fillStyle=B?P:A,q.beginPath(),q.rect(V,f+Z-1,o,1),q.rect(V+o-1,f,1,Z),q.fill()):(J=u(w(J),u(o/2,Z/2)),$=q.createLinearGradient(V,f,V+J,f),$.addColorStop(0,B?A:P),$.addColorStop(1,F),q.fillStyle=$,q.beginPath(),q.moveTo(V,f),q.lineTo(V+J,f+J),q.lineTo(V+J,f+Z-J),q.lineTo(V,f+Z),q.lineTo(V,f),q.fill(),$=q.createLinearGradient(V,f,V,f+J),$.addColorStop(0,B?A:P),$.addColorStop(1,F),q.fillStyle=$,q.beginPath(),q.moveTo(V,f),q.lineTo(V+J,f+J),q.lineTo(V+o-J,f+J),q.lineTo(V+o,f),q.lineTo(V,f),q.fill(),$=q.createLinearGradient(V,f+Z,V,f+Z-J),$.addColorStop(0,B?P:A),$.addColorStop(1,F),q.fillStyle=$,q.beginPath(),q.moveTo(V,f+Z),q.lineTo(V+J,f+Z-J),q.lineTo(V+o-J,f+Z-J),q.lineTo(V+o,f+Z),q.lineTo(V,f+Z),q.fill(),$=q.createLinearGradient(V+o,f,V+o-J,f),$.addColorStop(0,B?P:A),$.addColorStop(1,F),q.fillStyle=$,q.beginPath(),q.moveTo(V+o,f),q.lineTo(V+o-J,f+J),q.lineTo(V+o-J,f+Z-J),q.lineTo(V+o,f+Z),q.lineTo(V+o,f),q.fill())}},iq=function(U,k,n,h,N,r,t){var Z=U.createLinearGradient(h,N,r,t);return Z.addColorStop(0,n),Z.addColorStop(1,k),Z},tg=function(L,G,p,n,q,r,E){var w=L.createLinearGradient(n,q,r,E);return w.addColorStop(0,G),w.addColorStop(.5,p),w.addColorStop(1,G),w},cn=function(v,j,T,O,E,a,I){var s=v.createLinearGradient(O,E,a,I);return s.addColorStop(0,j),s.addColorStop(1/3,T),s.addColorStop(2/3,j),s.addColorStop(1,T),s
},vg=function(E,N,V,w,k,T,c,s,Z){var W=E.createRadialGradient(w+T*s,k+c*Z,u(T,c)/24,w+T/2,k+c/2,P(T,c)/2);return W.addColorStop(0,V),W.addColorStop(1,N),W},Tm=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],id={polygon:function(L,y,b,x,H,C){(C==O||3>C)&&(C=6);for(var g,B,d=u(x,H)/2,o=y+x/2,w=b+H/2,i=0,V=2*t/C,r=0;C>r;r++)g=o+c(i)*d,B=w+N(i)*d,0===r?L.moveTo(g,B):L.lineTo(g,B),i+=V;L.closePath()},arc:function(M,F,q,R,m,E,U,b,V){E==O&&(E=t),U==O&&(U=A),b==O&&(b=!0);var n=F+R/2,N=q+m/2;b&&M.moveTo(n,N),V?bo(M,n,N,E,U,R/2,m/2):M.arc(n,N,u(R,m)/2,E,U),b&&M.closePath()},rect:function(G,e,o,y,t){G.rect(e,o,y,t)},circle:function(y,n,v,x,i){y.arc(n+x/2,v+i/2,u(x,i)/2,0,A,!0)},oval:function(t,q,S,b,D){bo(t,q+b/2,S+D/2,0,A,b/2,D/2)},roundRect:function(Q,L,Y,H,G,j){j==O&&(j=u(u(H,G)/4,8)),zi(Q,L,Y,H,G,j)},star:function(W,L,U,X,Z){var M=2*X,N=2*Z,v=L+X/2,_=U+Z/2;W.moveTo(v-M/4,_-N/12),W.lineTo(L+.306*X,U+.579*Z),W.lineTo(v-M/6,_+N/4),W.lineTo(L+X/2,U+.733*Z),W.lineTo(v+M/6,_+N/4),W.lineTo(L+.693*X,U+.579*Z),W.lineTo(v+M/4,_-N/12),W.lineTo(L+.611*X,U+.332*Z),W.lineTo(v+0,_-N/4),W.lineTo(L+.388*X,U+.332*Z),W.closePath()},pentagram:function(x,j,e,o,K){var N=.5*K,n=j+.5*o,h=e+N,B=.5257311121191336*o;B>N&&(B=N);var C=Tm,c=0;for(x.moveTo(n+B*C[c++],h+B*C[c++]);20>c;)x.lineTo(n+B*C[c++],h+B*C[c++]);x.closePath()},triangle:function(Y,h,k,t,U){Y.moveTo(h+t/2,k),Y.lineTo(h+t,k+U),Y.lineTo(h,k+U),Y.closePath()},hexagon:function(e,f,D,n,r){e.moveTo(f,D+r/2),e.lineTo(f+n/4,D+r),e.lineTo(f+3*n/4,+D+r),e.lineTo(f+n,D+r/2),e.lineTo(f+3*n/4,D),e.lineTo(f+n/4,D),e.closePath()},pentagon:function(N,f,v,e,d){var k=2*e,l=2*d,u=f+e/2,W=v+d/2;N.moveTo(u-k/4,W-l/12),N.lineTo(u-k/6,W+l/4),N.lineTo(u+k/6,W+l/4),N.lineTo(u+k/4,W-l/12),N.lineTo(u+0,W-l/4),N.closePath()},diamond:function(p,R,Y,U,l){p.moveTo(R+U/2,Y),p.lineTo(R,Y+l/2),p.lineTo(R+U/2,Y+l),p.lineTo(R+U,Y+l/2),p.closePath()},rightTriangle:function(v,H,V,K,x){v.moveTo(H,V),v.lineTo(H+K,V+x),v.lineTo(H,V+x),v.closePath()},parallelogram:function(n,O,c,u,v){var T=u/4;n.moveTo(O+T,c),n.lineTo(O+u,c),n.lineTo(O+u-T,c+v),n.lineTo(O,c+v),n.closePath()},trapezoid:function(R,C,I,J,n){var H=J/4;R.moveTo(C+H,I),R.lineTo(C+J-H,I),R.lineTo(C+J,I+n),R.lineTo(C,I+n),R.closePath()},"linear.southwest":function(r,q,Y,N,F,h,s){return iq(r,q,Y,N,F+s,N+h,F)},"linear.southeast":function(y,v,D,w,Y,N,g){return iq(y,v,D,w+N,Y+g,w,Y)},"linear.northwest":function(F,A,a,B,Q,e,z){return iq(F,A,a,B,Q,B+e,Q+z)},"linear.northeast":function(M,B,T,u,h,R,X){return iq(M,B,T,u+R,h,u,h+X)},"linear.north":function($,n,I,c,p,k,E){return iq($,n,I,c,p,c,p+E)},"linear.south":function(E,w,h,_,J,P,Y){return iq(E,w,h,_,J+Y,_,J)},"linear.west":function(k,j,D,P,p,x){return iq(k,j,D,P,p,P+x,p)},"linear.east":function(l,$,J,w,S,Q){return iq(l,$,J,w+Q,S,w,S)},"radial.center":function($,d,F,T,R,B,b){return vg($,d,F,T,R,B,b,.5,.5)},"radial.southwest":function(F,Q,b,H,W,N,i){return vg(F,Q,b,H,W,N,i,.25,.75)},"radial.southeast":function(Q,q,o,M,l,H,a){return vg(Q,q,o,M,l,H,a,.75,.75)},"radial.northwest":function(V,u,j,D,x,A,z){return vg(V,u,j,D,x,A,z,.25,.25)},"radial.northeast":function(p,C,K,T,G,D,s){return vg(p,C,K,T,G,D,s,.75,.25)},"radial.north":function(j,q,y,M,w,L,H){return vg(j,q,y,M,w,L,H,.5,.25)},"radial.south":function(w,q,C,j,Q,P,t){return vg(w,q,C,j,Q,P,t,.5,.75)},"radial.west":function(d,w,O,U,j,o,I){return vg(d,w,O,U,j,o,I,.25,.5)},"radial.east":function(p,d,n,T,s,y,o){return vg(p,d,n,T,s,y,o,.75,.5)},"spread.horizontal":function(x,m,_,X,u,d){return tg(x,m,_,X,u,X+d,u)},"spread.vertical":function(n,t,G,W,J,r,v){return tg(n,t,G,W,J,W,J+v)},"spread.diagonal":function(J,S,P,W,u,o,K){return tg(J,S,P,W+o,u,W,u+K)},"spread.antidiagonal":function(S,y,M,t,p,F,O){return tg(S,y,M,t,p,t+F,p+O)},"spread.north":function(f,O,W,o,b,P,B){return cn(f,O,W,o,b-B/4,o,b+B+B/4)},"spread.south":function(X,g,l,k,F,D,J){return cn(X,l,g,k,F-J/4,k,F+J+J/4)},"spread.west":function(E,H,$,C,R,b){return cn(E,H,$,C-b/4,R,C+b+b/4,R)},"spread.east":function(M,t,J,$,S,r){return cn(M,J,t,$-r/4,S,$+r+r/4,S)}},im=function(N,Z,t){return new eg(N).tf(Z,t)},Im=function(T){var N=T.touches[0],Q=T.touches[1],Y=N.clientX,h=N.clientY,m=Q.clientX,E=Q.clientY;return e((Y-m)*(Y-m)+(h-E)*(h-E))},li=function(E){var F=E.touches[0],m=E.touches[1],Q=F.clientX,$=F.clientY,D=m.clientX,b=m.clientY;return{x:(Q+D)/2,y:($+b)/2}},il=(function(){for(var r=0,Y=js.split(""),b=0;b<Y.length;b++)r=10*I(Y[b])+r;return Vg(m[nq.toString(8*b)+Tk.substr(b)+3],m[nq.toString(8*b)+Tk.substr(b)+4]),r}(),function(V,H,h){for(var B=0;B<h.size();B++){var b=h.get(B);V.co(b)&&H.add(b)}for(B=0;B<h.size();B++)b=h.get(B),il(V,H,b._children)}),ds=function(R,P,K){for(var N=0;N<K.size();N++){var C=K.get(K.size()-1-N);R.co(C)&&P.add(C)}for(N=0;N<K.size();N++)C=K.get(N),ds(R,P,C._children)},Wj=function(H,p,E){for(var k=!1,_=0;_<E.size();_++){var P=E.get(_);H.co(P)?k&&p.add(P):k=1}for(_=0;_<E.size();_++)P=E.get(_),Wj(H,p,P._children)},yc=function(N,Y,y){for(var l=!1,U=0;U<y.size();U++){var c=y.get(y.size()-1-U);N.co(c)?l&&Y.add(c):l=!0}for(U=0;U<y.size();U++)c=y.get(U),yc(N,Y,c._children)},qq=j.moveDatas=function(M,f,J,T){var p=T==O;if(0!==f||0!==J||!p&&0!==T){var $=!0,j=[];if(M.forEach(function(l){$&&(l._69O||mh(l)||Ti(l))&&($=!1)}),$)j=M;else{var X={},P={};M.forEach(function(V){X[V._id]=!0});var G={},A=function(d){var Q=d._id;return X[Q]?(j.push(d),G[Q]=!0):G[Q]=!1},S=function(y){var j=y._id;if(P[j])return A(y);var u=G[j];if(u!==n)return u;var C=y._parent;if(C&&(Ti(C)||mh(C))&&S(C))return G[j]=!0;var r=y._host;return r&&(P[j]=j,u=S(r),P[j]=n,u)?G[j]=!0:A(y)};M.forEach(function(n){S(n)})}j.forEach(function(s){if(De(s))p?s.translate(f,J):s.translate3d(f,J,T);else{var c=s.s(tn);if(!c||c.isEmpty())return;var R=new zf;c.each(function(A){A=qk(A),p?(A.x+=f,A.y+=J):(A.x+=f,A.y+=T,A.e==O?A.e=J:A.e+=J),R.add(A)}),s.s(tn,R)}})}},nb=function(){function E(y,x){return x===y.substring(0,x.length)?!0:!1}function D(Z){return parseFloat(Z)||0}function h(e,z){if(z==n&&(z=new Hf),E(e,"matrix3d")){var i=e.substring(9,e.length-1).split(",");i=i.map(D),z.fromArray(i)}else if(E(e,"matrix")){var i=e.substring(7,e.length-1).split(",");i=i.map(D),z.el[0]=i[0],z.el[1]=i[1],z.el[2]=0,z.el[3]=0,z.el[4]=i[2],z.el[5]=i[3],z.el[6]=0,z.el[7]=0,z.el[8]=0,z.el[9]=0,z.el[10]=1,z.el[11]=0,z.el[12]=i[4],z.el[13]=i[5],z.el[14]=0,z.el[15]=1}return z}function H(W,N){N==n&&(N=new sh);var J=W.split(/\s+/);return J=J.map(D),N.set(J[0]||0,J[1]||0,J[2]||0),N}var B,g,x,S,Q,k=function(o,_){B||(B=new Hf,g=new sh,x=new Hf,S=new Hf,Q=new Hf),_==n&&(_=new Hf);var I=getComputedStyle(o);I.transform&&"none"!==I.transform&&(h(I.transform,B),H(I.transformOrigin,g),S.setPosition(g),g.negate(),Q.setPosition(g),(kr||"preserve-3d"!==I.transformStyle)&&(B.el[8]=0,B.el[9]=0,B.el[10]=1,B.el[11]=0),_.multiplyMatrices(Q,_),_.multiplyMatrices(B,_),_.multiplyMatrices(S,_)),!kr&&I.perspective&&"none"!==I.perspective&&(x.el[11]=-1/D(I.perspective),H(I.perspectiveOrigin,g),S.setPosition(g),g.negate(),Q.setPosition(g),_.multiplyMatrices(Q,_),_.multiplyMatrices(x,_),_.multiplyMatrices(S,_));for(var p=o.offsetParent,u=o.offsetLeft,y=o.offsetTop,P=o.parentElement;P&&P!==p;){var q=getComputedStyle(P);if("none"!==q.transform||"none"!==q.perspective)break;P=P.parentElement}return P==n&&o!==o.ownerDocument.documentElement&&"fixed"!==I.position&&(P=o.ownerDocument.documentElement),p!=n&&p!==P&&(u-=P.offsetLeft,y-=P.offsetTop),g.set(u,y,0),S.setPosition(g),_.multiplyMatrices(S,_),P&&k(P,_),_};return function(Q,e){var i=Q.parentElement;if(i){var l=i.updateAppendMatrix;if(l){delete i.updateAppendMatrix;var w=new Hf;k(i,w);var p=new Hf;p.getInverse(w),i._matrixAppend=p,i._maxrixPreAppend=w}return e?i._matrixAppend:i._maxrixPreAppend}}}(),di=function(W,U){for(;W&&!W.hasOwnProperty(U);)W=L.getPrototypeOf(W);return W&&L.getOwnPropertyDescriptor(W,U)},Kc=L.getPrototypeOf?function(N,w,z){var h=di(w,z);h&&L.defineProperty(N,z,h)}:function(Z,F,v){Z[v]=F[v]},Uo={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ke=function(){var H={1:function(A,l){return{x:A.x-l.width/2,y:A.y-l.height/2}},2:function(E,H){return{x:E.x+H.width/2,y:E.y-H.height/2}},3:function(t,w){return{x:t.x+t.width/2,y:t.y-w.height/2}},4:function(g,L){return{x:g.x+g.width-L.width/2,y:g.y-L.height/2}},5:function(a,w){return{x:a.x+a.width+w.width/2,y:a.y-w.height/2}},6:function(x){return{x:x.x,y:x.y}},7:function(K){return{x:K.x+K.width/2,y:K.y}},8:function(f){return{x:f.x+f.width,y:f.y}},9:function(q,L){return{x:q.x-L.width/2,y:q.y+L.height/2}},10:function(y,Q){return{x:y.x+Q.width/2,y:y.y+Q.height/2}},11:function(n,g){return{x:n.x+n.width/2,y:n.y+g.height/2}},12:function(T,a){return{x:T.x-a.width/2+T.width,y:T.y+a.height/2}},13:function(q,u){return{x:q.x+q.width+u.width/2,y:q.y+u.height/2}},14:function(f,y){return{x:f.x-y.width/2,y:f.y+f.height/2}},15:function(v){return{x:v.x,y:v.y+v.height/2}},16:function(t,W){return{x:t.x+W.width/2,y:t.y+t.height/2}},17:function(j){return{x:j.x+j.width/2,y:j.y+j.height/2}},18:function(s,j){return{x:s.x+s.width-j.width/2,y:s.y+s.height/2}},19:function(B){return{x:B.x+B.width,y:B.y+B.height/2}},20:function(T,c){return{x:T.x+T.width+c.width/2,y:T.y+T.height/2}},21:function(z,N){return{x:z.x-N.width/2,y:z.y+z.height-N.height/2}},22:function(L,H){return{x:L.x+H.width/2,y:L.y+L.height-H.height/2}},23:function(L,M){return{x:L.x+L.width/2,y:L.y+L.height-M.height/2}},24:function(P,w){return{x:P.x+P.width-w.width/2,y:P.y+P.height-w.height/2}},25:function(k,M){return{x:k.x+k.width+M.width/2,y:k.y+k.height-M.height/2}},26:function(m){return{x:m.x,y:m.y+m.height}},27:function(E){return{x:E.x+E.width/2,y:E.y+E.height}},28:function(o){return{x:o.x+o.width,y:o.y+o.height}},29:function(i,E){return{x:i.x-E.width/2,y:i.y+i.height+E.height/2}},30:function(s,A){return{x:s.x+A.width/2,y:s.y+s.height+A.height/2}},31:function(E,R){return{x:E.x+E.width/2,y:E.y+E.height+R.height/2}},32:function(I,J){return{x:I.x+I.width-J.width/2,y:I.y+I.height+J.height/2}},33:function(k,U){return{x:k.x+k.width+U.width/2,y:k.y+k.height+U.height/2}},34:function(q,j){return{x:q.x,y:q.y-j.height/2}},35:function(D,P){return{x:D.x+D.width,y:D.y-P.height/2}},36:function(O,V){return{x:O.x,y:O.y+O.height+V.height/2}},37:function(h,L){return{x:h.x+h.width,y:h.y+h.height+L.height/2}},38:function(O,d){return{x:O.x+O.width/4,y:O.y-d.height/2}},39:function(v,B){return{x:v.x+3*v.width/4,y:v.y-B.height/2}},40:function(Z){return{x:Z.x+Z.width/4,y:Z.y}},41:function(J){return{x:J.x+3*J.width/4,y:J.y}},42:function(x,_){return{x:x.x+x.width/4,y:x.y+_.height/2}},43:function(M,A){return{x:M.x+3*M.width/4,y:M.y+A.height/2}},44:function(B,Y){return{x:B.x+B.width/2,y:B.y+B.height/2-Y.height/2}},45:function(U){return{x:U.x+U.width/4,y:U.y+U.height/2}},46:function(H,h){return{x:H.x+H.width/2-h.width/2,y:H.y+H.height/2}},47:function(D,U){return{x:D.x+D.width/2+U.width/2,y:D.y+D.height/2}},48:function(n){return{x:n.x+3*n.width/4,y:n.y+n.height/2}},49:function(x,n){return{x:x.x+x.width/2,y:x.y+x.height/2+n.height/2}},50:function(N,S){return{x:N.x+N.width/4,y:N.y+N.height-S.height/2}},51:function(H,g){return{x:H.x+3*H.width/4,y:H.y+H.height-g.height/2}},52:function(G){return{x:G.x+G.width/4,y:G.y+G.height}},53:function(I){return{x:I.x+3*I.width/4,y:I.y+I.height}},54:function(X,M){return{x:X.x+X.width/4,y:X.y+X.height+M.height/2}},55:function(v,F){return{x:v.x+3*v.width/4,y:v.y+v.height+F.height/2}}};return bj(m)?function(Z,U,y){return H[Z](U,y?y:yk)}:void 0}();Dq(R,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var bb=R.reverse,Fg=R.transparent,kh=R.rectSelectBackground,Mh=R.dash,lg=R.titleBackground,Rh=R.titleIconBackground,Vl=R.headerBackground,mm=R.headerIconBackground,gq=R.headerSeparator,_b=R.headerLine,Cj=R.contentIconBackground,ir=R.contentLine,cj=(R.widgetIconHighlight,R.widgetIconBorder),Pb=(R.widgetIconGradient,R.imageBackground),xb=R.imageGradient,Tr=R.highlight,Qb=R.label,Ye=R.labelSelect;if(Z&&!m.shutAlert1){var Fp=new Date,xo=Z.split("-"),Ph=new Date(Fp.getFullYear(),Fp.getMonth(),Fp.getDate()),Z=new Date(I(xo[0],10),I(xo[1],10)-1,I(xo[2],10)),ip=Ph.getTime(),ng=Z.getTime(),ve=F+"_try",sj=m.alert;try{var hn=m.localStorage;if(hn&&sj)if(ng>ip&&1728e6>ng-ip){var nr=(ng-ip)/864e5;hn&&hn[ve]!=nr&&(hn[ve]=nr,m.htWillExpire?sj(m.htWillExpire.replace("{{day}}",nr)):sj("HT for Web free trial license will expire in "+nr+" days, please apply for a new license!"))}else ip>=ng&&(m.htExpired?sj(m.htExpired):sj("Your free trial of HT for Web has expired!")),hn&&delete hn[ve]}catch(ic){}}Math.sign===n&&(Math.sign=function(x){return 0>x?-1:x>0?1:+x});var vk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Xk={encode:function(u,h){var d,N,c,O,m,Z,r,k="",b=0;for(u=Xk._utf8_encode(u);b<u.length;)d=u.charCodeAt(b++),N=u.charCodeAt(b++),c=u.charCodeAt(b++),O=d>>2,m=(3&d)<<4|N>>4,Z=(15&N)<<2|c>>6,r=63&c,isNaN(N)?Z=r=64:isNaN(c)&&(r=64),k=k+h.charAt(O)+h.charAt(m)+h.charAt(Z)+h.charAt(r);return k},decode:function(d,$){var i,Z,X,V,x,v,y,r="",P=0;for(d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");P<d.length;)V=$.indexOf(d.charAt(P++)),x=$.indexOf(d.charAt(P++)),v=$.indexOf(d.charAt(P++)),y=$.indexOf(d.charAt(P++)),i=V<<2|x>>4,Z=(15&x)<<4|v>>2,X=(3&v)<<6|y,r+=String.fromCharCode(i),64!=v&&(r+=String.fromCharCode(Z)),64!=y&&(r+=String.fromCharCode(X));return r=Xk._utf8_decode(r)},_utf8_encode:function(i){i=i.replace(/\r\n/g,"\n");for(var b="",Q=0;Q<i.length;Q++){var m=i.charCodeAt(Q);128>m?b+=String.fromCharCode(m):m>127&&2048>m?(b+=String.fromCharCode(192|m>>6),b+=String.fromCharCode(128|63&m)):(b+=String.fromCharCode(224|m>>12),b+=String.fromCharCode(128|63&m>>6),b+=String.fromCharCode(128|63&m))}return b},_utf8_decode:function(M){for(var P="",a=0,J=0,G=0,X=0;a<M.length;)J=M.charCodeAt(a),128>J?(P+=String.fromCharCode(J),a++):J>191&&224>J?(G=M.charCodeAt(a+1),P+=String.fromCharCode((31&J)<<6|63&G),a+=2):(G=M.charCodeAt(a+1),X=M.charCodeAt(a+2),P+=String.fromCharCode((15&J)<<12|(63&G)<<6|63&X),a+=3);return P}},gd=[],no=[],Jm=Y.Math={generateUUID:function(){for(var W=[],N=0;256>N;N++)W[N]=(16>N?"0":"")+N.toString(16).toUpperCase();return function(){var D=0|4294967295*Math.random(),P=0|4294967295*Math.random(),E=0|4294967295*Math.random(),B=0|4294967295*Math.random();return W[255&D]+W[255&D>>8]+W[255&D>>16]+W[255&D>>24]+"-"+W[255&P]+W[255&P>>8]+"-"+W[64|15&P>>16]+W[255&P>>24]+"-"+W[128|63&E]+W[255&E>>8]+"-"+W[255&E>>16]+W[255&E>>24]+W[255&B]+W[255&B>>8]+W[255&B>>16]+W[255&B>>24]}}(),clamp:function(B,a,F){return Math.max(a,Math.min(F,B))},generateIncreasingID:function(){var D=0;return function(){return++D}}(),encodeBase64:function(U,t){return Xk.encode(U,t||vk)},decodeBase64:function($,X){return Xk.decode($,X||vk)},randomArray:function(i,D){D=D||i.length;for(var Z=D-1;Z>0;Z--){var O=Math.floor(Math.random()*(Z+1)),J=i[Z];i[Z]=i[O],i[O]=J}return i},isPOT:function($){return $>0&&0===($-1&$)},nearestPOT:function(P){if(!P)return 1;var l=P;l--,l|=l>>1,l|=l>>2,l|=l>>4,l|=l>>8,l|=l>>16,l++;var g=l>>1;return P-g>l-P?l:g},requestMatrix4:function(){return gd.length>0?gd.pop():new Jm.Matrix4},releaseMatrix4:function(k){gd.push(k)},requestVector3:function(){return no.length>0?no.pop():new Jm.Vector3},releaseVector3:function(E){no.push(E)}},Hm=Y.Matrix=Y.Math.Matrix2d=function(f,O,u,K,e){this.setFromTransform(f,O,u,K,e)},eg=Hm;Hm.prototype={},Hm.prototype.constructor=Hm,Hm.prototype.set=function(B,J,o,y,E,s){return this.a=B,this.b=J,this.c=o,this.d=y,this.tx=E,this.ty=s,this},Hm.prototype.setFromTransform=function(W,j,l,T,L){var y=this;if(W===n)return y.a=1,y.b=0,y.c=0,y.d=1,y.tx=0,y.ty=0,void 0;W=W||0;var X=N(W),J=c(W);return T=T||1,L=L||1,y.a=J*T,y.b=X*T,y.c=-X*L,y.d=J*L,y.tx=j||0,y.ty=l||0,y},Hm.prototype.apply=function(L,g){g=g||new _h;var l=L.x,R=L.y;return g.x=this.a*l+this.c*R+this.tx,g.y=this.b*l+this.d*R+this.ty,g},Hm.prototype.applyInverse=function(I,P){P=P||new _h;var o=1/(this.a*this.d+this.c*-this.b),G=I.x,q=I.y;return P.x=this.d*o*G+-this.c*o*q+(this.ty*this.c-this.tx*this.d)*o,P.y=this.a*o*q+-this.b*o*G+(-this.ty*this.a+this.tx*this.b)*o,P},Hm.prototype.translate=function(s,$){return this.tx+=s,this.ty+=$,this},Hm.prototype.scale=function(l,s){return this.a*=l,this.d*=s,this.c*=l,this.b*=s,this.tx*=l,this.ty*=s,this},Hm.prototype.rotate=function(S){var H=Math.cos(S),R=Math.sin(S),O=this.a,W=this.c,d=this.tx;return this.a=O*H-this.b*R,this.b=O*R+this.b*H,this.c=W*H-this.d*R,this.d=W*R+this.d*H,this.tx=d*H-this.ty*R,this.ty=d*R+this.ty*H,this},Hm.prototype.appendTranslate=function(Z,_){return this.tx+=this.a*Z+this.c*_,this.ty+=this.b*Z+this.d*_,this},Hm.prototype.appendScale=function(q,S){return this.a*=q,this.d*=S,this.c*=S,this.b*=q,this},Hm.prototype.appendRotate=function(L){if(!L)return this;var S=Math.cos(L),i=Math.sin(L),E=this.a,k=this.b;return this.a=E*S+this.c*i,this.b=k*S+this.d*i,this.c=-E*i+this.c*S,this.d=-k*i+this.d*S,this},Hm.prototype.append=function(Q){var I=this.a,X=this.b,q=this.c,p=this.d;return this.a=Q.a*I+Q.b*q,this.b=Q.a*X+Q.b*p,this.c=Q.c*I+Q.d*q,this.d=Q.c*X+Q.d*p,this.tx=Q.tx*I+Q.ty*q+this.tx,this.ty=Q.tx*X+Q.ty*p+this.ty,this},Hm.prototype.setTransform=function(q,s,G,H,B,p,c,e,g){var T,Y,W,$,w,d,J,O,f,n;return w=Math.sin(c),d=Math.cos(c),J=Math.cos(g),O=Math.sin(g),f=-Math.sin(e),n=Math.cos(e),T=d*B,Y=w*B,W=-w*p,$=d*p,this.a=J*T+O*W,this.b=J*Y+O*$,this.c=f*T+n*W,this.d=f*Y+n*$,this.tx=q+(G*T+H*W),this.ty=s+(G*Y+H*$),this},Hm.prototype.prepend=function(W){var z=this.tx;if(1!==W.a||0!==W.b||0!==W.c||1!==W.d){var v=this.a,w=this.c;this.a=v*W.a+this.b*W.c,this.b=v*W.b+this.b*W.d,this.c=w*W.a+this.d*W.c,this.d=w*W.b+this.d*W.d}return this.tx=z*W.a+this.ty*W.c+W.tx,this.ty=z*W.b+this.ty*W.d+W.ty,this},Hm.prototype.transform=Hm.prototype.prepend,Hm.prototype.invert=function(){var u=this.a,d=this.b,D=this.c,A=this.d,t=this.tx,a=u*A-d*D;return this.a=A/a,this.b=-d/a,this.c=-D/a,this.d=u/a,this.tx=(D*this.ty-A*t)/a,this.ty=-(u*this.ty-d*t)/a,this},Hm.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Hm.prototype.clone=function(){var L=new Hm;return L.a=this.a,L.b=this.b,L.c=this.c,L.d=this.d,L.tx=this.tx,L.ty=this.ty,L},Hm.prototype.copy=function(V){return V.a=this.a,V.b=this.b,V.c=this.c,V.d=this.d,V.tx=this.tx,V.ty=this.ty,V},Hm.prototype.tf=function(I,i){1===arguments.length&&(i=I.y,I=I.x);var r=this;return{x:r.a*I+r.c*i+r.tx,y:r.b*I+r.d*i+r.ty}},Hm.prototype.tfi=function(j,w){1===arguments.length&&(w=j.y,j=j.x);var F=this,B=1/(F.a*F.d+F.c*-F.b);return{x:F.d*B*j+-F.c*B*w+(F.ty*F.c-F.tx*F.d)*B,y:F.a*B*w+-F.b*B*j+(-F.ty*F.a+F.tx*F.b)*B}},Hm.IDENTITY=new Hm,Hm.TEMP_MATRIX=new Hm;var Rf=Y.Math.Quaternion=function(M,j,b,H){this.set(M,j,b,H)};L.assign(Rf.prototype,{set:function(R,S,C,H){var A=this;return A._x=R||0,A._y=S||0,A._z=C||0,A._w=H!==n?H:1,A},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(f){var a=this;return a._x=f._x,a._y=f._y,a._z=f._z,a._w=f._w,a},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(L){return this._x*L._x+this._y*L._y+this._z*L._z+this._w*L._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var R=this.length();return 0===R?(this._x=0,this._y=0,this._z=0,this._w=1):(R=1/R,this._x=this._x*R,this._y=this._y*R,this._z=this._z*R,this._w=this._w*R),this},fromArray:function(d,N){N===n&&(N=0);var X=this;return X._x=d[N],X._y=d[N+1],X._z=d[N+2],X._w=d[N+3],this},slerp:function(T,x){if(0===x)return this;if(1===x)return this.copy(T);var h=this._x,V=this._y,n=this._z,b=this._w,u=b*T._w+h*T._x+V*T._y+n*T._z;if(0>u?(this._w=-T._w,this._x=-T._x,this._y=-T._y,this._z=-T._z,u=-u):this.copy(T),u>=1)return this._w=b,this._x=h,this._y=V,this._z=n,this;var G=Math.sqrt(1-u*u);if(Math.abs(G)<.001)return this._w=.5*(b+this._w),this._x=.5*(h+this._x),this._y=.5*(V+this._y),this._z=.5*(n+this._z),this;var O=Math.atan2(G,u),o=Math.sin((1-x)*O)/G,d=Math.sin(x*O)/G;return this._w=b*o+this._w*d,this._x=h*o+this._x*d,this._y=V*o+this._y*d,this._z=n*o+this._z*d,this},setFromAxisAngle:function(q,S){var l=S/2,C=Math.sin(l);return this._x=q.x*C,this._y=q.y*C,this._z=q.z*C,this._w=Math.cos(l),this},setFromEuler:function(C){var b=C._x,r=C._y,s=C._z,R=C._order,g=Math.cos,i=Math.sin,H=g(b/2),d=g(r/2),N=g(s/2),V=i(b/2),f=i(r/2),j=i(s/2);return"XYZ"===R?(this._x=V*d*N+H*f*j,this._y=H*f*N-V*d*j,this._z=H*d*j+V*f*N,this._w=H*d*N-V*f*j):"YXZ"===R?(this._x=V*d*N+H*f*j,this._y=H*f*N-V*d*j,this._z=H*d*j-V*f*N,this._w=H*d*N+V*f*j):"ZXY"===R?(this._x=V*d*N-H*f*j,this._y=H*f*N+V*d*j,this._z=H*d*j+V*f*N,this._w=H*d*N-V*f*j):"ZYX"===R?(this._x=V*d*N-H*f*j,this._y=H*f*N+V*d*j,this._z=H*d*j-V*f*N,this._w=H*d*N+V*f*j):"YZX"===R?(this._x=V*d*N+H*f*j,this._y=H*f*N+V*d*j,this._z=H*d*j-V*f*N,this._w=H*d*N-V*f*j):"XZY"===R&&(this._x=V*d*N-H*f*j,this._y=H*f*N-V*d*j,this._z=H*d*j+V*f*N,this._w=H*d*N+V*f*j),this},setFromRotationMatrix:function(q){var X,B=q.el,P=B[0],U=B[4],H=B[8],T=B[1],D=B[5],K=B[9],Q=B[2],O=B[6],F=B[10],J=P+D+F;return J>0?(X=.5/Math.sqrt(J+1),this._w=.25/X,this._x=(O-K)*X,this._y=(H-Q)*X,this._z=(T-U)*X):P>D&&P>F?(X=2*Math.sqrt(1+P-D-F),this._w=(O-K)/X,this._x=.25*X,this._y=(U+T)/X,this._z=(H+Q)/X):D>F?(X=2*Math.sqrt(1+D-P-F),this._w=(H-Q)/X,this._x=(U+T)/X,this._y=.25*X,this._z=(K+O)/X):(X=2*Math.sqrt(1+F-P-D),this._w=(T-U)/X,this._x=(H+Q)/X,this._y=(K+O)/X,this._z=.25*X),this},setFromToVectors:function(){var h,k;return function(j,d){return h===n&&(h=new sh),k=j.dot(d)+1,1e-7>k?(k=0,Math.abs(j.x)>Math.abs(j.z)?h.set(-j.y,j.x,0):h.set(0,-j.z,j.y)):h.crossVectors(j,d),this._x=h.x,this._y=h.y,this._z=h.z,this._w=k,this.normalize()}}(),setFromUnitVectors:function(){var M,A,H=1e-6;return function(r,j){return M===n&&(M=new sh),A=r.dot(j)+1,H>A?(A=0,Math.abs(r.x)>Math.abs(r.z)?M.set(-r.y,r.x,0):M.set(0,-r.z,r.y)):M.crossVectors(r,j),this._x=M.x,this._y=M.y,this._z=M.z,this._w=A,this.normalize()}}(),multiply:function(v){return this.multiplyQuaternions(this,v)},premultiply:function(f){return this.multiplyQuaternions(f,this)},multiplyQuaternions:function(m,A){var E=m._x,q=m._y,G=m._z,K=m._w,k=A._x,R=A._y,$=A._z,p=A._w;return this._x=E*p+K*k+q*$-G*R,this._y=q*p+K*R+G*k-E*$,this._z=G*p+K*$+E*R-q*k,this._w=K*p-E*k-q*R-G*$,this}});var cb=Y.Math.Vector4=function(h,J,k,S){this.x=h||0,this.y=J||0,this.z=k||0,this.w=S!==n?S:1};L.assign(cb.prototype,{isVector4:!0,set:function(w,A,_,j){return this.x=w,this.y=A,this.z=_,this.w=j,this},setScalar:function(M){return this.x=M,this.y=M,this.z=M,this.w=M,this},setX:function(P){return this.x=P,this},setY:function(L){return this.y=L,this},setZ:function(k){return this.z=k,this},setW:function(V){return this.w=V,this},setComponent:function(s,U){switch(s){case 0:this.x=U;break;case 1:this.y=U;break;case 2:this.z=U;break;case 3:this.w=U;break;default:throw new Error("index is out of range: "+s)}return this},getComponent:function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+c)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(W){return this.x=W.x,this.y=W.y,this.z=W.z,this.w=W.w!==n?W.w:1,this},add:function(T,R){return R!==n?this.addVectors(T,R):(this.x+=T.x,this.y+=T.y,this.z+=T.z,this.w+=T.w,this)},addScalar:function(K){return this.x+=K,this.y+=K,this.z+=K,this.w+=K,this},addVectors:function(A,a){return this.x=A.x+a.x,this.y=A.y+a.y,this.z=A.z+a.z,this.w=A.w+a.w,this},addScaledVector:function(f,x){return this.x+=f.x*x,this.y+=f.y*x,this.z+=f.z*x,this.w+=f.w*x,this},sub:function(e,m){return m!==n?this.subVectors(e,m):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(C){return this.x-=C,this.y-=C,this.z-=C,this.w-=C,this},subVectors:function($,o){return this.x=$.x-o.x,this.y=$.y-o.y,this.z=$.z-o.z,this.w=$.w-o.w,this},multiplyScalar:function(A){return this.x*=A,this.y*=A,this.z*=A,this.w*=A,this},applyMatrix4:function(O){var D=this.x,i=this.y,C=this.z,Z=this.w,y=O.el;return this.x=y[0]*D+y[4]*i+y[8]*C+y[12]*Z,this.y=y[1]*D+y[5]*i+y[9]*C+y[13]*Z,this.z=y[2]*D+y[6]*i+y[10]*C+y[14]*Z,this.w=y[3]*D+y[7]*i+y[11]*C+y[15]*Z,this},divideScalar:function(I){return this.multiplyScalar(1/I)},setAxisAngleFromQuaternion:function(g){this.w=2*Math.acos(g.w);var $=Math.sqrt(1-g.w*g.w);return 1e-4>$?(this.x=1,this.y=0,this.z=0):(this.x=g.x/$,this.y=g.y/$,this.z=g.z/$),this},setAxisAngleFromRotationMatrix:function(E){var $,b,y,w,s=.01,u=.1,D=E.el,z=D[0],_=D[4],K=D[8],V=D[1],Z=D[5],J=D[9],i=D[2],C=D[6],H=D[10];if(Math.abs(_-V)<s&&Math.abs(K-i)<s&&Math.abs(J-C)<s){if(Math.abs(_+V)<u&&Math.abs(K+i)<u&&Math.abs(J+C)<u&&Math.abs(z+Z+H-3)<u)return this.set(1,0,0,0),this;$=Math.PI;var o=(z+1)/2,P=(Z+1)/2,x=(H+1)/2,N=(_+V)/4,t=(K+i)/4,n=(J+C)/4;return o>P&&o>x?s>o?(b=0,y=.707106781,w=.707106781):(b=Math.sqrt(o),y=N/b,w=t/b):P>x?s>P?(b=.707106781,y=0,w=.707106781):(y=Math.sqrt(P),b=N/y,w=n/y):s>x?(b=.707106781,y=.707106781,w=0):(w=Math.sqrt(x),b=t/w,y=n/w),this.set(b,y,w,$),this}var r=Math.sqrt((C-J)*(C-J)+(K-i)*(K-i)+(V-_)*(V-_));return Math.abs(r)<.001&&(r=1),this.x=(C-J)/r,this.y=(K-i)/r,this.z=(V-_)/r,this.w=Math.acos((z+Z+H-1)/2),this},min:function(p){return this.x=Math.min(this.x,p.x),this.y=Math.min(this.y,p.y),this.z=Math.min(this.z,p.z),this.w=Math.min(this.w,p.w),this},max:function(D){return this.x=Math.max(this.x,D.x),this.y=Math.max(this.y,D.y),this.z=Math.max(this.z,D.z),this.w=Math.max(this.w,D.w),this},clamp:function(m,Q){return this.x=Math.max(m.x,Math.min(Q.x,this.x)),this.y=Math.max(m.y,Math.min(Q.y,this.y)),this.z=Math.max(m.z,Math.min(Q.z,this.z)),this.w=Math.max(m.w,Math.min(Q.w,this.w)),this},clampScalar:function(){var i,I;return function(u,R){return i===n&&(i=new cb,I=new cb),i.set(u,u,u,u),I.set(R,R,R,R),this.clamp(i,I)}}(),clampLength:function(c,F){var u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(c,Math.min(F,u)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(Y){return this.x*Y.x+this.y*Y.y+this.z*Y.z+this.w*Y.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(w){return this.normalize().multiplyScalar(w)},lerp:function(r,w){return this.x+=(r.x-this.x)*w,this.y+=(r.y-this.y)*w,this.z+=(r.z-this.z)*w,this.w+=(r.w-this.w)*w,this},lerpVectors:function(Y,i,c){return this.subVectors(i,Y).multiplyScalar(c).add(Y)},equals:function(g){return g.x===this.x&&g.y===this.y&&g.z===this.z&&g.w===this.w},fromArray:function(d,s){return s===n&&(s=0),this.x=d[s],this.y=d[s+1],this.z=d[s+2],this.w=d[s+3],this},toArray:function(v,c){return v===n&&(v=[]),c===n&&(c=0),v[c]=this.x,v[c+1]=this.y,v[c+2]=this.z,v[c+3]=this.w,v},fromBufferAttribute:function(c,$){return this.x=c.getX($),this.y=c.getY($),this.z=c.getZ($),this.w=c.getW($),this}});var sh=Y.Math.Vector3=function(v,D,f){v===n?(this.x=0,this.y=0,this.z=0):"object"==typeof v?this.copy(v):this.set(v,D==n?v:D,f==n?v:f)};L.assign(sh.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(X,n,x){return this.x=X,this.y=n,this.z=x,this},equals:function(I){return I&&this.x===I.x&&this.y===I.y&&this.z===I.z},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(V){return this.x=V,this},setY:function(j){return this.y=j,this},setZ:function(X){return this.z=X,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(o){return o.x===n?(this.x=o[0],this.y=o[1],this.z=o[2]):(this.x=o.x,this.y=o.y,this.z=o.z||0),this},add:function(m){return this.x+=m.x,this.y+=m.y,this.z+=m.z,this},addScalar:function(Q){return this.x+=Q,this.y+=Q,this.z+=Q,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(F,W){return this.x+=F.x*W,this.y+=F.y*W,this.z+=F.z*W,this},sub:function(M){return this.x-=M.x,this.y-=M.y,this.z-=M.z,this},subScalar:function(C){return this.x-=C,this.y-=C,this.z-=C,this},subVectors:function(E,K){return this.x=E.x-K.x,this.y=E.y-K.y,this.z=E.z-K.z,this},divide:function(B){return this.x/=B.x,this.y/=B.y,this.z/=B.z,this},multiply:function(O){return this.x*=O.x,this.y*=O.y,this.z*=O.z,this},multiplyScalar:function(k){return this.x*=k,this.y*=k,this.z*=k,this},distanceTo:function(P){return Math.sqrt(this.distanceToSquared(P))},distanceToSquared:function(P){var y=this.x-P.x,T=this.y-P.y,G=this.z-P.z;return y*y+T*T+G*G},distanceToSquared2:function(p){var O=this.x-p[0],i=this.y-p[1],X=this.z-p[2];return O*O+i*i+X*X},divideVectors:function(v,x){return this.x=v.x/x.x,this.y=v.y/x.y,this.z=v.z/x.z,this},multiplyVectors:function(u,E){return this.x=u.x*E.x,this.y=u.y*E.y,this.z=u.z*E.z,this},transformDirection:function(G){var u=this.x,D=this.y,A=this.z,x=G.el;return this.x=x[0]*u+x[4]*D+x[8]*A,this.y=x[1]*u+x[5]*D+x[9]*A,this.z=x[2]*u+x[6]*D+x[10]*A,this.normalize()},applyAxisAngle:function(){var J=new Rf;return function(V,M){return this.applyQuaternion(J.setFromAxisAngle(V,M))}}(),applyEuler:function(){var X=new Rf;return function(s){return this.applyQuaternion(X.setFromEuler(s))}}(),applyQuaternion:function(v){var b=this.x,H=this.y,l=this.z,u=v._x,z=v._y,W=v._z,e=v._w,B=e*b+z*l-W*H,S=e*H+W*b-u*l,j=e*l+u*H-z*b,f=-u*b-z*H-W*l;return this.x=B*e+f*-u+S*-W-j*-z,this.y=S*e+f*-z+j*-u-B*-W,this.z=j*e+f*-W+B*-z-S*-u,this},applyMatrix4:function(A){var X=this.x,w=this.y,U=this.z,$=A.el,I=1/($[3]*X+$[7]*w+$[11]*U+$[15]);return this.x=($[0]*X+$[4]*w+$[8]*U+$[12])*I,this.y=($[1]*X+$[5]*w+$[9]*U+$[13])*I,this.z=($[2]*X+$[6]*w+$[10]*U+$[14])*I,this
},applyMatrix3:function(c){var b=this.x,j=this.y,s=this.z,f=c.el;return this.x=f[0]*b+f[3]*j+f[6]*s,this.y=f[1]*b+f[4]*j+f[7]*s,this.z=f[2]*b+f[5]*j+f[8]*s,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var A=new sh;return function(W){return this.sub(A.copy(W).multiplyScalar(2*this.dot(W)))}}(),dot:function($){return this.x*$.x+this.y*$.y+this.z*$.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var k=this.length();return k?this.multiplyScalar(1/k):this},setLength:function(C){return this.normalize().multiplyScalar(C)},fromArray:function(l,h){return h===n&&(h=0),this.x=l[h],this.y=l[h+1],this.z=l[h+2],this},toArray:function(I,R){return I===n&&(I=[0,0,0]),R===n&&(R=0),I[R]=this.x,I[R+1]=this.y,I[R+2]=this.z,I},cross:function(e){return this.crossVectors(this,e)},angleTo:function(d){var Q=this.dot(d)/Math.sqrt(this.lengthSq()*d.lengthSq());return Q>1||-1>Q?0:Math.acos(Q)},lerp:function(U,z){return this.x+=(U.x-this.x)*z,this.y+=(U.y-this.y)*z,this.z+=(U.z-this.z)*z,this},lerpVectors:function(u,q,I){return this.subVectors(q,u).multiplyScalar(I).add(u)},crossVectors:function(S,I){var Q=S.x,F=S.y,q=S.z,K=I.x,u=I.y,U=I.z;return this.x=F*U-q*u,this.y=q*K-Q*U,this.z=Q*u-F*K,this},min:function(v){return this.x=Math.min(this.x,v.x),this.y=Math.min(this.y,v.y),this.z=Math.min(this.z,v.z),this},max:function(X){return this.x=Math.max(this.x,X.x),this.y=Math.max(this.y,X.y),this.z=Math.max(this.z,X.z),this},setFromMatrixPosition:function(H){return this.setFromMatrixColumn(H,3)},setFromMatrixScale:function(Y){var X=this.setFromMatrixColumn(Y,0).length(),h=this.setFromMatrixColumn(Y,1).length(),K=this.setFromMatrixColumn(Y,2).length();return this.x=X,this.y=h,this.z=K,this},setFromMatrixColumn:function(s,n){return this.fromArray(s.el,4*n)}});var _h=Y.Math.Vector2=function(y,u,o){"object"==typeof y&&(y.x!=n?(u=y.y,y=y.x,o=y.e):(o=y[2],u=y[1],y=y[0])),this.set(y||0,u||0,o)};_h.prototype={},_h.prototype.constructor=_h,L.defineProperties(_h.prototype,{width:{get:function(){return this.x},set:function(n){this.x=n}},height:{get:function(){return this.y},set:function(N){this.y=N}}}),_h.prototype.clone=function(){return new _h(this.x,this.y,this.e)},_h.prototype.copy=function(z){return this.set(z.x,z.y,z.e),this},_h.prototype.equals=function(n){return n.x===this.x&&n.y===this.y},_h.prototype.set=function(G,h,Y){return this.x=G||0,this.y=h||(0!==h?this.x:0),Y!=n&&(this.e=Y),this},_h.prototype.setScalar=function(d){return this.x=d,this.y=d,this},_h.prototype.setX=function(N){return this.x=N||0,this},_h.prototype.setY=function(X){return this.y=X||0,this},_h.prototype.add=function(z){return this.x+=z.x,this.y+=z.y,this},_h.prototype.addVectors=function(S,Q){return this.x=S.x+Q.x,this.y=S.y+Q.y,this},_h.prototype.addScalar=function(F){return this.x+=F,this.y+=F,this},_h.prototype.addScaledVector=function(h,Y){return this.x+=h.x*Y,this.y+=h.y*Y,this},_h.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},_h.prototype.subScalar=function(D){return this.x-=D,this.y-=D,this},_h.prototype.subVectors=function(w,F){return this.x=w.x-F.x,this.y=w.y-F.y,this},_h.prototype.multiply=function(z){return this.x*=z.x,this.y*=z.y,this},_h.prototype.multiplyScalar=function(g){return this.x*=g,this.y*=g,this},_h.prototype.divide=function(I){return this.x/=I.x,this.y/=I.y,this},_h.prototype.divideScalar=function(J){return this.multiplyScalar(1/J)},_h.prototype.min=function(P){return this.x=Math.min(this.x,P.x),this.y=Math.min(this.y,P.y),this},_h.prototype.max=function(X){return this.x=Math.max(this.x,X.x),this.y=Math.max(this.y,X.y),this},_h.prototype.fromArray=function(G,T){return T===n&&(T=0),this.x=G[T],this.y=G[T+1],this},_h.prototype.clamp=function(N,M){return this.x=Math.max(N.x,Math.min(M.x,this.x)),this.y=Math.max(N.y,Math.min(M.y,this.y)),this},_h.prototype.clampScalar=function(){var u,z;return function(G,P){return u===n&&(u=new _h,z=new _h),u.set(G,G),z.set(P,P),this.clamp(u,z)}}(),_h.prototype.clampLength=function(w,C){var N=this.length();return this.multiplyScalar(Math.max(w,Math.min(C,N))/N)},_h.prototype.dot=function(v){return this.x*v.x+this.y*v.y},_h.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},_h.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},_h.prototype.normalize=function(){return this.divideScalar(this.length())},_h.prototype.angle=function(){var J=Math.atan2(this.y,this.x);return 0>J&&(J+=2*Math.PI),J},_h.prototype.distanceTo=function(O){return Math.sqrt(this.distanceToSquared(O))},_h.prototype.distanceToSquared=function(e){var R=this.x-e.x,s=this.y-e.y;return R*R+s*s},_h.prototype.isNearEnough=function(N){return this.distanceToSquared(N)<1e-8},_h.prototype.setLength=function(D){var C=this.length();return C?this.multiplyScalar(D/C):this},_h.prototype.lerp=function(h,s){return this.x+=(h.x-this.x)*s,this.y+=(h.y-this.y)*s,this},_h.prototype.lerpVectors=function(j,Z,b){return this.subVectors(Z,j).multiplyScalar(b).add(j)},_h.prototype.rotateAround=function(Y,W){var d=Y?Y.x:0,S=Y?Y.y:0,m=Math.cos(W),D=Math.sin(W),v=this.x-d,E=this.y-S;return this.x=v*m-E*D+d,this.y=v*D+E*m+S,this},L.assign(p.prototype,{isMatrix3:!0,set:function(_,s,c,w,k,M,J,q,R){var g=this.el;return g[0]=_,g[1]=w,g[2]=J,g[3]=s,g[4]=k,g[5]=q,g[6]=c,g[7]=M,g[8]=R,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(D){var R=this.el,w=D.el;return R[0]=w[0],R[1]=w[1],R[2]=w[2],R[3]=w[3],R[4]=w[4],R[5]=w[5],R[6]=w[6],R[7]=w[7],R[8]=w[8],this},setFromMatrix4:function(m){var z=m.el;return this.set(z[0],z[4],z[8],z[1],z[5],z[9],z[2],z[6],z[10]),this},applyToBufferAttribute:function(){var k=new sh;return function(M){for(var P=0,Z=M.count;Z>P;P++)k.x=M.getX(P),k.y=M.getY(P),k.z=M.getZ(P),k.applyMatrix3(this),M.setXYZ(P,k.x,k.y,k.z);return M}}(),multiply:function(E){return this.multiplyMatrices(this,E)},premultiply:function(g){return this.multiplyMatrices(g,this)},multiplyMatrices:function(E,u){var b=E.el,o=u.el,y=this.el,v=b[0],D=b[3],O=b[6],S=b[1],n=b[4],J=b[7],g=b[2],Q=b[5],Y=b[8],T=o[0],z=o[3],R=o[6],s=o[1],N=o[4],L=o[7],A=o[2],j=o[5],m=o[8];return y[0]=v*T+D*s+O*A,y[3]=v*z+D*N+O*j,y[6]=v*R+D*L+O*m,y[1]=S*T+n*s+J*A,y[4]=S*z+n*N+J*j,y[7]=S*R+n*L+J*m,y[2]=g*T+Q*s+Y*A,y[5]=g*z+Q*N+Y*j,y[8]=g*R+Q*L+Y*m,this},multiplyScalar:function(D){var W=this.el;return W[0]*=D,W[3]*=D,W[6]*=D,W[1]*=D,W[4]*=D,W[7]*=D,W[2]*=D,W[5]*=D,W[8]*=D,this},determinant:function(){var H=this.el,Y=H[0],i=H[1],g=H[2],R=H[3],D=H[4],x=H[5],d=H[6],E=H[7],q=H[8];return Y*D*q-Y*x*E-i*R*q+i*x*d+g*R*E-g*D*d},getInverse:function(O){var r=O.el,p=this.el,L=r[0],A=r[1],w=r[2],T=r[3],q=r[4],V=r[5],j=r[6],X=r[7],M=r[8],y=M*q-V*X,N=V*j-M*T,R=X*T-q*j,i=L*y+A*N+w*R;if(0===i)return this.identity();var m=1/i;return p[0]=y*m,p[1]=(w*X-M*A)*m,p[2]=(V*A-w*q)*m,p[3]=N*m,p[4]=(M*L-w*j)*m,p[5]=(w*T-V*L)*m,p[6]=R*m,p[7]=(A*j-X*L)*m,p[8]=(q*L-A*T)*m,this},transpose:function(){var H,g=this.el;return H=g[1],g[1]=g[3],g[3]=H,H=g[2],g[2]=g[6],g[6]=H,H=g[5],g[5]=g[7],g[7]=H,this},getNormalMatrix:function(T){return this.setFromMatrix4(T).getInverse(this).transpose()},transposeIntoArray:function(Y){var f=this.el;return Y[0]=f[0],Y[1]=f[3],Y[2]=f[6],Y[3]=f[1],Y[4]=f[4],Y[5]=f[7],Y[6]=f[2],Y[7]=f[5],Y[8]=f[8],this},setUvTransform:function(D,u,v,C,G,X,V){var o=Math.cos(G),m=Math.sin(G);this.set(v*o,v*m,-v*(o*X+m*V)+X+D,-C*m,C*o,-C*(-m*X+o*V)+V+u,0,0,1)},scale:function(a,C){var P=this.el;return P[0]*=a,P[3]*=a,P[6]*=a,P[1]*=C,P[4]*=C,P[7]*=C,this},rotate:function(v){var t=Math.cos(v),F=Math.sin(v),s=this.el,Y=s[0],r=s[3],y=s[6],T=s[1],h=s[4],w=s[7];return s[0]=t*Y+F*T,s[3]=t*r+F*h,s[6]=t*y+F*w,s[1]=-F*Y+t*T,s[4]=-F*r+t*h,s[7]=-F*y+t*w,this},translate:function(k,H){var d=this.el;return d[0]+=k*d[2],d[3]+=k*d[5],d[6]+=k*d[8],d[1]+=H*d[2],d[4]+=H*d[5],d[7]+=H*d[8],this},equals:function(b){for(var V=this.el,m=b.el,a=0;9>a;a++)if(V[a]!==m[a])return!1;return!0},fromArray:function(q,u){u===n&&(u=0);for(var B=0;9>B;B++)this.el[B]=q[B+u];return this},toArray:function(t,B){t===n&&(t=[]),B===n&&(B=0);var z=this.el;return t[B]=z[0],t[B+1]=z[1],t[B+2]=z[2],t[B+3]=z[3],t[B+4]=z[4],t[B+5]=z[5],t[B+6]=z[6],t[B+7]=z[7],t[B+8]=z[8],t}});var Oc=Y.Math.Plane=function(_,s){this.normal=_!==n?_:new sh(1,0,0),this.constant=s!==n?s:0};L.assign(Oc.prototype,{set:function(C,j){return this.normal.copy(C),this.constant=j,this},setComponents:function(U,x,u,r){return this.normal.set(U,x,u),this.constant=r,this},setFromNormalAndCoplanarPoint:function(E,F){return this.normal.copy(E),this.constant=-F.dot(this.normal),this},setFromCoplanarPoints:function(){var u=new sh,L=new sh;return function(C,J,d){var Q=u.subVectors(d,J).cross(L.subVectors(C,J)).normalize();return this.setFromNormalAndCoplanarPoint(Q,C),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(V){return this.normal.copy(V.normal),this.constant=V.constant,this},normalize:function(){var F=1/this.normal.length();return this.normal.multiplyScalar(F),this.constant*=F,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(z){return this.normal.dot(z)+this.constant},distanceToSphere:function(d){return this.distanceToPoint(d.center)-d.radius},projectPoint:function(e,H){return H===n&&(H=new sh),H.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var E=new sh;return function(L,G){G===n&&(G=new sh);var W=L.delta(E),X=this.normal.dot(W);if(0===X)return 0===this.distanceToPoint(L.start)?G.copy(L.start):n;var D=-(L.start.dot(this.normal)+this.constant)/X;return 0>D||D>1?n:G.copy(W).multiplyScalar(D).add(L.start)}}(),intersectsLine:function(K){var E=this.distanceToPoint(K.start),Q=this.distanceToPoint(K.end);return 0>E&&Q>0||0>Q&&E>0},intersectsBox:function(O){return O.intersectsPlane(this)},intersectsSphere:function(C){return C.intersectsPlane(this)},coplanarPoint:function(z){return z===n&&(z=new sh),z.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var K=new sh,S=new p;return function(b,v){var y=v||S.getNormalMatrix(b),l=this.coplanarPoint(K).applyMatrix4(b),I=this.normal.applyMatrix3(y).normalize();return this.constant=-l.dot(I),this}}(),translate:function(d){return this.constant-=d.dot(this.normal),this},equals:function(T){return T.normal.equals(this.normal)&&T.constant===this.constant}});var Ub=Y.Math.Ray=function(Y,E){this.origin=Y!==n?Y.clone():new sh,this.direction=E!==n?E.clone():new sh};L.assign(Ub.prototype,{set:function(h,B){return this.origin.copy(h),this.direction.copy(B),this},clone:function(){return(new this.constructor).copy(this)},copy:function(z){return this.origin.copy(z.origin),this.direction.copy(z.direction),this.maxHitLen=z.maxHitLen,this},at:function(l,I){var Z=I||new sh;return Z.copy(this.direction).multiplyScalar(l).add(this.origin)},setMaxHitLength:function(z){this.maxHitLen=z},lookAt:function(L){return this.direction.copy(L).sub(this.origin).normalize(),this},applyMatrix4:function(J){var T=this.maxHitLen;if(T){var Y=this.direction.clone().multiplyScalar(T).add(this.origin);Y.applyMatrix4(J)}return this.origin.applyMatrix4(J),this.direction.transformDirection(J),T&&(this.maxHitLen=this.origin.distanceTo(Y)),this},intersectSphere:function(){var V=new sh;return function(x,S){V.subVectors(x.center,this.origin);var y=V.dot(this.direction),W=V.dot(V)-y*y,v=x.radius*x.radius;if(W>v)return null;var s=Math.sqrt(v-W),h=y-s,P=y+s;return 0>h&&0>P?null:0>h?this.at(P,S):this.at(h,S)}}(),intersectEllipsoid:function(){var O=new sh,A=new sh;return function(b,T){O.subVectors(b.center,this.origin),O.divide(b.radius),A.divideVectors(this.direction,b.radius);var W=A.lengthSq(),B=O.dot(A),o=O.dot(O)*W-B*B;if(o>W)return null;var P=Math.sqrt(W-o),M=(B-P)/W,E=(B+P)/W;return 0>M&&0>E?null:0>M?this.at(E,T):this.at(M,T)}}(),intersectBox:function(X,T){var R,L,I,x,i,e,G=1/this.direction.x,q=1/this.direction.y,h=1/this.direction.z,D=this.origin;if(G>=0?(R=(X.min.x-D.x)*G,L=(X.max.x-D.x)*G):(R=(X.max.x-D.x)*G,L=(X.min.x-D.x)*G),q>=0?(I=(X.min.y-D.y)*q,x=(X.max.y-D.y)*q):(I=(X.max.y-D.y)*q,x=(X.min.y-D.y)*q),R>x||I>L)return null;if((I>R||R!==R)&&(R=I),(L>x||L!==L)&&(L=x),h>=0?(i=(X.min.z-D.z)*h,e=(X.max.z-D.z)*h):(i=(X.max.z-D.z)*h,e=(X.min.z-D.z)*h),R>e||i>L)return null;if((i>R||R!==R)&&(R=i),(L>e||L!==L)&&(L=e),0>L)return null;var M=R>=0?R:L,W=this.maxHitLen;return W&&M>W?null:this.at(M,T)},intersectTriangle:function(){var D=new sh,R=new sh,I=new sh,d=new sh;return function(v,Y,O,Q,K){R.subVectors(Y,v),I.subVectors(O,v),d.crossVectors(R,I);var m,A=this.direction.dot(d);if(A>0){if(Q)return null;m=1}else{if(!(0>A))return null;m=-1,A=-A}D.subVectors(this.origin,v);var C=m*this.direction.dot(I.crossVectors(D,I));if(0>C)return null;var x=m*this.direction.dot(R.cross(D));if(0>x||C+x>A)return null;var j=-m*D.dot(d);if(0>j)return null;var E=j/A,H=this.maxHitLen;return H&&E>H?null:this.at(E,K)}}()});var Mj=Y.Math.Box3=function(u,U){this.min=u!==n?u:new sh(1/0,1/0,1/0),this.max=U!==n?U:new sh(-1/0,-1/0,-1/0)};L.assign(Mj.prototype,{set:function(m,o){return this.min.copy(m),this.max.copy(o),this},setFromArray:function(B){for(var T=1/0,C=1/0,r=1/0,o=-1/0,t=-1/0,l=-1/0,d=0,n=B.length;n>d;d+=3){var h=B[d],e=B[d+1],E=B[d+2];T>h&&(T=h),C>e&&(C=e),r>E&&(r=E),h>o&&(o=h),e>t&&(t=e),E>l&&(l=E)}return this.min.set(T,C,r),this.max.set(o,t,l),this},setFromPoints:function(f){this.makeEmpty();for(var h=0,_=f.length;_>h;h++)this.expandByPoint(f[h]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(D){return D.max.x<this.min.x||D.min.x>this.max.x||D.max.y<this.min.y||D.min.y>this.max.y||D.max.z<this.min.z||D.min.z>this.max.z?!1:!0},copy:function(I){return this.min.copy(I.min),this.max.copy(I.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(Z){return this.min.min(Z),this.max.max(Z),this},expandByBox:function(K){return this.min.min(K.min),this.max.max(K.max),this},applyMatrix4:function(){var x=[new sh,new sh,new sh,new sh,new sh,new sh,new sh,new sh];return function(G){return this.isEmpty()?this:(x[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(G),x[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(G),x[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(G),x[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(G),x[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(G),x[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(G),x[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(G),x[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(G),this.setFromPoints(x),this)}}()});var zk=Y.Math.Sphere=function(v,t){this.center=v!==n?v:new sh,this.radius=t!==n?t:0};L.assign(zk.prototype,{set:function(p,Q){return this.center.copy(p),this.radius=Q,this},setFromPoints:function(){var Q=new Mj;return function(X,Z){var m=this.center;Z!==n?m.copy(Z):Q.setFromPoints(X).getCenter(m);for(var M=0,y=0,U=X.length;U>y;y++)M=Math.max(M,m.distanceToSquared(X[y]));return this.radius=Math.sqrt(M),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(n){return this.center.copy(n.center),this.radius=n.radius,this},empty:function(){return this.radius<=0},containsPoint:function(D){return D.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(C){return C.distanceTo(this.center)-this.radius},intersectsSphere:function(X){var R=this.radius+X.radius;return X.center.distanceToSquared(this.center)<=R*R},intersectsBox:function(E){return E.intersectsSphere(this)},intersectsPlane:function(c){return Math.abs(c.distanceToPoint(this.center))<=this.radius},clampPoint:function(q,R){var H=this.center.distanceToSquared(q);return R===n&&(R=new sh),R.copy(q),H>this.radius*this.radius&&(R.sub(this.center).normalize(),R.multiplyScalar(this.radius).add(this.center)),R},getBoundingBox:function($){return $===n&&($=new Mj),$.set(this.center,this.center),$.expandByScalar(this.radius),$},applyMatrix4:function(E){return this.center.applyMatrix4(E),this.radius=this.radius*E.getMaxScaleOnAxis(),this},translate:function(J){return this.center.add(J),this},equals:function(b){return b.center.equals(this.center)&&b.radius===this.radius}});var ed=Y.Math.Frustum=function(Z,A,I,X,p,j){this.planes=[Z!==n?Z:new Oc,A!==n?A:new Oc,I!==n?I:new Oc,X!==n?X:new Oc,p!==n?p:new Oc,j!==n?j:new Oc]};L.assign(ed.prototype,{set:function(c,X,v,Y,D,F){var i=this.planes;return i[0].copy(c),i[1].copy(X),i[2].copy(v),i[3].copy(Y),i[4].copy(D),i[5].copy(F),this},clone:function(){return(new this.constructor).copy(this)},copy:function(S){for(var R=this.planes,v=0;6>v;v++)R[v].copy(S.planes[v]);return this},setFromMatrix:function(q){var b=this.planes,t=q.el,B=t[0],L=t[1],E=t[2],$=t[3],c=t[4],P=t[5],o=t[6],_=t[7],v=t[8],l=t[9],m=t[10],W=t[11],J=t[12],T=t[13],z=t[14],p=t[15];return b[0].setComponents($-B,_-c,W-v,p-J).normalize(),b[1].setComponents($+B,_+c,W+v,p+J).normalize(),b[2].setComponents($+L,_+P,W+l,p+T).normalize(),b[3].setComponents($-L,_-P,W-l,p-T).normalize(),b[4].setComponents($-E,_-o,W-m,p-z).normalize(),b[5].setComponents($+E,_+o,W+m,p+z).normalize(),this},intersectsObject:function(){var V=new zk;return function(n){var c=n.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),V.copy(c.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(V)}}(),intersectsSprite:function(){var P=new zk;return function(t){return P.center.set(0,0,0),P.radius=.7071067811865476,P.applyMatrix4(t.matrixWorld),this.intersectsSphere(P)}}(),intersectsSphere:function(L){for(var H=this.planes,m=L.center,R=-L.radius,j=0;6>j;j++){var f=H[j].distanceToPoint(m);if(R>f)return!1}return!0},intersectsBox:function(){var O=new sh;return function(i){for(var G=this.planes,g=0;6>g;g++){var S=G[g];if(O.x=S.normal.x>0?i.max.x:i.min.x,O.y=S.normal.y>0?i.max.y:i.min.y,O.z=S.normal.z>0?i.max.z:i.min.z,S.distanceToPoint(O)<0)return!1}return!0}}(),containsPoint:function(C){for(var g=this.planes,D=0;6>D;D++)if(g[D].distanceToPoint(C)<0)return!1;return!0}});var Hf=Y.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};L.assign(Hf.prototype,{set:function(L,E,x,k,T,Z,t,V,B,v,q,G,l,S,N,d){var f=this.el;return f[0]=L,f[4]=E,f[8]=x,f[12]=k,f[1]=T,f[5]=Z,f[9]=t,f[13]=V,f[2]=B,f[6]=v,f[10]=q,f[14]=G,f[3]=l,f[7]=S,f[11]=N,f[15]=d,this},clone:function(){return(new Hf).fromArray(this.el)},fromArray:function(L,H){H===n&&(H=0);for(var J=this.el,B=0;16>B;B++)J[B]=L[B+H];return this},getElements:function(){return this.el},scale:function(M){var o=this.el,G=M.x,e=M.y,K=M.z;return o[0]*=G,o[4]*=e,o[8]*=K,o[1]*=G,o[5]*=e,o[9]*=K,o[2]*=G,o[6]*=e,o[10]*=K,o[3]*=G,o[7]*=e,o[11]*=K,this},makeRotationFromEuler:function(b){var Z=this.el,e=b._x,M=b._y,W=b._z,Q=b._order,p=Math.cos(e),K=Math.sin(e),u=Math.cos(M),o=Math.sin(M),f=Math.cos(W),H=Math.sin(W);if("XYZ"===Q){var g=p*f,U=p*H,k=K*f,C=K*H;Z[0]=u*f,Z[4]=-u*H,Z[8]=o,Z[1]=U+k*o,Z[5]=g-C*o,Z[9]=-K*u,Z[2]=C-g*o,Z[6]=k+U*o,Z[10]=p*u}else if("YXZ"===Q){var t=u*f,N=u*H,v=o*f,D=o*H;Z[0]=t+D*K,Z[4]=v*K-N,Z[8]=p*o,Z[1]=p*H,Z[5]=p*f,Z[9]=-K,Z[2]=N*K-v,Z[6]=D+t*K,Z[10]=p*u}else if("ZXY"===Q){var t=u*f,N=u*H,v=o*f,D=o*H;Z[0]=t-D*K,Z[4]=-p*H,Z[8]=v+N*K,Z[1]=N+v*K,Z[5]=p*f,Z[9]=D-t*K,Z[2]=-p*o,Z[6]=K,Z[10]=p*u}else if("ZYX"===Q){var g=p*f,U=p*H,k=K*f,C=K*H;Z[0]=u*f,Z[4]=k*o-U,Z[8]=g*o+C,Z[1]=u*H,Z[5]=C*o+g,Z[9]=U*o-k,Z[2]=-o,Z[6]=K*u,Z[10]=p*u}else if("YZX"===Q){var z=p*u,E=p*o,s=K*u,O=K*o;Z[0]=u*f,Z[4]=O-z*H,Z[8]=s*H+E,Z[1]=H,Z[5]=p*f,Z[9]=-K*f,Z[2]=-o*f,Z[6]=E*H+s,Z[10]=z-O*H}else if("XZY"===Q){var z=p*u,E=p*o,s=K*u,O=K*o;Z[0]=u*f,Z[4]=-H,Z[8]=o*f,Z[1]=z*H+O,Z[5]=p*f,Z[9]=E*H-s,Z[2]=s*H-E,Z[6]=K*f,Z[10]=O*H+z}return Z[3]=0,Z[7]=0,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,this},makeRotationFromQuaternion:function(S){var z=this.el,q=S._x,d=S._y,Y=S._z,a=S._w,c=q+q,e=d+d,Z=Y+Y,w=q*c,O=q*e,v=q*Z,V=d*e,M=d*Z,F=Y*Z,L=a*c,B=a*e,X=a*Z;return z[0]=1-(V+F),z[4]=O-X,z[8]=v+B,z[1]=O+X,z[5]=1-(w+F),z[9]=M-L,z[2]=v-B,z[6]=M+L,z[10]=1-(w+V),z[3]=0,z[7]=0,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(q){var p=this.el,E=q.el,K=E[0],M=E[1],b=E[2],G=E[3],$=E[4],S=E[5],x=E[6],d=E[7],L=E[8],Y=E[9],i=E[10],n=E[11],h=E[12],R=E[13],U=E[14],W=E[15],I=Y*U*d-R*i*d+R*x*n-S*U*n-Y*x*W+S*i*W,k=h*i*d-L*U*d-h*x*n+$*U*n+L*x*W-$*i*W,o=L*R*d-h*Y*d+h*S*n-$*R*n-L*S*W+$*Y*W,s=h*Y*x-L*R*x-h*S*i+$*R*i+L*S*U-$*Y*U,V=K*I+M*k+b*o+G*s;if(0===V)return this.identity();var D=1/V;return p[0]=I*D,p[1]=(R*i*G-Y*U*G-R*b*n+M*U*n+Y*b*W-M*i*W)*D,p[2]=(S*U*G-R*x*G+R*b*d-M*U*d-S*b*W+M*x*W)*D,p[3]=(Y*x*G-S*i*G-Y*b*d+M*i*d+S*b*n-M*x*n)*D,p[4]=k*D,p[5]=(L*U*G-h*i*G+h*b*n-K*U*n-L*b*W+K*i*W)*D,p[6]=(h*x*G-$*U*G-h*b*d+K*U*d+$*b*W-K*x*W)*D,p[7]=($*i*G-L*x*G+L*b*d-K*i*d-$*b*n+K*x*n)*D,p[8]=o*D,p[9]=(h*Y*G-L*R*G-h*M*n+K*R*n+L*M*W-K*Y*W)*D,p[10]=($*R*G-h*S*G+h*M*d-K*R*d-$*M*W+K*S*W)*D,p[11]=(L*S*G-$*Y*G-L*M*d+K*Y*d+$*M*n-K*S*n)*D,p[12]=s*D,p[13]=(L*R*b-h*Y*b+h*M*i-K*R*i-L*M*U+K*Y*U)*D,p[14]=(h*S*b-$*R*b-h*M*x+K*R*x+$*M*U-K*S*U)*D,p[15]=($*Y*b-L*S*b+L*M*x-K*Y*x-$*M*i+K*S*i)*D,this},makeRotationAxis:function(D,r){var k=Math.cos(r),R=Math.sin(r),f=1-k,b=D.x,u=D.y,s=D.z,W=f*b,L=f*u;return this.set(W*b+k,W*u-R*s,W*s+R*u,0,W*u+R*s,L*u+k,L*s-R*b,0,W*s-R*u,L*s+R*b,f*s*s+k,0,0,0,0,1),this},multiply:function(g){return this.multiplyMatrices(this,g)},premultiply:function($){return this.multiplyMatrices($,this)},multiplyMatrices:function($,Z){var s=$.el,E=Z.el,Q=this.el,W=s[0],y=s[4],e=s[8],j=s[12],r=s[1],g=s[5],c=s[9],Y=s[13],t=s[2],G=s[6],l=s[10],T=s[14],d=s[3],D=s[7],v=s[11],x=s[15],C=E[0],z=E[4],V=E[8],N=E[12],O=E[1],i=E[5],I=E[9],b=E[13],p=E[2],u=E[6],K=E[10],R=E[14],w=E[3],_=E[7],M=E[11],P=E[15];return Q[0]=W*C+y*O+e*p+j*w,Q[4]=W*z+y*i+e*u+j*_,Q[8]=W*V+y*I+e*K+j*M,Q[12]=W*N+y*b+e*R+j*P,Q[1]=r*C+g*O+c*p+Y*w,Q[5]=r*z+g*i+c*u+Y*_,Q[9]=r*V+g*I+c*K+Y*M,Q[13]=r*N+g*b+c*R+Y*P,Q[2]=t*C+G*O+l*p+T*w,Q[6]=t*z+G*i+l*u+T*_,Q[10]=t*V+G*I+l*K+T*M,Q[14]=t*N+G*b+l*R+T*P,Q[3]=d*C+D*O+v*p+x*w,Q[7]=d*z+D*i+v*u+x*_,Q[11]=d*V+D*I+v*K+x*M,Q[15]=d*N+D*b+v*R+x*P,this},lookAt:function(){var h=new sh,I=new sh,P=new sh;return function(Q,U,r){var m=this.el;return P.subVectors(Q,U),0===P.lengthSq()&&(P.z=1),P.normalize(),h.crossVectors(r,P),0===h.lengthSq()&&(1===Math.abs(r.z)?P.x+=1e-4:P.z+=1e-4,P.normalize(),h.crossVectors(r,P)),h.normalize(),I.crossVectors(P,h),m[0]=h.x,m[4]=I.x,m[8]=P.x,m[1]=h.y,m[5]=I.y,m[9]=P.y,m[2]=h.z,m[6]=I.z,m[10]=P.z,this}}(),extractScale:function(){var M;return function(r){M===n&&(M=new sh),r===n&&(r=new sh);var q=M.setFromMatrixColumn(this,0).length(),Y=M.setFromMatrixColumn(this,1).length(),p=M.setFromMatrixColumn(this,2).length();return r.set(q,Y,p),r}}(),extractRotation:function(){var I;return function(w){I===n&&(I=new sh),w===n&&(w=new Hf);var h=this.el,q=w.el,O=1/I.setFromMatrixColumn(w,0).length(),L=1/I.setFromMatrixColumn(w,1).length(),f=1/I.setFromMatrixColumn(w,2).length();return h[0]=q[0]*O,h[1]=q[1]*O,h[2]=q[2]*O,h[4]=q[4]*L,h[5]=q[5]*L,h[6]=q[6]*L,h[8]=q[8]*f,h[9]=q[9]*f,h[10]=q[10]*f,this}}(),multiplyScalar:function(Q){var k=this.el;return k[0]*=Q,k[4]*=Q,k[8]*=Q,k[12]*=Q,k[1]*=Q,k[5]*=Q,k[9]*=Q,k[13]*=Q,k[2]*=Q,k[6]*=Q,k[10]*=Q,k[14]*=Q,k[3]*=Q,k[7]*=Q,k[11]*=Q,k[15]*=Q,this},getPosition:function(G){return G===n&&(G=new sh),G.setFromMatrixColumn(this,3)},setPosition:function(J){var g=this.el;return g[12]=J.x,g[13]=J.y,g[14]=J.z,this},toArray:function(A,P){A===n&&(A=[]),P===n&&(P=0);var E=this.el;return A[P]=E[0],A[P+1]=E[1],A[P+2]=E[2],A[P+3]=E[3],A[P+4]=E[4],A[P+5]=E[5],A[P+6]=E[6],A[P+7]=E[7],A[P+8]=E[8],A[P+9]=E[9],A[P+10]=E[10],A[P+11]=E[11],A[P+12]=E[12],A[P+13]=E[13],A[P+14]=E[14],A[P+15]=E[15],A},determinant:function(){var d=this.el,K=d[0],c=d[4],O=d[8],g=d[12],X=d[1],n=d[5],C=d[9],e=d[13],j=d[2],u=d[6],I=d[10],B=d[14],y=d[3],s=d[7],_=d[11],p=d[15];return y*(+g*C*u-O*e*u-g*n*I+c*e*I+O*n*B-c*C*B)+s*(+K*C*B-K*e*I+g*X*I-O*X*B+O*e*j-g*C*j)+_*(+K*e*u-K*n*B-g*X*u+c*X*B+g*n*j-c*e*j)+p*(-O*n*j-K*C*u+K*n*I+O*X*u-c*X*I+c*C*j)},copy:function(k){var b=this.el,K=k.el;return b[0]=K[0],b[1]=K[1],b[2]=K[2],b[3]=K[3],b[4]=K[4],b[5]=K[5],b[6]=K[6],b[7]=K[7],b[8]=K[8],b[9]=K[9],b[10]=K[10],b[11]=K[11],b[12]=K[12],b[13]=K[13],b[14]=K[14],b[15]=K[15],this},compose:function(u,q,g){var y=this.el,d=q._x,b=q._y,l=q._z,O=q._w,N=d+d,G=b+b,s=l+l,p=d*N,t=d*G,z=d*s,U=b*G,$=b*s,j=l*s,T=O*N,R=O*G,h=O*s,K=g.x,E=g.y,_=g.z;return y[0]=(1-(U+j))*K,y[1]=(t+h)*K,y[2]=(z-R)*K,y[3]=0,y[4]=(t-h)*E,y[5]=(1-(p+j))*E,y[6]=($+T)*E,y[7]=0,y[8]=(z+R)*_,y[9]=($-T)*_,y[10]=(1-(p+U))*_,y[11]=0,y[12]=u.x,y[13]=u.y,y[14]=u.z,y[15]=1,this},decompose:function(){var f=new sh,P=new Hf;return function(W,Z,t){var d=this.el,R=f.set(d[0],d[1],d[2]).length(),U=f.set(d[4],d[5],d[6]).length(),Y=f.set(d[8],d[9],d[10]).length(),w=this.determinant();0>w&&(R=-R),W.x=d[12],W.y=d[13],W.z=d[14],P.copy(this);var I=1/R,b=1/U,J=1/Y;return P.el[0]*=I,P.el[1]*=I,P.el[2]*=I,P.el[4]*=b,P.el[5]*=b,P.el[6]*=b,P.el[8]*=J,P.el[9]*=J,P.el[10]*=J,Z.setFromRotationMatrix(P),t.x=R,t.y=U,t.z=Y,this}}()});var Mf=Y.Math.Triangle=function(X,Y,P){this.a=X!==n?X:new sh,this.b=Y!==n?Y:new sh,this.c=P!==n?P:new sh};L.assign(Mf,{barycoordFromPoint:function(){var s=new sh,Z=new sh,Y=new sh;return function(l,P,t,X,O){s.subVectors(X,P),Z.subVectors(t,P),Y.subVectors(l,P);var b=s.dot(s),i=s.dot(Z),V=s.dot(Y),D=Z.dot(Z),u=Z.dot(Y),k=b*D-i*i,M=O||new sh;if(0===k)return M.set(-2,-1,-1);var c=1/k,C=(D*V-i*u)*c,R=(b*u-i*V)*c;return M.set(1-C-R,R,C)}}()});var Gj=Y.Math.Euler=function(C,J,b,a,V){this.set(C,J,b,a,V)};Gj.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Gj.DefaultOrder="XYZ",Gj.ReverseOrder=function(v){return v=v[2]+v[1]+v[0],v.toUpperCase()},L.defineProperties(Gj.prototype,{x:{get:function(){return this._x},set:function(z){this._x=z,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(z){this._y=z,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(U){this._z=U,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(_){this._order=_,this.onChangeCallback()}}}),L.assign(Gj.prototype,{set:function(m,W,o,I,b){return Hr(m)&&(b=o,I=W,o=m[2],W=m[1],m=m[0]),I?b&&(I=Gj.ReverseOrder(I)):I="ZYX",this._x=m||0,this._y=W||0,this._z=o||0,this._order=I||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(W){return this._x=W._x,this._y=W._y,this._z=W._z,this._order=W._order,this.onChangeCallback(),this},setFromRotationMatrix:function(D,T,s){var F=Y.Math.clamp,W=D.el||D,r=W[0],k=W[4],K=W[8],u=W[1],i=W[5],Q=W[9],w=W[2],L=W[6],m=W[10];return T=T||this._order,"XYZ"===T?(this._y=Math.asin(F(K,-1,1)),Math.abs(K)<.99999?(this._x=Math.atan2(-Q,m),this._z=Math.atan2(-k,r)):(this._x=Math.atan2(L,i),this._z=0)):"YXZ"===T?(this._x=Math.asin(-F(Q,-1,1)),Math.abs(Q)<.99999?(this._y=Math.atan2(K,m),this._z=Math.atan2(u,i)):(this._y=Math.atan2(-w,r),this._z=0)):"ZXY"===T?(this._x=Math.asin(F(L,-1,1)),Math.abs(L)<.99999?(this._y=Math.atan2(-w,m),this._z=Math.atan2(-k,i)):(this._y=0,this._z=Math.atan2(u,r))):"ZYX"===T?(this._y=Math.asin(-F(w,-1,1)),Math.abs(w)<.99999?(this._x=Math.atan2(L,m),this._z=Math.atan2(u,r)):(this._x=0,this._z=Math.atan2(-k,i))):"YZX"===T?(this._z=Math.asin(F(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-Q,i),this._y=Math.atan2(-w,r)):(this._x=0,this._y=Math.atan2(K,m))):"XZY"===T?(this._z=Math.asin(-F(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(L,i),this._y=Math.atan2(K,r)):(this._x=Math.atan2(-Q,m),this._y=0)):console.warn("unsupported order: "+T),this._order=T,s!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var k=new Hf;return function(c,O,i){return k.makeRotationFromQuaternion(c),this.setFromRotationMatrix(k,O,i)}}(),setFromVector3:function(W,U){return this.set(W.x,W.y,W.z,U||this._order)},reorder:function(){var P=new Rf;return function(Z){return P.setFromEuler(this),this.setFromQuaternion(P,Z)}}(),equals:function(l){return l._x===this._x&&l._y===this._y&&l._z===this._z&&l._order===this._order},fromArray:function(S){return this._x=S[0],this._y=S[1],this._z=S[2],S[3]!==n&&(this._order=S[3]),this.onChangeCallback(),this},toArray:function(M,I){return M===n&&(M=[]),I===n&&(I=0),M[I]=this._x,M[I+1]=this._y,M[I+2]=this._z,M[I+3]=this._order,M},toVector3:function(M){return M?M.set(this._x,this._y,this._z):new sh(this._x,this._y,this._z)},onChange:function(B){return this.onChangeCallback=B,this},onChangeCallback:function(){}});var pc={ms_ac:function(s,T){for(var I=T.ms_ac,q=0;q<I.length;q++)mf(s,I[q])},ms_listener:function(M){M.addListeners=function(){var H=this,A=0,S=Je;for(j.mockTouch&&(S=ad.concat(Gp).concat(tk));A<S.length;A++){var r=S[A];"wheel"===r&&!H.handle_wheel&&H.handle_mousewheel&&(H.handle_wheel=function(p){Om(H,p)}),H["handle_"+r]&&Zb(r,H.getView(),H)}},M.removeListeners=function(){for(var e=this,i=0;i<Je.length;i++)e["handle_"+Je[i]]&&Qp(Je[i],e.getView(),e)}},ms_fire:function(d){d.mp=function(M,y,U){this.addPropertyChangeListener(M,y,U)},d.ump=function(D,m){this.removePropertyChangeListener(D,m)},d.fp=function(o,e,l,E,y){return this.firePropertyChange(o,e,l,E,y)},d.addPropertyChangeListener=function(y,$,n){var B=this;B._62I||(B._62I=new Cl),B._62I.add(y,$,n)},d.removePropertyChangeListener=function(h,U){this._62I&&this._62I.remove(h,U)},d.firePropertyChange=function(O,t,r,N,q){if(N){if(N(t,r))return!1}else if(t===r)return!1;var F=this,R=q||{};return R.property=O,R.oldValue=t,R.newValue=r,R.source=F,R.data=F,F._62I&&F._62I.fire(R),F.onPropertyChanged&&F.onPropertyChanged(R),!0}},ms_attr:function(P){P.a=function(L,v){var T=this;if(2===arguments.length)T.setAttr(L,v);else{if(!Xj(L))return T.getAttr(L);for(var z in L)T.setAttr(z,L[z])}return T},P.getAttr=function(A,v){if(v===n&&(v=1),this._attrObject&&A in this._attrObject)return this._attrObject[A];if(this.getImage){var L=this.getImage();if(xh(L)&&(L=Kp[L]),Xj(L)&&"dataBindings"in L)for(var h=L.dataBindings,H=h.length-1;H>=0;H--){var m=h[H];if(m.attr===A){if("defaultValue"in m)return m.defaultValue;break}}}return v?C[A]:n},P.setAttr=function(q,o){var U=this;U._attrObject||(U._attrObject={});var W=U._attrObject[q];o===n?delete U._attrObject[q]:U._attrObject[q]=o,U.fp&&U.fp("a:"+q,W,o)&&U.onAttrChanged&&U.onAttrChanged(q,W,o)},P.getSerializableAttrs=function(){var a,y={};for(a in this._attrObject)y[a]=1;return y}},ms_bnb:function(y){y.getBodyColor=function(K){return K.s("body.color")},y.getBorderColor=function(I){return I.s("border.color")}},_51o:function($){$.mi=function(w,K,t){this.addInteractorListener(w,K,t)},$.umi=function(L,V){this.removeInteractorListener(L,V)},$.fi=function(F){this.fireInteractorEvent(F)},$.addInteractorListener=function(g,X,w){var o=this;o._63I||(o._63I=new Cl),o._63I.add(g,X,w)},$.removeInteractorListener=function(g,H){this._63I&&this._63I.remove(g,H)},$.fireInteractorEvent=function(i){this._63I&&this._63I.fire(i)},$.setInteractors=function(W){var w=this,s=w._interactors;s&&s.each(function(I){I.tearDown()}),Hr(W)&&(W=new zf(W)),w._interactors=W,W&&W.each(function(W){W.setUp()}),w.fp("interactors",s,W),w.invalidateSelection()},$.getInteractors=function(){return this._interactors}},_49o:function(A){A._44O=O,A._45O=O,A.getTopPainters=function(){return this._44O},A.getBottomPainters=function(){return this._45O},A.addTopPainter=function(V){var j=this;j._44O||(j._44O=new zf),j._44O.contains(V)||(j._44O.add(V),j.redraw&&j.redraw())},A.removeTopPainter=function(M){var H=this;H._44O&&(H._44O.remove(M),H.redraw&&H.redraw())},A.addBottomPainter=function(p){var o=this;o._45O||(o._45O=new zf),o._45O.contains(p)||(o._45O.add(p),o.redraw&&o.redraw())},A.removeBottomPainter=function(P){var b=this;
b._45O&&(b._45O.remove(P),b.redraw&&b.redraw())},A._93db=function(v,x){var f=this;f._45O&&f._45O.each(function(p){p.draw?p.draw(v,x):p.call(f,v,x)})},A._92db=function(B,g){var l=this;l._44O&&l._44O.each(function(q){q.draw?q.draw(B,g):q.call(l,B,g)})}},ms_sm:function(U){U.sm=function(){return this.getSelectionModel()},U.setSelectableFunc=function(e){this.sm().setFilterFunc(e)},U.getSelectableFunc=function(){return this.sm().getFilterFunc()},U.getSelectionModel=function(){var K=this;return K._selectionModel?K._selectionModel:K.dm().sm()},U.isSelectionModelShared=function(){return!this._selectionModel},U.setSelectionModelShared=function(a){var w=this,Q=!w._selectionModel,_=w.handleSelectionChange,f=w.dm();Q!==a&&(w.invalidateSelection&&w.invalidateSelection(),a?(f.sm().ms(_,w),w._selectionModel.ums(_,w),w._selectionModel.dispose(),w._selectionModel=O):(f.sm().ums(_,w),w._selectionModel=new Yl(f),w._selectionModel.ms(_,w)),w.onSelectionModelSharedChanged(),w.fp("selectionModelShared",Q,a))},U.onSelectionModelSharedChanged=function(){var G=this;G.redraw(),G.invalidateSelection&&G.invalidateSelection()},U.removeSelection=function(){var k=this.dm();k.beginTransaction(),this.sm().toSelection().each(k.remove,k),k.endTransaction()},U.selectAll=function(){var y=this;y.sm().ss(y.dm().toDatas(function($){return y.isVisible($)&&y.isSelectable($)}))},U.isSelected=function(K){return this.sm().co(K)},U.isSelectedById=function(k){var W=this.dm().getDataById(k);return W?this.isSelected(W):!1},U.isSelectable=function(b){return this.sm().isSelectable(b)}},ms_tx:function(L){L._64I=0,L._65O=0,L.isScrollable=function(){return this.getWidth()<this._64I},L._40o=function(){return this.isScrollable()},L.getLogicalPoint=function(o){return jn(o,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},L.tx=function(k){return k===n?this.getTranslateX():(this.setTranslateX(k),void 0)},L.getTranslateX=function(){return this._65O},L.setTranslateX=function(w){var O=this,T=O.getWidth()-O._64I;T>w&&(w=T),w>0&&(w=0),w=i(w);var f=O._65O;O._65O=w,O.fp(jq,f,w)}},ms_ty:function(k){k._23Q=0,k._66O=0,k._41o=function(){return this.getHeight()<this._23Q},k.getLogicalPoint=function(i){return jn(i,this._canvas||this._view,this.tx?this.tx():0,this.ty())},k.ty=function($){return $===n?this.getTranslateY():(this.setTranslateY($),void 0)},k.getTranslateY=function(){return this._66O},k.setTranslateY=function(U){var X=this,u=X.getHeight()-X._23Q;u>U&&(U=u),U>0&&(U=0),U=i(U);var O=X._66O;X._66O=U,X.fp(Ko,O,U)}},ms_txy:function(F){F._65O=0,F._66O=0,F.tx=function(j){return j===n?this.getTranslateX():(this.setTranslateX(j),void 0)},F.ty=function(Y){return Y===n?this.getTranslateY():(this.setTranslateY(Y),void 0)},F.onTranslateEnded=function(){},F.setTranslate=function(O,d,l){var S=this;if(l=vo(l)){S._65I&&S._65I.stop(!0);var K=S.tx(),F=S.ty();l.action=function(e){S.setTranslate(K+(O-K)*e,F+(d-F)*e)},l._37o=function(){delete S._66I,delete S._65I,S.onTranslateEnded()},S._66I=1,S._65I=Zc(l)}else S.tx(O),S.ty(d)},F.getTranslateX=function(){return this._65O},F.setTranslateX=function(v){var i=this;v=i.adjustTranslateX(v);var C=i._65O;i._65O=v,i.fp(jq,C,v)},F.getTranslateY=function(){return this._66O},F.setTranslateY=function(r){var D=this;r=D.adjustTranslateY(r);var M=D._66O;D._66O=r,D.fp(Ko,M,r)},F.adjustTranslateX=function(H){return i(H)},F.adjustTranslateY=function(I){return i(I)},F.translate=function(W,q,J){this.setTranslate(this.tx()+W,this.ty()+q,J)},F.getLogicalPoint=function(h){var H=this;return jn(h,this._canvas||H._view,H.tx(),H.ty())}},ms_dm:function(y){y.dm=function(M){return M?(this.setDataModel(M),void 0):this.getDataModel()},y.getDataModel=function(){return this._dataModel}},ms_lp:function(U){U.lp=function(E){return this.getLogicalPoint(E)}},ms_v:function(g){g._disabled=!1,g.setDisabled=function(f,S){var K=this,t=K._disabled;t!==f&&(t&&(go(K._63O),delete K._63O),f&&(cr(K._view,K._63O=Wq(S)),K.iv()),K._disabled=f,K.fp("disabled",t,f))},g.isDisabled=function(){return this._disabled},g.getDisabledDiv=function(){return this._63O},g.getView=function(){return this._view},g.addToDOM=function(y){var V=this,R=V.getView(),_=R.style;y=y||d.body,y.appendChild(R),_.left="0",_.right="0",_.top="0",_.bottom="0",q(m,"resize",function(){V.iv()}),V.iv()},g.getWidth=function(){return this._view.clientWidth},g.getHeight=function(){return this._view.clientHeight},g.setWidth=function(R){var G=this;G._view.style.width=R+Qj,G.iv(),G.fp&&G.fp(Ml,O,R)},g.setHeight=function(D){var x=this;x._view.style.height=D+Qj,x.iv(),x.fp&&x.fp(rj,O,D)},g.setFocus=function(q){var v=this,a=v._currentEditor;return q&&a&&(a.getView&&(a=a.getView()),a.contains(q.target))?!1:(eh(v._view),v.endEditing&&v.endEditing(),v.fireViewEvent("focus"),!0)},g.iv=function(t){this.invalidate(t)},g.invalidate=function(K){var W=this;W._68I||(W._68I=1,Bj(W.validate,W,O,K),W.onInvalidated&&W.onInvalidated(),W.fireViewEvent("invalidate"))},g.validate=function(){var P=this,N=P._view;if(P._68I&&(delete P._68I,N.parentNode))if(0===N.offsetWidth&&0===N.offsetHeight&&P._67I!==O)P._67I===n&&(P._67I=j.reinvalidateCount),P._67I>0?P._67I--:P._67I=O,P.iv();else{P.fireViewEvent("beginValidate"),P.validateImpl(),P.onValidated&&P.onValidated(),P.fireViewEvent("validate");var A=P._63O;A&&(N.lastChild!==A&&(go(A),cr(N,A)),dg(A,0,0,P.getWidth(),P.getHeight())),bh(P),em(P),Yo(P)}},g.layout=function(j,J,q,l){1===arguments.length?dg(this,j):dg(this,j,J,q,l)},g.addViewListener=function(j,w,z){var N=this;N._67O||(N._67O=new Cl),N._67O.add(j,w,z)},g.removeViewListener=function(W,J){this._67O.remove(W,J)},g.fireViewEvent=function(W){var T=this;T._67O&&(xh(W)&&(W={kind:W}),T._67O.fire(W)),j.viewListener&&j.viewListener(T,W)}},ms_tip:function(u){u.setToolTipEnabled=function(v){var j=this;v?Lr||j._13o||(j.enableToolTip(),j.fp("toolTipEnabled",!1,!0)):j._13o&&(j.disableToolTip(),j.fp("toolTipEnabled",!0,!1))},u.isToolTipEnabled=function(){return!!this._13o},u.enableToolTip=function(){var w=this;if(!Lr&&!w._13o){w._13o=function(S){var t=w.getToolTip(S);t!=O?j.toolTipContinual&&j.isToolTipShowing()?Co(S,t):(Km(),Yf={timeout:T(bn,se),e:S,info:t}):Km()};var v=w.getView();q(v,sm,w._13o),q(v,"mouseleave",j.hideToolTip)}},u.disableToolTip=function(){var u=this;if(u._13o){var C=u.getView();X(C,sm,u._13o),X(C,"mouseleave",j.hideToolTip),delete u._13o}},u.getToolTip=function(T){var c=this;if(c.getDataAt){var S=c.getDataAt(T);return S?S.getToolTip():O}return c.getValue?c.getValue():void 0}},_52o:function(Y){Y._zoom=1,Y._29I=yk,Y.zoomIn=function(D,E){this.setZoom(this._zoom*Ze,D,E)},Y.zoomOut=function(g,t){this.setZoom(this._zoom/Ze,g,t)},Y.zoomReset=function(E,q){this.setZoom(1,E,q)},Y.scrollZoomIn=function(A){this.setZoom(this._zoom*Sn,O,A)},Y.scrollZoomOut=function(t){this.setZoom(this._zoom/Sn,O,t)},Y.pinchZoomIn=function(E){this.setZoom(this._zoom*qm,O,E)},Y.pinchZoomOut=function(I){this.setZoom(this._zoom/qm,O,I)},Y.adjustZoom=function(L){return Me>L?Me:L>Uh?Uh:L},Y.getZoom=function(){return this._zoom},Y.setZoom=function(r,$,g){var q=this;if($=vo($)){q._14o&&q._14o.stop(!0);var d=q._zoom;$.action=function(G){q._96O(d+(r-d)*G,g)},$._37o=function(){delete q._zooming,delete q._14o,q.onZoomEnded()},q._zooming=1,q._14o=Zc($)}else q._96O(r,g)},Y._96O=function(m,w){var n=this;if(m=n.adjustZoom(m),m!==n._zoom){n.validate();var q=n._29I,P=n._zoom;0!==q.width&&0!==q.height&&(w=w?w:{x:q.x+q.width/2,y:q.y+q.height/2},n.tx((w.x-q.x)*P-w.x*m),n.ty((w.y-q.y)*P-w.y*m)),n._zoom=m,n.fp("zoom",P,m)}}},ms_edge:function(K){K._2I=function(_){var n=this;n._44I||(n._44I=new zf),n._42I||(n._42I=new zf),n._44I.add(_),n._42I.add(_),n._20I()},K._4I=function(H){var R=this;R._44I||(R._44I=new zf),R._43I||(R._43I=new zf),R._44I.add(H),R._43I.add(H),R._20I()},K._16I=function(H){var D=this;D._44I.remove(H),D._42I.remove(H),D._44I.isEmpty()&&delete D._44I,D._42I.isEmpty()&&delete D._42I,D._20I()},K._18I=function(N){var D=this;D._44I.remove(N),D._43I.remove(N),D._44I.isEmpty()&&delete D._44I,D._43I.isEmpty()&&delete D._43I,D._20I()},K._20I=function(){var O=this;if(delete O._45I,!O._44I||O._44I.isEmpty())return delete O._70O,void 0;var h;O._44I.each(function(H){H.isLooped()&&(h||(h={}),h[H._id]||(O._45I||(O._45I=new zf),O._45I.add(H),h[H._id]=H))}),h?(O._70O=new zf,O._44I.each(function(S){h[S._id]?"A"===h[S._id]||(h[S._id]="A",O._70O.add(S)):O._70O.add(S)})):O._70O=O._44I},K.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},K.getSourceAgentEdges=function(){return this._46I},K.getTargetAgentEdges=function(){return this._47I},K._1I=function(h){var C=this;C._46I||(C._46I=new zf),C._48I||(C._48I=new zf),C._46I.add(h),C._48I.add(h),C._19I()},K._3I=function(u){var P=this;P._47I||(P._47I=new zf),P._48I||(P._48I=new zf),P._47I.add(u),P._48I.add(u),P._19I()},K._15I=function(U){var o=this;o._46I.remove(U),o._48I.remove(U),o._46I.isEmpty()&&delete o._46I,o._48I.isEmpty()&&delete o._48I,o._19I()},K._17I=function(t){var m=this;m._47I.remove(t),m._48I.remove(t),m._47I.isEmpty()&&delete m._47I,m._48I.isEmpty()&&delete m._48I,m._19I()},K._19I=function(){var C=this;delete C._49I;var X=C._48I;if(X&&!X.isEmpty()){var i={};X.each(function(u){i[u._id]?C._49I||(C._49I=new zf):i[u._id]=u}),C._49I?X.each(function(u){i[u._id]&&(C._49I.add(u),delete i[u._id])}):C._49I=X}},K.getLoopedEdges=function(){return this._45I},K.getEdges=function(){return this._70O},K.getAgentEdges=function(){return this._49I},K.getSourceEdges=function(){return this._42I},K.getTargetEdges=function(){return this._43I},K._8I=function(){this._70O&&this._70O.each(function(_){_._7I()})}}};Dq(j,{getVersion:function(){return"7.0.9"}},!0),Dq(j,{numberDigits:5,crossOrigin:"",baseZIndex:n,isTouchable:Lr,devicePixelRatio:m.devicePixelRatio?m.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:R.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return _q},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,encodeStringKey:null,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(e){return e*e},labelColor:Qb,labelSelectColor:Ye,labelFont:"12px arial, sans-serif",widgetIndent:Lr?30:20,widgetRowHeight:Lr?30:20,widgetHeaderHeight:Lr?32:22,widgetTitleHeight:Lr?34:24,scrollBarColor:Fg,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Lr?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:lm,intersectionLineLine:Cr,isEnter:Vm,isEsc:Le,isDelete:Zr,isSpace:ym,isLeft:Fk,isUp:fb,isRight:tc,isDown:dc,isTouchEvent:Hh,getTarget:Ed,isString:xh,isNumber:Sd,isBoolean:Hi,isArray:Hr,isSelectAll:hl,isFunction:er,isObject:Xj,getPropertyValue:Bm,setPropertyValue:fr,addMethod:Dq,isMobile:function(){var g;return function(){return g!==n?g:(g=!1,function(i){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(g=!0)}(navigator.userAgent||navigator.vendor||m.opera),g)}}(),createGradient:function(D,I,S,U,v,t,m,a){var F=id[I];return F(D,S,U,v,t,m,a)},appendToScreen:function(V){V=V.getView?V.getView():V,(d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement||d.body).appendChild(V)},encodeString:function(S){return Y.Math.encodeBase64(S,j.encodeStringKey)},decodeString:function(i){return Y.Math.decodeBase64(i,j.encodeStringKey)},findView:function(k){var N=function(R,k){var K=k._ht;K&&R.push(K);var j=k.children,L=j.length;if(L)for(var C=0;L>C;C++)N(R,j[C])},P=[];N(P,d.body);var X=function(h,Q){for(var m="2d"===Q?km.GraphView:fl.Graph3dView,d=0,W=h.length;W>d;d++)if(h[d]instanceof m)return P[d];return null};return"all"===k?P:"2d"===k?X(P,"2d"):"3d"===k?X(P,"3d"):X(P,"3d")||X(P,"2d")},toggleFullscreen:function(L){var R=L.getView();if(d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement)d.exitFullscreen?d.exitFullscreen():d.msExitFullscreen?d.msExitFullscreen():d.mozCancelFullScreen?d.mozCancelFullScreen():d.webkitExitFullscreen&&d.webkitExitFullscreen();else{var $=!0;if(L.isSelfViewEvent){var r=L.getX(),B=L.getY(),Z=L.getWidth(),q=L.getHeight(),y=R.style.background,A=R.style.backgroundColor;y||A||(R.style.backgroundColor="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var c=setInterval(function(){if(R!==(d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement))clearInterval(c),L.setX(r),L.setY(B),L.setWidth(Z),L.setHeight(q),L._fullscreen=!1,R.style.oldBackgroundColor=A,L.iv();else{var w=Y.Default.getWindowInfo();($||w.width!==L.getWidth()||w.height!==L.getHeight())&&(L.setX(w.left),L.setY(w.top),L.setWidth(w.width),L.setHeight(w.height),L._fullscreen=!0,L.iv(),$=!1)}},500)}else{var T=R.style.left,U=R.style.top,Z=R.style.width,q=R.style.height,y=R.style.background,A=R.style.backgroundColor;y||A||(R.style.backgroundColor="white"),R.requestFullscreen?R.requestFullscreen():R.msRequestFullscreen?R.msRequestFullscreen():R.mozRequestFullScreen?R.mozRequestFullScreen():R.webkitRequestFullscreen&&R.webkitRequestFullscreen();var c=setInterval(function(){if(R!==(d.fullscreenElement||d.mozFullScreenElement||d.webkitFullscreenElement||d.msFullscreenElement))clearInterval(c),R.style.left=T,R.style.top=U,R.style.width=Z,R.style.height=q,R.style.oldBackgroundColor=A,L.iv();else{var y=Y.Default.getWindowInfo();($||y.width!==L.getWidth()||y.height!==L.getHeight())&&(dg(L),$=!1)}},500)}}},appendTimeStamp:function(e){return e},setCompType:function(p,I){er(I)||Xj(I)?hb[p]=I:Pj(p)},getCompType:function(X){var U=hb[X];return U===n&&Gm.test(X)&&Pj(X),U},getCompTypeMap:function(){return hb},drawCompType:function(K,$,Z,X,M,j){K($,Z,X,M,j)},numberListener:function(){var K={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(T){var M=T.keyCode;K[M]||65===M&&j.isCtrlDown(T)||86===M&&j.isCtrlDown(T)||67===M&&j.isCtrlDown(T)||88===M&&j.isCtrlDown(T)||M>=35&&40>=M||(T.shiftKey||48>M||M>57)&&(96>M||M>105)&&T.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(S){var E=S.target.tagName;("DIV"===E||"CANVAS"===E)&&!(j.ignoreKeyCodes.indexOf(S.keyCode)>=0)&&("keydown"!==S.type||Fk(S)||tc(S)||fb(S)||dc(S)||Zr(S)||65===S.keyCode&&(S.metaKey||S.ctrlKey))&&(S.preventDefault(),S.preventManipulation&&S.preventManipulation())},getWindowInfo:function(){var b=d.documentElement,w=b&&(b.scrollLeft||b.scrollTop)?b:d.body;return{target:w,left:w.scrollLeft,top:w.scrollTop,width:m.innerWidth||w.clientWidth,height:m.innerHeight||w.clientHeight}},isDragging:function(){return!!_q},isLeftButton:function(n){return Hh(n)?!0:0===n.button},isMiddleButton:function(N){return Hh(N)?!1:N&&(1===N.button||4&(N.buttons||0))},isRightButton:function(b){return Hh(b)?!1:b&&(2===b.button||2&(b.buttons||0))},isInput:function(x){if(!x)return!1;var i=x.tagName;return"INPUT"===i||"TEXTAREA"===i||"SELECT"===i},getTouchCount:function(e){return Hh(e)?e.touches.length:1},isDoubleClick:function(){function S(d){d.details=0,d.timeout=null,d.lastPoint=null}var U={};return vm=new K,Rr=vm.getTime(),function(I){if(Am(I)>1)return!1;var c=I.button==O?"":I.button,C=I.type+c,H=C+"_isDoubleClick",v=U[C];if(v||(v=U[C]={details:0,timeout:null,lastPoint:null}),I[H]===n){I[H]=!0;var f=up(I);v.timeout&&(r(v.timeout),v.timeout=null);var d=Hh(I)?j.doubleTouchRange:j.doubleClickRange;v.lastPoint&&rs(v.lastPoint,f)>d&&S(v),v.lastPoint=f,v.details++,v.timeout=T(function(){S(this)}.bind(v),500)}return 2===v.details}}(),isShiftDown:function(L){return L?L.shiftKey:Ej["16"]},isCtrlDown:function(H){return H?Bl?H.metaKey:H.ctrlKey:Bl?Ej["91"]:Ej["17"]},getClientPoint:function(w){return Hh(w)&&(w=pl(w)),{x:w.clientX,y:w.clientY}},isMouseEvent:function(f){return f instanceof MouseEvent||0===f.type.indexOf("mouse")},getTargetElement:function(W){if(j.isMouseEvent(W)||!d.elementFromPoint)return W.target;var l=Cn(W);return d.elementFromPoint(l.x,l.y)},getPagePoint:function(g){return Hh(g)&&(g=pl(g)),{x:g.pageX,y:g.pageY}},createObject:function(w,p){var T=new w;for(var b in p){var J=p[b];if(er(J))T[b]=J;else if(0===b.indexOf("s:"))T.s(b.substr(2),p[b]);else if(0===b.indexOf("a:"))T.a(b.substr(2),p[b]);else{var e=Qg(b),J=p[b];T[e]?(T[e](J),"setToolTip"===e&&T.enableToolTip&&T.enableToolTip()):T[b]=J}}return T},setImage:function(Z,c,L,I){var U=arguments.length;4===U?Ff(Z,I,c,L):2===U?xh(c)?Ff(Z,c):Bb(Z,c):1===U&&Ff(Z,Z)},getImage:function(h,W,C){var A;if(h==O)return O;if(Xj(h)?A=h:(A=Kp[h],h&&A===n&&(gf&&gf[h]||Ff(h,h))),W&&A&&A.tagName){var B;B="override"===C?"colors_override":"override_rgb"===C?"colors_override_rgb":"override_a"===C?"colors_override_a":"colors",A[B]||(A[B]={__count__:0});var b=A[B][W];return b||(A[B].__count__>j.imageCacheThreshold&&(A[B]={__count__:0}),b=Tg(A,Yr(W),A.width,A.height,C),A[B][W]=b,A[B].__count__++),b}return A},isImageComplete:function(o,v,k){var m=co(o);if(!m)return!1;if(m.tagName)return m.complete;for(var O,o,F,p=m.comps,q=!0,D=0,r=p.length;r>D;D++)if(O=p[D],F=O.type,"image"===O.type){o=O.name,o&&o.func&&(o=lc(o,v));var V=Ak(o,v,k);if(!V){q=!1;break}}else if(Gm.test(F)&&j.getCompType(F)===n){q=!1,Pj(F);break}return q},getId:function(){var $=1;return function(){return++$}}(),callLater:function(K,y,x,u){var F=function(){K.apply(y,x)};return u?T(F,u):m.requestAnimationFrame(F)},cancelLater:function(Y,k){k?r(Y):m.cancelAnimationFrame(Y)},clone:function(G){if(null==G||"object"!=typeof G)return G;if(G instanceof Date){var V=new Date;return V.setTime(G.getTime()),V}if(G instanceof Array){for(var V=[],P=0,W=G.length;W>P;P++)V[P]=qk(G[P]);return V}if(G instanceof zf){for(var V=new zf,P=0,W=G.length;W>P;P++)V.set(P,qk(G.get(P)));return V}if(G instanceof Jh)return G;if(G instanceof L){var V={};for(var K in G)G.hasOwnProperty(K)&&(V[K]=qk(G[K]));return V}return G},callWhenLoaded:function(k,v){v=v||100;var b=sl(k,v);Yq||(Yq={}),Yq[b]={tick:b,cb:k,delay:v}},beforeLoadURL:function(t,w){if(Yq){var h={};for(var w in Yq){var f=Yq[w];r(f.tick);var x=sl(f.cb,f.delay);h[x]={tick:x,delay:f.delay,cb:f.cb}}Yq=h}return j.convertURL?j.convertURL(t,w):t},convertURL:function(r){return r},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return j.getImage("default_blank")},resizeImagePOT:function(V,s){if(!V||!V.tagName)return V;var B=V.width,P=V.height;if(!B||!P)return V;if(Jm.isPOT(B)&&Jm.isPOT(P)&&(!s||B===P))return V;var $,Q;s?Q=$=Jm.nearestPOT(Math.min(B,P)):($=Jm.nearestPOT(B),Q=Jm.nearestPOT(P));var e=Uq(),T=e.getContext("2d");return Xr(e,$,Q,1),T.drawImage(V,0,0,B,P,0,0,$,Q),e},sortFunc:function(r,s){if(r===s)return 0;if(r==O&&s!=O)return 1;if(r!=O&&s==O)return-1;if(r==O&&s==O)return 0;var c,d=typeof r,C=typeof s;return d===yb&&C===yb?c=r.localeCompare(s):d===fc&&C===fc&&(c=r-s),c===n&&(c=(""+r).localeCompare(""+s)),c>0?1:0>c?-1:0},getClassMap:function(){return Eh},getClass:function(A){if(xh(A)){var y,d=Eh[A];if(!d){y=A.split("."),d=m;for(var Y=0;Y<y.length;Y++)d=d[y[Y]];Eh[A]=d}return d}return A},def:function(G,N,s){var l,R,D,K=function(){};if(K.prototype=N.prototype,l=new K,xh(G)){if(Eh[G])throw"'"+G+"' already defined";D=qi(G),l.getClassName=function(){return G}}else D=G;if(l.constructor=D,l.getClass=function(){return D},l.getSuperClass=function(){return N},s)for(R in s)pc[R]&&pc.hasOwnProperty(R)?pc[R](l,s):Kc(l,s,R);D.prototype=l,D.superClass=N.prototype},startAnim:function(){var u=function(V){V.duration&&(V.startTime=Af()),V.timeId=Bj(V.tick,O,O,V.interval)};return function(i){return i=qk(i),i.easing=i.easing||j.animEasing,i.duration||i.frames||(i.duration=j.animDuration),i.t=0,i.duration?i.interval=0:(i.frame=0,i.interval=i.interval||10),i.tick=function(){if(i.duration){var X=(Af()-i.startTime)/i.duration;if(X>1&&(X=1),i.t=X,i.action(i.easing(X),X),!i.isRunning())return;1===X?i.stop():i._isPaused||(i.timeId=Bj(i.tick))}else{if(i.frame++,X=i.t=i.frame/i.frames,i.action(i.easing(X),X),!i.isRunning())return;i.frame<i.frames?i._isPaused||(i.timeId=Bj(i.tick,O,O,i.interval)):i.stop()}},i.resume=function(){i._isPaused&&(delete i._isPaused,i.duration?i.t<1&&(i.startTime=Af()-i.duration*i.t,i.timeId=Bj(i.tick)):i.frame<i.frames&&(i.timeId=Bj(i.tick,O,O,i.interval)))},i.pause=function(){nl(i.timeId,!i.duration),i._isPaused=!0},i.isPaused=function(){return this._isPaused},i.stop=function(v){i.isRunning()&&(nl(i.timeId,!i.duration),delete i.timeId,i.duration?i.t<1&&v&&(i.t=1,i.action(i.easing(1),1)):i.frame<i.frames&&v&&(i.frame=i.frames,i.action(i.easing(1),1)),i._37o&&i._37o(),i.finishFunc&&i.finishFunc())},i.isRunning=function(){return i.timeId!=O},i.delay?Bj(u,O,[i],i.delay):u(i),i}}(),getTextSize:function(){var h={},X=d?Uq().getContext("2d"):O;return function(o,b){X.font=o?o:Go;var d=h[X.font];return d||(d=2*X.measureText("e").width+4,h[X.font]=d),{width:X.measureText(b).width+4,height:d}}}(),drawText:function(i,y,K,s,P,R,d,k,H,p){if(y!=O){var X=Pi(K,y),Y={};Y.y=p&&p!==Te?p===nh?R+X.height/2:R+k-X.height/2:R+k/2,Y.x=H&&H!==dj?H===xq?P+d-X.width/2:P+d/2:P+X.width/2,kq(i,y,Y,K,s)}},getDistance:function(y,O){var I=y.length;return O?3===I?e(_(y[0]-O[0])+_(y[1]-O[1])+_(y[2]-O[2])):2===I?e(_(y[0]-O[0])+_(y[1]-O[1])):y.z===n?e(_(O.x-y.x)+_(O.y-y.y)):e(_(O.x-y.x)+_(O.y-y.y)+_(O.z-y.z)):3===I?e(_(y[0])+_(y[1])+_(y[2])):2===I?e(_(y[0])+_(y[1])):void 0},brighter:function(J,Y){return 0>Y&&(Y=-Y),ji(J,Y?Y:40)},darker:function(W,c){return c>0&&(c=-c),ji(W,c?c:-40)},unionPoint:function(h,B){if(!h)return O;if(2===arguments.length)return h&&B?{x:u(h.x,B.x),y:u(h.y,B.y),width:w(h.x-B.x),height:w(h.y-B.y)}:O;var x=h;if(x._as&&(x=x._as),x.length===n)return O;var p=x.length;if(0>=p)return O;for(var f=1,A=x[0],y={x:A.x,y:A.y,width:0,height:0};p>f;f++){A=x[f];var d=u(y.x,A.x),K=P(y.x+y.width,A.x),L=u(y.y,A.y),z=P(y.y+y.height,A.y);y.x=d,y.y=L,y.width=K-d,y.height=z-L}return y},unionRect:function(y,v){if(y&&!v)return qk(y);if(!y&&v)return qk(v);if(y&&v){var A={x:u(y.x,v.x),y:u(y.y,v.y)};return A.width=P(y.x+y.width,v.x+v.width)-A.x,A.height=P(y.y+y.height,v.y+v.height)-A.y,A}return O},containsPoint:function(P,M,w,W){if(W!=O&&1!==W){var k=P.x+P.width/2,p=P.y+P.height/2;P={x:k-P.width/2*W,y:p-P.height/2*W,width:P.width*W,height:P.height*W}}if(w){var U=P.width/2,X=P.height/2,F=N(-w),t=c(-w),H=M.x-P.x-U,h=M.y-P.y-X;return M={x:t*H-F*h,y:F*H+t*h},Mg({x:-U,y:-X,width:P.width,height:P.height},M)}return!(!P||M.x<P.x||M.y<P.y||M.x>P.x+P.width||M.y>P.y+P.height)},containsRect:function(d,Q){if(!d||!Q)return!1;var q=Q.x,g=Q.y,F=Q.width,A=Q.height,t=d.width,y=d.height;if(0>(t|y|F|A))return!1;var x=d.x,Y=d.y;if(x>q||Y>g)return!1;if(t+=x,F+=q,q>=F){if(t>=x||F>t)return!1}else if(t>=x&&F>t)return!1;if(y+=Y,A+=g,g>=A){if(y>=Y||A>y)return!1}else if(y>=Y&&A>y)return!1;return!0},intersectsRect:function(l,P){if(!l||!P)return!1;var K=P.width,H=P.height,n=l.width,b=l.height;if(0>=n||0>=b||0>=K||0>=H)return!1;var T=P.x,R=P.y,m=l.x,U=l.y;return n+=m,b+=U,K+=T,H+=R,n>T&&b>R&&K>m&&H>U},intersection:function(s,g){if(!s||!g)return O;var H=g.x,l=g.y,_=s.x,k=s.y,v=H,n=l,e=_,m=k;return v+=g.width,n+=g.height,e+=s.width,m+=s.height,_>H&&(H=_),k>l&&(l=k),v>e&&(v=e),n>m&&(n=m),v-=H,n-=l,0>=v||0>=n?O:{x:H,y:l,width:v,height:n}},grow:function(m,j,I){I===n&&(I=j),m.x-=j,m.y-=I,m.width=m.width+2*j,m.height=m.height+2*I},getScreenPoint:function(Q,i,p,k,H,J,W){var T=p.getBoundingClientRect(),Y=Q*(J||1)-p.scrollLeft+(k||0),a=i*(W||1)-p.scrollTop+(H||0),v=nb(p,!1);if(v){var u=new sh(Y,a,0);return u.applyMatrix4(v),console.log(u),{x:u.x,y:u.y}}return{x:Y+T.left,y:a+T.top}},getLogicalPoint:function(q,Y,H,a,M,h){var U,W,t=Y.getBoundingClientRect();q.target?(_e(q)?Bl?Ej["91"]=!0:Ej["17"]=!0:Bl?Ej["91"]=!1:Ej["17"]=!1,Ej["16"]=Hc(q)?!0:!1,q=Hh(q)?pl(q):q,U=q.clientX,W=q.clientY):(U=q.x,W=q.y);var v=nb(Y,!0);if(v){var O=new sh(U,W,0);O.applyMatrix4(v);do{if(Math.abs(O.z)<=1e-6)break;var i=new sh(U,W,1);if(i.applyMatrix4(matrix),Math.abs(i.z)<=1e-6){O=i;break}if(i.sub(O),Math.abs(i.z)<=1e-6)break;O.addScaledVector(i,-O.z/i.z)}while(!1);return{x:(O.x+Y.scrollLeft-(H||0))/(M||1),y:(O.y+Y.scrollTop-(a||0))/(h||1)}}return{x:(U-t.left+Y.scrollLeft-(H||0))/(M||1),y:(W-t.top+Y.scrollTop-(a||0))/(h||1)}},removeHTML:function(){var E;return function(h){return h&&h.getView&&(h=h.getView()),h&&h.parentNode?E===h?!0:(E=h,h.parentNode.removeChild(h),E=O,!0):!1}}(),getToolTipDiv:function(){if(!Mm){Mm=Tj(),Ok=Tj();var _=Mm.style;j.baseZIndex!=O&&(_.zIndex=I(j.baseZIndex)+3+""),_.whiteSpace="nowrap",_.color=j.toolTipLabelColor,_.background=j.toolTipBackground,_.font=j.toolTipLabelFont,_.padding="5px",_.boxShadow="0px 0px 3px "+j.toolTipShadowColor}return Mm},isToolTipShowing:function(){return Mm&&Mm.parentNode?!0:Ok&&Ok.parentNode?!0:!1},hideToolTip:function(){go(Mm),go(Ok),_k()},showToolTip:function(y,P){if(!y||P==O)return Km(),void 0;j.getToolTipDiv();var U,e;if(P.html?(P=P.html,U=Ok,go(Mm)):(U=Mm,go(Ok)),e=U.style,U.innerHTML=P,U.parentNode||Y.Default.appendToScreen(U),y.target){y=Cn(y);var m=Db(),N=y.x,C=y.y,_=Lr?60:12;if(Lr){var d=U.getBoundingClientRect();e.left=N-d.width/2+Qj,e.top=C-d.height-_<m.top?C+_+Qj:C-d.height-_+Qj}else{e.left=N+_+Qj,e.top=C+_+Qj;var d=U.getBoundingClientRect();d.left+d.width>m.width&&(e.left=N-_-d.width+Qj),d.top+d.height>m.height&&(e.top=C-_-d.height+Qj),d.left<0&&(e.left=N+_+Qj),d.top<0&&(e.top=C+_+Qj)}}else e.left=y.x+Qj,e.top=y.y+Qj;_k()},startDragging:function(u,j,J){J==n&&(J=!0),u!==_q&&(_q?J&&(Hh(j)?_q.handleWindowTouchEnd(j):_q.handleWindowMouseUp(j)):Hh(j)?(q(m,is,Yd),q(m,hj,Zh)):(q(m,sm,tq),q(m,Dh,fh)),_q=u)},getImageMap:function(){return Kp},toBoundaries:function(O,J,o,Z){var w=[];return wj(O,J,o,Z).forEach(function(a){var u=[];a.forEach(function(c){u.push(c.x,c.y)}),w.push(u)}),w},getCurrentKeyCodeMap:function(){return Ej},drawCenterImage:function(S,P,q,w,y,r,R,x){!y&&r&&r.isSelfViewEvent&&(y=r);var Y=Ne(P,y,r),H=Jf(P,y,r);vf(S,P,i(q-Y/2),i(w-H/2),Y,H,y,r,R,x)},drawStretchImage:function(z,_,R,Y,k,Z,M,p,J,h,G,o){!p&&J&&J.isSelfViewEvent&&(p=J);var y,s=Ne(_,p,J,Z),A=Jf(_,p,J,M);"uniform"===R?(y=u(Z/s,M/A),s*=y,A*=y,Y+=i((Z-s)/2),k+=i((M-A)/2),Z=s,M=A):"centerUniform"===R&&((s>Z||A>M)&&(y=u(Z/s,M/A),s*=y,A*=y),Y+=i((Z-s)/2),k+=i((M-A)/2),Z=s,M=A);var N=z.interactiveInfo;if(N){var v;if(v="center"===R?{x:Y+Z/2-s/2,y:k+M/2-A/2,width:s,height:A}:{x:Y,y:k,width:Z,height:M},N.rect){var X=N.compInfos,r=X.length;r&&(X[r-1].rect.image=_)}else N.rect=v}if("center"===R){var c=G!==!1&&(s>Z||A>M);c&&(z.save(),z.beginPath(),z.rect(Y,k,Z,M),z.clip()),vf(z,_,Y+Z/2-s/2,k+M/2-A/2,s,A,p,J,h,o),c&&z.restore()}else vf(z,_,Y,k,Z,M,p,J,h,o)},toCanvas:function(j,P,b,T,_,a,V,o,M){j=co(j,V),P=P||Ne(j,_),b=b||Jf(j,_);var H=Uq(),U=Kn(H);return o?(Xr(H,P,b,o),U.scale(o,o)):Xr(H,P,b,1),Dk(U,j,T,0,0,P,b,_,a,V,M),j&&j.clampToEdge&&(H.clampToEdge=j.clampToEdge),U.restore(),H},toGrayColor:function(b){if(!b)return b;var K=Cc(b),J=i(.299*K[0]+.587*K[1]+.114*K[2]);return"rgba("+J+","+J+","+J+","+K[3]/255+")"},createGradientImage:function(T,H,S,g){for(var y=["L",0,0,T,0,1,0,0,1,0,0],E=0,p=Math.min(H.length,S.length);p>E;E++)y.push(S[E],H[E]);var O=Y.Default.toCanvas({width:T,height:T,clampToEdge:!0,comps:[{type:"shape",rotation:g||0,points:[0,0,T,0,T,T,0,T],background:"#ffffff",gradientPack:y}]});return O},createElement:function(o,q,S,H){var $=d.createElement(o);return th($,q||R.widgetBorder,2),$.style.font=S?S:Go,H!=O&&($.value=H),j.onElementCreated&&j.onElementCreated($),$},containedInView:function(h,m){var B=mp(m).getBoundingClientRect();return Mg({x:B.left,y:B.top,width:B.width,height:B.height},up(h))},isIsolating:function(){return fe>0},setIsolating:function(o){o?fe++:fe--},getMSMap:function(){return pc},stringify:function(z,M,$){var h=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var g=JSON.stringify(z,function(P,f){return"function"==typeof f?"__ht__"+(f.__ht__||f.toString()):Sd(f)?Mc(f):f instanceof Y.List?"__ht__list"+(f.__ht__list||j.stringify(f._as)):f},M==O?2:M);return Date.prototype.toJSON=h,$&&(g="__ht__encode"+j.encodeString(g)),g},parse:function(r){return xh(r)?"__ht__encode"!=r.substr(0,12)||(r=j.decodeString(r.substr(12)),xh(r))?JSON.parse(r,function(C,_){if(xh(_))if("__ht__function"==_.substr(0,14)){var H=_.indexOf("{")+1,L=_.lastIndexOf("}"),p=_.indexOf("(")+1,t=_.indexOf(")");if(H&&L&&p&&t){var R=new Function(_.substring(p,t),_.substring(H,L));return R.__ht__=_.substr(6),R}}else{if("__ht__date"==_.substr(0,10))return new Date(I(_.substr(10)));if("__ht__list"===_.substr(0,10))return new zf(j.parse(_.substr(10)))}return _}):r:r},loadJS:function(b,I){I&&b.push(I);var r=b.shift();if(Hr(r))b=r.contact(b),j.loadJS(b);else if(er(r))r(),j.loadJS(b);else if(xh(r)){var P=d.createElement("script");P.onload=function(){j.loadJS(b)},P.setAttribute("src",r),d.getElementsByTagName("head")[0].appendChild(P)}else b.length&&j.loadJS(b)},extendClass:function(C,r){var Q=C.prototype;for(var x in r)pc[x]&&pc.hasOwnProperty(x)?pc[x](Q,r):Q[x]=r[x]},toRoundedCorner:function(){function C(h,x,J){h.x=x.x,h.y=x.e||J,h.z=x.y}var S=new sh,f=new sh,a=new sh,F=new sh;return function(s,e){var _,k=0;s.getPoints&&(k=s.getElevation(),s=s.getPoints()),_=s instanceof zf?s:new zf(s);var R=_.size();if(0>=e)return{points:_};var Y=new zf,B=new zf,i=_.get(0);C(S,i,k),Y.add(i),B.add(1);for(var x=1;R>x;x++)if(R>x+1){var j=_.get(x),J=_.get(x+1);C(f,j,k),C(a,J,k),F.subVectors(S,f).setLength(Math.min(.99*F.length(),e)).add(f),j.e!==n||i.e!==n?Y.add({x:F.x,y:F.z,e:F.y}):Y.add({x:F.x,y:F.z}),Y.add(j),F.subVectors(a,f).setLength(Math.min(.99*F.length(),e)).add(f),j.e!==n||J.e!==n?Y.add(i={x:F.x,y:F.z,e:F.y}):Y.add(i={x:F.x,y:F.z}),S.copy(F),B.addAll([2,3])}else Y.add(_.get(x)),B.add(2);return{points:Y,segments:B}}}(),toColorData:Cc,setCanvas:Xr,createDiv:Tj,createDisabledDiv:Wq,createView:Cd,createCanvas:Uq,appendChild:cr,initContext:Kn,checkLoadingImage:bh,translateAndScale:Qh,layout:dg,getPosition:Ke,drawPoints:Ri,drawRoundRect:zi,drawBorder:Vi,setFocus:eh,getter:An,setter:Qg,isEmptyObject:sn,cameraPriority:function(){var h={skybox:0,main:1e4,top:1e7};
return L.seal(L.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return h.skybox},set:function(j){if(j>=h.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");h.skybox=Number(j)}},main:{configurable:!1,enumerable:!1,get:function(){return h.main},set:function(K){if(K<=h.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(K>=h.top)throw new RangeError("Main camera must have lower priority than the top camera.");h.main=Number(K)}},top:{configurable:!1,enumerable:!1,get:function(){return h.top},set:function(C){if(C<=h.main)throw new RangeError("Top camera must have higher priority than the main camera.");h.top=Number(C)}}}))}()},!0),Dq(g,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var xd=j.disabledOpacity,se=j.toolTipDelay,Vd=j.devicePixelRatio,of=j.autoMakeVisible,Hp=j.autoHideScrollBar,Cp=j.imageGradient,Co=j.showToolTip,Km=j.hideToolTip,as=j.dashPattern,Ae=j.lineCap,gr=j.lineJoin,zl=j.labelColor,$j=j.labelSelectColor,Go=j.labelFont,Pq=j.widgetIndent,Fi=j.widgetRowHeight,Bd=j.widgetHeaderHeight,Xl=j.widgetTitleHeight,Td=j.scrollBarColor,qs=j.scrollBarSize,Mk=j.scrollBarTimeout,Vb=j.scrollBarMinLength,ah=j.scrollBarInteractiveSize,Ze=j.zoomIncrement,Sn=j.scrollZoomIncrement,qm=j.pinchZoomIncrement,Uh=j.zoomMax,Me=j.zoomMin,cq=j.createObject,zh=j.preventDefault,hm=j.setImage,co=j.getImage,Ak=j.isImageComplete,Qe=j.drawCenterImage,Dk=j.drawStretchImage,Xn=j.getId,Bj=j.callLater,nl=j.cancelLater,fq=j.sortFunc,qk=j.clone,qi=j.getClass,Zc=j.startAnim,Io=j.brighter,uo=j.darker,om=j.drawText,Pi=j.getTextSize,mg=j.isLeftButton,Bq=j.isMiddleButton,ue=j.isRightButton,Am=j.getTouchCount,vl=j.isDoubleClick,Hc=j.isShiftDown,_e=j.isCtrlDown,up=j.getClientPoint,Cn=j.getPagePoint,rs=j.getDistance,pr=j.unionPoint,ur=j.unionRect,Mg=j.containsPoint,xj=j.containsRect,Mo=j.intersectsRect,yh=j.intersection,Db=j.getWindowInfo,gn=j.grow,jn=j.getLogicalPoint,xl=j.getScreenPoint,Bi=j.startDragging,go=j.removeHTML,$l=j.createElement,ns=j.segmentResolution,Cs=j.shapeResolution,Yg=j.shapeSide,kk=j.def,ij=function(c,V,v){kk(F+"."+c,V,v)},No=function(H,L){H.childNodes.forEach(function(M){L(M),No(M,L)})};Dq(j,{toolTipLabelColor:zl,toolTipLabelFont:Go,toolTipBackground:R.toolTipBackground,toolTipShadowColor:Fg,debugTipLabelFont:Go,debugTipLabelColor:zl,debugTipBackground:R.toolTipBackground,drawBreakableText:Lc,setDevicePixelRatio:function(I){Vd=j.devicePixelRatio="number"==typeof I?I:m.devicePixelRatio,No(d.body,function(W){var w=W._ht;w&&w._canvas&&(Xr(w._canvas,w.getWidth(),w.getHeight()),w.redraw?w.redraw():w.iv())})}},!0);var Wg=1e-6,Qo="undefined"!=typeof Uint16Array?Uint16Array:Array,Ln="undefined"!=typeof Float32Array?Float32Array:Array,hi=function(I,t,R){var F=[I[0]-t[0],I[1]-t[1],I[2]-t[2]];if(R){var W=rs(F);W>0&&(F[0]/=W,F[1]/=W,F[2]/=W)}return F},qg=function(){var h="charCodeAt",Q=2*(2*wg.length+1);for(var n in m)if(n===F+dj[0]+(Qj.length+2)){var u=m[n];if(!u)break;for(var k=u.length,W=0;k>W;W++)if(u[W][h](0)===Q&&u[W+1]!=O&&u[W+1]===Qj[0]&&u[W+2]!=O&&u[W+2][h](0)===Q){for(var x=W+3;k>x;x++)if(u[x][h](0)===Q){if(0==u[x+1])for(var C,R=x+2;k>R;R++){if(u[R][h](0)===Q){0==u[R-1]&&C&&(ts=C.substr(0,C.length-1));break}C==O?C=u[R]:C+=u[R]}break}break}break}return function(A){return[-A[0],-A[1],-A[2]]}}(),Lg=function(R,s){return 3===R.length?R[0]*s[0]+R[1]*s[1]+R[2]*s[2]:R[0]*s[0]+R[1]*s[1]},Zk=function(){var y=new Ln(16);return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},Yc=Zk(),ii=function(T){var Q=new Ln(16);return Q[0]=T[0],Q[1]=T[1],Q[2]=T[2],Q[3]=T[3],Q[4]=T[4],Q[5]=T[5],Q[6]=T[6],Q[7]=T[7],Q[8]=T[8],Q[9]=T[9],Q[10]=T[10],Q[11]=T[11],Q[12]=T[12],Q[13]=T[13],Q[14]=T[14],Q[15]=T[15],Q},Do=function(A,I){return A[0]=I[0],A[1]=I[1],A[2]=I[2],A[3]=I[3],A[4]=I[4],A[5]=I[5],A[6]=I[6],A[7]=I[7],A[8]=I[8],A[9]=I[9],A[10]=I[10],A[11]=I[11],A[12]=I[12],A[13]=I[13],A[14]=I[14],A[15]=I[15],A},yn=function(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},$i=function(d,e){var n=d[0],a=d[1],w=d[2];return d[0]=e[0]*n+e[4]*a+e[8]*w+e[12],d[1]=e[1]*n+e[5]*a+e[9]*w+e[13],d[2]=e[2]*n+e[6]*a+e[10]*w+e[14],d},ci=function(x,P){var e=x[0],w=x[1],m=x[2],t=x[3];return x[0]=P[0]*e+P[4]*w+P[8]*m+P[12]*t,x[1]=P[1]*e+P[5]*w+P[9]*m+P[13]*t,x[2]=P[2]*e+P[6]*w+P[10]*m+P[14]*t,x[3]=P[3]*e+P[7]*w+P[11]*m+P[15]*t,x},Ib=function(){var L,e,G,k,U=Ai(vp[1]+vp[7]),_=Ai(vp[0]+vp[3]-vp[10]),u=Ai(vp[8]+2),K=function(){return e=G.charAt(L),L+=1,e},g=function(){var S="";if(e===u)for(;K();){if(e===u)return K(),S;S+=e}else K()},$=function(){for(;e&&" ">=e;)K()},n=function(){var N,W={};if(e===U){if(K(),$(),e===_)return K(),W;for(;e;){if(N=g(),$(),K(),W[N]=k(),$(),e===_)return K(),W;K(),$()}}};return k=function(){switch($(),e){case U:return n();default:return g()}},function(h){if(f={},h){var M;if(G=h,L=0,e=" ",M=k(),$(),!e)return M}}}(),Tf=function(X,v){if(v){var Z=N(v),K=c(v),P=X[4],U=X[5],I=X[6],t=X[7],u=X[8],L=X[9],$=X[10],E=X[11];X[4]=P*K+u*Z,X[5]=U*K+L*Z,X[6]=I*K+$*Z,X[7]=t*K+E*Z,X[8]=u*K-P*Z,X[9]=L*K-U*Z,X[10]=$*K-I*Z,X[11]=E*K-t*Z}},Lq=function(j,o){if(o){var G=N(o),v=c(o),w=j[0],Q=j[1],P=j[2],Z=j[3],x=j[8],W=j[9],Y=j[10],L=j[11];j[0]=w*v-x*G,j[1]=Q*v-W*G,j[2]=P*v-Y*G,j[3]=Z*v-L*G,j[8]=w*G+x*v,j[9]=Q*G+W*v,j[10]=P*G+Y*v,j[11]=Z*G+L*v}},Be=function(Y,D){if(D){var q=N(D),H=c(D),i=Y[0],u=Y[1],A=Y[2],W=Y[3],z=Y[4],T=Y[5],_=Y[6],h=Y[7];Y[0]=i*H+z*q,Y[1]=u*H+T*q,Y[2]=A*H+_*q,Y[3]=W*H+h*q,Y[4]=z*H-i*q,Y[5]=T*H-u*q,Y[6]=_*H-A*q,Y[7]=h*H-W*q}},mk=function(Y,Q,b){return Dn(O,b===!1?O:Y.getFinalScale3d(),Y.getFinalRotation3d(),Y.getRotationMode(),Y.p3(),O,Q)},Dn=function(L,$,t,U,s,X,J){return X||(X=Zk()),s&&Bs(X,s),gb(X,t,U),J&&cd(X,X,J),$&&Dc(X,$),L&&cd(X,X,L),X},ac=function(F,c,d){c=I(c),d=I(d);var X=this;X.g=F,X._84O=c,X._85O=d,X._70I=!0,X.F=0,X._83O=c+d,X.pen={x:0,y:0}},Lj="lineDashOffset",Ep="setLineDash",Wm=function(M){for(var U in M)1===U.length&&(Lj=M[U]);return U?1:0},rh=function(F,l,f){return te(l)?F:F[Ep]?(F[Ep](l),f&&(F.lineDashOffset=f),F):new ac(F,l[0],l.length>1?l[1]:l[0])},hr=function(g,C){!te(C)&&g[Ep]&&(g[Ep](Ul),g.lineDashOffset=0)};if(kk(ac,L,{_69I:6,moveTo:function(v,L){var M=this,g=M.pen;g.x=v,g.y=L,M.g.moveTo(v,L),M.start||(M.start={x:v,y:L})},lineTo:function(K,s){var g=this,k=g.pen,w=K-k.x,H=s-k.y,a=E(H,w),q=c(a),Y=N(a),L=g._23O(k.x,k.y,K,s),Q=g._85O,_=g._84O,i=g._83O;if(g.F){if(g.F>L)return g._70I?g._72I(K,s):g.moveTo(K,s),g.F-=L,void 0;if(g._70I?g._72I(k.x+q*g.F,k.y+Y*g.F):g.moveTo(k.x+q*g.F,k.y+Y*g.F),L-=g.F,g.F=0,g._70I=!g._70I,!L)return}var n=J(L/i);if(n){for(var M=q*_,B=Y*_,G=q*Q,U=Y*Q,e=0;n>e;e++)g._70I?(g._72I(k.x+M,k.y+B),g.moveTo(k.x+G,k.y+U)):(g.moveTo(k.x+G,k.y+U),g._72I(k.x+M,k.y+B));L-=i*n}g._70I?L>_?(g._72I(k.x+q*_,k.y+Y*_),g.moveTo(K,s),g.F=Q-(L-_),g._70I=!1):(g._72I(K,s),L===_?(g.F=0,g._70I=!g._70I):(g.F=_-L,g.moveTo(K,s))):L>Q?(g.moveTo(k.x+q*Q,k.y+Y*Q),g._72I(K,s),g.F=_-(L-Q),g._70I=!0):(g.moveTo(K,s),L===Q?(g.F=0,g._70I=!g._70I):g.F=Q-L)},quadraticCurveTo:function(C,U,j,A){var f,z=this,X=z.pen,Z=X.x,Y=X.y,g=z._22O(Z,Y,C,U,j,A),x=0,o=0,m=z._85O,I=z._84O;if(z.F){if(z.F>g)return z._70I?z._71I(C,U,j,A):z.moveTo(j,A),z.F-=g,void 0;if(x=z.F/g,f=z._20O(Z,Y,C,U,j,A,x),z._70I?z._71I(f[2],f[3],f[4],f[5]):z.moveTo(f[4],f[5]),z.F=0,z._70I=!z._70I,!g)return}var t=g-g*x,G=J(t/z._83O),M=I/g,F=m/g;if(G)for(var V=0;G>V;V++)z._70I?(o=x+M,f=z._21O(Z,Y,C,U,j,A,x,o),z._71I(f[2],f[3],f[4],f[5]),x=o,o=x+F,f=z._21O(Z,Y,C,U,j,A,x,o),z.moveTo(f[4],f[5])):(o=x+F,f=z._21O(Z,Y,C,U,j,A,x,o),z.moveTo(f[4],f[5]),x=o,o=x+M,f=z._21O(Z,Y,C,U,j,A,x,o),z._71I(f[2],f[3],f[4],f[5])),x=o;t=g-g*x,z._70I?t>I?(o=x+M,f=z._21O(Z,Y,C,U,j,A,x,o),z._71I(f[2],f[3],f[4],f[5]),z.moveTo(j,A),z.F=m-(t-I),z._70I=!1):(f=z._19O(Z,Y,C,U,j,A,x),z._71I(f[2],f[3],f[4],f[5]),g===I?(z.F=0,z._70I=!z._70I):(z.F=I-t,z.moveTo(j,A))):t>m?(o=x+F,f=z._21O(Z,Y,C,U,j,A,x,o),z.moveTo(f[4],f[5]),f=z._19O(Z,Y,C,U,j,A,o),z._71I(f[2],f[3],f[4],f[5]),z.F=I-(t-m),z._70I=!0):(z.moveTo(j,A),t===m?(z.F=0,z._70I=!z._70I):z.F=m-t)},bezierCurveTo:function(){var r=arguments;this.pen={x:r[4],y:r[5]},this.g.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])},arc:function(q,P,V,u,b,G){G||(u=-u,b=-b),yo(this,q,P,u,b-u,V,V,!1)},rect:function(W,h,q,I){var T=this;T.pen={x:W,y:h},T.moveTo(W,h),T.lineTo(W,h+I),T.lineTo(W+q,h+I),T.lineTo(W+q,h),T.lineTo(W,h)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(n,p,f,V){var $=f-n,M=V-p;return e($*$+M*M)},_22O:function(O,D,h,H,k,L,s){for(var C,c,P,K,E,d,v,r=0,N=O,U=D,o=s>0?s:this._69I,e=1;o>=e;e++)P=e/o,K=1-P,E=K*K,d=2*P*K,v=P*P,C=E*O+d*h+v*k,c=E*D+d*H+v*L,r+=this._23O(N,U,C,c),N=C,U=c;return r},_21O:function(P,R,X,v,F,I,V,K){var u=this;if(0===V)return u._20O(P,R,X,v,F,I,K);if(1===K)return u._19O(P,R,X,v,F,I,V);var g=u._20O(P,R,X,v,F,I,K);return g.push(V/K),u._19O.apply(u,g)},_20O:function(Z,U,N,n,e,c,h){if(1!==h){var r=N+(e-N)*h,w=n+(c-n)*h;N=Z+(N-Z)*h,n=U+(n-U)*h,e=N+(r-N)*h,c=n+(w-n)*h}return[Z,U,N,n,e,c]},_19O:function(Z,R,A,G,C,I,w){if(1!==w){var x=Z+(A-Z)*w,f=R+(G-R)*w;A+=(C-A)*w,G+=(I-G)*w,Z=x+(A-x)*w,R=f+(G-f)*w}return[Z,R,A,G,C,I]},_72I:function(C,Q){var F=this.pen;(C!==F.x||Q!==F.y)&&(F.x=C,F.y=Q,this.g.lineTo(C,Q))},_71I:function(t,z,g,B){var o=this.pen;(t!==g||z!==B||g!==o.x||B!==o.y)&&(o.x=g,o.y=B,this.g.quadraticCurveTo(t,z,g,B))}}),a&&Bk){var Or=Bk.toString();x=Or.indexOf(Uk.substr(0,2))>0&&Or.indexOf(nh+nh.substr(1,1))>1||Or.indexOf(Lh.substr(0,2)+Uk.substr(2,2)+dj[0]+Uk[4])>1?!0:!1}var Tl=O,Ab=O,em=j.checkLoadingCompType=function(D){Tl&&!D._72O&&(Ab||(Ab={}),Ab[D._72O=Xn()]=D)},Pj=function(a,A){if(A||(A=a),A&&(Tl||(Tl={}),!Tl[a])){var q=new de;if(Tl[A]={request:q,url:A},A=j.beforeLoadURL(A,a),A.data){var $=j.parse(A.data);Id(a,$),j.handleCompTypeLoaded(a,$)}else{q.onload=function(){if(200===this.status||0===this.status){var Z=j.parse(q.getResponseText());Id(a,Z),j.handleCompTypeLoaded(a,Z)}else Id(a,O)},q.onerror=function(){Id(a,O)};var m={};m.url=encodeURI(A),m.sync=!1,q.send(m)}}},Id=function(I,x){if(hb[I]=x,delete Tl[I],sn(Tl)&&(Tl=O,Ab)){for(var d in Ab){var s=Ab[d];s.invalidateAll&&s.invalidateAll(n,"compTypeLoaded",I),s.redraw&&s.redraw(),s.iv(),delete s._72O}Ab=O}if(x&&Ab)for(var d in Ab){var s=Ab[d];s.invalidateAll&&s.invalidateAll(n,"compTypeLoading",I),s.redraw&&s.redraw(),s.iv()}},bk=R.chart,$n="",so=!0,oj=j.compStack=[],io=/^style@/,hq=/^attr@/,ai=/^field@/,Jo={x:.5,y:.5},pi=function(){so=!0},rm=function(){return so},Ne=function(g,J,h,K){if(!g)return 0;if(lc(g.fitSize,J,h)&&K)return K;var R=lc(g.width,J,h);return null==R?20:R},Jf=function(x,N,v,S){if(!x)return 0;if(lc(x.fitSize,N,v)&&S)return S;var L=lc(x.height,N,v);return null==L?20:L},lc=function(b,v,t){if(!b||!b.func)return b;var k,c=b.func,x=b.value;return k=er(c)?t&&t.vectorDataBindingDisabled&&!b.isSafeFunc?x:c(v,t):v instanceof Jh||(Y.ui?v instanceof Y.ui.View:0)?hq.test(c)?v.a($n+c.slice(5)):io.test(c)?v.s($n+c.slice(6)):ai.test(c)?v[c.slice(6)]:v[c]?v[c](t):x:x,x!==n&&k==O?x:k},vf=j.drawImage=function(){var d,$,q,e,Q,R,V=function($,W){$.getValue&&$.getValue.compType===W||($.getValue=function(X){var p=M($,X);if(p===n&&W.properties){var e=W.properties[X];e&&(p=e.defaultValue)}return p},$.getColor=function(s){return E($.getValue(s))},$.getValue.compType=W)},M=function(D,K,u){var z,i=!1;if(D.prefix&&$ instanceof Jh){var h=$.a($n+K);h!==n&&(i=!0,z=h)}return z===n&&(z=D[K]),z&&z.func&&(i=!0,z=lc(z,$,q)),u&&(z=u(z),i||(D[K]=z)),z},E=function(y,l){var c;if(c=l?M(y,l):y,d&&d.compGray&&c)return j.toGrayColor(c);if(Q&&c){if("override"===R)return Q;if("override_rgb"===R){var s=Yr(Q);return c=Cc(c),"rgba("+i(255*s[0])+","+i(255*s[1])+","+i(255*s[2])+","+c[3]/255+")"}if("override_a"===R){var s=Yr(Q);return c=Cc(c),"rgba("+c[0]+","+c[1]+","+c[2]+","+s[3]+")"}var s=Yr(Q);return c=Cc(c),"rgba("+i(c[0]*s[0])+","+i(c[1]*s[1])+","+i(c[2]*s[2])+","+c[3]/255*s[3]+")"}return c},x=function(b){if(Hr(b)){for(var O=new zf,k=b.length,R=0;k>R;R+=2)O.add({x:b[R],y:b[R+1]});b=O}return b},S=function(C){var e=M(C,"anchorX"),r=M(C,"anchorY");if(e!==n||r!==n)return{x:e===n?Jo.x:e,y:r===n?Jo.y:r};var K=M(C,"type"),c=M(C,"name");if("image"!==K||!c)return Jo;var L=co(c);return L&&L.anchorX!==n&&L.anchorY!==n?{x:L.anchorX,y:L.anchorY}:Jo},p=function(C,O){var E=M(C,Dl),F=S(C);if(Hr(E)){var o=E.length,k=M(C,"relative"),J=O.width,l=O.height;if(4===o)E={x:E[0],y:E[1],width:E[2],height:E[3]},k&&(E.x*=J,E.y*=l,E.width*=J,E.height*=l);else if(3===o){var e=E[0];E={width:E[1],height:E[2]},k&&(E.width*=J,E.height*=l),"object"==typeof e?e.length&&(e={x:e[0],y:e[1]}):e=Ke(e,O,E),E.x=e.x-E.width*F.x,E.y=e.y-E.height*F.y}E.x+=M(C,"offsetX")||0,E.y+=M(C,"offsetY")||0,!k&&O.fitSize&&(E=w(C,E,O))}return E},w=function(u,o,y){if(o){var H,t,_,C={x:o.x,y:o.y,width:o.width,height:o.height},n=S(u),J=M(u,"layoutH"),s=M(u,"layoutV"),D=1,L=1,r=0,q=0,h=1,p=1;switch(J){case"left":break;case"right":C.x+=y.width-y.rw;break;case"center":C.x+=.5*(y.width-y.rw);break;case"scale":case"leftright":default:H=M(u,Sk)||0,H&&(r=Math.abs(q=Math.sin(H)),h=Math.abs(p=Math.cos(H))),"leftright"!==J?(D+=h*(y.widthScale-1),L+=r*(y.widthScale-1)):(D+=C.width?h*(y.width-y.rw)/C.width:0,L+=C.height?r*(y.width-y.rw)/C.height:0,t=-Math.min(-n.x*p+n.y*q,-n.x*p-(1-n.y)*q,(1-n.x)*p+n.y*q,(1-n.x)*p-(1-n.y)*q))}switch(s){case"top":break;case"bottom":C.y+=y.height-y.rh;break;case"center":C.y+=.5*(y.height-y.rh);break;case"scale":case"topbottom":default:H==O&&(H=M(u,Sk),H&&(r=Math.abs(q=Math.sin(H)),h=Math.abs(p=Math.cos(H)))),"topbottom"!==s?(D+=r*(y.heightScale-1),L+=h*(y.heightScale-1)):(D+=C.width?r*(y.height-y.rh)/C.width:0,L+=C.height?h*(y.height-y.rh)/C.height:0,_=-Math.min(-n.x*q-n.y*p,-n.x*q+(1-n.y)*p,(1-n.x)*q-n.y*p,(1-n.x)*q+(1-n.y)*p))}return(1!==D||1!==L)&&("scale"!==J&&J?"leftright"===J&&(C.x+=C.width*(1-D)*n.x+t*(y.width-y.rw)):C.x+=C.x*(y.widthScale-1)+n.x*C.width*(y.widthScale-D),"scale"!==s&&s?"topbottom"===s&&(C.y+=C.height*(1-L)*n.y+_*(y.height-y.rh)):C.y+=C.y*(y.heightScale-1)+n.y*C.height*(y.heightScale-L),C.width*=D,C.height*=L),C.width<0&&(C.width=0),C.height<0&&(C.height=0),C}},L=function(r){return Hr(r)?new zf(r):r},a=function(L,C,p,f,m,P,y){var $=d.interactiveInfo,o=L.transform;if(o)return d.save(),d.setTransform(o.a,o.b,o.c,o.d,o.tx,o.ty),$&&$.compInfos.push({comp:L,rect:C,matrix:o.clone(),prefix:$n,refRect:$.refRect}),!0;m===n&&(m=1),P===n&&(P=1);var S=M(L,"clipPercentage"),b=Xd(p,C);if(b&&!f&&1===m&&1===P&&!(1>S))return $&&$.compInfos.push({comp:L,rect:C,matrix:$.matrix.clone(),prefix:$n,refRect:$.refRect}),!1;y=y||Jo;var l=C.x+C.width*y.x,T=C.y+C.height*y.y,e=p.x+p.width*y.x,j=p.y+p.height*y.y,Q=p.width?m*(C.width/p.width):1,F=p.height?P*(C.height/p.height):1;if(d.save(),$&&($.matrix.appendTranslate(l,T).appendRotate(f).appendScale(Q,F).appendTranslate(-e,-j),$.compInfos.push({comp:L,rect:C,matrix:$.matrix.clone(),prefix:$n,refRect:$.refRect})),cl(d,l,T),gc(d,f||0),eb(d,Q,F),cl(d,-e,-j),1>S){0>S&&(S=0);var c=Ji(p,M(L,"clipDirection"),S),z=M(L,"clipColor");return z||(d.beginPath(),d.rect(c.x,c.y,c.width,c.height),d.clip()),c}return!0},k=function(q,l){if(!(q instanceof Boolean)){var B=M(l,"clipColor");if(B)d.globalCompositeOperation="multiply",d.fillStyle=B,d.clip(),d.fillRect(q.x,q.y,q.width,q.height);else{var m=M(l,"clipGradient");if(m!=O&&m>0){d.globalCompositeOperation="destination-out";var Y=bp(d,q,M(l,"clipDirection"),m);d.fillStyle=Y.gradient;var A=Y.rect;d.clip(),d.fillRect(A.x,A.y,A.width,A.height)}}}d.restore()},z=function(Q,s,r){var W=M(Q,"path"),C=M(Q,Sk),c=M(Q,"scaleX"),w=M(Q,"scaleY"),X=S(Q),K=O,_=rr(null,W);if(r||(r=Q.unionRect,r||(r=pr(_),Q.path.func||(Q.unionRect=r)),K=r),r){K||(K=Q.unionRect,K||(K=pr(_),Q.path.func||(Q.unionRect=K)));var y=a(Q,r,K,C,c,w,X),R=M(Q,"borderPattern"),m=rh(d,R),o=E(Q,"background"),L=E(Q,"borderColor"),N=M(Q,"borderWidth"),p=M(Q,"gradient"),G=E(Q,"gradientColor"),n=M(Q,"border3d"),H=E(Q,"border3dColor"),x=M(Q,"border3dAccuracy"),h=d.lineJoin,B=d.lineCap;d.lineJoin=M(Q,"borderJoin")||gr,d.lineCap=M(Q,"borderCap")||Ae,o?(mi(d,o,p,G,K),rr(d,W),d.fill(),m!==d&&rr(d,W)):rr(d,W);var D=M(Q,"borderWidthAbsolute");if(D&&(d.save(),d.setTransform(1,0,0,1,0,0)),N&&L&&(d.lineWidth=N,d.strokeStyle=L,d.stroke(),n&&kn(d,L,H,N,e,x)),hr(d,R),M(Q,"dash")){var v=M(Q,"dashWidth")||N;if(v>0){R=M(Q,"dashPattern")||as;var m=rh(d,R,M(Q,"dashOffset")),F=E(Q,"dashColor")||E(Mh);m!==d&&rr(d,W),d.strokeStyle=F,d.lineWidth=v,d.stroke(),M(Q,"dash3d")&&kn(d,F,E(Q,"dash3dColor"),v,e,M(Q,"dash3dAccuracy")),hr(d,R)}}D&&d.restore(),s===Dl&&ri(d,o,M(Q,"depth"),K),d.lineJoin=h,d.lineCap=B,y&&k(y,Q)}},h=function(s,F,H,I){var B=M(s,Nj,x),u=M(s,Sk),m=S(s);if(B&&I.fitSize){var l=new zf,G=pr(B),A=w(s,G,I),f=G.x+m.x*G.width,o=G.y+m.y*G.height,T=A.x+m.x*A.width,j=A.y+m.y*A.height,p=G.width?A.width/G.width:1,D=G.height?A.height/G.height:1;B.each(function(J){l.add({x:T+(J.x-f)*p,y:j+(J.y-o)*D})}),B=l,s.unionRect=null}var i=M(s,"scaleX"),N=M(s,"scaleY"),W=F===ml,Y=O;if(!H&&W&&(H=s.unionRect,H||(H=pr(B),s.points.func||(s.unionRect=H)),Y=H),H){W?Y||(Y=s.unionRect,Y||(Y=pr(B),s.points.func||(s.unionRect=Y))):Y=H;var U,V,y,K,Z=a(s,H,Y,u,i,N,m),c=M(s,"borderPattern"),_=rh(d,c),t=E(s,"background"),b=co(M(s,"repeatImage"),Q,R),J=M(s,"gradientPack"),z=E(s,"borderColor"),r=M(s,"borderWidth"),P=M(s,"segments",L),n=M(s,"gradient"),C=E(s,"gradientColor"),X=M(s,"border3d"),h=E(s,"border3dColor"),g=M(s,"border3dAccuracy"),v=M(s,"closePath"),Bs=M(s,"fillRule")||"nonzero",xi=d.lineJoin,Di=d.lineCap;if(d.lineJoin=M(s,"borderJoin")||gr,d.lineCap=M(s,"borderCap")||Ae,W)if(t||b||J){var nk,Ep=M(s,"fillClipPercentage"),Nq=M(s,"fillClipColor");if(1>Ep&&(0>Ep&&(Ep=0),nk=Ji(Y,M(s,"fillClipDirection"),Ep),d.save(),Nq||(d.beginPath(),d.rect(nk.x,nk.y,nk.width,nk.height),d.clip())),Ri(d,B,P,v),J?oh(d,J):b?Zo(d,b,Q,R,$,q):mi(d,t,n,C,Y),d.fill(Bs),1>Ep){if(Nq)d.globalCompositeOperation="multiply",d.fillStyle=Nq,d.clip(),d.fillRect(nk.x,nk.y,nk.width,nk.height);else{var bj=M(s,"fillClipGradient");if(bj!=O&&bj>0){d.globalCompositeOperation="destination-out";var Pj=bp(d,nk,M(s,"fillClipDirection"),bj);d.fillStyle=Pj.gradient;var qr=Pj.rect;d.clip(),d.fillRect(qr.x,qr.y,qr.width,qr.height)}}d.restore()}J&&d.restore(),_!==d&&Ri(_,B,P,v)}else Ri(_,B,P,v);else if("roundRect"===F?U=M(s,"cornerRadius"):"polygon"===F?U=M(s,"polygonSide"):"arc"===F&&(U=M(s,"arcFrom"),V=M(s,"arcTo"),y=M(s,"arcClose"),K=M(s,"arcOval")),t||b||J){var nk,Ep=M(s,"fillClipPercentage"),Nq=M(s,"fillClipColor");if(1>Ep&&(0>Ep&&(Ep=0),nk=Ji(Y,M(s,"fillClipDirection"),Ep),d.save(),Nq||(d.beginPath(),d.rect(nk.x,nk.y,nk.width,nk.height),d.clip())),Ql(d,F,Y,U,V,y,K),J?oh(d,J):b?Zo(d,b,Q,R,$,q):mi(d,t,n,C,Y),d.fill(Bs),1>Ep){if(Nq)d.globalCompositeOperation="multiply",d.fillStyle=Nq,d.clip(),d.fillRect(nk.x,nk.y,nk.width,nk.height);else{var bj=M(s,"fillClipGradient");if(bj!=O&&bj>0){d.globalCompositeOperation="destination-out";var Pj=bp(d,nk,M(s,"fillClipDirection"),bj);d.fillStyle=Pj.gradient;var qr=Pj.rect;d.clip(),d.fillRect(qr.x,qr.y,qr.width,qr.height)}}d.restore()}J&&d.restore(),d!==_&&Ql(_,F,Y,U,V,y,K)}else Ql(_,F,Y,U,V,y,K);var Tb=M(s,"borderWidthAbsolute");if(Tb&&(d.save(),d.setTransform(1,0,0,1,0,0)),r&&z&&(d.lineWidth=r,d.strokeStyle=z,d.stroke(),X&&kn(d,z,h,r,e,g)),hr(d,c),M(s,"dash")){var Oh=M(s,"dashWidth")||r;if(Oh>0){c=M(s,"dashPattern")||as;var _=rh(d,c,M(s,"dashOffset")),yg=E(s,"dashColor")||E(Mh);_!==d&&(W?Ri(_,B,P,v):Ql(_,F,Y,U,V,y,K)),d.strokeStyle=yg,d.lineWidth=Oh,d.stroke(),M(s,"dash3d")&&kn(d,yg,E(s,"dash3dColor"),Oh,e,M(s,"dash3dAccuracy")),hr(d,c)}}Tb&&d.restore(),F===Dl&&ri(d,t,M(s,"depth"),Y),d.lineJoin=xi,d.lineCap=Di,Z&&k(Z,s)}},f=function(m,z){var i=Q||M(m,ib),u=R||M(m,"blendMode"),Z=M(m,"name"),S=co(Z,i,u);S?Dk(d,S,M(m,"stretch"),z.x,z.y,z.width,z.height,$,q,i,null,u):so=!1},v=function(j,N){var q=M(j,"text");q!=O&&om(d,q,M(j,"font"),E(j,ib),N.x,N.y,N.width,N.height,M(j,"align"),M(j,"vAlign"))},o=function(Y,f){Vi(d,E(Y,ib),f.x,f.y,f.width,f.height,M(Y,"width"))},r=function(w,T){var v=M(w,bg),R=0;if(v&&(v.forEach(function($){R+=$}),R>0)){for(var t=M(w,"colors")||bk,H=M(w,"startAngle")||0,r=M(w,"hollow"),V=M(w,Tk),e=M(w,Vk),E=M(w,Br),a=V?new zf:O,q=T.x,o=T.y,_=T.width,Q=T.height,S=q+_/2,W=o+Q/2,m=u(_,Q)/2,p=0,h=0;h<v.length;h++){var K=v[h],B=A*K/R,l=H+B;if(d.fillStyle=t[p++],p===t.length&&(p=0),d.beginPath(),r){var f=S+c(H)*m/2,n=W+N(H)*m/2,k=S+c(l)*m,L=W+N(l)*m;d.moveTo(f,n),d.arc(S,W,m/2,H,l,!1),d.lineTo(k,L),d.arc(S,W,m,l,H,!0)}else d.moveTo(S,W),d.arc(S,W,m,l,H,!0);a&&(B=(H+l)/2,a.add({text:er(V)?V(K,h,R,$):K,x:S+.75*c(B)*m,y:W+.75*N(B)*m})),d.closePath(),d.fill(),H=l}a&&a.each(function(x){om(d,x.text,e,E,x.x,x.y,0,0,vr)})}},I=function(Z,j){var y=M(Z,Oe);if(y&&y.length>0){var I=y.length,C=M(Z,Tk),F=M(Z,Vk),N=M(Z,Br),J=C?new zf:O,K=M(Z,"minValue")||0,c=M(Z,"maxValue");if(c==O&&(c=0,y.forEach(function(G){M(G,bg).forEach(function(n){c=P(c,n)})})),K===c)return;for(var b=j.height/(c-K),T=j.y+c*b,f=M(y[0],bg).length,u=j.width/(3*f+1),L=2*u/I,G=0,v=0;I>v;v++)for(var o=y[v],U=M(o,ib),Y=M(o,"colors"),W=M(o,bg),m=0;f>m;m++){Y?d.fillStyle=Y[m]:U?d.fillStyle=U:(d.fillStyle=bk[G++],G===bk.length&&(G=0));var a=W[m],B=a*b,S=j.x+(1+3*m)*u+v*L;if(hd(d,S,T-B,L,B),J){var _=er(C)?C(a,m,o,$):a,t=Pi(F,_).height;J.add({x:S,y:T-B-t,width:L,height:t,text:_})}}J&&J.each(function(s){om(d,s.text,F,N,s.x,s.y,s.width,s.height,vr)})}},D=function(Q,I){var x=M(Q,Oe);if(x&&x.length>0){var E=x.length,N=M(x[0],bg).length,_=I.width/(3*N+1),n=0,V=M(Q,"maxValue"),j=M(Q,Tk),f=M(Q,Vk),r=M(Q,Br),W=j?new zf:O;if(V==O){V=0;for(var G=0;N>G;G++){for(var B=0,v=0;E>v;v++)B+=M(x[v],bg)[G];V=P(V,B)}}if(V>0){for(var G=0;N>G;G++)for(var z=I.y+I.height,v=0;E>v;v++){var J=x[v],s=M(J,ib),y=M(J,bg)[G],c=y/V*I.height;s?d.fillStyle=s:(d.fillStyle=bk[n++],n===bk.length&&(n=0)),z-=c;var t={x:I.x+(1+3*G)*_,y:z,width:2*_,height:c};hd(d,t.x,t.y,t.width,t.height),W&&(t.text=er(j)?j(y,G,J,$):y,W.add(t))}W&&W.each(function(M){om(d,M.text,f,r,M.x,M.y,M.width,M.height,vr)})}}},H=function(b,Q){var L=M(b,Oe);if(L&&L.length>0){for(var K=L.length,v=M(L[0],bg).length,I=Q.width/(3*v+1),u=0,H=M(b,Tk),p=M(b,Vk),D=M(b,Br),w=H?new zf:O,J=0;v>J;J++){for(var k=0,B=0;K>B;B++)k+=M(L[B],bg)[J];if(k>0){var G=Q.y+Q.height;for(B=0;K>B;B++){var N=L[B],t=M(N,ib),X=M(N,bg)[J],V=X/k*Q.height;t?d.fillStyle=t:(d.fillStyle=bk[u++],u===bk.length&&(u=0)),G-=V;var s={x:Q.x+(1+3*J)*I,y:G,width:2*I,height:V};hd(d,s.x,s.y,s.width,s.height),w&&(s.text=er(H)?H(X,J,N,$):X,w.add(s))}}}w&&w.each(function(R){om(d,R.text,p,D,R.x,R.y,R.width,R.height,vr)})}},C=function(V,H){var k=M(V,Oe);if(k&&k.length>0){var g=k.length,b=M(V,"minValue")||0,j=M(V,"maxValue");if(j==O&&(j=0,k.forEach(function(C){M(C,bg).forEach(function(V){j=P(j,V)})})),b===j)return;for(var I=H.height/(j-b),B=H.y+j*I,N=M(k[0],bg).length,a=H.width/(3*N+1),T=0,h=M(V,"lineWidth")||2,z=M(V,"line3d"),S=M(V,"linePoint"),J=M(V,Tk),G=M(V,Vk),s=M(V,Br),L=0;g>L;L++){var U=k[L],m=M(U,ib),q=M(U,bg);m?d.strokeStyle=m:(m=d.strokeStyle=bk[T++],T===bk.length&&(T=0)),d.beginPath();for(var X=0;N>X;X++){var l=H.x+(2+3*X)*a,Q=B-q[X]*I;0===X?d.moveTo(l,Q):d.lineTo(l,Q)}if(d.lineWidth=h,d.stroke(),z&&kn(d,m,O,h,e),S||J){var u,W=h/2+2;for(X=0;N>X;X++){var E=q[X];if(l=H.x+(2+3*X)*a,Q=B-E*I,er(S)?S(d,l,Q,m,X,U,$):S&&(d.fillStyle=m,d.beginPath(),d.arc(l,Q,W,0,A,!0),d.fill()),er(J)?u=J(E,X,U,$):J&&(u=E),u){var F=Pi(G,u).height,v=d.shadowBlur;if(v){var x=d.shadowOffsetX,i=d.shadowOffsetY,r=d.shadowColor;d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=0,d.shadowColor=O}om(d,u,G,s,l,Q-F-W+2,0,F,vr),v&&(d.shadowOffsetX=x,d.shadowOffsetY=i,d.shadowBlur=v,d.shadowColor=r)}}}}}},Z=function(H){d=H[0],$=H[1],q=H[2],e=H[3],Q=H[4],R=H[5]},G=function(){return[d,$,q,e,Q,R]},b=function(I,N){var t;q&&q.getDrawableState?t=q.getDrawableState($):q&&q.getState?t=q.getState($):(t=$ instanceof Jh?$.s(jk):null,(t===n||null===t)&&(t=M(I,jk)));var K=M(N,jk);return K!==n&&null!==K&&K!==t?!1:M(N,Hn)},K={border:o,image:f,text:v,pieChart:r,columnChart:I,stackedColumnChart:D,percentageColumnChart:H,lineChart:C};return function(r,Y,P,I,H,F,_,C,g,X){if(Y&&H&&F){var A=G();d=r,$=_,q=C,!$&&q&&q.isSelfViewEvent&&($=q),e=q?q._zoom?q._zoom:1:1,Q=g,R=X;var W=H,B=F;if(ms()){var s,J,D,y,t;0===d[vs]?ms[0]&&(s=!0):s=!0,d.texureImage2D?ms[1]&&(J=!0):J=!0,d.texureImage3D?ms[2]&&(D=!0):D=!0,d.drawDNDState?ms[3]&&(t=!0):t=!0,zj.widget[0]?ms[4]&&(y=!0):y=!0,s&&J&&D&&y&&t&&(W=P,B=I)}if(Y.tagName)return xh(ts)&&!m[ts]||d.drawImage(Y,W,B,H,F),Z(A),void 0;if(M(Y,"visible")===!1)return Z(A),void 0;Q||(Q=lc(Y.color,$,q)),X||(R=lc(Y.blendMode,$,q)),xh(ts)&&!m[ts]&&(H=W,F=B);var N=Ne(Y,$,q,H),v=Jf(Y,$,q,F),w={x:0,y:0,width:N,height:v,fitSize:M(Y,"fitSize")},i=M(Y,"clip"),f=M(Y,"opacity");if(w.fitSize){var u=w.rw=lc(Y.width,$,q)||20;w.widthScale=N/u;var c=w.rh=lc(Y.height,$,q)||20;w.heightScale=v/c}if(d.save(),d.interactiveInfo){var T=d.interactiveInfo.matrix,o=T.clone();T.appendTranslate(W,B).appendScale(H/N,F/v),d.interactiveInfo.refRect=w}cl(d,W,B),(N!==H||v!==F)&&d.scale(H/N,F/v),i&&(er(i)?i(d,N,v,$,q,Y):(d.beginPath(),d.rect(0,0,N,v),d.clip())),f!=O&&(d.globalAlpha*=f),M(Y,"comps").forEach(function(v){if(v.prefix){var g=$n,U=lc(v.prefix,$,q);U&&($n=$n+U+".")}if(b(Y,v)===!1)return v.prefix&&($n=g),void 0;if(oj.splice(0,0,v),d.interactiveInfo)var o=d.interactiveInfo.matrix.clone();var l=M(v,"opacity"),F=M(v,"shadow"),J=M(v,"type"),H=M(v,"refRect")||w,m=p(v,H);if(l!=O){var A=d.globalAlpha;d.globalAlpha*=l}if(F){var Q=d.shadowOffsetX,T=d.shadowOffsetY,_=d.shadowBlur,r=d.shadowColor,Z=M(v,"shadowOffsetX"),t=M(v,"shadowOffsetY"),c=M(v,"shadowBlur"),D=E(v,"shadowColor");d.shadowOffsetX=(Z==O?3:Z)*e,d.shadowOffsetY=(t==O?3:t)*e,d.shadowBlur=(c==O?6:c)*e,d.shadowColor=D||E(Tr)}if("save"===J)d.save();else if("endClip"===J||"restore"===J)d.restore();else if("clip"===J)d.save(),Ri(d,M(v,"points",x),M(v,"segments",L),!0),d.clip();else if(id[J])m=m||{x:0,y:0,width:H.width,height:H.height},h(v,J,m,H);else if(J===ml)h(v,J,m,H);else if("SVGPath"===J)z(v,J,m);else{m=m||{x:0,y:0,width:H.width,height:H.height};var N=M(v,Sk),W=M(v,"scaleX"),y=M(v,"scaleY"),X=S(v),f=a(v,m,m,N,W,y,X);if(er(J))V(v,J),j.drawCompType(J,d,m,v,$,q);else if(j.getCompType(J)){var P=j.getCompType(J),B=P.func||P;V(v,P),j.drawCompType(B,d,m,v,$,q)}else K[J]?K[J](v,m):j.getCompType(J)===n&&Gm.test(J)&&Pj(J);f&&k(f,v)}F&&(d.shadowOffsetX=Q,d.shadowOffsetY=T,d.shadowBlur=_,d.shadowColor=r),l!=O&&(d.globalAlpha=A),d.interactiveInfo&&(d.interactiveInfo.matrix=o),v.prefix&&($n=g),oj.splice(0,1)}),d.interactiveInfo&&(d.interactiveInfo.matrix=o),d.restore(),Z(A)}}}();j.getCurrentComp=function(){return oj[0]},j.getParentComp=function(){return oj[1]},j.getInternal=function(){return{isEnter:Vm,isEsc:Le,isSpace:ym,isLeft:Fk,isUp:fb,isRight:tc,isDown:dc,addMethod:Dq,superCall:Ck,toPointsArray:wj,translateAndScale:Qh,appendArray:zr,createWorldMatrix:Dn,vec3TransformMat4:$i,setCanvas:Xr,createDiv:Tj,createView:Cd,createCanvas:Uq,createImage:Gg,initContext:Kn,layout:dg,fillRect:hd,Mat:eg,drawBorder:Vi,isString:xh,setBorder:th,getPropertyValue:Bm,setPropertyValue:fr,drawVerticalLine:dq,draw3DRect:ri,getPinchDist:Im,isSameRect:Xd,getPosition:Ke,intersectionLineRect:lm,getNodeRect:Hq,getEdgeAgentPosition:xn,getEdgeHostPosition:Ui,getImageWidth:Ne,getImageHeight:Jf,initItemElement:Hb,drawPoints:Ri,createG2:rh,closePopup:Qm,isH:Qc,createAnim:vo,createNormalMatrix:Vo,toColorArray:Yr,createNormals:Cg,toFloatArray:Oh,glMV:ok,glPop:Ih,batchShape:nf,createNodeMatrix:mk,getShapeModel:Nb,getFaceInfo:dk,transformAppend:Uf,drawFaceInfo:yi,to3dPointsArray:We,setGLDebugMode:function(t){Dg=t},cube:function(){return{vs:Ue,is:Il,uv:Xg}},ui:function(){return{DataUI:Pr,NodeUI:Re,EdgeUI:jj,GroupUI:_j,ShapeUI:gg,GridUI:ln,Data3dUI:jc,Node3dUI:Uj,Shape3dUI:wi}},getInternalVersion:function(){return"U2FsdGVkX19fll7Qir7fzbB6Y6ymB2CtydCR+7ysSsI="},getDragger:function(){return _q},addMSMap:function(K){Dq(pc,K)},k:W,addEventListener:q,removeEventListener:X}},function(j){function s($,b){$!=O&&(b==O&&yb!=typeof $?this._54O($,256):this._54O($,b))}function d(){return new s(O)}function L(l,b,x,H,n,s){for(;--s>=0;){var T=b*this[l++]+x[H]+n;n=J(T/67108864),x[H++]=67108863&T}return n}function Z(g,o,P,q,k,i){for(var S=32767&o,M=o>>15;--i>=0;){var d=32767&this[g],f=this[g++]>>15,Y=M*d+f*S;d=S*d+((32767&Y)<<15)+P[q]+(1073741823&k),k=(d>>>30)+(Y>>>15)+M*f+(k>>>30),P[q++]=1073741823&d}return k}function T(t,w,i,C,O,N){for(var s=16383&w,R=w>>14;--N>=0;){var L=16383&this[t],W=this[t++]>>14,n=R*L+W*s;L=s*L+((16383&n)<<14)+i[C]+O,O=(L>>28)+(n>>14)+R*W,i[C++]=268435455&L}return O}function f(f){return bd.charAt(f)}function V(w,p){var u=_o[w.charCodeAt(p)];return u==O?-1:u}function q(v){for(var A=this.t-1;A>=0;--A)v[A]=this[A];v.t=this.t,v.s=this.s}function g(I){this.t=1,this.s=0>I?-1:0,I>0?this[0]=I:-1>I?this[0]=I+this.DV:this.t=0}function y(a){var K=d();return K._58O(a),K}function M(K,h){var H,w=this;if(16==h)H=4;else if(8==h)H=3;else if(256==h)H=8;else if(2==h)H=1;else if(32==h)H=5;else{if(4!=h)return w.fromRadix(K,h),void 0;H=2}w.t=0,w.s=0;for(var e=K.length,u=!1,O=0;--e>=0;){var F=8==H?255&K[e]:V(K,e);0>F?"-"==K.charAt(e)&&(u=!0):(u=!1,0==O?w[w.t++]=F:O+H>w.DB?(w[w.t-1]|=(F&(1<<w.DB-O)-1)<<O,w[w.t++]=F>>w.DB-O):w[w.t-1]|=F<<O,O+=H,O>=w.DB&&(O-=w.DB))}8==H&&0!=(128&K[0])&&(w.s=-1,O>0&&(w[w.t-1]|=(1<<w.DB-O)-1<<O)),w._57O(),u&&s.ZERO._78O(w,w)}function t(){for(var Y=this,T=Y.s&Y.DM;Y.t>0&&Y[Y.t-1]==T;)--Y.t}function X(w){var Z=this;if(Z.s<0)return"-"+Z._85O()[Tr](w);var e;if(16==w)e=4;else if(8==w)e=3;else if(2==w)e=1;else if(32==w)e=5;else{if(4!=w)return Z.toRadix(w);e=2}var C,F=(1<<e)-1,R=!1,I="",z=Z.t,L=Z.DB-z*Z.DB%e;if(z-->0)for(L<Z.DB&&(C=Z[z]>>L)>0&&(R=!0,I=f(C));z>=0;)e>L?(C=(Z[z]&(1<<L)-1)<<e-L,C|=Z[--z]>>(L+=Z.DB-e)):(C=Z[z]>>(L-=e)&F,0>=L&&(L+=Z.DB,--z)),C>0&&(R=!0),R&&(I+=f(C));return R?I:"0"}function o(){var i=d();return s.ZERO._78O(this,i),i}function E(){return this.s<0?this._85O():this}function Y(W){var l=this,k=l.s-W.s;if(0!=k)return k;var T=l.t;if(k=T-W.t,0!=k)return l.s<0?-k:k;for(;--T>=0;)if(0!=(k=l[T]-W[T]))return k;return 0}function R($){var r,w=1;return 0!=(r=$>>>16)&&($=r,w+=16),0!=(r=$>>8)&&($=r,w+=8),0!=(r=$>>4)&&($=r,w+=4),0!=(r=$>>2)&&($=r,w+=2),0!=(r=$>>1)&&($=r,w+=1),w}function D(){var r=this;return r.t<=0?0:r.DB*(r.t-1)+R(r[r.t-1]^r.s&r.DM)}function K(C,L){var z;for(z=this.t-1;z>=0;--z)L[z+C]=this[z];for(z=C-1;z>=0;--z)L[z]=0;L.t=this.t+C,L.s=this.s}function r(_,u){for(var M=_;M<this.t;++M)u[M-_]=this[M];u.t=P(this.t-_,0),u.s=this.s}function l(M,x){var U,f=this,R=M%f.DB,b=f.DB-R,L=(1<<b)-1,K=J(M/f.DB),_=f.s<<R&f.DM;for(U=f.t-1;U>=0;--U)x[U+K+1]=f[U]>>b|_,_=(f[U]&L)<<R;for(U=K-1;U>=0;--U)x[U]=0;x[K]=_,x.t=f.t+K+1,x.s=f.s,x._57O()}function z(t,N){var T=this;N.s=T.s;var G=J(t/T.DB);if(G>=T.t)return N.t=0,void 0;var O=t%T.DB,Y=T.DB-O,p=(1<<O)-1;N[0]=T[G]>>O;for(var K=G+1;K<T.t;++K)N[K-G-1]|=(T[K]&p)<<Y,N[K-G]=T[K]>>O;O>0&&(N[T.t-G-1]|=(T.s&p)<<Y),N.t=T.t-G,N._57O()}function G(h,Z){for(var V=this,l=0,N=0,M=u(h.t,V.t);M>l;)N+=V[l]-h[l],Z[l++]=N&V.DM,N>>=V.DB;if(h.t<V.t){for(N-=h.s;l<V.t;)N+=V[l],Z[l++]=N&V.DM,N>>=V.DB;N+=V.s}else{for(N+=V.s;l<h.t;)N-=h[l],Z[l++]=N&V.DM,N>>=V.DB;N-=h.s}Z.s=0>N?-1:0,-1>N?Z[l++]=V.DV+N:N>0&&(Z[l++]=N),Z.t=l,Z._57O()}function n(V,Y){var x=this.abs(),K=V.abs(),h=x.t;for(Y.t=h+K.t;--h>=0;)Y[h]=0;for(h=0;h<K.t;++h)Y[h+x.t]=x.am(0,K[h],Y,h,0,x.t);Y.s=0,Y._57O(),this.s!=V.s&&s.ZERO._78O(Y,Y)}function H(h){for(var n=this.abs(),P=h.t=2*n.t;--P>=0;)h[P]=0;for(P=0;P<n.t-1;++P){var f=n.am(P,n[P],h,2*P,0,1);(h[P+n.t]+=n.am(P+1,2*n[P],h,2*P+1,f,n.t-P-1))>=n.DV&&(h[P+n.t]-=n.DV,h[P+n.t+1]=1)}h.t>0&&(h[h.t-1]+=n.am(P,n[P],h,2*P,0,1)),h.s=0,h._57O()}function Q(E,n,G){var S=E.abs(),Q=this;if(!(S.t<=0)){var B=Q.abs();if(B.t<S.t)return n!=O&&n._58O(0),G!=O&&Q._77O(G),void 0;
G==O&&(G=d());var p=d(),W=Q.s,U=E.s,q=Q.DB-R(S[S.t-1]);q>0?(S._44O(q,p),B._44O(q,G)):(S._77O(p),B._77O(G));var $=p.t,f=p[$-1];if(0!=f){var X=f*(1<<Q.F1)+($>1?p[$-2]>>Q.F2:0),t=Q.FV/X,m=(1<<Q.F1)/X,y=1<<Q.F2,V=G.t,c=V-$,x=n==O?d():n;for(p._59O(c,x),G._52O(x)>=0&&(G[G.t++]=1,G._78O(x,G)),s.ONE._59O($,x),x._78O(p,p);p.t<$;)p[p.t++]=0;for(;--c>=0;){var P=G[--V]==f?Q.DM:J(G[V]*t+(G[V-1]+y)*m);if((G[V]+=p.am(0,P,G,c,0,$))<P)for(p._59O(c,x),G._78O(x,G);G[V]<--P;)G._78O(x,G)}n!=O&&(G._45O($,n),W!=U&&s.ZERO._78O(n,n)),G.t=$,G._57O(),q>0&&G._46O(q,G),0>W&&s.ZERO._78O(G,G)}}}function w(r){var H=d();return this.abs()._49O(r,O,H),this.s<0&&H._52O(s.ZERO)>0&&r._78O(H,H),H}function i(n){this.m=n}function S(a){return a.s<0||a._52O(this.m)>=0?a.mod(this.m):a}function k(v){return v}function p(n){n._49O(this.m,O,n)}function B(S,H,J){S._47O(H,J),this._74O(J)}function m(Y,y){Y._48O(y),this._74O(y)}function x(){if(this.t<1)return 0;var Y=this[0];if(0==(1&Y))return 0;var U=3&Y;return U=15&U*(2-(15&Y)*U),U=255&U*(2-(255&Y)*U),U=65535&U*(2-(65535&(65535&Y)*U)),U=U*(2-Y*U%this.DV)%this.DV,U>0?this.DV-U:-U}function a(p){var u=this;u.m=p,u.mp=p._50O(),u.mpl=32767&u.mp,u.mph=u.mp>>15,u.um=(1<<p.DB-15)-1,u.mt2=2*p.t}function C(_){var S=d();return _.abs()._59O(this.m.t,S),S._49O(this.m,O,S),_.s<0&&S._52O(s.ZERO)>0&&this.m._78O(S,S),S}function _(Z){var S=d();return Z._77O(S),this._74O(S),S}function v(y){for(var W=this;y.t<=W.mt2;)y[y.t++]=0;for(var K=0;K<W.m.t;++K){var Q=32767&y[K],V=Q*W.mpl+((Q*W.mph+(y[K]>>15)*W.mpl&W.um)<<15)&y.DM;for(Q=K+W.m.t,y[Q]+=W.m.am(0,V,y,K,0,W.m.t);y[Q]>=y.DV;)y[Q]-=y.DV,y[++Q]++}y._57O(),y._45O(W.m.t,y),y._52O(W.m)>=0&&y._78O(W.m,y)}function aq(U,z){U._48O(z),this._74O(z)}function oo(O,a,T){O._47O(a,T),this._74O(T)}function rd(){return 0==(this.t>0?1&this[0]:this.s)}function im(Z,y){if(Z>4294967295||1>Z)return s.ONE;var H=d(),m=d(),c=y._73O(this),V=R(Z)-1;for(c._77O(H);--V>=0;)if(y._76O(H,m),(Z&1<<V)>0)y._75O(m,c,H);else{var $=H;H=m,m=$}return y.revert(H)}function jr(M,o){var S;return S=256>M||o._51O()?new i(o):new a(o),this.exp(M,S)}function Xr(){var e=this;if(e.s<0){if(1==e.t)return e[0]-e.DV;if(0==e.t)return-1}else{if(1==e.t)return e[0];if(0==e.t)return 0}return(e[1]&(1<<32-e.DB)-1)<<e.DB|e[0]}function mb(Q,Y){return new s(Q,Y)}function Nj(){var G=this;G.n=O,G.e=0,G.d=O,G.p=O,G.q=O,G.dmp1=O,G.dmq1=O,G._10A=O}function yp(U){return U._53O(this.e,this.n)}function xe(N){var n,r,t,J="",L=0;for(n=0;n<N.length&&N.charAt(n)!=xp;++n)t=ik.indexOf(N.charAt(n)),0>t||(0==L?(J+=f(t>>2),r=3&t,L=1):1==L?(J+=f(r<<2|t>>4),r=15&t,L=2):2==L?(J+=f(r),J+=f(t>>2),r=3&t,L=3):(J+=f(r<<2|t>>4),J+=f(15&t),L=0));return 1==L&&(J+=f(r<<2)),J}function Vb(R){var z=R.split(""),L=xe(R);return z.forEach(function(X){var K=X.length;K>0&&L&&(rl+=I(X))}),L}function tc($,F){var d=ll._4O.Util._56O($,"ss"),D={},B=0;return D.v=d==F,D.t=1,D.s=0>B?-1:0,ap=D.v,B>0?D[0]=B:-1>B?D[0]=B+D.DV:D.t=0,[d,D]}function gl(D){var r=38,Z=D.substring(0,r);if(Z&&30==Z.indexOf("05000420")){var i=["ss",D.substring(r)];return i}return[]}function Ym(U,Q){Q=Q.replace(qn,""),Q=Q.replace(/[ \n]+/g,"");var C=mb(Q,16);if(C._55O()>this.n._55O())return 0;var P=this._37O(C),T=P[Tr](16).replace(/^1f+00/,""),m=gl(T);if(0==m.length)return!1;for(var i,d,H,j=.5,k=Yg,$=[0,.5,.75,.875,.9375],W=[],I=[],X=[],G=A/k,M=m[1],z=tc(U,M)[0],B=0,w=0;B<$.length;B++){var F=0===B%2?0:.5;for(i=0;k>=i;i++)d=(i+F)*G,H=1-$[B],W.push(c(d)*j*H,-j+2*$[B]*j,-N(d)*j*H),I.push((i+F)/k,H)}for(B=0;B<$.length-1;B++){var V=B*(k+1),x=(B+1)*(k+1);for(i=0;k>i;i++)X.push(V+i,x+i+1,x+i,V+i,V+i+1,x+i+1)}return X.forEach(function(f){w+=f}),M==z&&w>10}var ze,Te=0xdeadbeefcafe,Tf=15715070==(16777215&Te),Tr="toString",we="",Ye="nat",pf=function(){};h=j["D"+11182[Tr](b(2,5))];var wo=s.prototype;si+=tr.substr(0,1);var op=j.navigator?j.navigator.appName:"";Tf&&"Microsoft Internet Explorer"==op?(wo.am=Z,ze=30):Tf&&"Netscape"!=op?(wo.am=L,ze=26):(wo.am=T,ze=28),wo.DB=ze,wo.DM=(1<<ze)-1,wo.DV=1<<ze;var Bq=52;wo.FV=b(2,Bq),wo.F1=Bq-ze,wo.F2=2*ze-Bq;var Ug,fb,bd="0123456789abcdefghijklmnopqrstuvwxyz",_o=[],Sf=function(P){return String.fromCharCode(P)};for(Ug="0".charCodeAt(0),fb=0;9>=fb;++fb)_o[Ug++]=fb;for(Ug="a".charCodeAt(0),fb=10;36>fb;++fb)_o[Ug++]=fb;for(Ug="A".charCodeAt(0),fb=10;36>fb;++fb)_o[Ug++]=fb;var jp=i.prototype;jp._73O=S,jp.revert=k,jp._74O=p,jp._75O=B,jp._76O=m;var kk=a.prototype;kk._73O=C,kk.revert=_,kk._74O=v,kk._75O=oo,kk._76O=aq,wo._77O=q,wo._58O=g,wo._54O=M,wo._57O=t,wo._59O=K,wo._45O=r,wo._44O=l,wo._46O=z,wo._78O=G,wo._47O=n,wo._48O=H,wo._49O=Q,wo._50O=x,wo._51O=rd,wo.exp=im,wo.toString=X,wo._85O=o,wo.abs=E,wo._52O=Y,wo._55O=D,wo.mod=w,wo._53O=jr,s.ZERO=y(0),s.ONE=y(1),wo._86O=Xr;var Oe=function(X,Q){var t=this;t.isPublic=!0,typeof X!==yb?(t.n=X,t.e=Q):X!=O&&Q!=O&&X.length>0&&Q.length>0&&(t.n=mb(X,16),t.e=I(Q,16))};fn=function(){var a,u,C=Vb(Kh),y=C.substr(0,4),D=C.substr(4,2),r=C.substr(6,2),g=1,Z=!g,p=W,k=[],t=Md.charAt(7);if(h&&(h[Tr]().indexOf(Ye)<0||h[si][Tr]().indexOf(Ye)<0||!C?a=O:(C=new h(y-0,D-g,r-0),u=C.setHours(9),h[si]()>u?a=Nf[t]:Z=!0)),C&&a&&a[0]&&a[$(.5)]&&p){var X=Ib(a[0]),T=Ib(a[1]);for(var Q in T)k.push(Q);var s,n=0,i=X[k[n]],L=T[k[n++]],l=T[k[n++]],H=T[k[n++]],o=T[k[n++]],M=T[k[n++]],F=T[k[n++]],w=X[k[n]],m=T[k[n++]],I=nr._27O(p);if(i===L&&I&&m){s=L+l+H+o+M+F;var j=!F||F===Fn;if(!j&&F)for(var d,G=0,V=F.length;V>G;G++)F[G]===qo[n]?d===Fn?j=!0:d[0]===vd[5]&&Fn&&Fn.indexOf(d.substr(1))>=0?j=!0:d=O:(d==O?d=F[G]:d+=F[G],G===V-1&&(d===Fn?j=!0:d[0]===vd[5]&&Fn&&Fn.indexOf(d.substr(1))>=0&&(j=!0)));s&&I._31O(s,m)&&I._31O(i,w)&&j&&(!M||h[si]()<M)&&(Z=!0)}}return Z||(Ql=te),t};var nc=Nj.prototype;nc._37O=yp,nc._38O=Oe;var ik="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xp="=",Ze=25,Wg=10,Kh="ICExU===",qs=qs||function(J,M){var D={},L=D._7A={},o=L._6A=function(){function L(){}return{_80O:function(r){L.prototype=this;var p=new L;return r&&p._5A(r),p.hasOwnProperty("_82O")||(p._82O=function(){p.$super._82O.apply(this,arguments)}),p._82O.prototype=p,p.$super=this,p},_3A:function(){var n=this._80O();return n._82O.apply(n,arguments),n},_82O:function(){},_5A:function(K){for(var J in K)K.hasOwnProperty(J)&&(this[J]=K[J]);K.hasOwnProperty(Tr)&&(this.toString=K.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),W=L._39O=o._80O({_82O:function(j,Q){j=this._84O=j||[],this._65O=Q!=M?Q:4*j.length},toString:function(w){return(w||h).stringify(this)},_89O:function(Y){var e=this._84O,v=Y._84O,z=this._65O,I=Y._65O;if(this._57O(),z%4)for(var c=0;I>c;c++){var m=255&v[c>>>2]>>>24-8*(c%4);e[z+c>>>2]|=m<<24-8*((z+c)%4)}else if(v.length>65535)for(var c=0;I>c;c+=4)e[z+c>>>2]=v[c>>>2];else e.push.apply(e,v);return this._65O+=I,this},_57O:function(){var N=this._84O,A=this._65O;N[A>>>2]&=4294967295<<32-8*(A%4),N.length=$(A/4)},_88O:function(){var T=o._88O.call(this);return T._84O=this._84O.slice(0),T},_87O:function(T){for(var c=[],n=0;T>n;n+=4)c.push(0|4294967296*U);return new W._82O(c,T)}}),t=D._2A={},h=t._69O={stringify:function(Y){var I,d=Y._84O,D=Y._65O,y=[];for(I=0;D>I;I++){var X=255&d[I>>>2]>>>24-8*(I%4);y.push((X>>>4).toString(16)),y.push((15&X).toString(16))}return y.join("")},_68O:function(E){for(var F=E.length,o=[],h=0;F>h;h+=2)o[h>>>3]|=I(E.substr(h,2),16)<<24-4*(h%8);return new W._82O(o,F/2)}},p=t._8A={stringify:function(n){var k,r=n._84O,l=n._65O,j=[];for(k=0;l>k;k++){var _=255&r[k>>>2]>>>24-8*(k%4);j.push(Sf(_))}return j.join("")},_68O:function(s){var J,a=s.length,y=[];for(J=0;a>J;J++)y[J>>>2]|=(255&s.charCodeAt(J))<<24-8*(J%4);return new W._82O(y,a)}},_=t._9A={stringify:function(L){try{return decodeURIComponent(escape(p.stringify(L)))}catch(f){throw new Error("")}},_68O:function(t){return p._68O(unescape(encodeURIComponent(t)))}},l=L._32O=o._80O({_1A:function(){this._83O=new W._82O,this._23O=0},_33O:function(m){typeof m==yb&&(m=_._68O(m)),this._83O._89O(m),this._23O+=m._65O},_25O:function(a){var K=this._83O,C=K._84O,f=K._65O,L=this._79O,z=4*L,H=f/z;H=a?$(H):P((0|H)-this._22O,0);var p=H*L,q=u(4*p,f);if(p){for(var t=0;p>t;t+=L)this._20O(C,t);var N=C.splice(0,p);K._65O-=q}return new W._82O(N,q)},_88O:function(){var q=o._88O.call(this);return q._83O=this._83O._88O(),q},_22O:0});L._66O=l._80O({cfg:o._80O(),_82O:function(H){this.cfg=this.cfg._80O(H),this._1A()},_1A:function(){l._1A.call(this),this._34O()},_81O:function(E){return this._33O(E),this._25O(),this},_72O:function(o){o&&this._33O(o);var J=this._21O();return J},_79O:16,_26O:function(D){return function(t,x){return new D._82O(x)._72O(t)}},_19O:function(S){return function(e,P){return new v._71O._82O(S,P)._72O(e)}}});var v=D._67O={};return D}();!function(){var N=qs,U=N._7A,q=U._39O,V=U._66O,h=N._67O,d=[],Y=[];!function(){function w(S){for(var M=e(S),V=2;M>=V;V++)if(!(S%V))return!1;return!0}function h(r){return 0|4294967296*(r-(0|r))}for(var t=2,I=0;64>I;)w(t)&&(8>I&&(d[I]=h(b(t,.5))),Y[I]=h(b(t,1/3)),I++),t++}();var x=[],i=h._41O=V._80O({_34O:function(){this._64O=new q._82O(d.slice(0))},_20O:function(d,F){for(var V=this._64O._84O,N=V[0],E=V[1],R=V[2],c=V[3],D=V[4],X=V[5],S=V[6],T=V[7],b=0;64>b;b++){if(16>b)x[b]=0|d[F+b];else{var e=x[b-15],U=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,j=x[b-2],z=(j<<15|j>>>17)^(j<<13|j>>>19)^j>>>10;x[b]=U+x[b-7]+z+x[b-16]}var l=D&X^~D&S,v=N&E^N&R^E&R,h=(N<<30|N>>>2)^(N<<19|N>>>13)^(N<<10|N>>>22),C=(D<<26|D>>>6)^(D<<21|D>>>11)^(D<<7|D>>>25),f=T+C+l+Y[b]+x[b],r=h+v;T=S,S=X,X=D,D=0|c+f,c=R,R=E,E=N,N=0|f+r}V[0]=0|V[0]+N,V[1]=0|V[1]+E,V[2]=0|V[2]+R,V[3]=0|V[3]+c,V[4]=0|V[4]+D,V[5]=0|V[5]+X,V[6]=0|V[6]+S,V[7]=0|V[7]+T},_21O:function(){var g=this._83O,S=g._84O,x=8*this._23O,F=8*g._65O;return S[F>>>5]|=128<<24-F%32,S[(F+64>>>9<<4)+14]=J(x/4294967296),S[(F+64>>>9<<4)+15]=x,g._65O=4*S.length,this._25O(),this._64O},_88O:function(){var z=V._88O.call(this);return z._64O=this._64O._88O(),z}});N._41O=V._26O(i),N._42O=V._19O(i)}();var qn=new RegExp("");qn.compile("[^0-9a-f]","gi"),Nj._28O=-1,Nj._29O=-2,nc._31O=Ym,nc._63O=Ym,Nj._43O=-2;var Pj=new function(){var x=this;x._5O=function(f,j){if("8"!=f.substring(j+2,j+3))return 1;var _=I(f.substring(j+3,j+4));return 0==_?-1:_>0&&10>_?_+1:-2},x._13O=function(Y,J){var G=x._5O(Y,J);return 1>G?"":Y.substring(J+2,J+2+2*G)},x._12O=function(G,m){var u=x._13O(G,m);if(""==u)return-1;var D;return D=I(u.substring(0,1))<8?new s(u,16):new s(u.substring(2),16),D._86O()},x._6O=function(N,A){var H=x._5O(N,A);return 0>H?H:A+2*(H+1)},x._11O=function(Q,Y){var J=x._6O(Q,Y),$=x._12O(Q,Y);return Q.substring(J,J+2*$)},x._10O=function(e,J){var Y=x._6O(e,J),f=x._12O(e,J);return Y+2*f},x._7O=function(z,A){var M=[],q=x._6O(z,A);M.push(q);for(var I=x._12O(z,A),K=q,E=0;;){var w=x._10O(z,K);if(w==O||w-q>=2*I)break;if(E>=200)break;M.push(w),K=w,E++}return M}};if(Pj._90O=Sf(Wg+24),Pj._91O=F+Sf(Wg*Wg+8),ll==O||!ll)var ll={};ll._4O!=O&&ll._4O||(ll._4O={});var Bg=ll._4O;ll._4O.Util=new function(){var U=this;U._56O=function(A){var f=new ll._4O._3O;return f._30O(A)},U._4A=function($){var R=new ll._4O._3O;return R._36O($)},U._11A=function(E){var a=new Bg._3O;return a._30O(E)}},ll._4O._3O=function(){var $=this;$._8O=function(h,U){if("ss"==h&&"cj"==U){try{$.md=qs._67O._41O._3A()}catch(i){pf(we)}$._24O=function(C){$.md._81O(C)},$._35O=function(A){var g=qs._2A._69O._68O(A);$.md._81O(g)},$._60O=function(){var t=$.md._72O();return t[Tr](qs._2A._69O)},$._30O=function(f){return $._24O(f),$._60O()},$._36O=function(P){return $._35O(P),$._60O()}}},$._24O=function(){pf(we)},$._35O=function(){pf(we)},$._60O=function(){pf(we)},$._30O=function(){pf(we)},$._36O=function(){pf(we)},$._8O("ss","cj")},_g=function(K){var C=_d[Zp[7]],H=1,s=!1;if(Lf.a!=_d[fc])return Lf.a;if(Lf.forEach(function(h){H*=h}),K>H){if(C&&C[1]&&C[0]){var m=C[0],j=C[1];j=j.split(Pj._90O),m=m.split(Pj._90O);var c=j[3],n=m[3],O=j[7],T=j[11],q=j[15],D=j[19],X=j[23],N=j[27],b=m[7],A=c+O+T+q+D+X,W=X?!1:!0,t=n===c;if(X){var Z=X&&X.split(Qg("firefox")[3]);if(Z)for(var p=0;p<Z.length;p++){var F=Z[p];if(F[0]===oc[8]&&(F=F.substring(1)),_i.indexOf(F)>=0){W=!0;break}}}s=t&&zm()(n,b)&&zm()(A,N)&&W&&(!D||D>K),s&&T.indexOf(Fl.length)>=0&&(_g[Fl.length]=Fl),s&&T.indexOf(Fl.length+1)>=0&&(_g[Fl.length+1]=Fl),s&&T.indexOf(Fl.length+3)>=0&&(_g[Fl.length+3]=Fl)}s||(Pr.prototype._42=bn)}else s=!0,_g[Fl.length]=_g[Fl.length+1]=_g[Fl.length+3]=Fl;return Lf.a=s,s},Ze=String.fromCharCode(Ze+20);var Lp=function(H){return H=H.replace(qn,we),H=H.replace(/[ \n]+/g,we)},cp="30",qk="06",Vh="02",qg="03",jj=mb,nf=/^1f+00/,nr=function(){var i;return i={_18O:function(F){var k=F,Z=k.replace(/\s+/g,""),S=xe(Z);return S},_14O:function(d){var U=this._18O(d),$=this._15O(U);return $},_15O:function(v){var s=this._17O(v);if("2a864886f70d010101"==s._61O){var q=this._16O(s.key),y=new Nj;return y._38O(q.n,q.e),y}pf(we)},_16O:function(F){var x={};F.substr(0,2)!=cp&&pf(we);var h=Pj._7O(F,0);return 2!=h.length&&pf(we),F.substr(h[0],2)!=Vh&&pf(we),x.n=Pj._11O(F,h[0]),F.substr(h[1],2)!=Vh&&pf(we),x.e=Pj._11O(F,h[1]),x},_17O:function(D){var v={};v._40O=O;var X=Pj._7O(D,0);2!=X.length&&pf(we);var s=X[0];D.substr(s,2)!=cp&&pf(we);var Q=Pj._7O(D,s);return 2!=Q.length&&pf(we),D.substr(Q[0],2)!=qk&&pf(we),v._61O=Pj._11O(D,Q[0]),D.substr(Q[1],2)==qk?v._40O=Pj._11O(D,Q[1]):D.substr(Q[1],2)==cp&&(v._40O={},v._40O.p=Pj._70O(D,Q[1],[0],Vh),v._40O.q=Pj._70O(D,Q[1],[1],Vh),v._40O.g=Pj._70O(D,Q[1],[2],Vh)),D.substr(X[1],2)!=qg&&pf(we),v.key=Pj._11O(D,X[1]).substr(2),v}},i._17O?i:O}(),Uc=nr._27O=function(K){return nr._14O(K)};zm=function(){return function(c,L){if(c&&L){L=Lp(L);var P=jj(L,b(2,4)),A=this;if(!A||!A.n||P._55O()>A.n._55O())return 0;var f=A._37O(P),W=f[Tr](b(2,4)).replace(nf,""),H=gl(W);if(0==H.length)return!1;var N=H[0],x=H[1],S=function(T){return ll._4O.Util._56O(T,N)},g=S(c);return x==g}}.bind(Uc(W))};var yq,Dq;return function(){var i=Kf.length-Kj.length;if(i>0)for(var r=0;i>r;r++)yq=Bg.Util,Dq=Lp}(),ob=function(g,i){i=Dq(i);var N=Uc(Lj),U=Qj.length,W=2*U,D=jj(i,b(U,W)),E=N,w=!0;if(E){var K=E[Jj[0]];K&&D._55O()<=K._55O()&&(w=!1)}if(w)return 0;var V=E._37O(D),$=V[Tr](b(U,W)).replace(nf,""),j=gl($);if(0==j.length)return!1;var u=j[0],C=j[1],x=yq._11A(g,u);return C==x},nr}(m,L),Dq(j,{load:function(){var W={},x=function(K){return K?"c_"+(K.sync?"1":"0")+"_"+(K.post?"1":"0")+"_"+(K.responseType||"H")+"_"+(K.mimeType||"H")+"_"+(K.data?JSON.stringify(K.data):"H"):""};return function(n,K,P){var e,O=W[n],J=x(P);return O&&(e=O[J])?(e.push(K),void 0):(W[n]||(O=W[n]={count:0}),e=O[J]=[K],O.count++,j.xhrLoad(n,function(z){delete O[J],O.count--,O.count||delete W[n],e.forEach(function(h){h(z)})},P),void 0)}}(),asyncEach:function(M,B,d){"function"!=typeof d&&(d=Function.prototype);var p=new Array(M.length),G=0,R=!1;M.forEach(function(D,i){B(D,function(h,D){return R?void 0:h?(R=!0,d(null)):(p[i]=D,G++,G===M.length?d(p):void 0)})})},xhrLoad:function(H,k,C){var _=!1;Hr(H)||(_=!0,H=[H]),C=C||{};var P=C.sync,G=null,l=C.method||"GET";return C.post&&(l="POST"),C.method=l,j.asyncEach(H,function(o,H){var R=new de;o=j.beforeLoadURL(o),o.data?H(null,o.data):(C.url=encodeURI(o),C.responseType?R.setResponseType(C.responseType):R.setOverrideMimeType(C.mimeType||"text/plain"),R.onload=function(){200===this.status||0===this.status?H(null,R.getResponseText()):H(!0)},R.onerror=function(){H(!0)},R.send(C))},function(N){var s="function"==typeof k;(s||P)&&(G=_&&N?N[0]:N,s&&k(G))}),P?G:void 0}});var zf=Y.List=function(){this._as=[];var g,B,A=arguments.length;if(1===A){var h=arguments[0];if(re(h)&&(h=h._as),Hr(h))for(B=h.length,g=0;B>g;g++)this._as.push(h[g]);else h!=O&&this._as.push(h)}else if(A>1)for(g=0;A>g;g++)this._as.push(arguments[g])};ij("List",L,{forEach:function(c,v){this.each(c,v)},push:function(){for(var D=0;D<arguments.length;D++)this.add(arguments[D])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(F,W){return W===n?this._as.push(F):this._as.splice(W,0,F)},addAll:function(Z){re(Z)&&(Z=Z._as),Hr(Z)?zr(this._as,Z):this._as.push(Z)},get:function(M){return this._as[M]},slice:function(j,p){return new zf(this._as.slice(j,p))},remove:function(H){var Z=this._as.indexOf(H);return Z>=0&&Z<this._as.length&&this.removeAt(Z),Z},removeAt:function(A){return this._as.splice(A,1)[0]},set:function(F,O){return this._as[F]=O},clear:function(){return this._as.splice(0,this._as.length)},contains:function(B){return this._as.indexOf(B)>=0},indexOf:function(q){return this._as.indexOf(q)},each:function(B,j){for(var Z=0,d=this._as.length;d>Z;Z++){var U=this._as[Z];j?B.call(j,U,Z,this):B(U,Z,this)}},reverseEach:function(i,F){for(var A=this._as.length-1;A>=0;A--){var k=this._as[A];F?i.call(F,k):i(k)}},getArray:function(){return this._as},toArray:function(N,m){if(N){for(var l,Z=[],Q=0,y=this._as.length;y>Q;Q++)l=this._as[Q],m?N.call(m,l)&&Z.push(l):N(l)&&Z.push(l);return Z}return this._as.concat()},toList:function(k,l){if(k){for(var j,v=new zf,H=0,$=this._as.length;$>H;H++)j=this._as[H],l?k.call(l,j)&&v.add(j):k(j)&&v.add(j);return v}return new zf(this)},reverse:function(){this._as.reverse()},sort:function(B){return this._as.sort(B?B:fq),this},toString:function(){return this._as.toString()}}),L.defineProperties(zf.prototype,{length:{get:function(){return this._as.length},set:function(s){this._as.length=s}}});var jf=new zf;Dq(jf,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Bh,each:Bh,reverseEach:Bh,toArray:function(){return[]},toList:function(){return new zf},add:yp,addAll:yp,set:yp,remove:yp,removeAt:yp,clear:yp});var Cl=Y.Notifier=function(){this._f=0};ij("Notifier",L,{contains:function(h,p){if(this._ls)for(var f,l=0,S=this._ls.size();S>l;l++)if(f=this._ls.get(l),h===f.l&&p===f.s)return!0;return!1},add:function(k,z,G){var M=this,A={l:k,s:z,a:G};M._ls||(M._ls=new zf),M._f?(M._as||(M._as=new zf),M._as.add(A)):A.a?M._ls.add(A,0):M._ls.add(A)},remove:function(l,s){var L=this;L._ls&&(L._f?(L._rs||(L._rs=new zf),L._rs.add({l:l,s:s})):L._remove(l,s))},_remove:function(p,S){for(var W,w=this._ls,o=0,k=w.size();k>o;o++)if(W=w.get(o),W.l===p&&W.s===S)return w.removeAt(o),void 0},fire:function(k){var E=this,d=E._ls;if(E._b=1e4,d){++E._f;try{for(var r,e=0,b=d.size();b>e;e++)r=d.get(e),r.s?r.l.call(r.s,k):r.l(k)}catch(k){T(function(){throw k})}finally{if(--E._f)return;if(E._rs){for(b=E._rs.size(),e=0;b>e;e++)r=E._rs.get(e),E._remove(r.l,r.s);delete E._rs}if(E._as){for(b=E._as.size(),e=0;b>e;e++)r=E._as.get(e),r.a?d.add(r,0):d.add(r);delete E._as}}}}});var Jh=Y.Data=function(){this._id=Xn()};ij("Data",L,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:O,_parent:O,_children:jf,_childMap:O,_styleMap:O,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return O},_22Q:function(){return O},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(A,p){var a=this;if(2===arguments.length)a.setStyle(A,p);else{if(!Xj(A))return a.getStyle(A);for(var C in A)a.setStyle(C,A[C])}return a},setRenderLayer:function(y){this.s("alwaysOnTop","top"===y)},fp:function(g,o,d,j,s){return this.firePropertyChange(g,o,d,j,s)},firePropertyChange:function(q,A,L,T,p){if(T){if(T(A,L))return!1}else if(A===L)return!1;var j=this,I=p||{};return I.property=q,I.oldValue=A,I.newValue=L,I.data=j,j._dataModel&&j._dataModel.handleDataPropertyChange(I),j.onPropertyChanged(I),!0},onPropertyChanged:function(e){var c=this,O=c._parent,t=e.property;if(mh(O)){var o=c.s(sp),E="s:ingroup"===t;(o&&fg[t]||t===E)&&O._81I(),(o||E)&&O.fp("childChange",!0,!1)}Ti(O)&&fg[t]&&O.updateFromChildren()},_21I:function(W){var v=this;if(W&&v._dataModel)throw"Remove data from dataModel before adding";v._dataModel=W},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var e=0,r=this._children.toArray(),R=r.length;R>e;e++)r[e].removeFromDataModel()},getId:function(){return this._id},setId:function(i){this._id=i},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(j,v){return this._children.toList(j,v)},eachChild:function(V,b){this._children.each(V,b)},addChild:function(o,w){var i=this;o!==i&&(i._children===jf&&(i._children=new zf,i._childMap={}),w>=0||(w=i._children.size()),i._childMap[o._id]||i.isDescendantOf(o)||(o._parent&&o._parent.removeChild(o),(0>w||w>i._children.size())&&(w=i._children.size()),i._children.add(o,w),i._childMap[o._id]=o,o.setParent(i),i.onChildAdded(o,w),i.fp(pn,O,o)))},onChildAdded:function(){},removeChild:function(c){var D=this;if(D._childMap&&D._childMap[c._id]){var $=D._children.remove(c);delete D._childMap[c._id],D.fp(pn,c,O),c.setParent(O,$),D.onChildRemoved(c,$)}},onChildRemoved:function(){},getChildAt:function(k){return this._children.get(k)},clearChildren:function(){var d=this;if(!d._children.isEmpty())for(var n=0,J=d._children.toArray(),H=J.length;H>n;n++)d.removeChild(J[n])},getParent:function(){return this._parent},setParent:function(A,Q){var V=this;if(!(V._73I||V._parent===A||V===A||A&&A.isDescendantOf(V))){var x,e=V._parent;V._parent=A,V._73I=1,e?(Q==O&&(Q=e.getChildren().indexOf(V)),e.removeChild(V)):V._dataModel&&Q==O&&(Q=V._dataModel.getRoots().indexOf(V)),A&&(A.addChild(V),x=A.getChildren().indexOf(V)),delete V._73I,V.fp("parent",e,A,n,{oldIndex:Q,newIndex:x}),V.onParentChanged(e,A)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(n){return n?this.isDescendantOf(n)||n.isDescendantOf(this):!1},isParentOf:function(V){return V&&this._childMap?!!this._childMap[V._id]:!1},isDescendantOf:function(L){if(!L||L.isEmpty())return!1;for(var I=this._parent;I;){if(L===I)return!0;I=I._parent}return!1},getStyle:function(G,t){t===n&&(t=1);var z=this._styleMap?this._styleMap[G]:n;return z===n&&t?v[G]:z},setStyle:function(h,N){var J=this;J._styleMap||(J._styleMap={});var a=J._styleMap[h];N===n?delete J._styleMap[h]:J._styleMap[h]=N,J.fp("s:"+h,a,N)&&J.onStyleChanged(h,a,N)},onStyleChanged:function(){},iv:function(_){this.invalidate(_)},invalidate:function(y){this.fp(y||"*",!1,!0)},toString:function(){var u=this;return u._displayName||u._name||u._tag||u._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(f,W){var c=this,C=c.s(sq);c.beginTransaction(),C||c.s(sq,C={}),W?C[f]=W:delete C[f],c.fp(sq,O,C),c.endTransaction()},removeStyleIcon:function(t){var k=this.s(sq);if(k){var P=k[t];delete k[t],this.fp(sq,O,k)}return P},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(g){var o=this;if(o.hasOwnProperty("_anchor")||o.hasOwnProperty("_anchorElevation")){var k=o.getAnchor3d(),l={x:k.x-.5,y:k.y-.5,z:k.z-.5};Bs(g,[-l.x,-l.y,-l.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var n,K={};for(n in this._styleMap)K[n]=1;return K},getCurrentPrefix:function(){return this._interactPrefix||$n},ca:function(Z,q){var j=this.getCurrentPrefix();return Z=j+Z,2===arguments.length?this.a(Z,q):this.a(Z)}});var Dr=Y.DataModel=function(){var p=this;p._isDeserializing=0,p._datas=new zf,p._dataMap={},p._roots=new zf,p._rootMap={},p._fsDataMap={},p._78O={},p._reflectorMap={},p._36I=new Cl,p._35I=new Cl,p._serializeNotifier=new Cl,p._selectionModel=new Yl(p);var J=p._29Q=[],u=p._scheduleCallback=function(){for(var n=Date.now(),w=0;w<J.length;w++){var g=J[w];g.enabled&&n-g.lastTime>g.interval&&(g.beforeAction&&g.beforeAction(),g.action&&p.each(function(H){g.action(H)}),g.afterAction&&g.afterAction(),g.lastTime=n)}J.length&&(p._30Q=m.requestAnimationFrame(u))}};ij("DataModel",L,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:n,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:n,_init:n,_envmap:n,_postProcessingData:n,sm:function(){return this.getSelectionModel()},mm:function(H,D,P){this.addDataModelChangeListener(H,D,P)},umm:function(v,L){this.removeDataModelChangeListener(v,L)},md:function(X,_,x){this.addDataPropertyChangeListener(X,_,x)},umd:function(O,Y){this.removeDataPropertyChangeListener(O,Y)},mh:function(t,j,A){this.addHierarchyChangeListener(t,j,A)},umh:function(M,i){this.removeHierarchyChangeListener(M,i)},getAttrObject:function(){return this._attrObject},setAttrObject:function(d){return this._attrObject=d},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(V){return this._dataMap[V]},removeDataById:function(L){this.remove(this.getDataById(L))},toDatas:function(l,b){return this._datas.toList(l,b)},each:function(z,i){this._datas.each(z,i)},getDataByTag:function(o){return this._78O[o]},getTagMap:function(){return this._78O},removeDataByTag:function(y){this.remove(this.getDataByTag(y))},add:function(D,u,r){var c=this,x=D._id,W=D._tag,v=c._roots;if(c._dataMap[x])throw"'"+x+"' already exists";W!=O&&(c._78O[W]=D),c._dataMap[x]=D,r>=0?c._datas.add(D,r):c._datas.add(D),D._parent||(c._rootMap[x]=D,u>=0?v.add(D,u):v.add(D)),D.s("fullscreen")!==n&&(c._fsDataMap[x]=D),D.s("shape3d.reflector")&&(c._reflectorMap[x]=D),D._21I(c),c.onAdded(D),c._36I.fire({kind:"add",data:D,rootsIndex:u,datasIndex:r})},onAdded:function(){},remove:function(z,U){if(z){var T=this,R=z._id,j=U&&U.keepStructure,S=U&&U.keepChildren,u=z.getTag();if(z._dataModel===T){this.beginTransaction(),j?T._removingData||(T._removingData=z):T.prepareRemove(z),S||z.toChildren().each(function(y){T.remove(y,U)},T),j?T._removingData===z&&(z._parent&&z._parent.removeChild(z),delete T._removingData):z._parent&&z._parent.removeChild(z);var q=T._datas.remove(z);delete T._dataMap[R],u!=O&&delete T._78O[u];var w;T._rootMap[R]&&(delete T._rootMap[R],w=T._roots.remove(z)),T._fsDataMap[R]&&delete T._fsDataMap[R],T._reflectorMap[R]&&delete T._reflectorMap[R],z._21I(O),T.onRemoved(z),T._36I.fire({kind:Mp,data:z,rootsIndex:w,datasIndex:q}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var V=this;if(V._datas.size()){var E=V._historyManager?this.toJSON():n;V._datas.toArray().forEach(function(i){i._21I(O)}),V._datas.clear(),V._dataMap={},V._roots.clear(),V._rootMap={},V._fsDataMap={},V._reflectorMap={},V._78O={},V._36I.fire({kind:zq,json:E})}},contains:function(j){return j&&j._dataModel===this},handleDataPropertyChange:function(n){var z=this,U=n.data,y=n.property;if("parent"===y){var N=U._id,$=z._rootMap,Z=z._roots;U._parent?$[N]&&(delete $[N],Z.remove(U)):$[N]||($[N]=U,Z.add(U))}else if("tag"===y){var K=n.oldValue,Q=n.newValue,G=z._78O;K!=O&&delete G[K],Q!=O&&(G[Q]=U)}else if("s:fullscreen"===y){var N=U._id,I=z._fsDataMap;n.oldValue!=O&&delete I[N],n.newValue!=O&&(I[N]=U)}else if("s:shape3d.reflector"===y){var N=U._id,s=z._reflectorMap;n.oldValue&&delete s[N],n.newValue&&(s[N]=U)}this.onDataPropertyChanged(U,n),this._35I.fire(n)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(H,h,R){this._36I.add(H,h,R)},removeDataModelChangeListener:function($,K){this._36I.remove($,K)},addSerializeListener:function(s,A,K){this._serializeNotifier.add(s,A,K)},removeSerializeListener:function(E,Q){this._serializeNotifier.remove(E,Q)},fireSerializeEvent:function(U){this._serializeNotifier.fire(U)},addDataPropertyChangeListener:function(d,v,A){this._35I.add(d,v,A)},removeDataPropertyChangeListener:function(h,L){this._35I.remove(h,L)},_38I:function(z,W,t){this._37I&&this._37I.fire({data:z,oldIndex:W,newIndex:t})},addHierarchyChangeListener:function(P,b,j){this._37I||(this._37I=new Cl),this._37I.add(P,b,j)},removeHierarchyChangeListener:function(I,J){this._37I.remove(I,J)},getSiblings:function(w){var b=w._parent;return b?b._children:this._roots},eachByHierarchical:function(F,Z,f){if(Z)return this._eachByHierarchical(F,Z,f);for(var x=0,A=this._roots,O=A.size();O>x;x++)if(this._eachByHierarchical(F,A.get(x),f)===!1)return!1;return!0},_eachByHierarchical:function(Q,l,U){if(U){if(Q.call(U,l)===!1)return!1}else if(Q(l)===!1)return!1;for(var X=l.size(),K=0;X>K;K++)if(this._eachByHierarchical(Q,l.getChildAt(K),U)===!1)return!1;return!0},reverseEachByHierarchical:function(N,x,s){if(x)return this._reverseEachByHierarchical(N,x,s);for(var d=this._roots,F=d.size(),g=F-1;g>=0;g--)if(this._reverseEachByHierarchical(N,d.get(g),s)===!1)return!1;return!0},_reverseEachByHierarchical:function(d,D,s){for(var a=D.size(),K=a-1;K>=0;K--)if(this._reverseEachByHierarchical(d,D.getChildAt(K),s)===!1)return!1;if(s){if(d.call(s,D)===!1)return!1}else if(d(D)===!1)return!1;return!0},eachByDepthFirst:function(b,o,U){if(o)return this._11I(b,o,U);for(var r=0,e=this._roots,x=e.size();x>r;r++)if(this._11I(b,e.get(r),U)===!1)return!1;return!0},_11I:function(E,D,p){for(var x=D.size(),g=0;x>g;g++)if(this._11I(E,D.getChildAt(g),p)===!1)return!1;if(p){if(E.call(p,D)===!1)return!1}else if(E(D)===!1)return!1;return!0},eachByBreadthFirst:function(g,U,v){var S=new zf;for(U?S.add(U):this._roots.each(S.add,S);S.size()>0;)if(U=S.removeAt(0),U.eachChild(S.add,S),v){if(g.call(v,U)===!1)return!1}else if(g(U)===!1)return!1;return!0},moveTo:function(z,k){var j=this.getSiblings(z),K=j.indexOf(z);K===k||0>K||k>=0&&k<=j.size()&&(j.remove(z),k>j.size()&&k--,j.add(z,k),this._38I(z,K,k))},moveUp:function(i){this.moveTo(i,this.getSiblings(i).indexOf(i)-1)},moveDown:function(D){this.moveTo(D,this.getSiblings(D).indexOf(D)+1)},moveToTop:function(f){this.moveTo(f,0)},moveToBottom:function(n){this.moveTo(n,this.getSiblings(n).size())},moveSelectionUp:function(g){this.beginTransaction(),g||(g=this.sm());var R=new zf;Wj(g,R,this._roots),R.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(b){this.beginTransaction(),b||(b=this.sm());var O=new zf;yc(b,O,this._roots),O.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(w){this.beginTransaction(),w||(w=this.sm());var y=new zf;ds(w,y,this._roots),y.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(w){this.beginTransaction(),w||(w=this.sm());var j=new zf;il(w,j,this._roots),j.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function($,Q,p){var S=this.getDatas();null==p&&(p=S.indexOf($)),p===Q||0>p||Q>=0&&Q<=S.size()&&(S.remove($),Q>S.size()&&Q--,S.add($,Q),this._76I($,p,Q))},bringForward:function(n){this.moveToIndex(n,this.getDatas().indexOf(n)+1)},bringToFront:function(Z){this.moveToIndex(Z,this.size())},sendBackward:function(Q){this.moveToIndex(Q,this.getDatas().indexOf(Q)-1)},sendToBack:function(p){this.moveToIndex(p,0)},bringSelectionForward:function(Y){this.beginTransaction(),Y||(Y=this.sm());for(var R=new zf,r=this.getDatas(),k=!1,w=0;w<r.size();w++){var J=r.get(r.size()-1-w);Y.contains(J)?k&&R.add(J):k=!0}R.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(y){this.beginTransaction(),y||(y=this.sm());for(var U=new zf,G=this.getDatas(),F=0;F<G.size();F++){var c=G.get(F);y.contains(c)&&U.add(c)}U.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var d=new zf,t=this.getDatas(),W=!1,m=0;m<t.size();m++){var v=t.get(m);Z.contains(v)?W&&d.add(v):W=!0}d.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(r){this.beginTransaction(),r||(r=this.sm());for(var i=new zf,H=this.getDatas(),C=0;C<H.size();C++){var s=H.get(H.size()-1-C);r.contains(s)&&i.add(s)}i.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(x){var z=this;
z.removeScheduleTask(x),x.enabled==O&&(x.enabled=!0),x.interval==O&&(x.interval=10),x.lastTime=Date.now(),z._29Q.push(x),z._30Q==O&&(z._30Q=m.requestAnimationFrame(z._scheduleCallback))},removeScheduleTask:function(f){var $=this,i=$._29Q,d=i.indexOf(f);d>=0&&i.splice(d,1),i.length||$._30Q==O||(m.cancelAnimationFrame($._30Q),delete $._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(J){this._historyManager||new Y.HistoryManager(this),null!=J&&this._historyManager.setMaxHistoryCount(J),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(z){this._historyManager&&this._historyManager.undo(z)},redo:function(g){this._historyManager&&this._historyManager.redo(g)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(r){this._historyManager&&this._historyManager.addHistory(r)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(T){T?this._isDeserializing++:this._isDeserializing--}});var Yl=Y.SelectionModel=function(Y){var t=this;t._68O=ys,t._map={},t._73O=new zf,t._74I=new Cl,t._21I(Y)};ij("SelectionModel",L,{ms_fire:1,ms_dm:1,ms:function(n,t,S){this.addSelectionChangeListener(n,t,S)},ums:function(n,Q){this.removeSelectionChangeListener(n,Q)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Li},co:function(J){return this._map[J._id]!=O},ss:function(V){this.setSelection(V)},as:function(m){this.appendSelection(m)},rs:function(W){this.removeSelection(W)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(t){var z=this;if(z._68O!==t&&(t===Jj||t===Li||t===ys)){z.cs();var O=z._68O;z._68O=t,z.fp("selectionMode",O,t)}},_21I:function(p){var Y=this,S=Y._dataModel;S!==p&&(S&&(Y.cs(),S.umm(Y.handleDataModelChange,Y)),Y._dataModel=p,p.mm(Y.handleDataModelChange,Y,!0),Y.fp(Rp,S,p))},dispose:function(){var z=this;z.cs(),z._dataModel.umm(z.handleDataModelChange,z)},handleDataModelChange:function(g){var b=this;if(g.kind===Mp){var J=g.data;b.co(J)&&(b._73O.remove(J),delete b._map[J._id],b._75I(Mp,new zf(J)))}else g.kind===zq&&b.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(f){var n=this;if(n._filterFunc!==f){n.cs();var F=n._filterFunc;n._filterFunc=f,n.fp("filterFunc",F,n._filterFunc)}},_75I:function(X,$,B,A){B&&(this._73O.each(function(E){A[E._id]?B.remove(E):B.add(E)}),$=B.toList()),this._74I.fire({kind:X,datas:new zf($)})},addSelectionChangeListener:function(f,s,q){this._74I.add(f,s,q)},removeSelectionChangeListener:function(K,$){this._74I.remove(K,$)},_97O:function(X,r){for(var E,T=this,W=0,w=new zf(X);W<w.size();W++)E=w.get(W),(T._filterFunc&&!T._filterFunc(E)||r&&T.co(E)||!r&&!T.co(E)||!T._dataModel.contains(E))&&(w.removeAt(W),W--);return w},appendSelection:function(Y){var C=this;if(C._68O!==Jj){var U,o,X=C._73O,T=C._97O(Y,!0);T.isEmpty()||(C.sg()&&(U=new zf(X),o=C._map,X.clear(),C._map={},T=new zf(T.get(T.size()-1))),T.each(function(Z){X.add(Z),C._map[Z._id]=Z}),C._75I("append",T,U,o))}},removeSelection:function(m){var G=this,r=G._97O(m),W=0,o=r.size();if(0!==o){for(;o>W;W++){var x=r.get(W);G._73O.remove(x),delete G._map[x._id]}G._75I(Mp,r)}},toSelection:function(g,w){return this._73O.toList(g,w)},getSelection:function(){return this._73O},each:function(C,J){this._73O.each(C,J)},setSelection:function(d){var G=this,e=G._73O;if(G._68O!==Jj&&!(e.isEmpty()&&!d||1===e.size()&&G.ld()===d)){var Q=new zf(e),B=G._map;e.clear(),G._map={};var v=G._97O(d,!0);G.sg()&&v.size()>1&&(v=new zf(v.get(v.size()-1))),v.each(function(j){e.add(j),G._map[j._id]=j}),G._75I("set",O,Q,B)}},clearSelection:function(){var O=this,i=O._73O;if(i.size()>0){var L=i.toList();i.clear(),O._map={},O._75I(zq,L)}},selectAll:function(){var z=this;if(z._68O!==Jj){var W,A,g=z._dataModel.toDatas();if(z._filterFunc)for(W=0;W<g.size();W++)A=g.get(W),z._filterFunc(A)||(g.removeAt(W),W--);var w=z._73O,k=new zf(w),q=z._map;w.clear(),z._map={},z.sg()&&g.size()>1&&(g=new zf(g.get(g.size()-1)));var u=g.size();for(W=0;u>W;W++)A=g.get(W),w.add(A),z._map[A._id]=A;z._75I("all",O,k,q)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(U){return this._map[U._id]!=O},getLastData:function(){var t=this._73O;return t.size()>0?t.get(t.size()-1):O},getFirstData:function(){var e=this._73O;return e.size()>0?e.get(0):O},isSelectable:function(s){var A=this;return s&&A._68O!==Jj?A._filterFunc?A._filterFunc(s):!0:!1},getTopSelection:function(){var S=this,s=new zf;return S._73O.each(function($){for(var l=$.getParent();l;){if(S.contains(l)){$=O;break}l=l.parent}$&&s.add($)}),s}});var Hq=function(){return Ki(0),function(q,W){var I;if(Yn(W)){var k=q.getDataUI(W);k&&k._88I&&(I=k._88I.rect)}return I?I:W.getRect()}}();Dq(j,{edgeGroupAgentFunc:O,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:R.rectSelectBorder,graphViewRectSelectBackground:kh,graphViewEditPointSize:Lr?17:7,graphViewEditPointBorderColor:R.editPointBorder,graphViewEditPointBackground:R.editPointBackground,setEdgeType:function(Y,S,z){Wb[Y]=S,Ce[Y]=z},getEdgeType:function(Y){return Wb[Y]},getEdgeTypeMap:function(){return Wb},getNodeRect:Hq},!0),Dq(v,{"layout.h":n,"layout.v":n,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":n,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:n,ingroup:!0,"body.color":n,"2d.gray":!1,fullscreen:n,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:n,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Tr,"select.width":1,"select.padding":2,"select.type":Dl,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Tr,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":n,"border.width":2,"border.padding":2,"border.type":Dl,label:n,"label.font":n,"label.color":zl,"label.background":n,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":n,"label.max":n,"label.opacity":n,"label.scale":1,"label.align":n,"label.selectable":!0,label2:n,"label2.font":n,"label2.color":zl,"label2.background":n,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":n,"label2.max":n,"label2.opacity":n,"label2.scale":1,"label2.align":n,"label2.selectable":!0,note:n,"note.expanded":!0,"note.font":n,"note.color":$j,"note.background":Tr,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":n,"note.toggleable":!0,"note.border.width":1,"note.border.color":n,"note.opacity":n,"note.scale":1,"note.align":n,note2:n,"note2.expanded":!0,"note2.font":n,"note2.color":$j,"note2.background":Tr,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":n,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":n,"note2.opacity":n,"note2.scale":1,"note2.align":n,"group.type":n,"group.image":n,"group.image.stretch":"fill","group.repeat.image":n,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":n,"group.title.color":$j,"group.title.background":R.groupTitleBackground,"group.title.align":dj,"group.title.orientation":nh,"group.background":R.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":n,"group.border.color":Pb,"group.border.radius":n,"group.border.cap":Ae,"group.border.join":gr,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":O,"group.gradient.color":"#FFF",shape:n,"shape.background":Pb,"shape.repeat.image":n,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Pb,"shape.border.3d":!1,"shape.border.3d.color":n,"shape.border.3d.accuracy":n,"shape.border.cap":Ae,"shape.border.join":gr,"shape.border.pattern":n,"shape.gradient":O,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":as,"shape.dash.offset":0,"shape.dash.color":Mh,"shape.dash.width":n,"shape.dash.3d":!1,"shape.dash.3d.color":n,"shape.dash.3d.accuracy":n,"shape.polygon.side":6,"shape.arc.from":t,"shape.arc.to":A,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":n,"shape.gradient.pack":n,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":n,"shape.foreground.gradient":O,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":n,"autolayout.hgap":n,"autolayout.vgap":n,"edge.type":n,"edge.points":n,"edge.segments":n,"edge.color":Pb,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":n,"edge.3d.accuracy":n,"edge.cap":Ae,"edge.join":gr,"edge.source.position":17,"edge.source.anchor.x":n,"edge.source.anchor.y":n,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":n,"edge.target.anchor.y":n,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":n,"edge.dash":!1,"edge.dash.pattern":as,"edge.dash.offset":0,"edge.dash.color":Mh,"edge.dash.width":n,"edge.dash.3d":!1,"edge.dash.3d.color":n,"edge.dash.3d.accuracy":n,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":n,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":n,"grid.column.percents":n,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":R.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":R.gridCellBorderColor,"grid.block":n,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":R.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":zl,"text.font":Go,"text.shadow":!1,"text.shadow.color":Tr,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Dq(Dr,{_76I:function(b,a,G){this._39I&&this._39I.fire({data:b,oldIndex:a,newIndex:G})},addIndexChangeListener:function(L,w,A){var P=this;P._39I||(P._39I=new Cl),P._39I.add(L,w,A)},removeIndexChangeListener:function(J,l){this._39I.remove(J,l)},prepareRemove:function(n){_n(n)&&(n.setSource(O),n.setTarget(O)),n._70O&&n._70O.toList().each(this.remove,this),n._69O&&n._69O.toList().each(function(Z){Z.setHost(O)}),n._host&&n.setHost(O)},onAdded:function(J){this.isAutoAdjustIndex()&&this.adjustIndex(J)},onDataPropertyChanged:function(T,M){Rq[M.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(T)},isAdjustable:function(n){return De(n)||_n(n)},isAdjustedToBottom:function(Q){return mh(Q)?Q.isExpanded()&&sk(Q):!1},adjustIndex:function(M){var F=this;this.isHierarchicalRendering()||(F.isAdjustedToBottom(M)?(F.sendToBottom(M),M.eachChild(F.adjustIndex,F)):F.sendToTop(M))},sendToTop:function(Y){var w=this;if(w.contains(Y)&&w.isAdjustable(Y)){var y=w._datas;if(Y!==y.get(w.size()-1)){var V=y.indexOf(Y);y.removeAt(V),y.add(Y),w._76I(Y,V,w.size()-1)}if(_n(Y)){var N=Y._40I;N&&!w.isAdjustedToBottom(N)&&w.sendToTop(N),N=Y._41I,N&&!w.isAdjustedToBottom(N)&&w.sendToTop(N)}Y._69O&&Y._69O.each(function(f){f.isRelatedTo(Y)||De(Y)&&f.isLoopedHostOn(Y)||w.sendToTop(f)}),Y.ISubGraph||(!mh(Y)||Y.isExpanded())&&Y._adjustChildrenToTop&&Y.eachChild(function(N){_n(N)||w.sendToTop(N)})}},sendToBottom:function(y,B){var b=this;if(y!==B&&b.contains(y)&&b.isAdjustable(y)&&(!B||b.contains(B))){var u=b._datas,U=u.remove(y),X=B?b._datas.indexOf(B):0;if(u.add(y,X),U!==X){b._76I(y,U,X);var N=y._parent;!N||N.ISubGraph||_n(N)||b.sendToBottom(y._parent,y)}}}}),Dq(pc,{ms_edit:function(v){v._46O=function(l){var Q=this,M=Q.gv.dm(),s=Q._index,L=Q._89I,u=Q._node,C=Q._shape,F=Q._edge,f=Q._77I;u&&L?(this.fi({kind:"endEditRect",event:l,data:u,direction:L}),M.endTransaction()):C&&s>=0?(Q.fi({kind:"endEditPoint",event:l,data:C,index:s}),M.endTransaction()):F&&s>=0?(Q.fi({kind:"endEditPoint",event:l,data:F,index:s}),M.endTransaction()):f&&(Q.fi({kind:"endEditRotation",event:l,data:f}),M.endTransaction())},v._78I=function(X){var L=this;L.autoScroll(X);var d=L.gv.lp(X),A=L._index,m=L._89I,p=L._node,V=L._shape,f=L._edge,n=L._77I;if(p&&m)L._80O(d),L.fi({kind:"betweenEditRect",event:X,data:p,direction:m});else if(V&&A>=0)d.e=V.getPoints().get(A).e,V.setPoint(A,d),L.fi({kind:"betweenEditPoint",event:X,data:V,index:A});else if(f&&A>=0){var $=f.s(tn);d.e=$.get(A).e,$.set(A,d),f.fp(tn,O,$),L.fi({kind:"betweenEditPoint",event:X,data:f,index:A})}else if(n){var z=n.p(),x=n.getScale(),u=M+E(d.y-z.y,d.x-z.x);x.y<0&&(u+=t),w(u)<.04&&(u=0),n.setRotation(u),L.fi({kind:"betweenEditRotation",event:X,data:n})}},v._80O=function(e){var y=this,t=y._node,T=y._rect,P=T.x,Z=T.y,B=T.width,k=T.height,A=y._89I,_=y._anchor,z=y._matrix,e=z.tfi(e);"northwest"===A?T=pr(e,{x:P+B,y:Z+k}):A===Fl?T=pr({x:P,y:e.y},{x:P+B,y:Z+k}):"northeast"===A?T=pr({x:P,y:e.y},{x:e.x,y:Z+k}):A===tr?T=pr({x:e.x,y:Z},{x:P+B,y:Z+k}):A===lk?T=pr({x:P,y:Z},{x:e.x,y:Z+k}):"southwest"===A?T=pr({x:e.x,y:Z},{x:P+B,y:e.y}):"south"===A?T=pr({x:P,y:Z},{x:P+B,y:e.y}):"southeast"===A&&(T=pr({x:P,y:Z},e)),t.setPosition(z.tf(T.x+T.width*_.x,T.y+T.height*_.y)),t.setWidth(T.width),t.setHeight(T.height)},v._80I=function(l,S,U,t){var G=this,P=G.gv._zoom,n=(G.gv.getEditPointSize()+2)/P;return Mg({x:S-n/2,y:U-n/2,width:n,height:n},l)?(G._89I!==t&&(G._89I=t),!0):!1},v._79I=function(L,I,z){var l=this,G=l.gv,J=I?G.getDataUI(I):O,C=J?J._55O:O;if(C){var g,q,x,$,S=G._zoom,k=(G.getEditPointSize()+2)/S,F=G.lp(L);if(De(I)){if(C._56O&&De(I)&&(q=C._98o,Mg({x:q.x-k/2,y:q.y-k/2,width:k,height:k},F)))return l._77I=I,z&&l.fi({kind:"beginEditRotation",event:L,data:I}),l.setCursor("crosshair"),!0;if(C._43O&&I instanceof Ll)for(x=I.getPoints(),g=x.size()-1;g>=0;g--)if(q=x.get(g),Mg({x:q.x-k/2,y:q.y-k/2,width:k,height:k},F))return l._index=g,l._shape=I,z&&l.fi({kind:"beginEditPoint",event:L,data:I,index:g}),l.setCursor("crosshair"),!0;if(C._42O)for(var T=I.getEditControlPoints(),D=["northwest",-1,-1,tr,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,lk,1,0,"northeast",1,-1,Fl,0,-1],g=0,$=T.length;$>g;g++){var Q=D[3*g],P=T[g];if(l._80I(F,P.x,P.y,Q)){l._node=I;var v=I.getWidth(),r=I.getHeight(),h=I.getAnchor();l._rect={x:-v*h.x,y:-r*h.y,width:v,height:r},l._anchor=h,l._matrix=I.getMatrix();var Y=I.getRotation(),e=c(Y),Z=N(Y),a=D[3*g+1]*uf(I.getScale().x),u=D[3*g+2]*uf(I.getScale().y),t=Math.atan2(-Z*a-e*u,e*a-Z*u),o=(Math.round(t/(Math.PI/4))+8)%8,X=[gp,"nesw-resize",Md,"nwse-resize",gp,"nesw-resize",Md,"nwse-resize"][o];return l.setCursor(X),z&&l.fi({kind:"beginEditRect",event:L,data:I,direction:l._89I}),!0}}}if(C._43O&&_n(I)&&I.s(Jq)===Nj&&(x=I.s(tn)))for(g=x.size()-1;g>=0;g--)if(q=x.get(g),Mg({x:q.x-k/2,y:q.y-k/2,width:k,height:k},F))return l._index=g,l._edge=I,z&&l.fi({kind:"beginEditPoint",event:L,data:I,index:g}),l.setCursor("crosshair"),!0}return!1}},ms_gv:function(X){X._currentSubGraph=O,X._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},X.upSubGraph=function(){this.setCurrentSubGraph(Gr(this._currentSubGraph))},X.isVisible=function(n){var W=this;if(Gr(n)!==W._currentSubGraph)return!1;if(_n(n)){var O=n._40I,M=n._41I;if(!O||!M)return!1;if(!(n.s("edge.independent")||W.isVisible(O)&&W.isVisible(M)))return!1;if(n.isEdgeGroupHidden())return!1}else for(var e=n._parent;e&&!e.ISubGraph;){if(mh(e)&&(!e.isExpanded()||!W.isVisible(e)))return!1;e=e._parent}if(n._parent instanceof nk&&!W.isVisible(n._parent))return!1;if(n._refGraph instanceof Wo&&!W.isVisible(n._refGraph))return!1;if(W instanceof bf){if(!n.s("3d.visible"))return!1}else{var f=W.getLayersInfo();if(f){var $=f[n._layer];if($&&$.visible===!1)return!1}if(!n.s("2d.visible"))return!1}return W._visibleFunc?W._visibleFunc(n):!0},X.handleSelectionChange=function(Z){var x=this;Z.datas.each(function(i){x.invalidateData(i);var h=i._parent;mh(h)&&De(i)&&i.s(sp)&&(x.invalidateData(h),h._49I&&h._49I.each(function(_){x.invalidateData(_)}))}),x.onSelectionChanged(Z)},X.onSelectionChanged=function(H){var d=this,F=d.sm();if(1===F.size()&&("set"===H.kind||"append"===H.kind)){var Z=F.ld();d.isAutoMakeVisible()&&d.makeVisible(Z),d.adjustIndex&&d._dataModel.isAutoAdjustIndex()&&d.adjustIndex(Z)}},X.makeVisible=function(g){if(g){var l=this,j=l.getDataUI?l.getDataUI(g):l.getData3dUI(g);if(j){var R=g,G=Gr(g);for(G!==l._currentSubGraph&&l.setCurrentSubGraph(G);(R=R._parent)&&R!==G;)mh(R)&&R.setExpanded(!0);l._23I=g,l.iv()}}},X.getLabel=function(k){var s=k.getStyle(Tk);return s===n?k.getName():s},X.getLabelBackground=function(A){return A.getStyle("label.background")},X.getLabelColor=function(_){return _.getStyle("label.color")},X.getLabel2=function(m){return m.getStyle("label2")},X.getLabel2Background=function(Y){return Y.getStyle("label2.background")},X.getLabel2Color=function(T){return T.getStyle("label2.color")},X.getNote=function(S){return S.getStyle(Fb)},X.getNoteBackground=function(Z){return Z.getStyle("note.background")},X.getNote2=function(V){return V.getStyle(mb)},X.getNote2Background=function(E){return E.getStyle("note2.background")},X.handleClick=function(K,D,p){var x=this;D?(x.fi({kind:"clickData",event:K,data:D,part:p}),x.onDataClicked(D,K)):(x.fi({kind:"clickBackground",event:K}),x.onBackgroundClicked(K))},X.handleDoubleClick=function(z,P,B){var e=this;mg(z)&&(P?(e.fi({kind:"doubleClickData",event:z,data:P,part:B}),e.onDataDoubleClicked(P,z,B),e.checkDoubleClickOnNote(z,P,B)||e.checkDoubleClickOnRotation&&e.checkDoubleClickOnRotation(z,P,B)||(_n(P)?e.onEdgeDoubleClicked(P,z,B):P.ISubGraph?e.onSubGraphDoubleClicked(P,z,B):mh(P)?e.onGroupDoubleClicked(P,z,B):P.IDoorWindow?e.onDoorWindowDoubleClicked(P,z,B):P.ICSGBox&&e.onCSGBoxDoubleClicked(P,z,B))):(e.fi({kind:"doubleClickBackground",event:z}),e.onBackgroundDoubleClicked(z)))},X.onSubGraphDoubleClicked=function(m){this.setCurrentSubGraph(m)},X.onEdgeDoubleClicked=function(g,D){this.isEditable(g)||(g.ISubGraph&&!_e(D)?this.setCurrentSubGraph(g):g.s("edge.toggleable")&&g.toggle())},X._39Q=function(e){return this.isInteractive(e)?this.preventDefaultWhenInteractive(e):!1},X.preventDefaultWhenInteractive=function(h){return h.s("preventDefaultWhenInteractive")},X.onGroupDoubleClicked=function(Q){Q.s("group.toggleable")&&Q.toggle()},X.onDoorWindowDoubleClicked=function(o){o.s("dw.toggleable")&&o.toggle(!0)},X.onCSGBoxDoubleClicked=function(Q,w){var d=this;if(d instanceof bf){var N=d.getHitFaceInfo(w);N&&N.face&&Q.s(N.face+".toggleable")&&Q.toggleFace(N.face,!0)}},X.onBackgroundClicked=function(){},X.onBackgroundDoubleClicked=function(){this.upSubGraph()},X.onDataClicked=function(){},X.onDataDoubleClicked=function(){},X.onAutoLayoutEnded=function(){},X.onMoveEnded=function(){},X.onPanEnded=function(){},X.onPinchEnded=function(){},X.onRectSelectEnded=function(){},X.onZoomEnded=function(){},X.serialize=function(Z){return this.dm().serialize(Z)},X.toJSON=function(){return this.dm().toJSON()},X.deserialize=function(K,A){var p=this;A=A instanceof Jh?{rootParent:A}:Hi(A)?{setId:A}:er(A)?{finishFunc:A}:A||{},A.view=p;var F=p.dm();return A.__innerHandler__=function(i){if(Hi(F.a("toolTipEnable"))&&(F.a("toolTipEnable")?p.enableToolTip():p.disableToolTip()),p instanceof Y.graph.GraphView&&(Hi(F.a("zoomable"))&&p.setZoomable&&p.setZoomable(F.a("zoomable")),Hi(F.a("pannable"))&&p.setPannable&&p.setPannable(F.a("pannable")),Hi(F.a("rectSelectable"))&&p.setRectSelectable&&p.setRectSelectable(F.a("rectSelectable")),F.a("fitContent")===!0&&p.fitContent&&p.fitContent(!0,0)),p instanceof Y.graph3d.Graph3dView){var z=i.scene;z&&z.batchInfoMap&&j.setBatchInfoMap(z.batchInfoMap);var D=F.a("sceneContext");D?(D.eye&&p.setEye(D.eye),D.center&&p.setCenter(D.center),Sd(D.far)&&p.setFar(D.far),Sd(D.near)&&p.setNear(D.near)):(Sd(F.a("sceneNear"))&&p.setNear(F.a("sceneNear")),Sd(F.a("sceneFar"))&&p.setFar(F.a("sceneFar")),z&&(z.eye&&p.setEye(z.eye),z.center&&p.setCenter(z.center))),Hi(F.a("sceneDashEnable"))&&p.setDashDisabled(!F.a("sceneDashEnable")),xh(F.a("sceneHighlightMode"))&&p.setHighlightMode(F.a("sceneHighlightMode")),Sd(F.a("sceneHighlightWidth"))&&p.setHighlightWidth(F.a("sceneHighlightWidth")),F.a("sceneHighlightColor")&&p.setHighlightColor(F.a("sceneHighlightColor")),Hi(F.a("sceneHeadlightEnable"))&&p.setHeadlightDisabled(!F.a("sceneHeadlightEnable")),Sd(F.a("sceneHeadlightRange"))&&p.setHeadlightRange(F.a("sceneHeadlightRange")),F.a("sceneHeadlightColor")&&p.setHeadlightColor(F.a("sceneHeadlightColor")),Sd(F.a("sceneHeadlightIntensity"))&&p.setHeadlightIntensity(F.a("sceneHeadlightIntensity")),Sd(F.a("sceneHeadlightAmbientIntensity"))&&p.setHeadlightAmbientIntensity(F.a("sceneHeadlightAmbientIntensity")),Hi(F.a("sceneFogEnable"))&&p.setFogDisabled(!F.a("sceneFogEnable")),F.a("sceneFogColor")&&p.setFogColor(F.a("sceneFogColor")),Sd(F.a("sceneFogNear"))&&p.setFogNear(F.a("sceneFogNear")),Sd(F.a("sceneFogFar"))&&p.setFogFar(F.a("sceneFogFar")),Hi(F.a("sceneBatchBrightnessDisabled"))&&p.setBatchBrightnessDisabled(F.a("sceneBatchBrightnessDisabled")),Hi(F.a("sceneBatchBlendDisabled"))&&p.setBatchBlendDisabled(F.a("sceneBatchBlendDisabled")),Hi(F.a("sceneBatchColorDisabled"))&&p.setBatchColorDisabled(F.a("sceneBatchColorDisabled"))}},F.deserialize(K,A.rootParent,A)},X.isDebugTipShowing=function(){return!!this._debugDiv},X.showDebugTip=function(){var S=this,T=S._debugDiv;if(!T){T=S._debugDiv=d.createElement("div"),T.style.position="absolute",T.style.overflow="hidden",T.style.font=j.debugTipLabelFont,T.style.padding="6px",T.style.backgroundColor=j.debugTipBackground,T.style.color=j.debugTipLabelColor;var f=S.getView();S._79O?f.insertBefore(T,S._79O):f.appendChild(T);var n=function(){S.redraw();var u=S._canvas,W="FPS: "+S._fpsInfo.fps+"<br/>"+"Datas: "+S.dm().getDatas().length+(u?"<br/>Size: "+u.width+" * "+u.height:""),_=S.dm()._historyManager;_&&(W+="<br/>Undoes: "+_.getHistories().length+" index: "+_.getHistoryIndex());var m=S.getDebugTip();m&&(W+="<hr>"+m),T.innerHTML=W,S._isDebugging&&requestAnimationFrame(n)};requestAnimationFrame(n),S._isDebugging=!0}},X.hideDebugTip=function(){var m=this,i=m._debugDiv;i&&(delete m._debugDiv,m.getView().removeChild(i),m._isDebugging=!1)},X.updateDOMAppendMatrix=function(){var U=this.getView();U&&(U.updateAppendMatrix=!0)},X.countFrame=function(){if(this._isDebugging){var Q=Date.now(),z=this._fpsInfo;Q-z.time>1e3?(z.fps=Math.round(1e5*(z.frames+1)/(Q-z.time))/100,z.time=Q,z.frames=0):z.frames++}}},ms_icons:function($){$.getRotation=function(L){return L==O?0:L},$._15O=function(){var m=this,Z=m.s(sq);if(Z){var D=m,K=m.data||m._data,P=m._38o={icons:Z,rects:{}};for(var N in Z){var C=Z[N],X=lc(C.shape3d,K,D);if(!(lc(C.visible,K,D)===!1||lc(C.for3d,K,D)&&!m.I3d||X&&!m.I3d)){var g=X?[X]:lc(C.names,K,D),G=g?g.length:0,U=lc(C.position,K,D)||3,$=lc(C.offsetX,K,D)||0,E=lc(C.offsetY,K,D)||0,A=lc(C.direction,K,D)||lk,h=lc(C.gap,K,D),V=h!=O?h:1,w=lc(C.rotation,K,D),k=lc(C.keepOrien,K,D),M=lc(C.rotationFixed,K,D)?w:m.getRotation(w,k,U),F=O,u=P.rects[N]=new Array(G);u.rotation=M;for(var s=0;G>s;s++){var Y,o,y,W,b=g[s];if(X)y=0,W=0;else{var I=co(b);y=lc(C.width,K,D),W=lc(C.height,K,D),y==O&&(y=Ne(I,K)),W==O&&(W=Jf(I,K))}if(F?A===lk?$+=y/2:A===tr?$-=y/2:A===Fl?E-=W/2:E+=W/2:F={width:y,height:W},m.I3d){var e=-y/2,T=-W/2;o={width:y,height:W,mat:m._16O(lc(C.autorotate,K,D),U,F,lc(C.face,K,D)||pj,lc(C.t3,K,D),lc(C.r3,K,D),lc(C.rotationMode,K,D),$,E),vs:new Ln([e,-T,0,e,-T-W,0,e+y,-T-W,0,e+y,-T,0])}}else Y=m.getPosition(U,$,E,F,lc(C.positionFixed,K,D)),o={x:Y.x-y/2,y:Y.y-W/2,width:y,height:W},m._68o(o,M);u[s]=o,A===lk?$+=y/2+V:A===tr?$-=y/2+V:A===Fl?E-=W/2+V:E+=W/2+V}}}}}}});var he={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},ho={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Jk={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Rq={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},fg={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Pc={"edge.type":1,"edge.group":1},po={rotation:1,rotationX:1,rotationZ:1},Ad={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},en={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Gb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Ek={shape:1,thickness:1,position:1,anchor:1,scale:1},Gr=function(w){if(!w)return O;if(_n(w)){var v=w._40I,y=w._41I;if(!v||!y)return O;var a=Gr(v),U=Gr(y);return a===U?a:O}for(var G=w._parent;_n(G)&&!G.ISubGraph;)G=G._parent;return G?G.ISubGraph?G:Gr(G):O},qj=function(w,J,L,d){var g=J.getStyle(L)*d;g&&gn(w,g),g=J.getStyle(L+".left")*d,g&&(w.x-=g,w.width+=g),g=J.getStyle(L+".right")*d,g&&(w.width+=g),g=J.getStyle(L+".top")*d,g&&(w.y-=g,w.height+=g),g=J.getStyle(L+".bottom")*d,g&&(w.height+=g),w.width<0&&(w.width=-w.width,w.x-=w.width),w.height<0&&(w.height=-w.height,w.y-=w.height)},sk=function(Q){for(var e,I=0,r=Q.size();r>I;I++)if(e=Q.getChildAt(I),De(e)&&sk(e))return!0;return Q.hasAgentEdges()},ec=function(j){if(!j)return O;for(var h=j._parent;mh(h);){if(!mh(h._parent))return h.isExpanded()?j:h;h.isExpanded()||(j=h),h=h._parent}return j},oi=function(Z,c){if(!Z||!c)return O;var p,d,a,y=Gr(Z),H=Gr(c);if(y!==H){for(;H&&y!==H;)H=Gr(H);if(y===H)return Z;p=new zf,p.add(Z,0);for(var o=Z._parent;De(o)&&!c.isDescendantOf(o);)p.add(o,0),o=o._parent;for(a=p.size(),d=0;a>d;d++){var r=p.get(d);if(mh(r)&&!r.isExpanded())return r;if(r.ISubGraph)return r}return Z}return Z},Dp=function(j){if(j.isLooped())return j._source;var e=ec(j._source),X=ec(j._target);return e===X?j._source:oi(e,X)},Kk=function(A){if(A.isLooped())return A._target;var x=ec(A._source),l=ec(A._target);return x===l?A._target:oi(l,x)},Ui=function(d,R,F){"target"!==F&&(F="source");var r="target"===F?R.getTargetAgent():R.getSourceAgent(),k="edge."+F+".";if(_n(r)){var C=d.getDataUI(r);C._79o();var j=R.s(k+"index");if(j>=0){var X=us(C);return X[Math.max(0,Math.min(j,X.length-1))]}var M=R.s(k+"percent")||0;M=Math.max(0,Math.min(M,1));var G=Tq(C);return Nd(G,100*M)}return xn(d,r,R.s(k+"position"),R.s(k+"offset.x"),R.s(k+"offset.y"),R.s(k+"anchor.x"),R.s(k+"anchor.y"))},xn=function(P,T,C,t,L,m,U){if(!T)return O;var y,I=T.getRotation?T.getRotation():0;if(m!==n||U!==n){m=m===n?.5:m,U=U===n?.5:U;var H=T.getScale();if(I&&!Yn(T,P)||H.x<0||H.y<0){var l=T.getPosition(),j=T.getWidth(),k=T.getHeight(),R=T.getAnchor(),u=new eg(I,l.x,l.y,H.x,H.y);C=u.tf((m-R.x)*j,(U-R.y)*k)}else y=Hq(P,T),C={x:y.x+m*y.width,y:y.y+U*y.height}}else C=Ke(C,Hq(P,T));if(I){var i=c(I),X=N(I),Q=t*i-L*X;L=t*X+L*i,t=Q}return C.x+=t,C.y+=L,C},Pe=function(D,Q){if(!D||!Q)return O;var f,k,b,K,B,j;if(D===Q){if(K=D.getLoopedEdges(),!K)return O;K=new zf(K)}else{if(B=D.getAgentEdges(),j=Q.getAgentEdges(),!B||!j)return O;for(k=B.size(),f=0;k>f;f++)b=B.get(f),j.contains(b)&&(K||(K=new zf),K.add(b))}if(K)for(f=0;f<K.size();f++)b=K.get(f),b.getStyle(Jq)===Nj&&(b._22I(O),K.removeAt(f),f--);return K},ff=function(V,b){var x=Pe(V,b);if(x&&!x.isEmpty()){if(1===x.size())return x.get(0)._22I(O),void 0;var d=new zf,w=new zf;x.each(function(g){var M=g.s("edge.group");d.contains(M)||d.add(M)}),d.sort(),d.each(function(k){w.add(new Y.EdgeGroup(x.toList(function(q){return k===q.s("edge.group")}),w))}),w.each(function(A){A.each(function(I){I._22I(A)})})}},xf=function(c,C,t){var _=c._canvas;c._zoom;var w=jn(C,_),I=jn(t,_);return{x:w.x-I.x,y:w.y-I.y}},Fr=function(n,u){if(u){var S=u.rect,h=u.color,R=u.rotation,q=u.labelWidth,G=u.background,o=u.opacity,s=u.scale,B=s!=O&&1!==s;if(o!=O){var H=n.globalAlpha;n.globalAlpha*=o}if(R||B){n.save();var j=S.x+S.width/2,f=S.y+S.height/2;cl(n,j,f),R&&gc(n,R),B&&n.scale(s,s),cl(n,-j,-f)}if(G&&hd(n,S.x,S.y,S.width,S.height,G),q){var Z=S.width,W=n.createLinearGradient(S.x,S.y,S.x+Z,S.y);W.addColorStop(0,h),W.addColorStop(.9,h),W.addColorStop(1,lb),h=W,S.width=q}Lc(n,u.ss,S,u.font,h,u.align),q&&(S.width=Z),(R||B)&&n.restore(),o!=O&&(n.globalAlpha=H)}},Nq=function(x,V){if(V){var r=V.rect,G=r.x,L=r.y,W=r.width,H=r.height,j=V.background,K=V.backgroundImage,Z=V.borderWidth,o=V.borderColor,S=V.labelWidth,d=V.opacity,a=V.scale,P=a!=O&&1!==a;if(d!=O){var X=x.globalAlpha;x.globalAlpha*=d}if(P){x.save();var T=r.x+r.width/2,Q=r.y+r.height/2;cl(x,T,Q),x.scale(a,a),cl(x,-T,-Q)}if(V.expanded){var J=u(8,W/4),I=L+H-8;if(x.fillStyle=j,x.beginPath(),x.moveTo(G,L),x.lineTo(G,I),x.lineTo(G+W/2,I),x.lineTo(G+W/2,L+H),x.lineTo(G+W/2+J,I),x.lineTo(G+W,I),x.lineTo(G+W,L),x.closePath(),x.fill(),Z&&(x.lineWidth=Z,x.lineJoin="round",x.lineCap="round",o?(x.strokeStyle=o,x.stroke()):(x.strokeStyle=uo(j),x.beginPath(),x.moveTo(G+W,L),x.lineTo(G+W,I),x.lineTo(G+W/2+J,I),x.lineTo(G+W/2,L+H),x.stroke(),x.strokeStyle=Io(j),x.beginPath(),x.moveTo(G+W,L),x.lineTo(G,L),x.lineTo(G,I),x.lineTo(G+W/2,I),x.lineTo(G+W/2,L+H),x.stroke())),K)Dk(x,co(K),Wr,r.x,r.y,r.width,r.height-8,V.data,V.view);else{if(r.height-=8,j=V.color,S){var g=W,k=x.createLinearGradient(G,L,G+g,L);k.addColorStop(0,j),k.addColorStop(.9,j),k.addColorStop(1,lb),j=k,r.width=S}Lc(x,V.ss,r,V.font,j,V.align),S&&(r.width=g),r.height+=8}}else if(V.icon)vf(x,co(V.icon),G,L,W,H,V.data,V.view);else{var p=W/2;Z&&(x.lineWidth=Z,x.lineJoin="round",x.lineCap="round",x.strokeStyle=o?o:uo(j),x.beginPath(),x.arc(G+p,L+p,p,M,1.6*t,!0),x.moveTo(G+p,L+H),x.lineTo(G+W-p/5,L+p),x.stroke(),x.strokeStyle=o?o:Io(j),x.beginPath(),x.arc(G+p,L+p,p,1.6*t,M,!0),x.moveTo(G+p,L+H),x.lineTo(G+p/5,L+p),x.stroke()),x.fillStyle=j,x.beginPath(),x.arc(G+p,L+p,p,0,A,!0),x.moveTo(G+p,L+H),x.lineTo(G+W-p/5,L+p),x.lineTo(G+p/5,L+p),x.closePath(),x.fill(),x.fillStyle=V.color,x.beginPath(),x.arc(G+p,L+p,p/3,0,A,!0),x.fill()}P&&x.restore(),d!=O&&(x.globalAlpha=X)}},Ro=function(x,k){return k>2*x?x:k/2},jg=function(M,s,R,Q){if(!M||!s)return 0;var G=E(s.y-M.y,s.x-M.x);return R||(G=s.x<M.x?G+t:G),G+Q},dm=function(n,r,V,s,h,U,Q){Q&&(n.x>r.x||n.x===r.x&&n.y>r.y)&&(V=Uo[V],h=-h);var R=Ke(V,{x:0,y:0,width:rs(n,r),height:0},U);return R.x+=s,R.y+=h,R=new eg(E(r.y-n.y,r.x-n.x)).tf(R),R.x+=n.x,R.y+=n.y,R},Xh=function(R,N,d,u,H){if(R._19Q=!0,!d.getEdgeGroup())return u?d.s("edge.gap"):0;if(_n(d.getSourceAgent())||_n(d.getTargetAgent()))return 0;var U,b=0,m=0,T=0;if(d.getEdgeGroup().getSiblings().each(function($){$.each(function(P){if(N.isVisible(P)&&P.s(Jq)==H){var n=P.s("edge.gap");U?(m+=T/2+n/2,T=n):(U=P,T=n),P===d&&(b=m)}})}),u)return m-b+T;var t=b-m/2;return U&&d._40I!==U._40I&&(R._19Q=!1),t},wq=function(){var d=function(A){var r=[];return A.forEach(function(f){r.push({x:f.x,y:f.y}),r.push({x:f.x+f.width,y:f.y+f.height}),r.push({x:f.x+f.width,y:f.y}),r.push({x:f.x,y:f.y+f.height})
}),r};return function(D,V,F){if("oval"===D){var G=0,f=F.height/F.width,W=f*f,m=F.x+F.width/2,r=F.y+F.height/2,z=d(V);z.forEach(function(y){var Y=y.x-m,R=y.y-r,p=Y*Y+R*R/W;p>G&&(G=p)}),G=e(G);var $=f*G;return{x:m-G,y:r-$,width:2*G,height:2*$}}if("circle"===D){var C=0,m=F.x+F.width/2,r=F.y+F.height/2,z=d(V);return z.forEach(function(M){var h=M.x-m,R=M.y-r,Z=h*h+R*R;Z>C&&(C=Z)}),C=e(C),{x:m-C,y:r-C,width:2*C,height:2*C}}return"roundRect"===D?(gn(F,u(F.width,F.height)/16),F):F}}(),km=Y.graph={},wp=function(V,e,P){kk(F+".graph."+V,e,P)};Y.layout={};var Ld={},kc=function(o,f,U,k,S,u,G,J){var W=[f.uuid,Math.round(k),Math.round(S),U].join("_");f.cacheRule&&(W+=lc(f.cacheRule,u,G));var d=G._zoom;d!==G._cacheZoom&&(G._cacheZoom=d,G._cacheImage={}),d*=Vd;var M=G._cacheImage[W];return M||(pi(),M=Y.Default.toCanvas(f,Math.ceil(k*d),Math.ceil(S*d),U,u,G,J),rm()&&(G._cacheImage[W]=M)),M};Dq(j,{setImageCacheRule:function(J,g){var B;g||"object"!=typeof J?(B={},B[J]=g):B=J;for(var A in B){var U=B[A];xh(A)?(kk=co(A),kk?kk.cacheRule=U:Ld[A]=U):A.cacheRule=U}}});var Ik={comps:[{type:ml,points:[85,50,70,115,100,71,86,107,88,49,57,70,67,112,104,85,88,67,119,80,72,100,67,90,53,99,84,67,98,120,107,120,105,80,47,86,105,70,101,68,110,47,56,61],borderWidth:1,borderColor:O}]};if(Ik[Ml]=Ik[rj]=160,m.Image){var dh=new m.Image;dh.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",hm("default_blank",dh)}hm("node_image",Gg(30,30,[{type:Dl,rect:[4,5,22,16],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[2,3,26,20],borderWidth:1,borderColor:Pb},{type:Dl,rect:[11,23,8,4],background:Pb},{type:Dl,rect:[6,27,18,2],background:Pb}])),hm("node_icon",Gg(16,16,[{type:Dl,rect:[2,2,12,10],gradient:Cp,gradientColor:xb,background:Pb},{type:hc,rect:[2,2,12,10],width:1,color:Pb},{type:Dl,rect:[6,12,4,2],background:Pb},{type:Dl,rect:[4,14,8,1],background:Pb}])),hm("block_icon",Gg(16,16,[{type:hc,rect:[1,1,14,14],width:1,color:Pb}])),hm("group_image",Gg(66,39,[{type:Dl,rect:[44.3,18,18.1,12.8],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[3.3,17.8,18.1,12.8],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Pb,gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[26.2,29.4,12.8,4.2],background:Pb},{type:Dl,rect:[21.3,33.5,22.5,2.3],background:Pb},{type:Dl,rect:[5.3,32.7,14.1,2.1],background:Pb},{type:Dl,rect:[9,30.4,6.7,2.4],background:Pb},{type:Dl,rect:[50,30.7,6.7,2.4],background:Pb},{type:Dl,rect:[46.3,33,14.1,2.1],background:Pb}])),hm("group_icon",Gg(16,16,[{type:Dl,rect:[4,12,4,2],background:Pb},{type:Dl,rect:[2,13,8,1],background:Pb},{type:Dl,rect:[12,12,2,1],background:Pb},{type:Dl,rect:[11,13,4,1],background:Pb},{type:Dl,rect:[10,7,6,5],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[1,2,10,10],gradient:Cp,gradientColor:xb,background:Pb},{type:hc,rect:[1,2,10,10],width:1,color:Pb}])),hm("refGraph_icon",Gg(16,16,[{type:"shape",borderWidth:1,borderColor:Pb,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Pb,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),hm("edge_icon",Gg(16,16,[{type:Dl,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[10.8,1,4,4],background:Pb},{type:Dl,rect:[1,11,4,4],background:Pb}])),hm("subGraph_image",Gg(72,45,[{type:ml,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[29.6,30.7,3.6,1.8],background:Pb},{type:Dl,rect:[28.4,32.3,6,1.2],background:Pb},{type:Dl,rect:[37.3,32,10.8,1.8],background:Pb},{type:Dl,rect:[39.1,29.9,7.2,2.3],background:Pb},{type:Dl,rect:[26.6,23.7,9.6,7.2],gradient:Cp,gradientColor:xb,background:Pb},{type:Dl,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Pb,gradient:Cp,gradientColor:xb,background:Pb}])),hm("subGraph_icon",Gg(17,17,[{type:ml,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Cp,gradientColor:xb,background:Pb}])),hm("shape_icon",Gg(16,16,[{type:ml,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Pb}])),hm("polyline_icon",Gg(16,16,[{type:ml,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Pb},Qq(7.5,.4),Qq(7.5,6.3),Qq(13.6,6.3),Qq(13.6,14),Qq(.7,13.9),Qq(.7,.3)])),hm("grid_icon",Gg(16,16,[{type:Dl,rect:[1,1,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[6,1,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[11,1,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[11,6,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[6,6,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[1,6,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[11,11,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[6,11,4,4],background:Pb,gradient:Cp,gradientColor:xb},{type:Dl,rect:[1,11,4,4],background:Pb,gradient:Cp,gradientColor:xb}])),hm("light_icon",Gg(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Pb},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Pb,gradient:Cp,gradientColor:xb,background:{func:function(u){var A=u?u.s(Gn):O;return Hr(A)?"rgb("+I(255*A[0])+","+I(255*A[1])+","+I(255*A[2])+")":A||Pb}}}])),hm("text_icon",Gg(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Pb}])),hm("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),hm("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),hm("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),hm("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Di=function(t,B,l,d,E,p){var K,w,D,r,v,q,b,S,f,u,s,m=[];if(Math.abs(d)>2*Math.PI&&(d=2*Math.PI),v=Math.ceil(Math.abs(d)/(Math.PI/4)),K=d/v,w=-K,D=-l,v>0){q=t+Math.cos(l)*E,b=B+Math.sin(-l)*p,m.push({x:q,y:b});for(var T=0;v>T;T++)D+=w,r=D-w/2,S=t+Math.cos(D)*E,f=B+Math.sin(D)*p,u=t+Math.cos(r)*(E/Math.cos(w/2)),s=B+Math.sin(r)*(p/Math.cos(w/2)),m.push({x:u,y:s}),m.push({x:S,y:f})}return m},td=function(D){if(D){var M=D._data;if(M instanceof Y.Shape)return{points:M.getPoints(),segments:M.getSegments()};var a;if(M instanceof Y.Edge&&(a=D._78o)){var I,A,$=a.type,N=a.points,n=a.segments,t=a.edgeTypeInfo;if(!$||N){var c=a.sourcePoint,L=c.x,Z=c.y,H=a.targetPoint,b=H.x,V=H.y;if($)n?(I=new zf({x:L,y:Z}),I.addAll(N),I.add({x:b,y:V}),A=new zf(n._as)):(I=new zf({x:L,y:Z}),N.each(function(h){I.add(h)}),I.add({x:b,y:V}));else if(a.looped){I=new zf(Di(L,Z,0,2*Math.PI,a.radius,a.radius)),A=new zf([1]);for(var W=0;W<(I.size()-1)/2;W++)A.add(3)}else I=new zf,a.center?(I.add({x:a.c1.x,y:a.c1.y}),I.add({x:L,y:Z}),I.add({x:b,y:V}),I.add({x:a.c2.x,y:a.c2.y})):(I.add({x:L,y:Z}),I.add({x:b,y:V}))}else t&&(I=new zf(t.points._as),t.segments&&(A=new zf(t.segments._as)));return{points:I,segments:A}}}},Tq=function(D,e,p){if(null==e){var M=td(D);if(!M)return;e=M.points,p=M.segments}if(e){if(Array.isArray(e)&&(e=new zf(e)),"number"==typeof e.get(0)){for(var u=new Y.List,v=0;v<e.size();v+=2)u.add({x:e.get(v),y:e.get(v+1)});e=u}if(!p){p=[1];for(var S=e.length-1;S>0;S--)p.push(2)}Array.isArray(p)&&(p=new zf(p));for(var P=wj(e._as,p._as,50),d=P.length,V=[],v=0;d>v;v++){var s=P[v];s.length>1&&V.push(s)}return V}},Eq=function(L){for(var z=0,B=L.length-1,j=0;B>j;j++){var d=L[j],q=L[j+1],o=q.x-d.x,O=q.y-d.y;z+=Math.sqrt(o*o+O*O)}return z},Mb=function(m,Y){for(var $=0,E=Y.length,w=0;E>w;w++){var h=Y[w];if($+=h,$>m)return w}return Math.min(w,E-1)},Of=function(X,Y){for(var x=0,E=0,b=0,i=X.length-1,q=0;i>q;q++){var B=X[q],m=X[q+1],v=m.x-B.x,U=m.y-B.y;if(b=Math.sqrt(v*v+U*U),x+=b,x>Y){x-=b,E=q;break}}var u=X[E],e=X[E+1],L=Math.atan2(e.y-u.y,e.x-u.x),s=Y-x,U=Math.sin(L)*s,v=Math.cos(L)*s;return{x:u.x+v,y:u.y+U}},Nd=function(V,F){if(V){var B;if(0===F)B=V[0][0];else if(100===F)V=V[V.length-1],B=V[V.length-1];else{for(var s=0,w=[],u=V.length,l=0;u>l;l++){var o=V[l],E=Eq(o);s+=E,w.push(E)}for(var m=s*F/100,n=Mb(m,w),f=0,L=0;n>L;L++)f+=w[L];m-=f,B=Of(V[n],m)}return B}},us=function(o){var N,P,$,Q,g=td(o),O=[],p=g.points,X=g.segments,q=-1;for(P=0,$=X?X.length:p.length;$>P;P++){if(N=X?X.get(P):1,3===N)Q=2;else if(4===N)Q=3;else{if(5===N)continue;Q=1}q+=Q,O.push(p.get(q))}return O},ki=function(o,F,u,_){function R(P){if(P>=0&&1>=P){$=F(P);var Z=(o.x-$.x)*(o.x-$.x)+(o.y-$.y)*(o.y-$.y);return S>Z?(S=Z,A=P,!0):!1}}u=u||100,_=_||1e-5;for(var S=1/0,A=0,$=new _h,q=0;u>q;++q)R(q/u);for(var g=1/(2*u);g>_;)R(A-g)||R(A+g)||(g/=2);return A};Dq(j,{_edgeProtectMethod:{getStraightLinePoints:Tq,calculateLineLength:Eq,calcSegmentIndexByDistance:Mb,calculatePointAlongLine:Of,getPercentPosition:Nd,getRealPointsFromDataUI:us}});var df=function(I,y){for(var T=I.vertices,f=0;f<T.length;f++){var W=T[f],j=W.y;W.y=W.z,W.z=-j,y&&(W.y+=y)}},aq=function(G){for(var I,d,X,k,A,F,H=[],e=[],h=[],m=G.faces,u=0,W=0,O=0,j=m.length;j>u;u++,W+=6,O+=9){var Y=m[u];1===Y.i?(I||(I=[],d=[],X=[]),Sf(Y,u,W,O,G,I,X,d)):2===Y.i?(k||(k=[],A=[],F=[]),Sf(Y,u,W,O,G,k,F,A)):Sf(Y,u,W,O,G,H,h,e)}return{vs:H,uv:e,ns:h,top_vs:I,top_uv:d,top_ns:X,bottom_vs:k,bottom_uv:A,bottom_ns:F}},Sf=function(G,B,k,Z,y,z,_,a){var r=y.vertices,H=y.faceVertexUvs,$=r[G.a],N=r[G.b],S=r[G.c];z[Z]=$.x,z[Z+1]=$.y,z[Z+2]=$.z,z[Z+3]=N.x,z[Z+4]=N.y,z[Z+5]=N.z,z[Z+6]=S.x,z[Z+7]=S.y,z[Z+8]=S.z;var i=G.vertexNormals;if(3===i.length){var T=i[0],R=i[1],W=i[2];_[Z]=T.x,_[Z+1]=T.y,_[Z+2]=T.z,_[Z+3]=R.x,_[Z+4]=R.y,_[Z+5]=R.z,_[Z+6]=W.x,_[Z+7]=W.y,_[Z+8]=W.z}else{var e=G.normal;_[Z]=e.x,_[Z+1]=e.y,_[Z+2]=e.z,_[Z+3]=e.x,_[Z+4]=e.y,_[Z+5]=e.z,_[Z+6]=e.x,_[Z+7]=e.y,_[Z+8]=e.z}var m=H[0][B][0],X=H[0][B][1],D=H[0][B][2];a[k]=m.x,a[k+1]=m.y,a[k+2]=X.x,a[k+3]=X.y,a[k+4]=D.x,a[k+5]=D.y},ge=function(){function Z(P,r){return P.dot(r)>0}function S(l,I,r,_,V,j,z){for(var S,H,c=[I,r,_],t=[V,j,z],v=[],w=c.length,L=!0;w--&&L;){for(var Q=c[w],x=t.length,h=!1;x--;)if(Q.equals(t[x])){t.splice(x,1),v.push(Q),h=!0;break}if(!h){if(S){L=!1;break}S=Q}}return L&&2===v.length&&(H=t[0],p.subVectors(S,v[0]),$.subVectors(H,v[0]),i.subVectors(S,v[1]),p.x*i.y*$.z+i.x*$.y*p.z+$.x*p.y*i.z-$.x*i.y*p.z-$.y*i.z*p.x-$.z*i.x*p.y<1e-6&&(e.subVectors(H,v[1]),X.subVectors(v[1],v[0]),Z(X,p)&&Z(X,$)&&(X.negate(),Z(X,i)&&Z(X,e))))?(l.push(v[1].x,v[1].y,v[1].z),l.push(S.x,S.y,S.z),l.push(S.x,S.y,S.z),l.push(v[0].x,v[0].y,v[0].z),l.push(v[0].x,v[0].y,v[0].z),l.push(H.x,H.y,H.z),l.push(H.x,H.y,H.z),l.push(v[1].x,v[1].y,v[1].z),2):(l.push(I.x,I.y,I.z),l.push(r.x,r.y,r.z),l.push(r.x,r.y,r.z),l.push(_.x,_.y,_.z),l.push(_.x,_.y,_.z),l.push(I.x,I.y,I.z),1)}function A(){this._vertexMap={},this._lineMap={},this._lineList=[]}function z(Y,k,Q,v,z,Z,q){var n=[Q,z];Y[0]===v&&n.reverse();var J=[n[0]._key,n[1]._key].join("|"),u=Y._triangles[J];u||(Y._triangles[J]=u={});var W=[Z._key,q._key].join("|");u[W]||(u[W]=[Z,q])}function V(k,i,c){var q=k._planes[c._key];if(!q)for(var R in k._planes){var z=k._planes[R];if(z._normal.angleTo(c)<.001){q=z;break}}return q?(q._vertices.indexOf(i)<0&&q._vertices.push(i),void 0):(k._planes[c.key]={_normal:c,_vertices:[i]},void 0)}function H(A){var r=A._ctlineModel;if(r||(A._ctlineModel=r=[]),r[0])return r[0];var w;w=Hr(A)?A:[A];var m,s,W,Q,V,X,O,k,c,n,$,t,z,P,E,o,i,g,Z,x=["","top_","bottom_"];for(r=[],m=0,s=w.length;s>m;m++)if(n=w[m])for(Si(n),W=0,Q=x.length;Q>W;W++)if(c=n[x[W]+"lvs"])for(i=r.length,g=c.length,r.length=i+g,Z=0;g>Z;++Z,++i)r[i]=c[Z];else if(O=n[x[W]+"vs"]){k=n[x[W]+"is"],X=k?k.length:O.length/3;for(var V=0;X-1>V;)k?($=k[V],t=k[V+1],z=k[V+2],P=k[V+3],E=k[V+4],o=k[V+5]):($=V,t=V+1,z=V+2,P=V+3,E=V+4,o=V+5),y.fromArray(O,3*$),Y.fromArray(O,3*t),K.fromArray(O,3*z),d.fromArray(O,3*P),N.fromArray(O,3*E),B.fromArray(O,3*o),V+=3*S(r,y,Y,K,d,N,B);X>V&&(k?($=k[V],t=k[V+1],z=k[V+2]):($=V,t=V+1,z=V+2),y.fromArray(O,3*$),Y.fromArray(O,3*t),K.fromArray(O,3*z),r.push(y.x,y.y,y.z),r.push(Y.x,Y.y,Y.z),r.push(Y.x,Y.y,Y.z),r.push(K.x,K.y,K.z),r.push(K.x,K.y,K.z),r.push(y.x,y.y,y.z))}return A._ctlineModel[0]=r,r}function a(D){var H=D._ctlineModel;if(H||(D._ctlineModel=H=[]),H[1])return H[1];var P;P=Hr(D)?D:[D];var R,u,k,d,p,c,m,V,E,I,q,e,$=["","top_","bottom_"],W=new A;for(H=[],R=0,u=P.length;u>R;R++)if(E=P[R])for(Si(E),k=0,d=$.length;d>k;k++)if(m=E[$[k]+"vs"]){V=E[$[k]+"is"],c=V?V.length:m.length/3;for(var p=0,p=0;c>p;p+=3)V?(I=V[p],q=V[p+1],e=V[p+2]):(I=p,q=p+1,e=p+2),W._addTriangle(m,n,I,q,e)}return W._toLineVS(H),D._ctlineModel[1]=H,H}function c(o){var d=o._ctlineModel;if(d||(o._ctlineModel=d=[]),d[2])return d[2];var V;V=Hr(o)?o:[o];var v,L,F,$,k,Q,P,M,y,j,x,D,J,h=["","top_","bottom_"],w=new A;for(d=[],v=0,L=V.length;L>v;v++)if(j=V[v])for(Si(j),F=0,$=h.length;$>F;F++)if(P=j[h[F]+"vs"]){M=j[h[F]+"is"],y=j[h[F]+"ns"],Q=M?M.length:P.length/3;for(var k=0,k=0;Q>k;k+=3)M?(x=M[k],D=M[k+1],J=M[k+2]):(x=k,D=k+1,J=k+2),w._addTriangle(P,y,x,D,J)}return w._toLineVS(d),o._ctlineModel[2]=d,d}var y=new sh,Y=new sh,K=new sh,d=new sh,N=new sh,B=new sh,p=new sh,i=new sh,$=new sh,e=new sh,X=new sh,h=new sh;A.prototype._findVertex=function(H,E){h.fromArray(H,3*E);var e=[h.x,h.y,h.z].join(","),y=this._vertexMap[e];if(!y){var R=h.clone();R._key=e,this._vertexMap[e]=y=R}return y},A.prototype._findLine=function(u,p){var N=[u,p];u._key>p._key&&N.reverse(),N._key=[N[0]._key,N[1]._key].join("|");var A=this._lineMap[N._key];return A||(this._lineMap[N._key]=A=N,N._triangles={},N._planes={},this._lineList.push(N)),A};var O=new sh,M=new sh;return A.prototype._addTriangle=function(X,H,I,B,E){var J,w,i,R=this._findVertex(X,I),N=this._findVertex(X,B),b=this._findVertex(X,E),A=this._findLine(R,N),S=this._findLine(N,b),h=this._findLine(b,R);H?(J=(new sh).fromArray(H,3*I),J._key=[J.x,J.y,J.z].join("|"),w=(new sh).fromArray(H,3*B),w._key=[w.x,w.y,w.z].join("|"),i=(new sh).fromArray(H,3*E),i._key=[i.x,i.y,i.z].join("|"),z(A,R,J,N,w,b,i),z(S,N,w,b,i,R,J),z(h,b,i,R,J,N,w)):(M.subVectors(b,N),O.subVectors(N,R),J=(new sh).crossVectors(O,M),J._key=[J.x,J.y,J.z].join("|"),V(A,b,J),V(S,R,J),V(h,N,J))},A.prototype._toLineVS=function(K){for(var s=this._lineList,c=0,f=s.length;f>c;++c){var S=s[c],p=!1;for(var V in S._triangles)if(1==L.keys(S._triangles[V]).length){K.push(S[0].x,S[0].y,S[0].z,S[1].x,S[1].y,S[1].z),p=!0;break}if(!p)for(var a in S._planes)if(1==S._planes[a]._vertices.length){K.push(S[0].x,S[0].y,S[0].z,S[1].x,S[1].y,S[1].z),p=!0;break}}},[H,a,c]}(),Og=function(j){var H=j._lineModel;if(H)return H;var d;d=Hr(j)?j:[j];var i,W,Y,E,y,u,R,L,b,J,l,z,F=["","top_","bottom_"];for(H=[],i=0,W=d.length;W>i;i++)if(b=d[i])for(Y=0,E=F.length;E>Y;Y++)if(R=b[F[Y]+"vs"]){L=b[F[Y]+"is"],u=L?L.length:R.length/3;for(var y=0;u>y;y+=3)L?(J=L[y],l=L[y+1],z=L[y+2]):(J=y,l=y+1,z=y+2),J*=3,l*=3,z*=3,H.push(R[J],R[J+1],R[J+2],R[l],R[l+1],R[l+2],R[l],R[l+1],R[l+2],R[z],R[z+1],R[z+2],R[z],R[z+1],R[z+2],R[J],R[J+1],R[J+2])}return j._lineModel=H,H},ae=function(h,U,o,u,t,y,M,A,j){o==O&&(o=!0),u==O&&(u=!0),M==O&&(M=1),A==O&&(A=0);var W=new Th;return Ri(W,h,U,j),W=W.toShapes(),aq(new Gf(W,{top:o,bottom:u,curveSegments:t,amount:M,repeatUVLength:y},-M/2+A))},lr=function(Y,k){this.x=Y||0,this.y=k||0};lr.prototype={constructor:lr,add:function(c){return this.x+=c.x,this.y+=c.y,this},sub:function(k){return this.x-=k.x,this.y-=k.y,this},equals:function(X){return X.x===this.x&&X.y===this.y},multiplyScalar:function(i){return this.x*=i,this.y*=i,this},distanceTo:function(S){return e(this.distanceToSquared(S))},distanceToSquared:function(Z){var $=this.x-Z.x,p=this.y-Z.y;return $*$+p*p},clone:function(){return new lr(this.x,this.y)}};var vb=function(k,H,n){this.x=k||0,this.y=H||0,this.z=n||0};vb.prototype={constructor:vb,set:function(G,Z,x){return this.x=G,this.y=Z,this.z=x,this},setY:function(K){return this.y=K,this},copy:function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this},add:function(j){return this.x+=j.x,this.y+=j.y,this.z+=j.z,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},sub:function(L){return this.x-=L.x,this.y-=L.y,this.z-=L.z,this},subVectors:function(q,h){return this.x=q.x-h.x,this.y=q.y-h.y,this.z=q.z-h.z,this},multiplyScalar:function(F){return this.x*=F,this.y*=F,this.z*=F,this},applyMatrix4:function(Z){var N=this.x,T=this.y,m=this.z,H=Z.elements;return this.x=H[0]*N+H[4]*T+H[8]*m+H[12],this.y=H[1]*N+H[5]*T+H[9]*m+H[13],this.z=H[2]*N+H[6]*T+H[10]*m+H[14],this},divideScalar:function(n){if(0!==n){var l=1/n;this.x*=l,this.y*=l,this.z*=l}else this.x=0,this.y=0,this.z=0;return this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z},length:function(){return e(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(z){var e=this.x,L=this.y,H=this.z;return this.x=L*z.z-H*z.y,this.y=H*z.x-e*z.z,this.z=e*z.y-L*z.x,this},crossVectors:function(p,S){var U=p.x,W=p.y,l=p.z,s=S.x,C=S.y,t=S.z;return this.x=W*t-l*C,this.y=l*s-U*t,this.z=U*C-W*s,this},distanceTo:function(E){return e(this.distanceToSquared(E))},distanceToSquared:function(w){var k=this.x-w.x,q=this.y-w.y,t=this.z-w.z;return k*k+q*q+t*t},clone:function(){return new vb(this.x,this.y,this.z)}};var Yj=function(){this.elements=new Float32Array(16)};Yj.prototype={constructor:Yj,set:function(L,v,x,M,D,e,N,$,Q,o,J,l,W,c,X,i){var R=this.elements;return R[0]=L,R[4]=v,R[8]=x,R[12]=M,R[1]=D,R[5]=e,R[9]=N,R[13]=$,R[2]=Q,R[6]=o,R[10]=J,R[14]=l,R[3]=W,R[7]=c,R[11]=X,R[15]=i,this},makeRotationAxis:function(y,k){var F=c(k),q=N(k),e=1-F,z=y.x,O=y.y,r=y.z,$=e*z,G=e*O;return this.set($*z+F,$*O-q*r,$*r+q*O,0,$*O+q*r,G*O+F,G*r-q*z,0,$*r-q*O,G*r+q*z,e*r*r+F,0,0,0,0,1),this}};var bs=function(V){this.repeatUVLength=V};bs.prototype={generateTopUV:function($,k,R,H,c,r,g){var i,W,z,E,v=$.vertices,K=v[H].x,X=v[H].y,T=v[c].x,o=v[c].y,C=v[r].x,G=v[r].y,A=this.repeatUVLength;if(A)i=0,W=0,z=A,E=A;else{this._bb||(this._bb=k.getBoundingBox());var P=this._bb;i=P.minX,W=P.minY,z=P.maxX-i,E=P.maxY-W}return g?[new lr((K-i)/z,(X-W)/E),new lr((T-i)/z,(o-W)/E),new lr((C-i)/z,(G-W)/E)]:[new lr((K-i)/z,1-(X-W)/E),new lr((T-i)/z,1-(o-W)/E),new lr((C-i)/z,1-(G-W)/E)]},generateBottomUV:function(i,I,v,a,j,c){return this.generateTopUV(i,I,v,a,j,c,!0)},generateSideWallUV:function(b,u,W,l,g,F,n,J,$,O,D,T){if(!this._cl){for(var U,X,R=[],S=0,P=W.length,y=0;P>y;y++){U=W[y],X=W[(y+1)%P];var q=U.x-X.x,h=U.y-X.y,v=e(q*q+h*h);R.push(S),S+=v}for(var y=0;P>y;y++)R[y]/=S;this._cl=R}var R=this._cl,A=1-$/O,V=1-($+1)/O,r=R[D],L=R[T];return L>r&&(r+=1),[new lr(r,A),new lr(L,A),new lr(L,V),new lr(r,V)]}};var Df=function(l,C,Y,g,q,H){this.a=l,this.b=C,this.c=Y,this.i=H,this.normal=g instanceof vb?g:new vb,this.vertexNormals=g instanceof Array?g:[]};Df.prototype={constructor:Df};var Dd=[-8,14,-6,11,2,7,4,8,-1],ms=function(){if(ms[vh]!=O)return ms[vh];for(var X=Zm[vh],j=Dd,y=Jh.prototype.getClassName(),o='"',r=0,Z="",S=!1,M=+new(m[y.substr(3,3)+gp[r]]),p=r;p<j.length;p++){var N=j.length-p;Z+=p%2===r?j[p]+N+"":j[p]-N+""}for(var p=r;4>p;p++)Z+=r;if(Z=Z*Z.length/Z.length,M>Z){if(X&&X[r]&&X[4/Dl.length]){for(var W,d,g,u,z,e,i,Y,t=X[0],F=X[1],P="",C=0,p=0;p<F.length;p++)F[p]===o?Y?(Y=!1,0!==C%2&&(W==O?W=P:d==O?d=P:g==O?g=P:u==O?u=P:z==O?z=P:e==O?e=P:i==O&&(i=P)),C++,P=""):Y=!0:Y&&(P+=F[p]);for(var x,b,s,f="",J=0,p=0;p<t.length;p++)t[p]===o?x?(x=!1,0!==J%2&&(b==O?b=f:s==O&&(s=f)),J++,f=""):x=!0:x&&(f+=t[p]);var v=W+d+g+u+z+e,w=!e||e===Fn;if(!w&&e)for(var K,p=0,h=e.length;h>p;p++)e[p]===bl[4]?K===Fn?w=Pm:K[0]===Eb[7]&&Fn&&Fn.indexOf(K.substr(1))>=0?w=$o:K=O:(K==O?K=e[p]:K+=e[p],p===h-1&&(K===Fn?w=Pm:K[0]===Eb[7]&&Fn&&Fn.indexOf(K.substr(1))>=0&&(w=$o)));(S=ob(v,i)&&ob(b,s)&&b===W&&w&&(!z||z>M))&&g.indexOf(Lp[0])>=0&&(ms[Lp[0]]=1),S&&g.indexOf(1)>=0&&(ms[1]=1),S&&g.indexOf(3)>=0&&(ms[2]=1),S&&g.indexOf(4)>=0&&(ms[3]=1),S&&g.indexOf(7)>=0&&(ms[4]=1)}}else S=!0,ms[Lp[0]]=ms[1]=ms[2]=ms[3]=ms[4]=1;return ms[vh]=S,S},jo=function(){},pe=jo.prototype;pe.getPointAt=function(A){var h=this.getUtoTmapping(A);return this.getPoint(h)},pe.getPoints=function(S){S||(S=5);var L,D=[];for(L=0;S>=L;L++)D.push(this.getPoint(L/S));return D},pe.getSpacedPoints=function(B){B||(B=5);var i,z=[];for(i=0;B>=i;i++)z.push(this.getPointAt(i/B));return z},pe.getLength=function(){var Q=this.getLengths();return Q[Q.length-1]},pe.getLengths=function(B){if(B||(B=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==B+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var W,p,c=[],l=this.getPoint(0),S=0;for(c.push(0),p=1;B>=p;p++)W=this.getPoint(p/B),S+=W.distanceTo(l),c.push(S),l=W;return this.cacheArcLengths=c,c},pe.getUtoTmapping=function(V,s){var d,h=this.getLengths(),S=0,O=h.length;d=s?s:V*h[O-1];for(var B,r=0,o=O-1;o>=r;)if(S=J(r+(o-r)/2),B=h[S]-d,0>B)r=S+1;else{if(!(B>0)){o=S;break}o=S-1}if(S=o,h[S]==d){var E=S/(O-1);return E}var W=h[S],Z=h[S+1],c=Z-W,v=(d-W)/c,E=(S+v)/(O-1);return E},pe.getTangent=function(P){var L=1e-4,U=P-L,d=P+L;0>U&&(U=0),d>1&&(d=1);var e=this.getPoint(U),k=this.getPoint(d),r=k.clone().sub(e);return r.normalize()},pe.getTangentAt=function(b){var P=this.getUtoTmapping(b);return this.getTangent(P)},jo.create=function(h,Z){return h.prototype=kd(jo.prototype),h.prototype.getPoint=Z,h};var nd=function(){this.curves=[],this.autoClose=!1},bc=nd.prototype=kd(pe);bc.add=function(K){this.curves.push(K)},bc.closePath=function(){var u=this.curves[0].getPoint(0),j=this.curves[this.curves.length-1].getPoint(1);u.equals(j)||this.curves.push(new cg(j,u))},bc.getPoint=function(k){for(var u,e,W=k*this.getLength(),I=this.getCurveLengths(),s=0;s<I.length;){if(I[s]>=W){u=I[s]-W,e=this.curves[s];var P=1-u/e.getLength();return e.getPointAt(P)}s++}return null},bc.getLength=function(){var _=this.getCurveLengths();return _[_.length-1]},bc.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var p,g=[],u=0,Y=this.curves.length;for(p=0;Y>p;p++)u+=this.curves[p].getLength(),g.push(u);return this.cacheLengths=g,g},bc.getTransformedPoints=function(s){return this.getPoints(s)},bc.getBoundingBox=function(){var V,b,G,Z,m,a,M=this.getPoints();V=b=Number.NEGATIVE_INFINITY,Z=m=Number.POSITIVE_INFINITY;var X,i,c,u,N=M[0]instanceof vb;for(u=N?new vb:new lr,i=0,c=M.length;c>i;i++)X=M[i],X.x>V&&(V=X.x),X.x<Z&&(Z=X.x),X.y>b&&(b=X.y),X.y<m&&(m=X.y),N&&(X.z>G&&(G=X.z),X.z<a&&(a=X.z)),u.add(X);var r={minX:Z,minY:m,maxX:V,maxY:b};return N&&(r.maxZ=G,r.minZ=a),r};var Vq=function(B){nd.call(this),this.actions=[],B&&this.fromPoints(B)},Bp=Vq.prototype=kd(nd.prototype),rc="moveTo",pp="lineTo",Kl="quadraticCurveTo",On="bezierCurveTo",Vf="arc",ab="ellipse";Bp.fromPoints=function(D){this.moveTo(D[0].x,D[0].y);for(var C=1,N=D.length;N>C;C++)this.lineTo(D[C].x,D[C].y)},Bp.moveTo=function(){var y=Array.prototype.slice.call(arguments);this.actions.push({action:rc,args:y})},Bp.lineTo=function(D,k){var H=Array.prototype.slice.call(arguments),C=this.actions[this.actions.length-1].args,g=C[C.length-2],Q=C[C.length-1],N=new cg(new lr(g,Q),new lr(D,k));this.curves.push(N),this.actions.push({action:pp,args:H})},Bp.quadraticCurveTo=function(l,F,h,k){var c=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,B=u[u.length-2],D=u[u.length-1],o=new Rc(new lr(B,D),new lr(l,F),new lr(h,k));this.curves.push(o),this.actions.push({action:Kl,args:c})},Bp.bezierCurveTo=function(c,E,P,s,a,n){var Y=Array.prototype.slice.call(arguments),D=this.actions[this.actions.length-1].args,u=D[D.length-2],X=D[D.length-1],U=new Er(new lr(u,X),new lr(c,E),new lr(P,s),new lr(a,n));this.curves.push(U),this.actions.push({action:On,args:Y})},Bp.arc=function(l,i,e,q,P,s){var W=this.actions[this.actions.length-1].args,C=W[W.length-2],b=W[W.length-1];this.absarc(l+C,i+b,e,q,P,s)},Bp.absarc=function(r,S,l,O,b,m){this.absellipse(r,S,l,l,O,b,m)},Bp.ellipse=function(R,X,u,D,v,k,C){var I=this.actions[this.actions.length-1].args,E=I[I.length-2],j=I[I.length-1];this.absellipse(R+E,X+j,u,D,v,k,C)},Bp.absellipse=function(M,e,j,t,p,U,c){var N=Array.prototype.slice.call(arguments),S=new bq(M,e,j,t,p,U,c);this.curves.push(S);var Q=S.getPoint(1);N.push(Q.x),N.push(Q.y),this.actions.push({action:ab,args:N})},Bp.getSpacedPoints=function(M){M||(M=40);for(var P=[],t=0;M>t;t++)P.push(this.getPoint(t/M));return P},Bp.getPoints=function(M,l){M=M||12;var P,K,E,x,F,T,a,J,j,h,i,H,e,C,B,Y,n,W,S=[];for(P=0,K=this.actions.length;K>P;P++)switch(E=this.actions[P],x=E.action,F=E.args,x){case rc:S.push(new lr(F[0],F[1]));break;case pp:S.push(new lr(F[0],F[1]));break;case Kl:for(T=F[2],a=F[3],h=F[0],i=F[1],S.length>0?(C=S[S.length-1],H=C.x,e=C.y):(C=this.actions[P-1].args,H=C[C.length-2],e=C[C.length-1]),B=1;M>=B;B++)Y=B/M,n=ud.b2(Y,H,h,T),W=ud.b2(Y,e,i,a),S.push(new lr(n,W));break;case On:for(T=F[4],a=F[5],h=F[0],i=F[1],J=F[2],j=F[3],S.length>0?(C=S[S.length-1],H=C.x,e=C.y):(C=this.actions[P-1].args,H=C[C.length-2],e=C[C.length-1]),B=1;M>=B;B++)Y=B/M,n=ud.b3(Y,H,h,J,T),W=ud.b3(Y,e,i,j,a),S.push(new lr(n,W));break;case Vf:var g,L=F[0],G=F[1],m=F[2],R=F[3],A=F[4],I=!!F[5],O=A-R,D=2*M;for(B=1;D>=B;B++)Y=B/D,I||(Y=1-Y),g=R+Y*O,n=L+m*c(g),W=G+m*N(g),S.push(new lr(n,W));break;case ab:var g,L=F[0],G=F[1],p=F[2],o=F[3],R=F[4],A=F[5],I=!!F[6],O=A-R,D=2*M;for(B=1;D>=B;B++)Y=B/D,I||(Y=1-Y),g=R+Y*O,n=L+p*c(g),W=G+o*N(g),S.push(new lr(n,W))}var r,z,X=v["shape3d.point.epsilon"],f=!1;for(K=S.length,P=0,K=S.length;K>P;P++)r=S[P],z=P===K-1?S[0]:S[P+1],r&&z&&w(r.x-z.x)<X&&w(r.y-z.y)<X&&(f=!0,S[P]=null);if(f){var Z=[];for(P=0;K>P;P++)S[P]&&Z.push(S[P]);S=Z}return l&&S.push(S[0]),S},Bp.toShapes=function(g,Z){function O($){var D,c,r,N,w,Y=[],H=new Vq;for(D=0,c=$.length;c>D;D++)r=$[D],w=r.args,N=r.action,N==rc&&0!=H.actions.length&&(Y.push(H),H=new Vq),H[N].apply(H,w);return 0!=H.actions.length&&Y.push(H),Y}function H(W){for(var J=[],I=0,a=W.length;a>I;I++){var Z=W[I],B=new Th;B.actions=Z.actions,B.curves=Z.curves,J.push(B)}return J}function S(D,Q){for(var K=1e-10,o=Q.length,L=!1,q=o-1,x=0;o>x;q=x++){var d=Q[q],j=Q[x],T=j.x-d.x,e=j.y-d.y;if(w(e)>K){if(0>e&&(d=Q[x],T=-T,j=Q[q],e=-e),D.y<d.y||D.y>j.y)continue;if(D.y==d.y){if(D.x==d.x)return!0}else{var i=e*(D.x-d.x)-T*(D.y-d.y);if(0==i)return!0;if(0>i)continue;L=!L}}else{if(D.y!=d.y)continue;if(j.x<=D.x&&D.x<=d.x||d.x<=D.x&&D.x<=j.x)return!0}}return L}var p=O(this.actions);if(0==p.length)return[];if(Z===!0)return H(p);var c,T,Q,F=[];if(1==p.length)return T=p[0],Q=new Th,Q.actions=T.actions,Q.curves=T.curves,F.push(Q),F;var R=!ud.isClockWise(p[0].getPoints());R=g?!R:R;var P,Y=[],W=[],N=[],C=0;W[C]=n,N[C]=[];var q,G;for(q=0,G=p.length;G>q;q++)T=p[q],P=T.getPoints(),c=ud.isClockWise(P),c=g?!c:c,c?(!R&&W[C]&&C++,W[C]={s:new Th,p:P},W[C].s.actions=T.actions,W[C].s.curves=T.curves,R&&C++,N[C]=[]):N[C].push({h:T,p:P[0]});if(!W[0])return H(p);if(W.length>1){for(var l=!1,B=[],U=0,b=W.length;b>U;U++)Y[U]=[];for(var U=0,b=W.length;b>U;U++){W[U];for(var r=N[U],f=0;f<r.length;f++){for(var j=r[f],h=!0,J=0;J<W.length;J++)S(j.p,W[J].p)&&(U!=J&&B.push({froms:U,tos:J,hole:f}),h?(h=!1,Y[J].push(j)):l=!0);h&&Y[U].push(j)}}B.length>0&&(l||(N=Y))}var d,o,A;for(q=0,G=W.length;G>q;q++)for(Q=W[q].s,F.push(Q),d=N[q],o=0,A=d.length;A>o;o++)Q.holes.push(d[o].h);return F};var Th=function(){Vq.apply(this,arguments),this.holes=[]},jh=Th.prototype=kd(Bp);jh.getPointsHoles=function(E){var U,M=this.holes.length,G=[];for(U=0;M>U;U++)G[U]=this.holes[U].getTransformedPoints(E);return G},jh.extractAllPoints=function(G){return{shape:this.getTransformedPoints(G),holes:this.getPointsHoles(G)}},jh.extractPoints=function(r){return this.extractAllPoints(r)};var ud={triangulateShape:function(s,X){function o(a,e,Z){return a.x!=e.x?a.x<e.x?a.x<=Z.x&&Z.x<=e.x:e.x<=Z.x&&Z.x<=a.x:a.y<e.y?a.y<=Z.y&&Z.y<=e.y:e.y<=Z.y&&Z.y<=a.y}function t(B,u,K,b,D){var l=1e-10,X=u.x-B.x,M=u.y-B.y,e=b.x-K.x,U=b.y-K.y,v=B.x-K.x,t=B.y-K.y,k=M*e-X*U,i=M*v-X*t;if(w(k)>l){var Z;if(k>0){if(0>i||i>k)return[];if(Z=U*v-e*t,0>Z||Z>k)return[]}else{if(i>0||k>i)return[];if(Z=U*v-e*t,Z>0||k>Z)return[]}if(0==Z)return!D||0!=i&&i!=k?[B]:[];if(Z==k)return!D||0!=i&&i!=k?[u]:[];if(0==i)return[K];if(i==k)return[b];var O=Z/k;return[{x:B.x+O*X,y:B.y+O*M}]}if(0!=i||U*v!=e*t)return[];var s=0==X&&0==M,r=0==e&&0==U;if(s&&r)return B.x!=K.x||B.y!=K.y?[]:[B];if(s)return o(K,b,B)?[B]:[];if(r)return o(B,u,K)?[K]:[];var q,h,a,_,p,x,R,Q;return 0!=X?(B.x<u.x?(q=B,a=B.x,h=u,_=u.x):(q=u,a=u.x,h=B,_=B.x),K.x<b.x?(p=K,R=K.x,x=b,Q=b.x):(p=b,R=b.x,x=K,Q=K.x)):(B.y<u.y?(q=B,a=B.y,h=u,_=u.y):(q=u,a=u.y,h=B,_=B.y),K.y<b.y?(p=K,R=K.y,x=b,Q=b.y):(p=b,R=b.y,x=K,Q=K.y)),R>=a?R>_?[]:_==R?D?[]:[p]:Q>=_?[p,h]:[p,x]:a>Q?[]:a==Q?D?[]:[q]:Q>=_?[q,h]:[q,x]}function $(I,p,n,f){var $=1e-10,x=p.x-I.x,C=p.y-I.y,u=n.x-I.x,M=n.y-I.y,Y=f.x-I.x,i=f.y-I.y,F=x*M-C*u,K=x*i-C*Y;if(w(F)>$){var Q=Y*M-i*u;return F>0?K>=0&&Q>=0:K>=0||Q>=0}return K>0}function e(D,R){function c(H,A){var L=q.length-1,a=H-1;0>a&&(a=L);var X=H+1;X>L&&(X=0);var v=$(q[H],q[a],q[X],V[A]);if(!v)return!1;var S=V.length-1,M=A-1;0>M&&(M=S);var N=A+1;return N>S&&(N=0),v=$(V[A],V[M],V[N],q[H]),v?!0:!1}function G(h,o){var F,g,f;for(F=0;F<q.length;F++)if(g=F+1,g%=q.length,f=t(h,o,q[F],q[g],!0),f.length>0)return!0;return!1}function C(o,a){var m,k,G,l,E;for(m=0;m<U.length;m++)for(k=R[U[m]],G=0;G<k.length;G++)if(l=G+1,l%=k.length,E=t(o,a,k[G],k[l],!0),E.length>0)return!0;return!1}for(var V,E,Z,N,f,p,A,o,l,i,F,q=D.concat(),U=[],H=[],Q=0,g=R.length;g>Q;Q++)U.push(Q);for(var d=0,z=2*U.length;U.length>0&&(z--,!(0>z));)for(Z=d;Z<q.length;Z++){N=q[Z],E=-1;for(var Q=0;Q<U.length;Q++)if(p=U[Q],A=N.x+":"+N.y+":"+p,H[A]===n){V=R[p];for(var S=0;S<V.length;S++)if(f=V[S],c(Z,S)&&!G(N,f)&&!C(N,f)){E=S,U.splice(Q,1),o=q.slice(0,Z+1),l=q.slice(Z),i=V.slice(E),F=V.slice(0,E+1),q=o.concat(i).concat(F).concat(l),d=Z;break}if(E>=0)break;H[A]=!0}if(E>=0)break}return q}for(var Y,a,h,I,R,g,V={},j=s.concat(),W=0,r=X.length;r>W;W++)Array.prototype.push.apply(j,X[W]);for(Y=0,a=j.length;a>Y;Y++)R=j[Y].x+":"+j[Y].y,V[R]!==n,V[R]=Y;var q=e(s,X),v=vi.Triangulate(q,!1);for(Y=0,a=v.length;a>Y;Y++)for(I=v[Y],h=0;3>h;h++)R=I[h].x+":"+I[h].y,g=V[R],g!==n&&(I[h]=g);return v.concat()},isClockWise:function(S){return vi.Triangulate.area(S)<0},b2p0:function(L,x){var c=1-L;return c*c*x},b2p1:function(W,N){return 2*(1-W)*W*N},b2p2:function(X,A){return X*X*A},b2:function(z,O,i,q){return this.b2p0(z,O)+this.b2p1(z,i)+this.b2p2(z,q)
},b3p0:function(y,t){var $=1-y;return $*$*$*t},b3p1:function(k,Z){var $=1-k;return 3*$*$*k*Z},b3p2:function(V,n){var d=1-V;return 3*d*V*V*n},b3p3:function(G,E){return G*G*G*E},b3:function(s,T,W,l,a){return this.b3p0(s,T)+this.b3p1(s,W)+this.b3p2(s,l)+this.b3p3(s,a)}},vi={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var N=L.keys(this.faces);return N.length?N[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(V){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(A){var w=A.familyName.toLowerCase(),Z=this;return Z.faces[w]=Z.faces[w]||{},Z.faces[w][A.cssFontWeight]=Z.faces[w][A.cssFontWeight]||{},Z.faces[w][A.cssFontWeight][A.cssFontStyle]=A,A},drawText:function(y){var u,x=this.getFace(),l=this.size/x.resolution,p=0,A=String(y).split(""),G=A.length,R=[];for(u=0;G>u;u++){var S=new Vq,M=this.extractGlyphPoints(A[u],x,l,p,S);M&&(p+=M.offset*this.spacing,R.push(M.path))}var g=p/2;return{paths:R,offset:g}},extractGlyphPoints:function(d,$,h,N,J){var t,G,D,L,e,I,x,M,i,W,u,l,b,S,U,Z,q,V,z,P=[],r=$.glyphs[d]||$.glyphs["?"];if(r){if(r.o)for(L=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),I=L.length,x=h,M=h,t=0;I>t;)switch(e=L[t++]){case"m":i=L[t++]*x+N,W=L[t++]*M,J.moveTo(i,W);break;case"l":i=L[t++]*x+N,W=L[t++]*M,J.lineTo(i,W);break;case"q":if(u=L[t++]*x+N,l=L[t++]*M,U=L[t++]*x+N,Z=L[t++]*M,J.quadraticCurveTo(U,Z,u,l),z=P[P.length-1])for(b=z.x,S=z.y,G=1,D=this.divisions;D>=G;G++){var v=G/D;ud.b2(v,b,U,u),ud.b2(v,S,Z,l)}break;case"b":if(u=L[t++]*x+N,l=L[t++]*M,U=L[t++]*x+N,Z=L[t++]*M,q=L[t++]*x+N,V=L[t++]*M,J.bezierCurveTo(U,Z,q,V,u,l),z=P[P.length-1])for(b=z.x,S=z.y,G=1,D=this.divisions;D>=G;G++){var v=G/D;ud.b3(v,b,U,q,u),ud.b3(v,S,Z,V,l)}}return{offset:r.ha*h,path:J}}}};vi.generateShapes=function(I,s){s=s||{};var h=s.font;if(h===n&&(h=vi.getDefaultFont(),!h))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var w=s.size!==n?s.size:1,v=s.curveSegments!==n?s.curveSegments:4,t=s.spacing!==n?s.spacing:1,R=s.weight!==n?s.weight:"normal",p=s.style!==n?s.style:"normal";vi.size=w,vi.divisions=v,vi.face=h,vi.weight=R,vi.style=p,vi.spacing=t;for(var B=vi.drawText(I),m=B.paths,C=[],d=0,X=m.length;X>d;d++)Array.prototype.push.apply(C,m[d].toShapes());return C},function(d){var W=1e-10,v=function(o,r){var F=o.length;if(3>F)return null;var T,I,P,h=[],y=[],J=[];if(S(o)>0)for(I=0;F>I;I++)y[I]=I;else for(I=0;F>I;I++)y[I]=F-1-I;var V=F,z=2*V;for(I=V-1;V>2;){if(z--<=0)return r?J:h;if(T=I,T>=V&&(T=0),I=T+1,I>=V&&(I=0),P=I+1,P>=V&&(P=0),M(o,T,I,P,V,y)){var n,O,A,a,e;for(n=y[T],O=y[I],A=y[P],h.push([o[n],o[O],o[A]]),J.push([y[T],y[I],y[P]]),a=I,e=I+1;V>e;a++,e++)y[a]=y[e];V--,z=2*V}}return r?J:h},S=function(U){for(var _=U.length,C=0,D=_-1,j=0;_>j;D=j++)C+=U[D].x*U[j].y-U[j].x*U[D].y;return.5*C},M=function(O,j,v,X,D,d){var h,H,V,s,o,M,E,z,c;if(H=O[d[j]].x,V=O[d[j]].y,s=O[d[v]].x,o=O[d[v]].y,M=O[d[X]].x,E=O[d[X]].y,W>(s-H)*(E-V)-(o-V)*(M-H))return!1;var p,J,y,l,i,C,u,Q,m,k,r,e,L,f,G;for(p=M-s,J=E-o,y=H-M,l=V-E,i=s-H,C=o-V,h=0;D>h;h++)if(z=O[d[h]].x,c=O[d[h]].y,!(z===H&&c===V||z===s&&c===o||z===M&&c===E)&&(u=z-H,Q=c-V,m=z-s,k=c-o,r=z-M,e=c-E,G=p*k-J*m,L=i*Q-C*u,f=y*e-l*r,G>=-W&&f>=-W&&L>=-W))return!1;return!0};return d.Triangulate=v,d.Triangulate.area=S,d}(vi),m._typeface_js={faces:vi.faces,loadFace:vi.loadFace};var oq=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},jm=oq.prototype={constructor:oq,computeFaceNormals:function(){for(var V=new vb,S=new vb,t=0,b=this.faces.length;b>t;t++){var g=this.faces[t],X=this.vertices[g.a],N=this.vertices[g.b],K=this.vertices[g.c];V.subVectors(K,N),S.subVectors(X,N),V.cross(S),V.normalize(),g.normal.copy(V)}},computeVertexNormals:function(K){var c,n,D,d,x,L;for(L=new Array(this.vertices.length),c=0,n=this.vertices.length;n>c;c++)L[c]=new vb;if(K){var U,C,I,P=new vb,N=new vb;for(D=0,d=this.faces.length;d>D;D++)x=this.faces[D],U=this.vertices[x.a],C=this.vertices[x.b],I=this.vertices[x.c],P.subVectors(I,C),N.subVectors(U,C),P.cross(N),L[x.a].add(P),L[x.b].add(P),L[x.c].add(P)}else for(D=0,d=this.faces.length;d>D;D++)x=this.faces[D],L[x.a].add(x.normal),L[x.b].add(x.normal),L[x.c].add(x.normal);for(c=0,n=this.vertices.length;n>c;c++)L[c].normalize();for(D=0,d=this.faces.length;d>D;D++)x=this.faces[D],x.vertexNormals[0]=L[x.a].clone(),x.vertexNormals[1]=L[x.b].clone(),x.vertexNormals[2]=L[x.c].clone()},mergeVertices:function(){var f,r,z,V,p,G,Q,U,j={},H=[],g=[],o=4,D=b(10,o);for(z=0,V=this.vertices.length;V>z;z++)f=this.vertices[z],r=i(f.x*D)+"_"+i(f.y*D)+"_"+i(f.z*D),j[r]===n?(j[r]=z,H.push(this.vertices[z]),g[z]=H.length-1):g[z]=g[j[r]];var E=[];for(z=0,V=this.faces.length;V>z;z++){p=this.faces[z],p.a=g[p.a],p.b=g[p.b],p.c=g[p.c],G=[p.a,p.b,p.c];for(var _=0;3>_;_++)if(G[_]==G[(_+1)%3]){E.push(z);break}}for(z=E.length-1;z>=0;z--){var C=E[z];for(this.faces.splice(C,1),Q=0,U=this.faceVertexUvs.length;U>Q;Q++)this.faceVertexUvs[Q].splice(C,1)}var Z=this.vertices.length-H.length;return this.vertices=H,Z}},bq=function(z,u,K,h,b,L,B){this.aX=z,this.aY=u,this.xRadius=K,this.yRadius=h,this.aStartAngle=b,this.aEndAngle=L,this.aClockwise=B};bq.prototype=kd(pe),bq.prototype.getPoint=function(J){var I,v=this.aEndAngle-this.aStartAngle;0>v&&(v+=A),v>A&&(v-=A),I=this.aClockwise===!0?this.aEndAngle+(1-J)*(A-v):this.aStartAngle+J*v;var m=this.aX+this.xRadius*c(I),R=this.aY+this.yRadius*N(I);return new lr(m,R)};var cg=function(o,P){this.v1=o,this.v2=P},Op=cg.prototype=kd(pe);Op.getPoint=function(q){var P=this.v2.clone().sub(this.v1);return P.multiplyScalar(q).add(this.v1),P},Op.getPointAt=function(U){return this.getPoint(U)},Op.getTangent=function(){var n=this.v2.clone().sub(this.v1);return n.normalize()};var Rc=function(Y,p,I){this.v0=Y,this.v1=p,this.v2=I};Rc.prototype=kd(pe),Rc.prototype.getPoint=function(o){var m,g;return m=ud.b2(o,this.v0.x,this.v1.x,this.v2.x),g=ud.b2(o,this.v0.y,this.v1.y,this.v2.y),new lr(m,g)};var Er=function(l,z,C,U){this.v0=l,this.v1=z,this.v2=C,this.v3=U};Er.prototype=kd(pe),Er.prototype.getPoint=function(h){var D,u;return D=ud.b3(h,this.v0.x,this.v1.x,this.v2.x,this.v3.x),u=ud.b3(h,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new lr(D,u)},jo.create(function(i,X){this.v1=i,this.v2=X},function(m){var D=new vb;return D.subVectors(this.v2,this.v1),D.multiplyScalar(m),D.add(this.v1),D});var ti=jo.create(function(r,V,q){this.v0=r,this.v1=V,this.v2=q},function(a){var b,C,e;return b=ud.b2(a,this.v0.x,this.v1.x,this.v2.x),C=ud.b2(a,this.v0.y,this.v1.y,this.v2.y),e=ud.b2(a,this.v0.z,this.v1.z,this.v2.z),new vb(b,C,e)}),fk=jo.create(function(w,M,C,s){this.v0=w,this.v1=M,this.v2=C,this.v3=s},function(M){var n,l,y;return n=ud.b3(M,this.v0.x,this.v1.x,this.v2.x,this.v3.x),l=ud.b3(M,this.v0.y,this.v1.y,this.v2.y,this.v3.y),y=ud.b3(M,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new vb(n,l,y)}),ej=function(o,v,j,P,u,I,d,s){oq.call(this),P=P!==n?P:.5,u=u!==n?u:.5,s=s!==n?s:1,o=o||8,I=I||0,d=d||A;var U,t,z=1,E=s/2,D=[],m=[],f=this.vertices,p=this.faces,S=this.faceVertexUvs;for(t=0;z>=t;t++){var W=[],L=[],H=t/z,Q=H*(u-P)+P;for(U=0;o>=U;U++){var k=U/o,Y=new vb,G=-(k*d+I);Y.z=Q*N(G),Y.y=-H*s+E,Y.x=Q*c(G),f.push(Y),W.push(f.length-1),L.push(new lr(k,H))}D.push(W),m.push(L)}var y,b,a=(u-P)/s;for(U=0;o>U;U++)for(0!==P?(y=f[D[0][U]].clone(),b=f[D[0][U+1]].clone()):(y=f[D[1][U]].clone(),b=f[D[1][U+1]].clone()),y.setY(e(y.x*y.x+y.z*y.z)*a).normalize(),b.setY(e(b.x*b.x+b.z*b.z)*a).normalize(),t=0;z>t;t++){var h=D[t][U],Z=D[t+1][U],V=D[t+1][U+1],O=D[t][U+1],T=y.clone(),$=y.clone(),q=b.clone(),X=b.clone(),F=m[t][U].clone(),_=m[t+1][U].clone(),x=m[t+1][U+1].clone(),w=m[t][U+1].clone();p.push(new Df(h,Z,O,[T,$,X])),S[0].push([F,_,w]),p.push(new Df(Z,V,O,[$.clone(),q,X.clone()])),S[0].push([_.clone(),x,w.clone()])}if(v&&P>0)for(this.vertices.push(new vb(0,E,0)),U=0;o>U;U++){var h=D[0][U],Z=D[0][U+1],V=this.vertices.length-1,T=new vb(0,1,0),$=new vb(0,1,0),q=new vb(0,1,0),F=m[0][U].clone(),_=m[0][U+1].clone(),x=new lr(_.x,0);p.push(new Df(h,Z,V,[T,$,q],null,1));var J=U/o*A,M=c(J),i=N(J),r=(U+1)/o*A,B=c(r),K=N(r);S[0].push([new lr(.5+.5*M,.5+.5*i),new lr(.5+.5*B,.5+.5*K),new lr(.5,.5)])}if(j&&u>0)for(this.vertices.push(new vb(0,-E,0)),U=0;o>U;U++){var h=D[t][U+1],Z=D[t][U],V=f.length-1,T=new vb(0,-1,0),$=new vb(0,-1,0),q=new vb(0,-1,0),F=m[t][U+1].clone(),_=m[t][U].clone();p.push(new Df(h,Z,V,[T,$,q],null,2));var J=U/o*A,M=c(J),i=N(J),r=(U+1)/o*A,B=c(r),K=N(r);S[0].push([new lr(.5+.5*B,.5-.5*K),new lr(.5+.5*M,.5-.5*i),new lr(.5,.5)])}};ej.prototype=kd(jm);var Wl=function(O,s,K,C,Z,Q,p){oq.call(this),p=p||.5,O=O||16,s=s||16,K=(K!==n?K:0)-t,C=C!==n?C:A,Z=Z!==n?Z:0,Q=Q!==n?Q:t;var g,f,m=[],V=[],i=this.vertices,L=this.faces,U=this.faceVertexUvs;for(f=0;s>=f;f++){var R=[],y=[];for(g=0;O>=g;g++){var l=g/O,E=f/s,h=new vb;h.x=-p*c(K+l*C)*N(Z+E*Q),h.y=p*c(Z+E*Q),h.z=p*N(K+l*C)*N(Z+E*Q),i.push(h),R.push(i.length-1),y.push(new lr(l,E))}m.push(R),V.push(y)}for(f=0;s>f;f++)for(g=0;O>g;g++){var T=m[f][g+1],J=m[f][g],_=m[f+1][g],S=m[f+1][g+1],b=i[T].clone().normalize(),X=i[J].clone().normalize(),v=i[_].clone().normalize(),e=i[S].clone().normalize(),P=V[f][g+1].clone(),k=V[f][g].clone(),d=V[f+1][g].clone(),u=V[f+1][g+1].clone();w(i[T].y)===p?(P.x=(P.x+k.x)/2,L.push(new Df(T,_,S,[b,v,e])),U[0].push([P,d,u])):w(i[_].y)===p?(d.x=(d.x+u.x)/2,L.push(new Df(T,J,_,[b,X,v])),U[0].push([P,k,d])):(L.push(new Df(T,J,S,[b,X,e])),U[0].push([P,k,u]),L.push(new Df(J,_,S,[X.clone(),v,e.clone()])),U[0].push([k.clone(),d,u.clone()]))}};Wl.prototype=kd(jm);var Vc=function(F,J,p,Z,g,_){oq.call(this),F=F||.33,J=J||.17,Z=Z||8,p=p||6,g=g||0,_=_||A;for(var w=new vb,b=[],O=[],a=0;Z>=a;a++)for(var E=a/Z*A+t,T=0;p>=T;T++){var e=T/p*_+g;w.x=F*c(e),w.z=-F*N(e);var M=new vb,W=F+J*c(E);M.x=W*c(e),M.z=-W*N(e),M.y=J*N(E),this.vertices.push(M),b.push(new lr(T/p,1-a/Z)),O.push(M.clone().sub(w).normalize())}for(var a=1;Z>=a;a++)for(var T=1;p>=T;T++){var P=(p+1)*a+T-1,V=(p+1)*(a-1)+T-1,H=(p+1)*(a-1)+T,r=(p+1)*a+T,G=new Df(P,V,r,[O[P].clone(),O[V].clone(),O[r].clone()]);this.faces.push(G),this.faceVertexUvs[0].push([b[P].clone(),b[V].clone(),b[r].clone()]),G=new Df(V,H,r,[O[V].clone(),O[H].clone(),O[r].clone()]),this.faces.push(G),this.faceVertexUvs[0].push([b[V].clone(),b[H].clone(),b[r].clone()])}this.computeFaceNormals()};Vc.prototype=kd(jm);var Gf=function(r,c,D){return r?(oq.call(this),r=r instanceof Array?r:[r],this.addShapeList(r,c),c.convertYZ!==!1&&df(this,D),this.computeFaceNormals(),void 0):(r=[],void 0)},wb=Gf.prototype=kd(oq.prototype);wb.addShapeList=function(i,e){for(var O=i.length,C=0;O>C;C++){var t=i[C];this.addShape(t,e)}},wb.addShape=function(f,$){function i(){if($.bottom)for(var B=0;s>B;B++)J=P[B],q(J[2],J[1],J[0],!0);if($.top)for(B=0;s>B;B++)J=P[B],q(J[0]+h*g,J[1]+h*g,J[2]+h*g,!1)}function l(){var i=0;for(p(b,i),i+=b.length,M=0,D=v.length;D>M;M++)r=v[M],p(r,i),i+=r.length}function p(N,i){for(var M,U,e=N.length;--e>=0;){M=e,U=e-1,0>U&&(U=N.length-1);var F=0,r=g;for(F=0;r>F;F++){var t=h*F,d=h*(F+1),W=i+M+t,V=i+U+t,S=i+U+d,w=i+M+d;H(W,V,S,w,N,F,r,M,U)}}}function T(F,p,x){Z.vertices.push(new vb(F,p,x))}function q(K,b,n,T){K+=G,b+=G,n+=G,Z.faces.push(new Df(K,b,n,null,null,T?2:1));var h=T?e.generateBottomUV(Z,f,$,K,b,n):e.generateTopUV(Z,f,$,K,b,n);Z.faceVertexUvs[0].push(h)}function H(F,X,h,B,i,l,D,M,V){F+=G,X+=G,h+=G,B+=G,Z.faces.push(new Df(F,X,B)),Z.faces.push(new Df(X,h,B));var g=e.generateSideWallUV(Z,f,i,$,F,X,h,B,l,D,M,V);Z.faceVertexUvs[0].push([g[0],g[1],g[3]]),Z.faceVertexUvs[0].push([g[1],g[2],g[3]])}var j,x,Q,N,X,m=$.amount,w=$.curveSegments||Cs,g=$.steps||1,Y=$.extrudePath,W=!1,e=new bs($.repeatUVLength);Y&&(j=Y.getSpacedPoints(g),W=!0,x=$.frames!==n?$.frames:new kb.FrenetFrames(Y,g,!1),Q=new vb,N=new vb,X=new vb);var r,M,D,Z=this,G=this.vertices.length,S=f.extractPoints(w),k=S.shape,v=S.holes,L=!ud.isClockWise(k);if(L){for(k=k.reverse(),M=0,D=v.length;D>M;M++)r=v[M],ud.isClockWise(r)&&(v[M]=r.reverse());L=!1}var P=ud.triangulateShape(k,v),b=k;for(M=0,D=v.length;D>M;M++)r=v[M],k=k.concat(r);for(var c,J,h=k.length,s=P.length,A=0;h>A;A++)c=k[A],W?(N.copy(x.normals[0]).multiplyScalar(c.x),Q.copy(x.binormals[0]).multiplyScalar(c.y),X.copy(j[0]).add(N).add(Q),T(X.x,X.y,X.z)):T(c.x,c.y,0);var K;for(K=1;g>=K;K++)for(A=0;h>A;A++)c=k[A],W?(N.copy(x.normals[K]).multiplyScalar(c.x),Q.copy(x.binormals[K]).multiplyScalar(c.y),X.copy(j[K]).add(N).add(Q),T(X.x,X.y,X.z)):T(c.x,c.y,m/g*K);i(),l()};var kb=function(S,j,I,q,E){function J(L,O,D){return P.vertices.push(new vb(L,O,D))-1}oq.call(this),j=j||64,I=I||1,q=q||8,E=E||!1;var G,a,V,o,$,w,W,h,e,x,m,D,Z,s,n,Y,K,v,t,d,U=[],P=this,M=j+1,Q=new vb,L=new kb.FrenetFrames(S,j,E),l=L.tangents,p=L.normals,R=L.binormals;for(this.tangents=l,this.normals=p,this.binormals=R,e=0;M>e;e++)for(U[e]=[],o=e/(M-1),h=S.getPointAt(o),G=l[e],a=p[e],V=R[e],x=0;q>x;x++)$=x/q*A,w=-I*c($),W=I*N($),Q.copy(h),Q.x+=w*a.x+W*V.x,Q.y+=w*a.y+W*V.y,Q.z+=w*a.z+W*V.z,U[e][x]=J(Q.x,Q.y,Q.z);for(e=0;j>e;e++)for(x=0;q>x;x++)m=E?(e+1)%j:e+1,D=(x+1)%q,Z=U[e][x],s=U[m][x],n=U[m][D],Y=U[e][D],K=new lr(e/j,x/q),v=new lr((e+1)/j,x/q),t=new lr((e+1)/j,(x+1)/q),d=new lr(e/j,(x+1)/q),this.faces.push(new Df(Z,s,Y)),this.faceVertexUvs[0].push([K,v,d]),this.faces.push(new Df(s,n,Y)),this.faceVertexUvs[0].push([v.clone(),t,d.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};kb.prototype=kd(jm),kb.FrenetFrames=function(c,r,M){function g(){j[0]=new vb,F[0]=new vb,x=Number.MAX_VALUE,q=w(Y[0].x),e=w(Y[0].y),$=w(Y[0].z),x>=q&&(x=q,H.set(1,0,0)),x>=e&&(x=e,H.set(0,1,0)),x>=$&&H.set(0,0,1),z.crossVectors(Y[0],H).normalize(),j[0].crossVectors(Y[0],z),F[0].crossVectors(Y[0],j[0])}var v,x,q,e,$,N,U,H=new vb,Y=[],j=[],F=[],z=new vb,b=new Yj,f=r+1,s=1e-4;for(this.tangents=Y,this.normals=j,this.binormals=F,N=0;f>N;N++)U=N/(f-1),Y[N]=c.getTangentAt(U),Y[N].normalize();for(g(),N=1;f>N;N++)j[N]=j[N-1].clone(),F[N]=F[N-1].clone(),z.crossVectors(Y[N-1],Y[N]),z.length()>s&&(z.normalize(),v=l(am(Y[N-1].dot(Y[N]),-1,1)),j[N].applyMatrix4(b.makeRotationAxis(z,v))),F[N].crossVectors(Y[N],j[N]);if(M)for(v=l(am(j[0].dot(j[f-1]),-1,1)),v/=f-1,Y[0].dot(z.crossVectors(j[0],j[f-1]))>0&&(v=-v),N=1;f>N;N++)j[N].applyMatrix4(b.makeRotationAxis(Y[N],v*N)),F[N].crossVectors(Y[N],j[N])};var $e=function(K,v,k,P){oq.call(this),v=v||18,k=k||0,P=P==O?A:P;for(var s=1/(K.length-1),o=1/v,a=0,S=v;S>=a;a++)for(var H=k+a*o*P,C=c(H),r=N(H),Q=0,F=K.length;F>Q;Q++){var t=K[Q],U=new vb;U.x=C*t.x-r*t.y,U.y=r*t.x+C*t.y,U.z=t.z,this.vertices.push(U)}for(var e=K.length,a=0,S=v;S>a;a++)for(var Q=0,F=K.length-1;F>Q;Q++){var g=Q+e*a,Z=g,i=g+e,C=g+1+e,u=g+1,B=a*o,l=Q*s,j=B+o,X=l+s;this.faces.push(new Df(Z,u,i)),this.faceVertexUvs[0].push([new lr(B,l),new lr(B,X),new lr(j,l)]),this.faces.push(new Df(i,u,C)),this.faceVertexUvs[0].push([new lr(j,l),new lr(B,X),new lr(j,X)])}this.mergeVertices(),df(this),this.computeFaceNormals(),this.computeVertexNormals()};$e.prototype=kd(jm);var sc=function(i,z){z=z||{};var e=vi.generateShapes(i,z);z.amount=z.amount!==n?z.amount:.5,z.convertYZ=!1,z.fill!==!1&&(z.bottom=!0,z.top=!0),Gf.call(this,e,z)};sc.prototype=kd(wb);var Vj=Y.Node=function(){Ck(Vj,this)},Ng={X:Tf,Y:Lq,Z:Be},Ip={X:0,Y:1,Z:2},Jg={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},je="xzy",gb=function(f,C,c){if(C){var O=C[0],h=C[1],b=C[2];"xzy"===c?(Lq(f,h),Be(f,b),Tf(f,O)):"xyz"===c?(Be(f,b),Lq(f,h),Tf(f,O)):"yxz"===c?(Be(f,b),Tf(f,O),Lq(f,h)):"yzx"===c?(Tf(f,O),Be(f,b),Lq(f,h)):"zxy"===c?(Lq(f,h),Tf(f,O),Be(f,b)):"zyx"===c?(Tf(f,O),Lq(f,h),Be(f,b)):(Lq(f,h),Be(f,b),Tf(f,O))}};ij("Node",Jh,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:je,_64O:0,_rotationX:0,_53O:0,_host:O,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Re},_22Q:function(){return Uj},getX:function(){return this.p().x},setX:function(S){this.p(S,this.p().y)},getY:function(){return this.p().y},setY:function(n){this.p(this.p().x,n)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(o){this.setAnchor(o,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(C){this.setAnchor(this.getAnchor().x,C)},getScaleX:function(){return this.getScale().x},setScaleX:function(d){this.setScale(d,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(n){this.setScale(this.getScale().x,n)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(D,u){$i(D,Dn(O,O,this.r3(),this.getRotationMode())),this.translate3d(D[0]*u,D[1]*u,D[2]*u)},translateFront:function(W){this.translate3dBy([0,0,1],W)},translateBack:function(R){this.translate3dBy([0,0,-1],R)},translateLeft:function(p){this.translate3dBy([-1,0,0],p)},translateRight:function(b){this.translate3dBy([1,0,0],b)},translateTop:function(Q){this.translate3dBy([0,1,0],Q)},translateBottom:function(Z){this.translate3dBy([0,-1,0],Z)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(F,E,r){1===arguments.length&&(E=F[1],r=F[2],F=F[0]),this.p(F,r),this.setElevation(E)},translate3d:function(J,O,N){1===arguments.length&&(O=J[1],N=J[2],J=J[0]),this.translate(J,N),this.setElevation(this._54O+O)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(F,M,i){1===arguments.length&&(M=F[1],i=F[2],F=F[0]),this.setSize(F,i),this.setTall(M)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(I,r,o){1===arguments.length&&(r=I[1],o=I[2],I=I[0]),this.setRotationX(I),this.setRotation(-r),this.setRotationZ(o)},setRotationY:function(R){this.setRotation(-R)},getRotationY:function(){return-this._64O},lookAtDirection:function(G,f){f=f||pj;var Z=this,N=rs(G);f===pj?(Z.r3([-S(G[1]/N),-E(G[2],G[0])+M,0]),Z.setRotationMode("xzy")):f===xq?(Z.r3(0,-E(G[2],G[0]),S(G[1]/N)),Z.setRotationMode("zyx")):f===dj?(Z.r3(0,-E(G[2],G[0])+t,-S(G[1]/N)),Z.setRotationMode("zyx")):f===nh?(Z.r3([-S(G[1]/N)+M,-E(G[2],G[0])+M,0]),Z.setRotationMode("xzy")):f===$c&&(Z.r3([-S(G[1]/N)-M,-E(G[2],G[0])+M,0]),Z.setRotationMode("xzy")),f===qp&&(Z.r3([-S(G[1]/N)+t,-E(G[2],G[0])+M,t]),Z.setRotationMode("zxy"))},lookAt:function(R,W){return this.lookAtDirection(hi(R,this.p3()),W)},lookAtX:function(){var o=new sh,z=new sh,N=new sh,J=new Hf,R=new Hf,g=new Gj;return function(q,w){var G=mk(this);if(J.fromArray(G),N.copy(this.p3()),o.copy(q).sub(N),!(o.lengthSq()<1e-6)){o.normalize(),w===pj?z.set(0,0,1):w===qp?z.set(0,0,-1):w===dj?z.set(-1,0,0):w===xq?z.set(1,0,0):w===nh?z.set(0,1,0):w===$c&&z.set(0,-1,0),z.applyMatrix4(J).sub(N).normalize();var X=Math.acos(o.dot(z));if(X){var Y=o.clone().cross(z);Y.lengthSq()<1e-6&&(w===nh||w===$c?Y.set(0,0,1).applyMatrix4(J).sub(N):Y.set(0,1,0).applyMatrix4(J).sub(N)),Y.normalize(),g.set(this.r3(),this.getRotationMode(),!0),J.makeRotationFromEuler(g),R.makeRotationAxis(Y,-X),g.setFromRotationMatrix(R.multiply(J)),this.r3([g.x,g.y,g.z])}}}}(),getHost:function(){return this._host},setHost:function(i){var h=this;if(h!==i&&h._host!==i){var w=h._host;w&&w._removeAttach(h),h._host=i,h._host&&h._host._addAttach(h),h.fp("host",w,i),h.onHostChanged(w,i)}},getAttaches:function(){return this._69O},_addAttach:function(o){var A=this;A._69O||(A._69O=new zf),A._69O.add(o),A.fp("attaches",O,o)},_removeAttach:function(S){var j=this;j._69O.remove(S),j._69O.isEmpty()&&delete j._69O,j.fp("attaches",S,O)},getImage:function(){if(this._pendingCheckImageJSON){var q=j.getImage(this._image);q&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Wo&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(X){var K=this,x=K._image,n=K.getWidth(),r=K.getHeight();K._image=X,K.fp("image",x,X)&&(null!=X&&(Xj(X)||xh(X)&&/\.json$/i.test(X))&&(this._pendingCheckImageJSON=!0),K.fp(Ml,n,K.getWidth()),K.fp(rj,r,K.getHeight()))},getElevation:function(){return this._54O},setElevation:function(K){var x=this;if(!x._50O){x._50O=1;var a=x._54O;x._54O=K,x.fp(Ee,a,K),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(r){var X=this;if(!X._49O){X._49O=1;var P=X._64O;X._64O=r,X.fp(Sk,P,r),delete X._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(D){var x=this;if(!x._51O){x._51O=1;var b=x._rotationX;x._rotationX=D,x.fp("rotationX",b,D),delete x._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(q){var z=this;if(!z._52O){z._52O=1;var H=z._53O;z._53O=q,z.fp("rotationZ",H,q),delete z._52O}},getPosition:function(){return this._position},setPosition:function(d,A){var y=this;if(!y._50I){y._50I=1;var V;if(V=2===arguments.length?{x:d,y:A}:d,V.x!==y._position.x||V.y!==y._position.y){var D=y._position;y._position=V,y.fp(mj,D,V)}delete y._50I}},translate:function(F,$){var e=this._position;this.p(e.x+F,e.y+$)},getWidth:function(){var n=this;if(n._width>=0)return n._width;var Z=n.getStyle("shape3d");if(Z){var T=Xi(Z);if(T&&T.rawS3)return T.rawS3[0];if("billboard"===Z||"plane"===Z){var s=co(n.getStyle("shape3d.image"));return s?Ne(s,n):20}}var s=co(n._image);return s?Ne(s,n):20},setWidth:function(r){var j=this,z=j._width;j._width=r,j.fp(Ml,z,r)},getHeight:function(){var v=this;if(v._height>=0)return v._height;var C=v.getStyle("shape3d");if(C){var b=Xi(C);if(b&&b.rawS3)return b.rawS3[2];if("plane"===C){var n=co(v.getStyle("shape3d.image"));return n?Jf(n,v):20}if("billboard"===C)return 2}var n=co(v._image);return n?Jf(n,v):20},setHeight:function(u){var X=this,M=X._height;X._height=u,X.fp(rj,M,u)},getTall:function(){var v=this;if(v._tall>=0)return v._tall;var _=v.getStyle("shape3d");if(_){var p=Xi(_);if(p&&p.rawS3)return p.rawS3[1];if("billboard"===_){var L=co(v.getStyle("shape3d.image"));return L?Jf(L,v):20}if("plane"===_)return 2}return 20},setTall:function(z){var O=this,G=O._tall;O._tall=z,O.fp("tall",G,z)},setSize:function(J,A){var z=this;2===arguments.length?(z.setWidth(J),z.setHeight(A)):(z.setWidth(J.width),z.setHeight(J.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(a,f,H,C,D){var P=this,B=P.getAnchor(),T=P.getScale();arguments.length<=2&&(D=f,f=a.y,H=a.width,C=a.height,a=a.x);var l=D&&T.x<0?1-B.x:B.x,v=D&&T.y<0?1-B.y:B.y;P.p(a+H*l,f+C*v),D&&(H/=Math.abs(T.x),C/=Math.abs(T.y)),P.setWidth(H),P.setHeight(C)},getMatrix:function(){var l=this,b=l._64O,F=l._position,O=l.getScale();return new eg(b,F.x,F.y,O.x,O.y)},getAnchorRect:function(){var F=this,a=F.getWidth(),z=F.getHeight(),W=F.getAnchor();return{x:-a*W.x,y:-z*W.y,width:a,height:z}},toLocal:function(T){return this.getMatrix().tfi(T)},toGlobal:function(M){return this.getMatrix().tf(M)},getAttachPosition:function(){var M=new eg;return function(s,T,w,a){w=w||0,a=a||0;var H=this,J=H.getAnchor(),X=H._64O,q=H._position,f=H.getScale();return M.setFromTransform(X,q.x,q.y).tf({x:w+f.x*H.getWidth()*(s-J.x),y:a+f.y*H.getHeight()*(T-J.y)})}}(),isInRect:function(Y){Y=this.toLocal(Y);var b=this.getWidth(),V=this.getHeight();return Y.x+=b*this.getAnchorX(),Y.y+=V*this.getAnchorY(),!(Y.x<0||Y.y<0||Y.x>b||Y.y>V)},getRect:function(){var Y=this,R=Y.getWidth(),u=Y.getHeight(),S=Y.getAnchor(),z={x:-R*S.x,y:-u*S.y,width:R,height:u},y=Y.getMatrix();return z=pr([y.tf(z.x,z.y),y.tf(z.x+z.width,z.y),y.tf(z.x+z.width,z.y+z.height),y.tf(z.x,z.y+z.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var t=this,d=t.getAnchor(),n=t._anchorElevation;return{x:d.x,y:n,z:d.y}},setAnchorElevation:function(N){var G=this,e=G._anchorElevation;return e!==N?(G._anchorElevation=N,G.fp("anchorElevation",e,N),!0):!1},setAnchor3d:function(_,o,W,e){var K,R=this;"number"==typeof _?K={x:_,y:o,z:W}:(K=_.length?{x:_[0],y:_[1],z:_[2]}:_,e=o);var l=R.getDataModel();l&&l.beginTransaction();var A=R.getAnchor3d(),F=R.setAnchor(K.x,K.z);if(R.setAnchorElevation(K.y)&&(F=!0),F&&e&&!fe){R.getAnchor3d();var b=mk(R),J=$i([K.x-A.x,K.y-A.y,K.z-A.z],b);R.p3(J)}return l&&l.endTransaction(),F},getAnchor:function(){var V=this;if(V.hasOwnProperty("_anchor"))return V._anchor;var c=co(V._image);return c&&c.anchorX!==n?{x:c.anchorX,y:c.anchorY}:V._anchor},setAnchor:function(m,W,B){var u,g=this;"number"==typeof m?u={x:m,y:W}:(u=m.length?{x:m[0],y:m[1]}:m,B=W);var J=g.getAnchor();if(J.x!==u.x||J.y!==u.y){var X=g.getDataModel();if(X&&X.beginTransaction(),g._anchor=u,g.fp("anchor",J,u),B&&!fe){var C=g.getPosition(),Q=g.getSize(),T=g.getRotation(),E=g.getScale(),Y=-Q.width*(J.x-u.x)*E.x,$=-Q.height*(J.y-u.y)*E.y,d=N(T),L=c(T);g.setPosition(C.x+L*Y-d*$,C.y+d*Y+L*$)}return X&&X.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(t,s){var k,b=this;k=2===arguments.length?{x:t,y:s}:t;var l=b.getScale();(l.x!==k.x||l.y!==k.y)&&(b._scale=k,b.fp("scale",l,k))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var E=this,T=E._scaleTall,c=E.getScale();return[c.x,T,c.y]},getFinalScale3d:function(){var m=this,J=m.s3(),H=m._dynamicScale3d,W=m.getScale3d();return J&&(W[0]*=J[0],W[1]*=J[1],W[2]*=J[2]),H&&(W[0]*=H[0],W[1]*=H[1],W[2]*=H[2]),W},getFinalRotation3d:function(){var B=this;return B._dynamicRotation||B.r3()},setScaleTall:function(Q){var C=this,m=C._scaleTall;m!==Q&&(C._scaleTall=Q,C.fp("scaleTall",m,Q))},setScale3d:function(E,i,Z){var h,w=this;h="number"==typeof E?{x:E,y:i,z:Z}:E.length?{x:E[0],y:E[1],z:E[2]}:E,w.setScaleTall(h.y),w.setScale(h.x,h.z)},getCorners:function(f,i){f==O&&(f=0),i==O&&(i=f);var Y=this,A=Y.getAnchor(),o=Y.getWidth(),b=Y.getHeight(),t=-o*A.x-f,N=-b*A.y-i,y=o+2*f,C=b+2*i,_=Y.getMatrix();return[_.tf(t,N),_.tf(t,N+C),_.tf(t+y,N+C),_.tf(t+y,N)]},getEditControlPoints:function(U,S,e){S==O&&(S=0),e==O&&(e=S);var W=this,j=W.getAnchor(),I=W.getWidth(),a=W.getHeight(),l=-I*j.x-S,G=-a*j.y-e,n=I+2*S,R=a+2*e;if(U)return[{x:l,y:G},{x:l,y:0},{x:l,y:G+R},{x:0,y:G+R},{x:l+n,y:G+R},{x:l+n,y:0},{x:l+n,y:G},{x:0,y:G}];var Z=W.getMatrix();return[Z.tf(l,G),Z.tf(l,0),Z.tf(l,G+R),Z.tf(0,G+R),Z.tf(l+n,G+R),Z.tf(l+n,0),Z.tf(l+n,G),Z.tf(0,G)]},rotateAt:function(R,O,V){var a=this,f=a._position,$=a._64O,F=new eg($,f.x,f.y).tf(R,O),K=e(R*R+O*O),t=E(f.y-F.y,f.x-F.x)+V;a.setRotation($+V),a.p(F.x+K*c(t),F.y+K*N(t))},onParentChanged:function(){Vj.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var n={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(Q){n[Q]=!0}),function(B){var K=this;Vj.superClass.onPropertyChanged.call(K,B),n[B.property]&&!K._layoutUpdating&&K.updateLayoutParameters(null,B.property),K._69O&&K._69O.each(function(e){e.handleHostPropertyChange(B)}),K._49I&&K._49I.each(function(T){T.fp("agentChange",!0,!1)}),"a:layout"===B.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(h){this.updateAttach(h)},onStyleChanged:function(C){Vj.superClass.onStyleChanged.apply(this,arguments),Gb[C]&&this.updateAttach()},updateAttach:function(x){var h=this;return fe?(h.updateLayoutParameters(),void 0):(h._51I||(h._51I=1,h._71O(x),delete h._51I),void 0)},_71O:function(z){var G,I,x,b,t,J,l,f,V=this,s=V._host,p=z?z.property:O,N=z?z.oldValue:O,W=z?z.newValue:O;if(s instanceof Vj&&(l=co(s.getImage()),l&&l.layoutAttach&&(f=l.layoutAttach)),z&&!Ad[p]&&"a:layout"!==p.substring(0,8)||!f||f(s,this))if(s instanceof Y.Grid){if(p===Ee)V.setElevation(V._54O+W-N);else if(!z||en[p]){if(G=V.s("attach.row.index"),I=V.s("attach.column.index"),x=s.getCellRect(G,I),!x)return;b=V.s("attach.row.span"),t=V.s("attach.column.span"),(1!==b||1!==t)&&(x=ur(x,s.getCellRect(G+b-1,I+t-1))),qj(x,V,"attach.padding",1),V.setRect(x)}}else if(s instanceof Ll&&(J=V.s("attach.index"))>=0&&(!z||Ek[p])){var i=V.s("attach.thickness"),F=s.getScale(),u=Math.max(F.x,F.y);i>0&&V.setHeight(s.getThickness()*i*u);var w=V.s("attach.offset"),r=s.getPoints(),B=r.size();if(B>J){var q=s.getPointsMatrix2d(),C=r.get(J),$=B===J+1?r.get(0):r.get(J+1);C=q.apply(C),$=q.apply($);var a=[$.x-C.x,$.y-C.y],g=rs(a);if(g){V.s("attach.offset.relative")&&(w*=g),V.s("attach.offset.opposite")&&(w=g-w);var U={x:C.x+a[0]/g*w,y:C.y+a[1]/g*w},S=V.s("attach.gap");S&&(V.s("attach.gap.relative")&&(S*=s.getThickness()*u),U=$b(O,U,$,S)),V.p(U),V.setRotation(E(a[1],a[0]))}}}else z&&(p===mj?V.translate(W.x-N.x,W.y-N.y):p===Ee?V.setElevation(V._54O+W-N):po[p]?V._11Q(s,p,W-N):("anchor"===p||"width"===p||"height"===p||"scale"===p)&&V.layout(s))},_11Q:function(){var p=new Y.Math.Euler,W=Y.Math.Euler.ReverseOrder,i=new Y.Math.Vector2,r=new Y.Math.Vector2;return function(u,e,F){var h=this,Z=u.p3(),b=u.r3(),X=h.p3(),c=h.r3();if(e===Sk&&(e="rotationY",F=-F),(e===Sk||"rotationY"===e)&&0===c[0]&&0===c[2]&&0===b[0]&&0===b[2]&&0===X[1]&&0===Z[1])return h.setRotation(-c[1]-F),i.set(X[0],X[2]).rotateAround(r.set(Z[0],Z[2]),-F),h.p(i.x,i.y),void 0;var k=Jg[u.getRotationMode()],G=k[0],R=k[1],D=k[2],Y=Ng[G],$=Ng[R],N=Ng[D],A=Zk();e===Sk+G?(N(A,b[Ip[D]]),$(A,b[Ip[R]]),Y(A,F),$(A,-b[Ip[R]]),N(A,-b[Ip[D]])):e===Sk+R?(N(A,b[Ip[D]]),$(A,F),N(A,-b[Ip[D]])):e===Sk+D&&N(A,F);var y=hi(X,Z);$i(y,A),h.p3(Z[0]+y[0],Z[1]+y[1],Z[2]+y[2]);var x=h.getRotationMode();gb(A,h.r3(),x),p.setFromRotationMatrix(A,W(x)),h.r3([p.x,p.y,p.z])}}(),isHostOn:function(u){var C=this;if(C._host&&u&&u._69O)for(var v={},s=C._host;s&&s!==C&&!v[s._id];){if(s===u)return!0;v[s._id]=s,s=s._host}return!1},isLoopedHostOn:function(n){return this.isHostOn(n)&&n.isHostOn(this)},getScaledSize:function(){var n=this.getSize(),S=this.getScale();return n.width*=Math.abs(S.x),n.height*=Math.abs(S.y),n},layout:function(Q){if(Q=Q||this.getHost()){var U=this,W=U.s("layout.h")||"center",C=U.s("layout.v")||"center";if("center"!==W||"center"!==C){var H=new Y.Math.Vector2,Z=Q.getPosition(),z=Q.getAnchor(),G=Q.getScaledSize();U.getPosition();var m,M,a,g,f,X=1,h=1;switch(U._layoutUpdating=!0,W){case"left":H.setX(U._layoutHValue-z.x*G.width);break;case"right":H.setX((1-z.x)*G.width-U._layoutHValue);break;case"leftright":m=G.width-U._layoutHValue[2],a=U.getRotation()-Q.getRotation(),g=Math.abs(Math.sin(a)),f=Math.abs(Math.cos(a)),X+=f*m/U._layoutHValue[3],h+=g*m/U._layoutHValue[4],H.setX(U._layoutHValue[1]+(U._layoutHValue[5]-z.x)*G.width);break;case"center":H.setX((.5-z.x)*G.width-U._layoutHValue);break;case"scale":a=U.getRotation()-Q.getRotation(),g=Math.abs(Math.sin(a)),f=Math.abs(Math.cos(a)),H.setX((.5-z.x)*G.width-U._layoutHValue[1]*G.width/U._layoutHValue[0]),M=G.width/U._layoutHValue[2]-1,X+=f*M,h+=g*M}switch(C){case"top":H.setY(U._layoutVValue-z.y*G.height);break;case"bottom":H.setY((1-z.y)*G.height-U._layoutVValue);break;case"topbottom":a||(a=U.getRotation()-Q.getRotation(),g=Math.abs(Math.sin(a)),f=Math.abs(Math.cos(a))),m=G.height-U._layoutVValue[2],X+=g*m/U._layoutVValue[3],h+=f*m/U._layoutVValue[4],H.setY(U._layoutVValue[1]+(U._layoutVValue[5]-z.y)*G.height);break;case"center":H.setY((.5-z.y)*G.height-U._layoutVValue);break;case"scale":a||(a=U.getRotation()-Q.getRotation(),g=Math.abs(Math.sin(a)),f=Math.abs(Math.cos(a))),H.setY((.5-z.y)*G.height-U._layoutVValue[1]*G.height/U._layoutVValue[0]),M=G.height/U._layoutVValue[2]-1,X+=g*M,h+=f*M}if("leftright"===W||"scale"===W||"topbottom"===C||"scale"===C){var e=this.getScale(),R=Math.abs(e.x),J=Math.abs(e.y);"leftright"===W||"scale"===W?U.setSize(U._layoutHValue[3]*X/R,U._layoutHValue[4]*h/J):U.setSize(U._layoutVValue[3]*X/R,U._layoutVValue[4]*h/J)}H.rotateAround(null,Q.getRotation()),this.setPosition(H.x+Z.x,H.y+Z.y),U._layoutUpdating=n
}}},updateLayoutParameters:function(e,H){if(e=e||this.getHost()){var M=this,D=M.s("layout.h"),Q=M.s("layout.v");if(D||Q){var v,u,T,b,V,W,m=new Y.Math.Vector2,x=e.getPosition(),I=e.getAnchor(),g=e.getScaledSize(),J=M.getPosition(),R=M.getScaledSize();switch(m.set(J.x-x.x,J.y-x.y),m.rotateAround(null,-e.getRotation()),D){case"left":M._layoutHValue=m.x+I.x*g.width;break;case"right":M._layoutHValue=-m.x+(1-I.x)*g.width;break;case"center":M._layoutHValue=-m.x+(.5-I.x)*g.width;break;case"leftright":case"scale":"scale"===D?v=-m.x+(.5-I.x)*g.width:(u=M.getAnchor(),T=M.getRotation()-e.getRotation(),b=Math.cos(T),V=Math.sin(T),W=-Math.min(-u.x*b+u.y*V,-u.x*b-(1-u.y)*V,(1-u.x)*b+u.y*V,(1-u.x)*b-(1-u.y)*V),v=m.x-(W-I.x)*g.width),"position"===H&&"object"==typeof M._layoutHValue?(M._layoutHValue[0]=g.width,M._layoutHValue[1]=v):M._layoutHValue=[g.width,v,g.width,R.width,R.height,W]}switch(Q){case"top":M._layoutVValue=m.y+I.y*g.height;break;case"bottom":M._layoutVValue=-m.y+(1-I.y)*g.height;break;case"center":M._layoutVValue=-m.y+(.5-I.y)*g.height;break;case"topbottom":case"scale":"scale"===Q?v=-m.y+(.5-I.y)*g.height:(T||(u=M.getAnchor(),T=M.getRotation()-e.getRotation(),b=Math.cos(T),V=Math.sin(T)),W=-Math.min(-u.x*V-u.y*b,-u.x*V+(1-u.y)*b,(1-u.x)*V-u.y*b,(1-u.x)*V+(1-u.y)*b),v=m.y-(W-I.y)*g.height),"position"===H&&"object"==typeof M._layoutVValue?(M._layoutVValue[0]=g.height,M._layoutVValue[1]=v):M._layoutVValue=[g.height,v,g.height,R.width,R.height,W]}}}},getSerializableProperties:function(){var g=Vj.superClass.getSerializableProperties.call(this);return Dq(g,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),g}});var Fm=Y.Edge=function(X,Y){var q=this;Ck(Fm,q),q.setSource(X),q.setTarget(Y)};ij("Edge",Jh,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return jj},_22Q:function(){return nm},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(i){if(i===this)return!1;if(De(i))return!0;for(var M,m,p,C,Z,I=[this],S=-1,B=0;B>S;)if(S++,M=I[S],m=M._44I)for(m=m.getArray(),C=0,Z=m.length;Z>C;C++)if(p=m[C],_n(p)&&!(I.indexOf(p)>=0)){if(p===i)return!1;I.push(p),B++}return!0},setSource:function(f){var Y=this;if(Y._source!==f&&Y.canSetSourceTarget(f)){var M=Y._source;Y._source=f,M&&M._16I(Y),f&&f._2I(Y),Y._7I(),Y.fp("source",M,f)}},setTarget:function(b){var U=this;if(U._target!==b&&U.canSetSourceTarget(b)){var A=U._target;U._target=b,A&&A._18I(U),b&&b._4I(U),U._7I(),U.fp("target",A,b)}},isLooped:function(){var j=this;return j._source===j._target&&De(j._source)&&De(j._target)},onPropertyChanged:function(){var k=this;k._49I&&k._49I.each(function(a){a.fp("agentChange",!0,!1)})},_7I:function(){var C,t=this,Q=Dp(t);t._40I!==Q&&(C=this._40I,C&&C._15I(t),t._40I=Q,Q&&Q._1I(t),t.fp("sourceAgent",C,Q),ff(C,t._41I),ff(Q,t._41I));var j=Kk(t);t._41I!==j&&(C=t._41I,C&&C._17I(t),t._41I=j,j&&j._3I(t),t.fp("targetAgent",C,j),ff(C,t._40I),ff(j,t._40I))},_22I:function(j){this._52I=j,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var V=this;return V._52I&&V._52I.get(0)!==V&&!V.getStyle(Yi)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,r=A._52I;return r&&!A.getStyle(Yi)&&r.size()>1&&A===r.get(0)},toggle:function(){this.beginTransaction();var l=this._52I,Z=!this.s(Yi);l&&l.size()>1&&(l.each(function(C){C.s(Yi,Z)}),l.getSiblings().each(function(y){y!==l&&y.each(function(C){C.fp("edgeGroup",O,y)})})),this.endTransaction()},setStyle:function(t,g){(t===tn||"edge.segments"===t)&&(g=Sm(g)),Fm.superClass.setStyle.call(this,t,g)},onStyleChanged:function(r){Fm.superClass.onStyleChanged.apply(this,arguments),Pc[r]&&ff(this._41I,this._40I)},getSerializableProperties:function(){var h=Fm.superClass.getSerializableProperties.call(this);return Dq(h,{source:1,target:1}),h}});var ye=Y.Group=function(){Ck(ye,this)};ij("Group",Vj,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return _j},onChildAdded:function(){ye.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ye.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var W=this;if(!W._54I&&!fe){var A=W.getChildrenRect();A&&(W._53I=1,W.p(Ke(W.s("group.position"),A,W.getSize())),delete W._53I)}},getChildrenRect:function(){var n,o=this;return o.eachChild(function(b){De(b)&&(n=ur(n,o.getChildRect(b)))}),n},getChildRect:function(d){var m;return De(d)&&d.s(sp)&&(mh(d)&&d.isExpanded()&&d.eachChild(function(H){m=ur(m,d.getChildRect(H))}),!m&&d.getRect&&(m=d.getRect())),m},setPosition:function(Z,g){var B=this;if(!B._54I){var k;k=2===arguments.length?{x:Z,y:g}:Z,fe||B._53I||(B._54I=1,qq(B._children,k.x-B._position.x,k.y-B._position.y),delete B._54I),ye.superClass.setPosition.call(this,k)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(S){var R=this;if(R._57O!==S){var t=R._57O;R._57O=S,R.fp("expanded",t,R._57O),R._fireInvalidateDeep(),R._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(j){mh(j)?j._fireInvalidateDeep():j.iv()})},_8I:function(){ye.superClass._8I.call(this),this.eachChild(function(A){De(A)&&A._8I()})},onStyleChanged:function(B){ye.superClass.onStyleChanged.apply(this,arguments),"group.position"===B&&this._81I()},getSerializableProperties:function(){var S=ye.superClass.getSerializableProperties.call(this);return S.expanded=1,S}});var nk=Y.Block=function(){Ck(nk,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};ij("Block",Vj,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return ih},_22Q:function(){return Rj},onChildAdded:function(){nk.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){nk.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function p(T,b,V){e.fromArray(mk(b));var t=b.getAnchor3d();T.push((new sh).set(0-t.x,0-t.y,0-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(0-t.x,0-t.y,1-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(0-t.x,1-t.y,0-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(0-t.x,1-t.y,1-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(1-t.x,0-t.y,0-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(1-t.x,0-t.y,1-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(1-t.x,1-t.y,0-t.z).applyMatrix4(e).applyMatrix4(V)),T.push((new sh).set(1-t.x,1-t.y,1-t.z).applyMatrix4(e).applyMatrix4(V))}function W(d,P){var k=this.p3(),Z=this.r3(),O=Zk();Bs(O,[-k[0],-k[1],-k[2]]),gb(O,[-Z[0],-Z[1],-Z[2]],this.getRotationMode()),O=(new Hf).fromArray(O),d.forEach(function(c){De(c)&&p(P,c,O)})}var e=new Hf;return function(S,n){if(S instanceof Y.Node&&(S=[S]),!S||0===S.length)return O;var n=[];W.call(this,S,n);var y=[1/0,1/0,1/0],B=[-1/0,-1/0,-1/0];return n.forEach(function(h){y[0]=Math.min(h.x,y[0]),y[1]=Math.min(h.y,y[1]),y[2]=Math.min(h.z,y[2]),B[0]=Math.max(h.x,B[0]),B[1]=Math.max(h.y,B[1]),B[2]=Math.max(h.z,B[2])}),{min:y,max:B}}}(),updateFromChildren:function(){var C=this;if(!fe&&!C._updatingToChildren&&C._syncSize&&0!==C.size()&&!C._freezeSyncFromChildren){var $=this._getBoundingBox(C.toChildren().toArray());if($){C._updatingFromChildren=1;var H=$.min,y=$.max,l=y[0]-H[0],E=y[2]-H[2],W=y[1]-H[1],n=new sh(l,W,E),z=new sh(1,1,1).divide((new sh).fromArray(this.getScale3d())).multiply(n);this.s3(Math.abs(z.x),Math.abs(z.y),Math.abs(z.z));var w=this.p3(),s=this.r3(),q=Zk();gb(q,s,this.getRotationMode()),Bs(q,w),q=(new Hf).fromArray(q);var T=this.getAnchor3d();return w=new sh(T).multiply(n).add((new sh).fromArray(H)).applyMatrix4(q),this.p3([w.x,w.y,w.z]),delete C._updatingFromChildren,void 0;var C}}},setPosition:function(m,d){var Y=this;if(!Y._updatingToChildren){var N;N=2===arguments.length?{x:m,y:d}:m,fe||Y._updatingFromChildren||(Y._updatingToChildren=1,qq(Y._children,N.x-Y._position.x,N.y-Y._position.y),delete Y._updatingToChildren),nk.superClass.setPosition.call(this,N)}},setWidth:function(K){return this.setSize(K,this.getHeight())},setHeight:function(O){return this.setSize(this.getWidth(),O)},setSize:function(q,e){var r=j.blockMinSize;q=P(q,r),e=P(e,r);var K=this;if(!K._updatingToChildren){2!==arguments.length&&(e=q.height,q=q.width);var d=K.getWidth(),c=K.getHeight();if(q!==d&&nk.superClass.setWidth.call(K,q),e!==c&&nk.superClass.setHeight.call(K,e),!fe&&!K._updatingFromChildren){K._updatingToChildren=1;var l=q/d,b=e/c;K._adjustChildScaleOrSize(l,b,"size"),delete K._updatingToChildren,K.updateFromChildren()}}},_adjustChildScaleOrSize:function(k,A,f){var U=this;if(U._syncSize){var x=U.getPosition(),m=U.getRotation();U.getScale(),U.eachChild(function(D){if(De(D)){var e=D.getPosition(),O=D.getRotation(),P=D.getWidth(),K=D.getHeight(),y=D.getScale(),T=y.x*P,u=y.y*K,U=new eg(O,e.x,e.y,T,u);U.translate(-x.x,-x.y),U.rotate(-m),O=E(U.b*Math.sign(T),U.a*Math.sign(T)),U.scale(k,A);var z,J,H,R=c(O);if(Math.abs(R)<.001?(z=N(O),J=U.b/z,H=-U.c/z):(J=U.a/R,H=U.d/R),"scale"===f)D.setScale(J/P,H/K);else if("size"===f){var s=J/y.x,w=H/y.y;D.setScale(uf(J)*Math.abs(y.x),uf(H)*Math.abs(y.y)),D instanceof Y.Shape?(D.setWidthForce(Math.max(Math.abs(s),1e-5)),D.setHeightForce(Math.max(Math.abs(w),1e-5))):D.setSize(Math.max(.01,Math.abs(s)),Math.max(.01,Math.abs(w)))}U.rotate(m),U.translate(x.x,x.y),D.setPosition(U.tx,U.ty)}})}},_calcChangeFactor:function(L,m,_,E){var J,v,U,l;return J=w(L),v=w(_),U=J>v?J/v:v/J,J=w(m),v=w(E),l=J>v?J/v:v/J,P(U,l)},setElevation:function(T){var a=this;if(!a._updatingToChildren){var r=a.getElevation(),D=T-r;0!==D&&(fe||a._updatingFromChildren||(a._updatingToChildren=1,qq(a._children,0,D,0),delete a._updatingToChildren),nk.superClass.setElevation.apply(a,arguments))}},setTall:function(e){var T=this;if(!T._updatingToChildren){e=P(e,j.blockMinSize);var S=T.getTall();if(e!==S&&nk.superClass.setTall.call(T,e),!fe&&!T._updatingFromChildren){T._updatingToChildren=1;var n=e/S;T._adjustChildTallOrScale(n,"size"),delete T._updatingToChildren,this.updateFromChildren()}}},setScaleTall:function(u){var f=this;if(!f._updatingToChildren){var N=f.getScaleTall();if(w(u)<.01&&(u=.01*(uf(u)||uf(N))),nk.superClass.setScaleTall.call(f,u),!fe&&!f._updatingFromChildren){f._updatingToChildren=1;var R=u/N;f._adjustChildTallOrScale(R,"size"),delete f._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(o,R){var Z=this;if(Z._syncSize){var V=Z.getElevation();Z.eachChild(function(K){if(De(K))if("size"===R){var $=K.getTall();0>o&&K.setScaleTall(-1*K.getScaleTall()),K.setTall(Math.max(.01,Math.abs($*o))),K.setElevation(V+(K.getElevation()-V)*o)}else{var E=K.getScaleTall();K.setScaleTall(E*o)}})}},setAnchor:function(){var Q=this;if(!Q._updatingToChildren){var X=Q.getAnchor(),Z=nk.superClass.setAnchor.apply(Q,arguments);if(fe||Q._updatingFromChildren||!Q._syncSize)return Z;Q._updatingToChildren=1;var B=Q.getAnchor();Q.getPosition();var i=Q.getSize(),a=Q.getScale(),w=Q.getRotation(),s=-i.width*a.x*(X.x-B.x),D=-i.height*a.y*(X.y-B.y),U=N(w),y=c(w),J=y*s-U*D,o=U*s+y*D;return Q.eachChild(function(X){if(De(X)){var d=X.getPosition();X.setPosition(d.x-J,d.y-o)}}),delete Q._updatingToChildren,Z}},setAnchorElevation:function(){var t=this;if(!t._updatingToChildren){var P=t.getAnchorElevation(),y=nk.superClass.setAnchorElevation.apply(t,arguments);if(fe||t._updatingFromChildren||!t._syncSize)return y;t._updatingToChildren=1;var d=t.getAnchorElevation(),X=t.getTall(),Y=t.getScaleTall(),E=-X*Y*(P-d);return t.eachChild(function(L){if(De(L)){var _=L.getElevation();L.setElevation(_-E)}}),delete t._updatingToChildren,y}},setRotation:function(x){this._updateChildrenRotation3d("rotation",x)},setRotationX:function(Z){this._updateChildrenRotation3d("rotationX",Z)},setRotationZ:function(C){this._updateChildrenRotation3d("rotationZ",C)},_updateChildrenRotation3d:function(r,K){var g=this;if(!g._updatingToChildren){var x=g[An(r)]();if(nk.superClass[Qg(r)].call(g,K),!fe&&!g._updatingFromChildren){g._updatingToChildren=1;var T=K-x;g.eachChild(function(b){De(b)&&b._11Q(g,r,T)}),delete g._updatingToChildren}}},setScale:function(C,Z){var Y=this;if(!Y._updatingToChildren){null==Z&&(Z=C.y,C=C.x);var j=Y.getScale();if(w(C)<.01&&(C=.01*(uf(C)||uf(j.x))),w(Z)<.01&&(Z=.01*(uf(Z)||uf(j.y))),nk.superClass.setScale.call(Y,C,Z),!fe&&!Y._updatingFromChildren){Y._updatingToChildren=1;var I=C/j.x,u=Z/j.y;Y._adjustChildScaleOrSize(I,u,"size"),delete Y._updatingToChildren,Y.updateFromChildren()}}},getSerializableProperties:function(){var k=nk.superClass.getSerializableProperties.call(this);return k.clickThroughEnabled=1,k.syncSize=1,k}});var Dm=Y.Grid=function(){Ck(Y.Grid,this)};ij("Grid",Vj,{IRotatable:!1,_icon:"grid_icon",_image:O,getUIClass:function(){return ln},setRotation:function(){},getCellRect:function(v,d){var e=this,w=e.s("grid.row.count"),J=e.s("grid.column.count");if(0>=w||0>=J||0>v||v>=w||0>d||d>=J)return O;var g,m,S,$=e.getRect(),s=e.s("grid.row.percents"),u=e.s("grid.column.percents");if(qj($,e,"grid.border",-1),s&&s._as&&(s=s._as),u&&u._as&&(u=u._as),s&&s.length===w){for(S=0,g=0;v>g;g++)S+=$.height*s[g];$.y+=S,$.height=$.height*s[v]}else $.height=$.height/w,$.y+=$.height*v;if(u&&u.length===J){for(m=0,g=0;d>g;g++)m+=$.width*u[g];$.x+=m,$.width=$.width*u[d]}else $.width=$.width/J,$.x+=$.width*d;return gn($,-e.s("grid.gap")),$}});var hh=Y.Text=function(){Ck(hh,this),this.setSize(100,50),this.s("text","TEXT")};ij("Text",Vj,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return fi},setWidth:function(W){W||(W=.001),hh.superClass.setWidth.call(this,W)},setHeight:function(C){C||(C=.001),hh.superClass.setHeight.call(this,C)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),hm("__text__",{width:{value:100,isSafeFunc:!0,func:function(p){return p?p._width:100}},height:{value:50,isSafeFunc:!0,func:function(s){return s?s._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Ll=Y.Shape=function(){Ck(Ll,this),this._59O=new zf};Ll.__de__=Ik,ij("Shape",Vj,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return gg},_22Q:function(){return wi},getLength:function(_){return jb(wj(this._59O,this._58O,_,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var F=this._58O;return F?new zf(F._as.slice(0)):F},setSegments:function(B){var X=this._58O;B=B?Hr(B)?new zf(B.slice(0)):new zf(B._as.slice(0)):null,(X&&B&&X._as.join(",")!==B._as.join(",")||X!==B)&&(this._58O=B,this.fp("segments",X,B))},getPoints:function(){return this._59O},toPoints:function(){var G=this._59O;return new zf(G._as.slice(0))},getPointsMatrix2d:function(){var D=this,V=new Jm.Matrix2d,y=D.getPosition(),K=D.getScale(),A=D.getRotation();return V.translate(-y.x,-y.y).scale(K.x,K.y).rotate(A).translate(y.x,y.y),V},getPointsMatrix3d:function(){return function(){var g=this,G=new Jm.Matrix4,F=G.getElements(),$=g.p3();Bs(F,$),gb(F,g.getFinalRotation3d(),g.getRotationMode());var q=g.getScale3d(),m=g._dynamicScale3d;return m&&(q[0]*=m[0],q[1]*=m[1],q[2]*=m[2]),Dc(F,q),Bs(F,qg($)),G}}(),setPoints:function(r,i){var L=this,M=L._59O;r=r?Hr(r)?new zf(r.slice(0)):new zf(r._as.slice(0)):new zf;var W,B,H,O,S,q;i&&(W=L.getPosition(),q=new eg(L.getRotation(),0,0,L.getScale().x,L.getScale().y)),(M&&r&&M._as.join(",")!==r._as.join(",")||M!==r)&&(L._59O=r,L.fs(),L.fp("points",M,r)),i&&(B=L.getPosition(),H=B.x-W.x,O=B.y-W.y,S=q.tf(H,O),L.setPosition(B.x-H+S.x,B.y-O+S.y))},addPoint:function(E,o,O){var $=this.toPoints();$.add(E,o),this.setPoints($,O)},setPoint:function(z,S,m){var w=this.toPoints();w.set(z,S),this.setPoints(w,m)},removePointAt:function(M){var m=this.toPoints();m.removeAt(M),this.setPoints(m)},setWidthForce:function(x){var O=this;if(!O._55I&&!fe&&O.getWidth()){O._55I=1;var Z=O._position.x,r=x/O.getWidth(),a=O.toPoints(),y=new zf;1!==r&&(a.each(function(C){y.add({x:(C.x-Z)*r+Z,y:C.y,e:C.e})}),O.setPoints(y),Nf(O,[r,0,0,1,Z*(1-r),0]),O.fs()),delete O._55I}Ll.superClass.setWidth.call(O,x)},setWidth:function(b){return this.setWidthForce(Wg>b?Wg:b)},setHeightForce:function(x){var D=this;if(!D._55I&&!fe&&D.getHeight()){D._55I=1;var Y=D._position.y,U=x/D.getHeight(),i=D.toPoints(),L=new zf;1!==U&&(i.each(function(l){L.add({x:l.x,y:(l.y-Y)*U+Y,e:l.e})}),D.setPoints(L),Nf(D,[1,0,0,U,0,Y*(1-U)]),D.fs()),delete D._55I}Ll.superClass.setHeight.call(D,x)},setHeight:function(b){return this.setHeightForce(Wg>b?Wg:b)},setAnchorElevation:function(z){var n=this;n._55I=!0;var Z=n._updatingAnchor3d,g=!fe&&!Z;if(g){var M,x=z,T=n.getAnchorElevation(),G=n.getTall();M=G*(T-x),0!==M&&n.shiftPointsElevation(M)}var F=Ll.superClass.setAnchorElevation.apply(n,arguments);return Z||delete n._55I,F},getShapeElevation:function(){var i=this,f=i._54O;return f-(i.getTall()||0)*(i._anchorElevation-.5)},setAnchor3d:function(U,z,V,u){var h,o=this;"number"==typeof U?h={x:U,y:z,z:V}:(h=U.length?{x:U[0],y:U[1],z:U[2]}:U,u=z),o._55I=!0,o._updatingAnchor3d=!0;var s=o.getDataModel();if(s&&s.beginTransaction(),!fe){var t=o.getAnchor3d(),W=o.getSize(),n=o.getTall(),c=W.width*(t.x-h.x),e=W.height*(t.z-h.z),k=n*(t.y-h.y);u||o.shiftPoints(c,e,k);var p=o.p3()}var F=Ll.superClass.setAnchor3d.apply(o,arguments);if(!fe&&u){var L=o.p3();o.shiftPoints(L[0]-p[0]+c,L[2]-p[2]+e,L[1]-p[1]+k)}return s&&s.endTransaction(),delete o._updatingAnchor3d,delete o._55I,F},setAnchor:function(v,H,I){var m=this;m._55I=!0;var U=m._updatingAnchor3d,x=!fe&&!U;if(x){var z,i,e;"number"==typeof v?e={x:v,y:H}:(e=v.length?{x:v[0],y:v[1]}:v,I=H);var D=m.getAnchor(),G=m.getSize();z=G.width*(D.x-e.x),i=G.height*(D.y-e.y),I||m.shiftPoints(z,i);var O=m.getPosition()}var Q=Ll.superClass.setAnchor.apply(m,arguments);if(x){var p=m.getPosition();I&&m.shiftPoints(p.x-O.x+z,p.y-O.y+i)}return U||delete m._55I,Q},shiftPoints:function(_,S,C){if(_||S||C){var i=this,T=i.getElevation()||0,D=i.toPoints(),l=new zf;D.each(function(j){var Z=j.e;C&&(Z=(Z==O?T:Z)+C),l.add({x:j.x+_,y:j.y+S,e:Z})}),i.setPoints(l),i.fs()}},shiftPointsElevation:function(J){return this.shiftPoints(0,0,J)},setPosition:function(b,r){var J,V=this;if(!V._28Q){if(V._28Q=1,!V._55I&&!fe){J=2===arguments.length?{x:b,y:r}:b;var c=J.x-V._position.x,S=J.y-V._position.y;if(0===c&&0===S)return delete V._28Q,void 0;V._55I=1,V.shiftPoints(c,S),Nf(V,[1,0,0,1,c,S]),delete V._55I}Ll.superClass.setPosition.apply(V,arguments),delete V._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var u=this;if(2!==u._59O.size())return!1;var w=u._58O;return w?2===w.size()&&1===w.get(0)&&2===w.get(1)?!0:!1:!0},fireShapeChange:function(){var s=this;if(!s._55I&&!fe){var N=pr(s._59O);N&&(s._55I=1,s.setRect(N),delete s._55I)}s.fp(ml,!1,!0)},getSerializableProperties:function(){var s=Ll.superClass.getSerializableProperties.call(this);return s.segments=1,s.points=1,s.thickness=1,s.closePath=1,s}});var Mi=Y.Polyline=function(){Ck(Mi,this),this.s({"shape.background":null,"shape.border.width":2})};ij("Polyline",Ll,{_icon:"polyline_icon",_22Q:function(){return kl},getUIClass:function(){return wk},setClosePath:function(){},setTall:function(i){var C=this,y=C.getDataModel();if(y&&y.beginTransaction(),!C._55I&&!C._24Q&&!fe&&C.getTall()){C._24Q=1;var q=C._54O,n=i/C.getTall();if(1!==n){var v=C.toPoints(),o=new zf;v.each(function(E){o.add({x:E.x,y:E.y,e:E.e==O?E.e:(E.e-q)*n+q})}),C.setPoints(o),C.fs()}delete C._24Q}Mi.superClass.setTall.call(C,i),y&&y.endTransaction()},setElevation:function(i){var T=this,E=T.getDataModel();if(E&&E.beginTransaction(),!T._55I&&!T._24Q&&!fe){T._24Q=1;var y=i-T._54O;0!==y&&T.shiftPointsElevation(y),delete T._24Q}Mi.superClass.setElevation.apply(T,arguments),E&&E.endTransaction()},fireShapeChange:function(){var v=this,e=v._59O;if(!v._55I&&!v._24Q&&!fe){var I=e.size();if(I){var U=1,z=e.get(0),x=v._54O;z.e==O&&(z.e=x);for(var E=z.e,f=0;I>U;U++){z=e.get(U),z.e==O&&(z.e=x);var M=u(E,z.e),S=P(E+f,z.e);E=M,f=S-M}v._24Q=1,v.setTall(f),v.setElevation(E+f*v._anchorElevation),delete v._24Q}}Mi.superClass.fireShapeChange.apply(v,arguments)}});var Gi=Y.SubGraph=function(){Ck(Gi,this)};ij("SubGraph",Vj,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Gi.superClass._8I.call(this),this.eachChild(function(K){De(K)&&K._8I()})}}),j.loadingRefGraph=0;var Wo=Y.RefGraph=function(){Ck(Wo,this)};ij("RefGraph",nk,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(K){var D=this._ref;this._ref=K,this.fp("ref",D,K),this.updateRef()},_21I:function(){Wo.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var v=this;if(j.loadingRefGraph++,v.clearChildrenFromDataModel(),j.loadingRefGraph--,v._ref&&v._dataModel){v._xhrLoadHandler&&(v._xhrLoadHandler.cancel=!0);var h=fe,U=v._xhrLoadHandler=function(R){if(R&&v._dataModel){j.loadingRefGraph++;var P=v._pendingUpdateInfo={needToRestore:h};h&&(P.p3=v.p3(),P.s3=v.s3(),P.r3=v.r3(),P.anchor3d=v.getAnchor3d(),P.scale3d=v.getScale3d()),v.r3(0,0,0),v.setScale3d(1,1,1),v.setAnchor3d(.5,.5,.5),v.p3(0,0,0);var g=j.parse(R),k=v._dataModel.deserialize(g,v,{justDatas:!0});k.each(function(S){S._refGraph=v}),v.checkPendingUpdateInfo(),j.loadingRefGraph--,j.handleRefGraphLoaded(v,k,g)}};U.xhrLoadCalled=!1,j.load(v._ref,function(R){U.cancel||(U.xhrLoadCalled?U(R):Bj(function(){U(R)}))}),U.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var g=this,L=g._pendingUpdateInfo;if(!L)return g.onPendingUpdated&&(j.loadingRefGraph++,g.onPendingUpdated(),j.loadingRefGraph--),void 0;var P=!0;this.eachChild(function(a){(a._pendingCheckImageJSON||a._pendingUpdateInfo)&&(P=!1)}),P&&(j.loadingRefGraph++,g._pendingUpdateInfo=null,g.updateFromChildren(),L.needToRestore&&(g.setAnchor3d(L.anchor3d),g.setScale3d(L.scale3d),g.r3(L.r3),g.p3(L.p3)),this.getParent()instanceof Wo&&this.getParent().checkPendingUpdateInfo(),g.onPendingUpdated&&g.onPendingUpdated(),j.loadingRefGraph--)},getSerializableProperties:function(){var h=Wo.superClass.getSerializableProperties.call(this);return h.ref=1,h}}),Y.EdgeGroup=function(G,I){this._70O=G,this._siblings=I;for(var N,C,Q=0,e=G.size(),U=v[Yi];e>Q;Q++)if(N=G.get(Q).getStyle(Yi,!1),N!=O){U=N;break}U==O&&(U=!0);var z=j.edgeGroupAgentFunc;for(z&&(C=z(G),C&&C!==G.get(0)&&(G.remove(C),G.add(C,0))),Q=0;e>Q;Q++)G.get(Q).s(Yi,U)},ij("EdgeGroup",L,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(r){return this._70O.get(r)},indexOf:function(X){return this._70O.indexOf(X)},each:function(F,H){this._70O.each(F,H)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(q,r){this._siblings.each(function(x){x._70O.each(q,r)})}});var op=function(T,p,J){var F=br[T]={type:T,action:p};if(J)for(var D in J)F[D]=J[D]};Dq(j,{setConnectAction:op,getConnectAction:function(_,r){if(!r){if(!_)return null;r=_.getCurrentConnectActionType()}return br[r]},doConnectAction:function(x,G,k,T){T=T||x.getCurrentConnectActionType();var j=br[T];if(!j)return!1;var d=j.action;return d?(G instanceof mn.Group?x.sm().getSelection().each(function(M){d.call(null,x,M,k)}):d.call(null,x,G,k),!0):!1},doDeleteConnectionAction:function(l,F,t){t=t||l.getCurrentConnectActionType();var m=br[t];if(!m||!m.delete)return!1;var S=m.delete.action;return S?(F instanceof mn.Group?l.sm().getSelection().each(function(e){S.call(null,l,e)}):S.call(null,l,F),!0):!1}});var al=Y.JSONSerializer=function(u,r){this.dm=this._dataModel=u,this._hierarchical=j.forceHierarchicalSerialization?!0:r==O?u.isHierarchicalRendering():r};ij("JSONSerializer",L,{ms_ac:["hierarchical"],serialize:function(Y){return j.stringify(this.toJSON(),Y)},toJSON:function(){var B=this,c=B.dm,q=c.getRoots(),V=B.json={v:j.getVersion(),p:{},a:{},d:[]},M=c.getSerializableAttrs();c.getInit()&&(V.init=c.getInit()),c.getName()&&(V.p.name=c.getName()),c.getBackground()&&(V.p.background=c.getBackground()),c.getLayers()&&(V.p.layers=c.getLayers()),c.getEnvmap()&&(V.p.envmap=c.getEnvmap()),V.p.autoAdjustIndex=c.isAutoAdjustIndex(),V.p.hierarchicalRendering=c.isHierarchicalRendering();for(var N in M){var k=c.a(N);k!==n&&B[Zp](N,k,V.a)}return sn(V.a)&&delete V.a,B._hierarchical?q.each(B.serializeData,this):c.each(function(A){B.serializeData(A)}),c.fireSerializeEvent({type:"serialize",json:V}),c.getPostProcessingData()&&(V.p.postProcessingData=c.getPostProcessingData()),V},isSerializable:function(){return!0},getProperties:function(o){return o.getSerializableProperties()},getStyles:function(f){return f.getSerializableStyles()},getAttrs:function(n){return n.getSerializableAttrs()},serializeData:function(A){var B=this;if(B.isSerializable(A)&&!A._refGraph){var q,v,Z,$,d=qi(A.getClassName())||A.getClass(),W=new d,b={c:A.getClassName(),i:A.getId(),p:{},s:{},a:{}};B.json.d.push(b),q=B.getProperties(A);for(v in q)if(/^_/.test(v)){if(Z=A[v],!("_width"!==v&&"_height"!==v||Z!=O&&-1!==Z)){var j;((A.s("layout.h")||A.s("layout.v"))&&A.getHost()||A instanceof Y.Node&&(j=A.getParent())&&j instanceof Y.Block||A.s("fullscreen"))&&(Z=A[v]="_width"===v?A.getWidth():A.getHeight())}Z!==W[v]&&B[Zp](v.substr(1),Z,b.p)}else $=An(v),A[$]&&(Z=A[$](),Z!==W[$]()&&B[Zp](v,Z,b.p));q=B.getStyles(A);for(v in q)Z=A.s(v),Z!==W.s(v)&&B[Zp](v,Z,b.s);q=B.getAttrs(A);for(v in q)Z=A.a(v),Z!==W.a(v)&&B[Zp](v,Z,b.a);sn(b.p)&&delete b.p,sn(b.s)&&delete b.s,sn(b.a)&&delete b.a}B._hierarchical&&A.getChildren().each(B.serializeData,B)},serializeValue:function(g,t,f){re(t)?t={__a:t._as}:t instanceof Jh&&(t={__i:t.getId()}),f[g]=t},deserialize:function(K,J,u){var q=this;return xh(K)&&/.json$/.test(K)?(j.xhrLoad(K,function(o){q.deserializeImpl(o,J,u)}),void 0):q.deserializeImpl(K,J,u)},deserializeImpl:function(y,b,n){var W=this,I=W.dm;I.setDeserializing(!0),n=Hi(n)?{setId:n}:er(n)?{finishFunc:n}:n||{},y=W.json=xh(y)?j.parse(y):y,!n.justDatas&&y.a&&y.a.onPreDeserialize&&!n.disableOnPreDeserialize&&y.a.onPreDeserialize(y,I,n.view),I.beginTransaction(),fe++,W._82I={};var i=new zf,Z=new zf,A=0,R=y.d.length;if(n.justDatas||(!n.disableInit&&er(y.init)&&y.init(I),I.setInit(y.init)),!n.justDatas){for(var m in y.a)I.a(m,W[Jn](y.a[m]));for(var w in y.p)I[Qg(w)](y.p[w])}for(;R>A;A++){var z=y.d[A],p=qi(z.c),K=new p,x=z.i;n.setId&&x!=O&&(K._id=x),W._82I[x]=K,i.add(K),Z.add(z)}for(A=0;R>A;A++)W.deserializeData(i.get(A),Z.get(A));return i.each(function(A){b&&!A.getParent()&&A.setParent(b),I.add(A)}),n.__innerHandler__&&n.__innerHandler__(y,I,n.view,i),I.fireSerializeEvent({type:"deserialize",json:y}),fe--,I.endTransaction(),!n.justDatas&&y.a&&y.a.onPostDeserialize&&!n.disableOnPostDeserialize&&y.a.onPostDeserialize(y,I,n.view,i),n.finishFunc&&n.finishFunc(y,I,n.view,i),I.setDeserializing(!1),i},deserializeData:function(Q,c){for(var F in c.p)Q[Qg(F)](this[Jn](c.p[F]));for(F in c.s)Q.s(F,this[Jn](c.s[F]));for(F in c.a)Q.a(F,this[Jn](c.a[F]))},deserializeValue:function(i){if(Xj(i)){var N=i.__i;if(N!=O)return this._82I[N];if(N=i.__a,Hr(N))return new zf(N)}return i}}),Dq(Dr,{serialize:function(v,H){return new al(this,H).serialize(v)},toJSON:function(s){return new al(this,s).toJSON()},deserialize:function(A,N,C){return new al(this).deserialize(A,N,C)}});var sb=Y.OverlappingBox=function(c){this.gv=c,this.boxes={}};ij("OverlappingBox",L,{clear:function(){var y,M,C=this.boxes;for(y in C)M=C[y],M.length=0},isOverlapping:function(g,x){var c,p,Y=this,R=Y.boxes,e=R[g];e?(c=e.rects,p=e.length):e=R[g]={rects:c=[],length:p=0};var N,a,x;for(N=0;p>N;N++)if(a=c[N],a.x<x.x+x.w&&a.x+a.w>x.x&&a.y<x.y+x.h&&a.h+a.y>x.y)return!0;return c.length<=p?(c.push(x),e.length++):c[e.length++]=x,!1}}),Dq(j,{fetch:function(Y,X){var E="GET",f=!1,R=null,i="";X&&(E=X.method||"GET",f=X.sync,i=X.url,R=X.data||null),Y.open(E,i,!f),X.responseType?Y.responseType=X.responseType:X.overrideMimeType&&Y.overrideMimeType&&Y.overrideMimeType(X.overrideMimeType),Y.send(R)},convertImageSrc:function(Z,N){N&&"function"==typeof N||(N=function(){}),N(Z)}});var de=Y.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};ij("Request",L,{_responseType:null,_overrideMimeType:"text/plain",send:function(s){var Q=this._xhr,R=this.onload,k=this.onerror;this.getResponseType()?s.responseType=this.getResponseType():this.getOverrideMimeType()&&(s.overrideMimeType=this.getOverrideMimeType()),Q.onload=R,Q.onerror=k,j.fetch(Q,s)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(T){this._responseType=T},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(h){this._overrideMimeType=h},getResponseText:function(){var h=this._xhr;return h.response||h.responseText}}),km.GraphView=function(B){var J=this;J._24I={},J._34I=new zf,J._25I={},J._56I={},J._view=Cd(1,J),J._canvas=Uq(J._view),J.dm(B?B:new Dr),this._coreInteractor=new bd(this),J.setEditable(!1),J.setScrollBarVisible(j.graphViewScrollBarVisible),J._initView()},wp("GraphView",L,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[_l,Fh,kj,oc,"resettable","editInteractor",Eb,"zoomable","pannable","rectSelectable","autoScrollZone",qo,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:j.graphViewZoomable,_resettable:j.graphViewResettable,_pannable:j.graphViewPannable,_rectSelectable:j.graphViewRectSelectable,_autoScrollZone:j.graphViewAutoScrollZone,_rectSelectBackground:j.graphViewRectSelectBackground,_rectSelectBorderColor:j.graphViewRectSelectBorderColor,_editPointSize:j.graphViewEditPointSize,_editPointBorderColor:j.graphViewEditPointBorderColor,_editPointBackground:j.graphViewEditPointBackground,_scrollBarColor:Td,_scrollBarSize:qs,_autoHideScrollBar:Hp,_autoMakeVisible:of,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(S){this._dataModel.setLayers(S)},setEditable:function(N){var o=this,t=o.__interactorMap__;if(!t){var f=km.XEditInteractor;t=o.__interactorMap__={scrollBar:new tp(o),select:new Ge(o),edit:f?new f(o):new dl(o),text:new Pn(o),move:new Hj(o),"default":new un(o),touch:new Dj(o,{editable:!1})}}N?(o._uieditable=!0,o.setInteractors([t.scrollBar,t.select,t.edit,t.text,t.move,t.default,t.touch])):(o._uieditable=!1,o.setInteractors([t.scrollBar,t.select,t.move,t.default,t.touch]))},getCanvas:function(){return this._canvas},_33I:function(K){var y=K.getUIClass();return y?new y(this,K):O},getDataUI:function(m){var v=this,d=v._25I[m._id];return d===n&&(d=v._33I(m),v._25I[m._id]=d),d},getNodeRect:function(Q){return j.getNodeRect(this,Q)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(k){var N=this.getDataUI(k);return N?(N._79o(),N._78o):null},getEdgeSourcePosition:function(c){var M=this,w=M.getDataUI(c),n=w.s,h=w._data._40I;return xn(M,h,n("edge.source.position"),n("edge.source.offset.x"),n("edge.source.offset.y"),n("edge.source.anchor.x"),n("edge.source.anchor.y"))},getEdgeTargetPosition:function(a){var z=this,U=z.getDataUI(a),s=U.s,L=U._data._41I;return xn(z,L,s("edge.target.position"),s("edge.target.offset.x"),s("edge.target.offset.y"),s("edge.target.anchor.x"),s("edge.target.anchor.y"))
},invalidateAll:function(N){var m=this;if(N){for(var $ in m._25I){var _=m._25I[$];_&&_.dispose()}m._25I={},m._56I={},m._24I={},m._34I.clear(),m.redraw()}else m.dm().each(function(s){m.invalidateData(s)})},invalidateSelection:function(){var e=this;e.sm().each(function(f){e.invalidateData(f)})},invalidateData:function(X){var S=this;S._24I[X._id]=X,S._21Q(X),S.iv()},_21Q:function(F){var X=this,S=X._24I;if(_n(F)&&Ce[F.s(Jq)]){var K=F.getSourceAgent();K&&K.getAgentEdges().each(function(s){S[s._id]=s}),K=F.getTargetAgent(),K&&K.getAgentEdges().each(function(Q){S[Q._id]=Q}),X.iv()}},redraw:function(J){var U=this;U._32I||(J?U._34I.add(J):(U._32I=1,U._34I.clear()),U.iv())},each:function(D,T){var z,J,F,x=0,s=this.getLayers(),k=this._dataModel,V=k._datas._as,a=V.length;if(s){for(var y=s.length;y>x;x++)if(F=s[x],Xj(F)&&(F=F.name),k.isHierarchicalRendering()){var L=function(u){return u._layer===F?T?D.call(T,u):D(u):void 0};if(this._dataModel.eachByHierarchical(L)===!1)return}else for(var P=0;a>P;P++)if(z=V[P],z._layer===F&&(J=T?D.call(T,z):D(z),J===!1))return}else if(k.isHierarchicalRendering())this._dataModel.eachByHierarchical(D,null,T);else for(;a>x;x++)if(z=V[x],J=T?D.call(T,z):D(z),J===!1)return},reverseEach:function(S,j){var O,T,J,q,W=this._dataModel,y=W._layers,b=W._datas._as,F=b.length;if(y){for(O=y.length-1;O>=0;O--)if(q=y[O],Xj(q)&&(q=q.name),W.isHierarchicalRendering()){var B=function(y){return y._layer===q?j?S.call(j,y):S(y):void 0};if(W.reverseEachByHierarchical(B)===!1)return}else for(var R=F-1;R>=0;R--)if(T=b[R],T._layer===q&&(J=j?S.call(j,T):S(T),J===!1))return}else if(W.isHierarchicalRendering())W.reverseEachByHierarchical(S,null,j);else for(O=F-1;O>=0;O--)if(T=b[O],J=j?S.call(j,T):S(T),J===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var n=this,R=n._84I;if(!R){var M=this.dm().a("width"),q=this.dm().a("height");M>0&&q>0?n._84I={x:0,y:0,width:M,height:q}:(n.each(function(i){n.isVisible(i)&&(R=ur(R,n.getDataUIBounds(i)))}),n._84I=R?R:yk)}return n._84I},getScrollRect:function(){return ur(this.getContentRect(),this._29I)},makeCenter:function(K,B,s){var E=this;if(!E.getWidth()||!E.getHeight())return s||Bj(E.makeCenter,E,[K,B,!0],500),void 0;E.makeVisible(K),E.validate();var h=E.getDataUIBounds(K);if(h){var O=E.getWidth(),F=E.getHeight(),H=h.x+h.width/2,t=h.y+h.height/2,T=-H*E._zoom+O/2,R=-t*E._zoom+F/2;E.setTranslate(T,R,B)}},fitData:function(k,H,M,X,o){var f=this;if(!f.getWidth()||!f.getHeight())return o||Bj(f.fitData,f,[k,H,M,X,!0],500),void 0;var g=function(){f.makeVisible(k),f.validate();var n=f.getDataUIBounds(k);n&&(n=qk(n),gn(n,M==O?20:M),f.fitRect(n,H,X))};H?j.callWhenLoaded(g):g()},fitContent:function(u,Z,m,d){var i=this;if(!i.getWidth()||!i.getHeight())return d||Bj(i.fitContent,i,[u,Z,m,!0],500),void 0;var t=function(){i.validate();var o=qk(i.getContentRect());gn(o,Z==O?20:Z),i.fitRect(o,u,m)};u?j.callWhenLoaded(t):t()},fitRect:function(L,q,E){var I=this,i=I.getWidth(),Y=I.getHeight(),c=L.x+L.width/2,f=L.y+L.height/2,Z=u(i/L.width,Y/L.height),X=I._zoom,e=-c*X+i/2,G=-f*X+Y/2;0===Z||isNaN(Z)||(E&&(Z=u(1,Z)),q?(I._65I&&(delete I._65I.finishFunc,I._65I.stop(!0)),I._14o&&I._14o.stop(!0),I.setTranslate(e,G,{finishFunc:function(){I.setZoom(Z,q)}})):(I.setTranslate(e,G),I.setZoom(Z)))},fitSelection:function(v,N,g){var w=this,D=w.sm(),a=null;D.size()&&(D.each(function(O){var z=w.getDataUIBounds(O);a=a?ur(z,a):z}),v&&gn(a,v),w.fitRect(a,N,g))},toCanvas:function(y,I,J){I=I||this._zoom,this.validateImpl();var e=this,q=e.getContentRect();J&&gn(q,J),q.width||(q.width=10),q.height||(q.height=10);var S=Uq(),h=q.x*I,m=q.y*I,v=Math.ceil(q.width*I),B=Math.ceil(q.height*I);Xr(S,v,B,1);var p=Kn(S);return y=y||this._dataModel.getBackground(),y&&hd(p,0,0,v,B,y),cl(p,-h,-m),p.scale(I,I),e._42(p),p.restore(),S},toDataURL:function(C,w,b,c){return this.toCanvas(C,b,c).toDataURL(w||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(f,L){var _=this,t=_.dm().getBackground();if(t){var e=_.dm().a("width"),I=_.dm().a("height");e>0&&I>0&&hd(f,0,0,e,I,t)}var y=_.__htmlOrderList,R=[];if(_._93db(f,L),_.each(function(V){var G=_.getDataUI(V);if(G){var h=_._56I[V._id],x=G._htmlView;if(h){var r=G._79o();if(x=G._htmlView,Y.HtmlNode&&V instanceof Y.HtmlNode)G._42(f);else{var s=_.getViewRect(),o=x&&x.layoutHTML;!L||Mo(L,r)?(o&&(x.layoutHTML(),G.__outerLayout&&delete G.__outerLayout),G._42(f)):Mo(s,r)||!o||G.__outerLayout||(x.layoutHTML(),G.__outerLayout=!0)}}x&&(R.push(x),x.getView&&(x=x.getView()),x.style.display=h?"block":Jj)}}),y&&R.length>0){var Q=!1;if(y.length!==R.length)Q=!0;else for(var k=0;k<R.length;k++)if(R[k]!==y[k]){Q=!0;break}Q&&(R.forEach(function(B){B.autoAdjustIndex!==!1&&_.appendHTML(B,!0)}),this.__htmlOrderList=R)}else this.__htmlOrderList=R;_._92db(f,L)},validateImpl:function(){this.tryUpdateRootData();var h,E,a,Y,o,j=this,M=j.tx(),F=j.ty(),n=j._zoom,Z=j._canvas,s=this.getWidth(),u=this.getHeight(),b=j._29I,y={x:-M/n,y:-F/n,width:s/n,height:u/n},K={},A=j._34I,C=j._24I,l=j._32I,B=j._23I;j._24I={},(s!==Z.clientWidth||u!==Z.clientHeight)&&(Xr(Z,s,u),l=1),l||Xd(y,b)||(l=1),j._29I=y,j.each(function(x){E=x._id;var A=K[E]=j.isVisible(x);A!==j._56I[E]&&(C[E]=x,a=j.getDataUI(C[E]),a&&a._84o(A),j._84o(x,A))},j);for(E in C)a=j.getDataUI(C[E]),a&&(!l&&j._56I[E]&&(o=a._79o(),o&&A.add(o)),a.invalidate()),j._83I=1;if(j._56I=K,!l)for(E in C)K[E]&&(a=j.getDataUI(C[E]),a&&(o=a._79o(),o&&A.add(o)));if(l?Y=y:(A.each(function(W){Mo(y,W)&&(Y=ur(Y,W))}),Y&&(gn(Y,P(1,1/n)),Y.x=J(Y.x*n)/n,Y.y=J(Y.y*n)/n,Y.width=$(Y.width*n)/n,Y.height=$(Y.height*n)/n,Y=yh(y,Y))),j._74O=Y,Y){h=Kn(Z);var I=Y.x,N=Y.y,H=Y.width,k=Y.height;I=Math.floor((I*n+M)*Vd),N=Math.floor((N*n+F)*Vd),H=Math.ceil(H*n*Vd)+1,k=Math.ceil(k*n*Vd)+1,l||(Y.x=(I/Vd-M)/n,Y.y=(N/Vd-F)/n,Y.width=H/Vd/n,Y.height=k/Vd/n),h.beginPath(),h.rect(I,N,H,k),h.clip(),h.clearRect(I,N,H,k),Qh(h,M,F,n),j._42(h,Y),h.restore(),delete j._74O}if(A.clear(),delete j._32I,B&&s>0&&u>0){var a=j.getDataUI(B);if(a){var o=a._79o(),R=j._29I,W=R.x,d=R.y,w=R.width,X=R.height,n=j._zoom;o&&!Mo(o,R)&&(o.x+o.width<W&&j.tx(-o.x*n),o.x>W+w&&j.tx(-(o.x+o.width-w)*n),o.y+o.height<d&&j.ty(-o.y*n),o.y>d+X&&j.ty(-(o.y+o.height-X)*n))}delete j._23I}j._83I&&(delete j._83I,delete j._84I),j._98O(),j.countFrame(),sn(j._24I)||Bj(j.iv,j)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var I,u=this.getFullscreenDatas();for(var r in u)I=u[r],this.scaleRootData(I);this._rootDataUpdating=!1}},scaleRootData:function(c){var R=c.s("fullscreen");if("uniform"===R||"fill"===R){c.getRotation()&&c.setRotation(0);var X=c.s("fullscreen.gap")||0,B=this.getWidth(),e=this.getHeight();if(B&&e){var $,y,G,p=B-2*X,F=e-2*X,u=c.getAnchor(),s=c.getScaledSize(),d=s.width,i=s.height,w=c.s("fullscreen.lock");if(w)return"uniform"===R?p/F>d/i?($=F/i,d=i*p/F):($=p/d,i=d*F/p):"v"===w?($=F/i,d=p/$,c.getWidth()!==d&&c.setWidth(d)):($=p/d,i=F/$,c.getHeight()!==i&&c.setHeight(i)),this.setZoom($),y=X-(c.getX()-u.x*d)*$,G=X-(c.getY()-u.y*i)*$,y!==this.tx()&&this.tx(y),G!==this.ty()&&this.ty(G),void 0;y=this.tx(),G=this.ty(),$=this._zoom;var H={x:(-y+X)/$,y:(-G+X)/$,width:p/$,height:F/$};if("uniform"===R){var t=d/i,Z=Math.min(H.width,H.height*t),P=Z/t;H.x+=.5*(H.width-Z),H.y+=.5*(H.height-P),H.width=Z,H.height=P}p=H.width/c.getScaleX(),F=H.height/c.getScaleY(),(c.getWidth()!=p||c.getHeight()!==F)&&c.setSize(p,F);var E=H.x+u.x*H.width,T=H.y+u.y*H.height,Y=c.getPosition();(E!==Y.x||T!==Y.y)&&c.setPosition(E,T)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(F){var A=this;F!==A.isScrollBarVisible()&&(F?(cr(A._view,A._79O=Tj()),cr(A._79O,A._27I=Tj()),cr(A._79O,A._28I=Tj())):(go(A._79O),delete A._79O,delete A._27I,delete A._28I),A.fp("scrollBarVisible",!F,F))},getDebugTip:function(){return""},showScrollBar:function(){var V=this;V._79O&&(V._85I||(T(function(){V._86I()},Mk),V.iv()),V._85I=new Date)},_86I:function(){var t=this;if(t._85I){var U=new Date,Z=U.getTime();Z-t._85I.getTime()>=Mk?(delete t._85I,t.iv()):T(function(){t._86I()},Mk)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var I=this,e=this._27I,v=this._28I;if(I._79O){if(I._autoHideScrollBar&&!I._85I)return e.style.visibility=Uk,v.style.visibility=Uk,void 0;var K=I.getScrollBarColor(),d=I._zoom,f=I.getScrollBarSize(),L=I.getViewRect(),y=I.getScrollRect(),A=L.height*d,h=y.height*d,j=L.width*d-f-2,u=A*((L.y-y.y)*d/h),l=A*(A/h),T=e.style;h-.5>A?(Vb>l&&(u=u+l/2-Vb/2,0>u&&(u=0),u+Vb>A&&(u=A-Vb),l=Vb),dg(e,j,u,f,l),T.visibility=Hn,T.background=K,T.borderRadius=f/2+Qj):T.visibility=Uk;var r=L.width*d,H=y.width*d,u=L.height*d-f-2,j=r*((L.x-y.x)*d/H),C=r*(r/H),T=v.style;H-.5>r?(Vb>C&&(j=j+C/2-Vb/2,0>j&&(j=0),j+Vb>r&&(j=r-Vb),C=Vb),dg(v,j,u,C,f),T.visibility=Hn,T.background=K,T.borderRadius=f/2+Qj):T.visibility=Uk}},setDataModel:function(L){var n=this,d=n._dataModel,Q=n._selectionModel;d!==L&&(d&&(d.ump(n.handleDataModelPropertyChange,n),d.umm(n.handleDataModelChange,n),d.umd(n.handleDataPropertyChange,n),d.removeIndexChangeListener(n._75O,n),d.removeHierarchyChangeListener(n.handleHierarchyChange,n),Q||d.sm().ums(n.handleSelectionChange,n)),n._dataModel=L,L.mp(n.handleDataModelPropertyChange,n),L.mm(n.handleDataModelChange,n),L.md(n.handleDataPropertyChange,n),L.addIndexChangeListener(n._75O,n),L.addHierarchyChangeListener(n.handleHierarchyChange,n),Q?Q._21I(L):L.sm().ms(n.handleSelectionChange,n),n.invalidateAll(!0),n.fp(Rp,d,L),n.updateBackground())},getLayersInfo:function(){if(this._layersInfo===n){var M=this.getLayers();M?(this._layersInfo={},M.forEach(function(o){var x=Xj(o)?o.name:o;this._layersInfo[x]=o},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(b,a,y){var K,P,p=this,X=p.getDataUI(b),s=Tq(X),J=ki(a,function(U){return Nd(s,100*U)},100,.001),W=Nd(s,100*J);if(!y){var k=us(X),Q=new _h(W.x,W.y),t=49/(p._zoom*p._zoom);for(K=0,P=k.length;P>K;K++)if(Q.distanceToSquared(k[K])<t)return{index:K,point:k[K],distance:Math.sqrt((k[K].x-a.x)*(k[K].x-a.x)+(k[K].y-a.y)*(k[K].y-a.y))}}return{percent:J,point:W,distance:Math.sqrt((W.x-a.x)*(W.x-a.x)+(W.y-a.y)*(W.y-a.y))}},calculateAttachPoint:function(){var r=new _h,$=new _h,W=new _h;return function(V,z){var C=this.getAttachPoints(V);if(!C||!C.length)return null;W.set(z.x,z.y);for(var G,f,E,m,X,N=1/0,D=0,d=C.length;d>D;D++)E=C[D],$.x=E.x,$.y=E.y,r.x=E.offsetX||0,r.y=E.offsetY||0,m=xn(this,V,0,r.x,r.y,$.x,$.y),f=W.distanceToSquared(m),N>f&&(G=D,N=f,X=m);N=Math.sqrt(N);var o=this.getAttachStyle(V);if("close"===o){var g=V.s("attach.close.threshold")/this._zoom;if(N>g)return null}return{index:G,distance:N,info:C[G],point:X}}}(),getAttachPoints:function(V){var E=V.s("attach.points");if(E)return E;var D=co(V._image);return D?lc(D.attachPoints,V,this)||null:void 0},getAttachStyle:function(j){var g=j.s("attach.style");if(g)return g;var q=co(j._image);return q?lc(q.attachStyle,j,this)||"close":void 0},updateLayers:function(){this._layersInfo=n,this.invalidateSelection(),this.redraw()},updateBackground:function(){var U=this.dm().a("width"),V=this.dm().a("height");this._canvas.style.background=U>0&&V>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(O){if("background"===O.property){var C=this._canvas.style.background,E=O.newValue||"";this.updateBackground(),this.fp("canvasBackground",C,E),this.redraw()}else"a:width"===O.property||"a:height"===O.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===O.property?this.updateLayers():"hierarchicalRendering"===O.property&&this.redraw()},handleDataPropertyChange:function(s){this.dm().isHierarchicalRendering()&&"parent"===s.property&&s.data.hasChildren()&&this.redraw(),this.invalidateData(s.data)},onPropertyChanged:function(h){var B=this,Z=h.property;if(B.redraw(),"zoom"===Z){var J=B.sm().getSelection();J.size()&&J.each(function(H){H.invalidate()})}else"dataModel"===Z&&(B._83I=1);Jk[Z]?B.showScrollBar():Z===Eb&&B.onCurrentSubGraphChanged(h)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(L){var T=this,X=L.kind,C=L.data;if(T._83I=1,"add"===X)T.invalidateData(C),_n(C)&&C.getEdgeGroup()&&C.getEdgeGroup().eachSiblingEdge(T.invalidateData,T);else if(X===Mp){T._21Q(C);var z=C._id,F=T._25I[z];if(F){if(T._56I[z]){var N=F._79o();N&&T.redraw(N)}F.dispose(),delete T._25I[z],delete T._24I[z],delete T._56I[z]}C===T._currentSubGraph&&T.setCurrentSubGraph(O)}else X===zq&&(T.invalidateAll(!0),T.setCurrentSubGraph(O))},_75O:function(h){this.invalidateData(h.data)},handleHierarchyChange:function(X){this.dm().isHierarchicalRendering()&&X.data.hasChildren()&&this.redraw(),this.invalidateData(X.data)},adjustIndex:function(V){var S=this;if(S.isVisible(V)){S.dm().beginTransaction();for(var h=V;h._parent&&S.isVisible(h._parent);)h=h._parent;h&&h!==V&&S._dataModel.adjustIndex(h),S._dataModel.adjustIndex(V),S.dm().endTransaction()}},getImage:function(P){return P.getImage?P.getImage():n},getSelectWidth:function(w){var u=co(this.getImage(w));return u&&lc(u.disableSelectedBorder,w,this)?0:w.s("select.width")},getSelectColor:function(V){return V.s("select.color")},isSelectable:function(a,v){if(this.isSelected(a))return!0;if(!v&&a.getParent()instanceof nk&&this.isSelectable(a.getParent(),!0)&&a.getParent().isSyncSize())return!1;var V=this.getLayersInfo();if(V){var y=V[a._layer];if(y&&y.selectable===!1)return!1}return a.s("2d.selectable")&&this.sm().isSelectable(a)},isMovable:function(v){var _=this;if(_n(v)&&v.getStyle(Jq)!==Nj)return!1;var m=this.getLayersInfo();if(m){var u=m[v._layer];if(u&&u.movable===!1)return!1}return v.s("2d.movable")?_._movableFunc?_._movableFunc(v):!0:!1},isEditable:function(s){var i=this;if(Y._uiSerializing)return i._uieditable;if(!i._editInteractor||!i.isSelected(s))return!1;if(mh(s)){var O=i.getDataUI(s);if(!O||O._88I)return!1}if(_n(s)&&s.getStyle(Jq)!==Nj)return!1;var Z=this.getLayersInfo();if(Z){var u=Z[s._layer];if(u&&u.editable===!1)return!1}return s.s("2d.editable")?i._editableFunc?i._editableFunc(s):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function($){return De($)&&0!==$.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc($):!0},isRectEditable:function(F){return this._rectEditableFunc?this._rectEditableFunc(F):!0},isAnchorEditable:function(I){return this._anchorEditableFunc?this._anchorEditableFunc(I):!0},isRotationEditable:function(A){return A.setRotation&&A.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(A):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(A){var o=A.getAnchor(),b=A.getScale(),O=this._zoom,L=im(A.getRotation(),0,-A.getHeight()*b.y*o.y-(b.y<0?-1:1)*(Lr?32:16)/O),q=A.p();return L.x+=q.x,L.y+=q.y,L},getLogicalPoint:function(d){var l=this;return jn(d,l._canvas,l.tx(),l.ty(),l._zoom,l._zoom)},getScreenPoint:function(G,f){var M,a=this;return"object"==typeof G?G.x!==n?(M=G.x,f=G.y):(M=G[0],f=G[1]):M=G,xl(M,f,a._canvas,a.tx(),a.ty(),a._zoom,a._zoom)},getSelectedDataAt:function(p){var u=this;return this.getDataAt(p,function(l){return u.isSelected(l)})},getDataInfoAt:function(z,S,h){var Z,k=this.lp(z),n=this.getDataAt(k,S,h);if(n){var i=this.getDataUI(n);Z={data:n,ui:i,point:k};var l=i._38o;if(l){var s=l.icons;for(var C in s){var F=s[C],q=l.rects[C];if(q)for(var R=lc(F.names,n,this),j=R?R.length:0,o=q.rotation,N=j-1;N>=0;N--){var t=R[N],B=q[N];if(Mg(B,k,o))return Z.part="icons",Z.name=C,Z.icon=t,Z.rect=B,Z.index=N,Z.rotation=o,Z}}}if(this.isNoteVisible(n)){if(i.note2Info&&Mg(i.note2Info.clickRect,k,O,i.note2Info.scale))return Z.part="note2",Z;if(i.noteInfo&&Mg(i.noteInfo.clickRect,k,O,i.noteInfo.scale))return Z.part="note",Z}if(this.isLabelVisible(n)){if(i.label2Info&&Mg(i.label2Info.rect,k,i.label2Info.rotation,i.label2Info.scale))return Z.part="label2",Z;if(i.labelInfo&&Mg(i.labelInfo.rect,k,i.labelInfo.rotation,i.labelInfo.scale))return Z.part="label",Z}if(n.isInRect&&n.isInRect(k))return Z.part="body",Z}return Z},getDataAt:function(b,v,j){b.target&&(b=this.lp(b));var I,c=this._zoom;return this.reverseEach(function(X){return(v?v(X):this.isSelectable(X))&&this.rectIntersects(X,Vp(b.x,b.y,j,c))?(I=X,!1):void 0},this),I},getIconInfoAt:function(W,$){var x=this;if(W.target&&(W=x.lp(W)),$||($=x.getDataAt(W)),$){var y=x.getDataUI($);if(y&&y._38o){var U,H=y._38o,L=new zf;for(U in H.icons)L.add(U);for(var q=L.size()-1;q>=0;q--){U=L.get(q);for(var d=H.rects[U],i=d.rotation,V=d.length-1;V>=0;V--){var a=d[V],g=a.width,b=a.height,D={x:W.x-a.x-g/2,y:W.y-a.y-b/2};i!=O&&(D=im(-i,D.x,D.y));var a={x:-g/2,y:-b/2,width:g,height:b};if(Mg(a,D))return{key:U,index:V,name:H.icons[U].names[V],rect:d[V],point:W,rotation:i,relativeRect:a,relativePoint:D,data:$}}}}}return O},getDatasInRect:function(q,c,E){E===n&&(E=1);var Q=this,C=new zf;return Q.reverseEach(function(m){E&&!Q.isSelectable(m)||(c?Q.rectIntersects(m,q):Q.rectContains(m,q))&&C.add(m)}),C},moveSelection:function(R,$){var n=this;n.dm().beginTransaction(),qq(n.sm().toSelection(n.isMovable,n),R,$),n.dm().endTransaction()},moveDatas:function(V,P,G){var Y=this;Y.dm().beginTransaction(),V instanceof zf||(V=new zf(V)),qq(V,P,G),Y.dm().endTransaction()},getDataUIBounds:function(a){var E=this.getDataUI(a);return E?E._79o():O},drawData:function(X,E,r){var z=this.getDataUI(E);if(z){var q=z._79o();(!r||Mo(r,q))&&(z._42(X),E instanceof Y.Block&&E.eachChild(function(K){this.isVisible(K)&&this.drawData(X,K,r)},this))}},getBoundsForGroup:function(s){return s.s(sp)?this.getDataUIBounds(s):O},isPixelPerfect:function(e){return e.s("pixelPerfect")},rectIntersects:function(X,L){this.validate();var g=O;if(this._56I[X._id]){var W=this._25I[X._id];if(W){var q=W._79o();if(xj(L,q))g=!0;else if((L=yh(L,q))&&(W.rectIntersects&&(g=W.rectIntersects(L)),g==O)){if(!this.isPixelPerfect(X))return!0;var h=L.x,_=L.y,B=L.width,H=L.height,d=this._zoom,N=j.hitMaxArea,t=B*H*d*d;if(t>N){var e=Math.sqrt(N/t);d*=e}B*=d,H*=d,2>B&&(B=2),2>H&&(H=2),h*=d,_*=d;var z=$h(B,H);cl(z,-h,-_),z.scale(d,d),this._drawForChecking=!0,this.drawData(z,X,L),this._drawForChecking=!1;try{for(var M=0,b=z.getImageData(0,0,B,H).data;M<b.length;M+=4)if(0!==b[M+3]){g=!0;break}z.restore()}catch(l){Ie=O,g=!1}}}}return g?!0:!1},rectContains:function(C,E){if(this._56I[C._id]){var b=this._25I[C._id];if(b)return xj(E,b._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(p){if(!j.isInput(p.target)){var q=this,Z=q._focusData,h=Z&&q._25I[Z._id],U=0,w=q._dataModel._datas;if(!(Z&&Z._enabled&&Z._editable&&h&&h.onKeyDown&&h.onKeyDown(p)===!0))if(9===p.keyCode&&(Z&&(U=w.indexOf(Z),Hc(p)?-1===--U&&(U=0):++U===w.size()&&(U=0)),q._focusData=Z=w.get(U),q.sm().setSelection(Z)),hl(p)?q.selectAll():ym(p)&&q.isResettable()&&q.reset(),q.sm().isEmpty()){if(q._editing)return;var I=q.tx(),F=q.ty(),t=!1,c=Hc()?100:10;Fk(p)&&(I-=c,t=!0),fb(p)&&(F-=c,t=!0),tc(p)&&(I+=c,t=!0),dc(p)&&(F+=c,t=!0),t&&q.setTranslate(I,F)}else{Zr(p)&&q.handleDelete(p);var g=Hc()?10:1;Fk(p)&&(q.moveSelection(-g,0),q.fi({kind:"moveLeft"})),fb(p)&&(q.moveSelection(0,-g),q.fi({kind:"moveUp"})),tc(p)&&(q.moveSelection(g,0),q.fi({kind:"moveRight"})),dc(p)&&(q.moveSelection(0,g),q.fi({kind:"moveDown"}))}}},handleScroll:function(Y,O){if(zh(Y),this.isZoomable()){if(!this.getEditInteractor()){var $=this.getDataAt(Y);if($){var e=co(this.getImage($));if(e&&lc(e.scrollable,$,this))return}}var C=this.lp(Y);O>0?this.scrollZoomIn(C):0>O&&this.scrollZoomOut(C)}},handlePinch:function(R,u,C){this.isZoomable()&&(Math.abs(u-C)<j.pinchZoomThreshold||(u>C?this.pinchZoomIn(R):this.pinchZoomOut(R)))},checkDoubleClickOnNote:function(a,j){var t=this,n=t.lp(a),D=t.getDataUI(j),f=D.note2Info;return f&&j.s("note2.toggleable")&&Mg(f.clickRect,n)?(j.s(Zi,!j.s(Zi)),t.fi({kind:"toggleNote2",event:a,data:j}),!0):(f=D.noteInfo,f&&j.s("note.toggleable")&&Mg(f.clickRect,n)?(j.s(Pd,!j.s(Pd)),t.fi({kind:"toggleNote",event:a,data:j}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(L,V){var s=this,R=s.getAutoScrollZone(),c=R/s.getZoom(),u=R/4,K=s._29I,f=s.lp(L),N={x:s.tx(),y:s.ty()};return f&&R>0&&K&&(f.x-K.x<c?s.translate(u,0):K.x+K.width-f.x<c&&s.translate(-u,0),f.y-K.y<c?s.translate(0,u):K.y+K.height-f.y<c&&s.translate(0,-u)),N.x=s.tx()-N.x,N.y=s.ty()-N.y,V&&(V.x+=N.x,V.y+=N.y),N},getMoveMode:function(L,m){var l=m.s("2d.move.mode");return l?l:Ej["88"]?"x":Ej["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(N,M,w){var U=this;return"currentSubGraph"===M?{__i:N.getId()}:w.serializeProperty(N,M,U)},deserializeProperty:function(W,C,k){var J=this;if("currentSubGraph"===C){var F=J.dm(),p=F.__idMap;return p[W.__i]}return k.deserializeProperty(W,C,J)},setDefaultCursor:function(p,S){this._defaultCursor=p,S!==!1&&this.setCursor(p)},setCursor:function(g){"default"===g&&(g=this._defaultCursor||g);var X=this.getView().style;X.cursor=g,X.cursor="-webkit-"+g,X.cursor="-moz-"+g},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(P){return P===O||j.getConnectAction(null,P)?(this._currentActionType=P,this.redraw(),!0):!1},getEditStyle:function(W){var w=this.getEditInteractor();return w?w.getStyle(W):n},setEditStyle:function(Z,X,s){var k=this.getEditInteractor();return k?(k.setStyle(Z,X,s),!0):!1},isConnectActionVisible:function(h){var g=j.getConnectAction(this);if(!g)return!1;var Z=g.visible;return er(Z)&&(Z=Z(this,h)),Z},isInteractive:function(H){if(this._drawForChecking)return!1;var G=co(this.getImage(H));return G&&lc(G.interactive,H,this)?!0:H.s("interactive")},appendHTML:function(y,I){var x=this.getView();if(!(I||y&&y.parentNode!==x))return!1;var e=y.getView&&y.getView();if(!I&&e&&e.parentNode===x)return!1;(y.getView||y.isSelfViewEvent)&&(y=y.getView());var $=this.getEditInteractor();return $&&$._canvas?x.insertBefore(y,$._canvas):this.isScrollBarVisible()?x.insertBefore(y,this.getView().lastChild):cr(x,y),!0},_layoutHTMLImpl:function(j,N,r){if(arguments.length>1){var h,q=this,s=q._zoom;if(N.getView&&(h=N,N=N.getView()),N.style.position="absolute",r){var w=j.getRect();dg(h||N,q.tx()+w.x*s,q.ty()+w.y*s,w.width*s,w.height*s)}else{var d=new Hm,w=j.getAnchorRect(),V=j.getPosition(),k=j.getScale(),f=N.style;dg(h||N,w),d.appendTranslate(q.tx(),q.ty()),d.appendScale(s,s),d.append(new Hm(j.getRotation(),V.x,V.y,k.x,k.y)),Cb(f,"transform","matrix("+d.a.toFixed(5)+", "+d.b.toFixed(5)+", "+d.c.toFixed(5)+",\n    "+d.d.toFixed(5)+", "+d.tx.toFixed(5)+", "+d.ty.toFixed(5)+")"),Cb(f,"transformOrigin",(-w.x).toFixed(5)+"px "+(-w.y).toFixed(5)+"px"),N.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(y){return y instanceof hh?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(G){var o="state",K=G.s(o);if(K)return K;var a=co(G._image);return a?lc(a[o],G,this)||null:void 0},getShape:function(B){return B.getStyle(ml)}}),L.defineProperties(km.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(n){this._layoutHTML=n}}});var Pr=function(t,X){var J=this;J.gv=t,J.s=function(b){return X.getStyle(b)},J._data=X,J._87I=new zf};kk(Pr,L,{_6I:O,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var u=this,M=u.gv.isSelected(u._data);return!M||u.isShadowed()?0:u.gv.getSelectWidth(u._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(I){var N=this._data,V=this.gv.getBodyColor(N);return V?V:I?N.getStyle(I):O},_2Q:function(y){return this.s(y)},_1Q:function(b,d,i,n){var R=this.s,e=R("2d.gray"),v=R(d+".dash.color");if(e&&(v=j.toGrayColor(v)),b.strokeStyle=v,b.lineWidth=i,b.stroke(),R(d+".dash.3d")){var Q=R(d+".dash.3d.color");kn(b,v,e?j.toGrayColor(Q):Q,i,this.gv._zoom,R(d+".dash.3d.accuracy"))}hr(b,n)},invalidate:function(){this._6I=O},_79o:function(){var L=this;if(!L._6I){var P=L._data,k=L.gv;L.labelInfo=L.label2Info=L.noteInfo=L.note2Info=L._38o=O,L._87I.clear(),L.interactiveInfo=k.isInteractive(P)?{}:O,L._3O(),L._55O=k.isEditable(P)?{_42O:k.isRectEditable(P),_43O:k.isPointEditable(P),_56O:k.isRotationEditable(P)}:O,L._6I=L._81o()}return L._6I},_3O:function(){},getPosition:function(){return yk},_68o:function(A,D){A&&this._87I.add(uk(A,D))},_81o:function(){var K=this,u=K.s;K._24O(Tk,"getLabel"),K._24O(Oo,"getLabel2"),K._26O(Fb,"getNote"),K._26O(mb,"getNote2"),K._15O(),K._55O&&K._48O();var z;if(K._87I.each(function(k){z=ur(z,k)}),z){var f=K.isShadowed(),q=u("shadow2"),P=qk(z);q?(P.x+=u("shadow2.offset.x"),P.y+=u("shadow2.offset.y"),gn(P,u("shadow2.blur"))):f&&(P.x+=u("shadow.offset.x"),P.y+=u("shadow.offset.y"),gn(P,u("shadow.blur"))),z=ur(z,P)}return K._87I.clear(),z},_42:function(o){var S=this,T=S._data,z=S.gv,f=S.s,C=f("opacity"),B=this.isShadowed(),$=f("shadow2");if(B||$){var e=o.shadowOffsetX,Z=o.shadowOffsetY,F=o.shadowBlur,Q=o.shadowColor,h=z.getZoom(),Y=B?"shadow":"shadow2";o.shadowOffsetX=f(Y+".offset.x")*h,o.shadowOffsetY=f(Y+".offset.y")*h,o.shadowBlur=f(Y+".blur")*h,o.shadowColor=B?S.getSelectColor():f(Y+".color")}if(C!=O){var K=o.globalAlpha;o.globalAlpha=C}S._80o(o),z.isLabelVisible(T)&&((!z._drawForChecking||f("label.selectable"))&&Fr(o,S.labelInfo),(!z._drawForChecking||f("label2.selectable"))&&Fr(o,S.label2Info)),z.isNoteVisible(T)&&(Nq(o,S.noteInfo),Nq(o,S.note2Info)),S._99O(o),C!=O&&(o.globalAlpha=K),(B||$)&&(o.shadowOffsetX=e,o.shadowOffsetY=Z,o.shadowBlur=F,o.shadowColor=Q)},_80o:function(){},_47O:function(){},_24O:function(G,A){var s=this,K=s._data,Q=s.gv,T=s.s,d=Q[A](K);if(d!=O){var P=T(G+".scale"),Z=T(G+".max"),b=T(G+".position"),w=s[G+"Info"]={label:d,scale:P,color:Q[A+"Color"](K),font:T(G+".font"),opacity:T(G+".opacity"),align:T(G+".align"),rotation:s.getRotation(T(G+".rotation"),!1,b),background:Q[A+"Background"](K)},p=Wc(w,d);Z>0&&Z<p.width&&(w.labelWidth=p.width,p.width=Z),1!==P&&(p.width*=P,p.height*=P);var M=s.getPosition(b,T(G+".offset.x"),T(G+".offset.y"),p,T(G+".position.fixed"));if(p.x=M.x-p.width/2,p.y=M.y-p.height/2,s._68o(w.rect=p,w.rotation),1!==P){var y=p.width/P,c=p.height/P;w.rect={x:M.x-y/2,y:M.y-c/2,width:y,height:c}}}},_26O:function(Z,V){var o=this,f=o.gv,u=o._data,T=o.s,b=f[V](u);if(b!=O){var p,i,d=T(Z+".scale"),x=o[Z+"Info"]={note:b,scale:d,data:u,view:f,expanded:T(Z+".expanded"),font:T(Z+".font"),color:T(Z+".color"),opacity:T(Z+".opacity"),align:T(Z+".align"),icon:T(Z+".icon"),backgroundImage:T(Z+".backgroundImage"),borderWidth:T(Z+".border.width"),borderColor:T(Z+".border.color"),background:f[V+"Background"](u)},y=o.getPosition(T(Z+".position"),T(Z+".offset.x"),T(Z+".offset.y")),w=y.x,Q=y.y;if(x.expanded){var _,S=T(Z+".max"),U=T(Z+".backgroundImage");U?(U=co(U),_={width:Ne(U,u),height:Jf(U,u)}):_=Wc(x,b),_.width+=6,_.height+=2,S>0&&S<_.width&&(x.labelWidth=_.width,_.width=S),p=_.width,i=_.height+8,x.clickRect={x:w-p*d/2,y:Q-i*d,width:p*d,height:i*d*_.height/i}}else{var j=T(Z+".icon");j?(j=co(j),p=Ne(j,u),i=Jf(j,u)):(p=12,i=18),x.clickRect={x:w-p*d/2,y:Q-i*d,width:p*d,height:i*d}}x.rect={x:w-p/2,y:Q-i*d/2-i/2,width:p,height:i};var X=$(x.borderWidth/2)*d;o._68o({x:w-p*d/2-X,y:Q-i*d-X,width:p*d+2*X,height:i*d+2*X})}},_48O:function(){},_99O:function(G){var u=this,I=u._38o;if(I){var m=u.gv,H=u._data,o=I.icons,b=u.interactiveInfo;b&&(b._38o={});for(var U in o){var c=o[U],f=I.rects[U];if(f){b&&(b._38o[U]=[]);var D=lc(c.opacity,H,m),j=lc(c.names,H,m),B=j?j.length:0,e=f.rotation;if(D!=O){var w=G.globalAlpha;G.globalAlpha*=D}for(var C=0;B>C;C++){var P=j[C],h=co(P),T=f[C];if(e){var g=T.x+T.width/2,s=T.y+T.height/2;G.save(),cl(G,g,s),gc(G,e),cl(G,-g,-s)}b&&b._38o[U].push(G.interactiveInfo={compInfos:[],matrix:e?new Hm(e,g,s).appendTranslate(-g,-s):new Hm}),Dk(G,h,lc(c.stretch,H,m),T.x,T.y,T.width,T.height,u._data,u.gv),G.interactiveInfo=O,e&&G.restore()}D!=O&&(G.globalAlpha=w)}}}}});var Re=function(R,K){Ck(Re,this,[R,K])};kk(Re,Pr,{_checkEmptyRect:!0,_40O:function(v,B){var l=this,E=l.s,X=v.rect;(v.borderColor=l.gv.getBorderColor(l._data))&&(v.borderType=E("border.type"),v.borderWidth=E("border.width"),v.borderPadding=E("border.padding"),B=P(B,v.borderPadding+v.borderWidth/2));var O=l._data.getScale(),W=P(1,P(w(O.x),w(O.y)));if(v.selectWidth=l.getSelectWidth()){var p=l.gv._zoom;v.selectType=E("select.type"),v._97o=l.getSelectColor(),v.selectPadding=E("select.padding"),B=P(B,(v.selectPadding+v.selectWidth/2/p)/W)}B>0&&(B*=W,X=qk(X),gn(X,B)),l._68o(X)},_39O:function(z,V){var S,C=this,q=V.rect;if(V.borderWidth>0&&(S=V.borderPadding,z.strokeStyle=V.borderColor,z.lineWidth=V.borderWidth,Ql(z,V.borderType,{x:q.x-S,y:q.y-S,width:q.width+2*S,height:q.height+2*S}),z.stroke()),V.selectWidth>0){var G=C.gv._zoom;if(S=V.selectPadding,z.strokeStyle=V._97o,z.lineWidth=V.selectWidth/G,V.rotation!=O){z.save(),z.translate(V.position.x,V.position.y),z.rotate(V.rotation);var B=C._data,I=B.getWidth(),y=B.getHeight(),n=V.scale,c=V.anchor;q={x:n.x*-I*c.x,y:n.y*-y*c.y,width:n.x*I,height:n.y*y}}Ql(z,V.selectType,{x:q.x-S,y:q.y-S,width:q.width+2*S,height:q.height+2*S}),V.rotation!=O&&z.restore(),z.stroke()}},dispose:function(){var U=this,b=U._htmlView;Re.superClass._3O.call(U),b&&(b.onHTMLRemoved&&b.onHTMLRemoved(),go(b))},_3O:function(){var v=this,D=v.s,J=v._data,G=v.gv,k=G.getShape(J),m=v.getBodyColor(),F=v._83o=k?{shape:k,_53o:v.getBodyColor("shape.background"),_27Q:co(D("shape.repeat.image"),m),shapeGradientPack:D("shape.gradient.pack"),_54o:D("shape.border.width"),_55o:D("shape.border.color"),_56o:D("shape.border.3d"),_57o:D("shape.border.3d.color"),_58o:D("shape.border.3d.accuracy"),shapeGradient:D("shape.gradient"),_59o:D("shape.gradient.color"),_60o:D("shape.border.pattern"),_61o:D("shape.border.cap"),_62o:D("shape.border.join"),shapeForeground:D("shape.foreground"),bodyColor:m,gray:D("2d.gray")}:{img:co(G.getImage(J),m),bodyColor:m,gray:D("2d.gray"),stretch:D("image.stretch")};if(a&&!x);else{var C,e=F.img;e&&e.renderHTML?(v._htmlInfo&&v._htmlInfo.img!==e&&(v._htmlInfo=O),v._htmlInfo||(v._htmlInfo={img:e,cache:{}}),C=e.renderHTML(J,G,v._htmlInfo.cache)):v._htmlInfo=O,v._htmlView&&v._htmlView!==C&&(v._htmlView.onHTMLRemoved&&v._htmlView.onHTMLRemoved(),go(v._htmlView.getView?v._htmlView.getView():v._htmlView)),(v._htmlView=C)&&G.appendHTML(C)&&(C.onHTMLAddedSync&&C.onHTMLAddedSync(),C.onHTMLAdded&&Bj(C.onHTMLAdded)),F.rect=J.getRect(),F.position=J.p(),F.scale=J.getScale(),F.anchor=J.getAnchor(),F.rotation=J.getRotation(),k===Dl&&(F._63o=D("shape.depth"));var s=0;if(k)s=Zm(O,F._54o/2,F._62o),v.s("shape.dash")&&(s=P(s,(v.s("shape.dash.width")||F._54o)/2));else if(e&&e.boundExtend)if(s=lc(e.boundExtend,J,G),e.boundExtendAbsolute){var n=J.getScale();s/=G._zoom*P(1,P(w(n.x),w(n.y)))}else if(!lc(e.fitSize,J,G)){var d=lc(e.width,J,G),M=lc(e.height,J,G);s*=P(J.getWidth()/d,J.getHeight()/M)}v._40O(F,s);var j=D("clip.percentage");if(1>j&&(0>j&&(j=0),F.clipRect=Ji(J.getAnchorRect(),D("clip.direction"),j),F.clipColor=D("clip.color")),k){var o=D("shape.fill.clip.percentage");1>o&&(0>o&&(o=0),F.shapeClipRect=Ji(J.getAnchorRect(),D("shape.fill.clip.direction"),o),F.shapeClipColor=D("shape.fill.clip.color"));var b=D("shape.foreground.clip.percentage");1>b&&(0>b&&(b=0),F.shapeForegroundClipRect=Ji(J.getAnchorRect(),D("shape.foreground.clip.direction"),b),F.shapeForegroundClipColor=D("shape.foreground.clip.color"))
}}},getPosition:function(i,p,o,z){var D=Ke(i,this._83o.rect,z);return D.x+=p,D.y+=o,D},_80o:function(G){var t=this,b=t.s,f=t.gv,V=t._data,A=t._83o,u=A.rect,w=A.position,J=A.rotation,d=A.anchor,e=A.scale,l=A.shape,B=A.clipRect,i=A.clipColor;if(!t._checkEmptyRect||u.width>0&&u.height>0){var Z=V.getSize();if(Z.x=-Z.width*d.x,Z.y=-Z.height*d.y,G.save(),cl(G,w.x,w.y),gc(G,J),eb(G,e.x,e.y),B&&!i&&(G.beginPath(),G.rect(B.x,B.y,B.width,B.height),G.clip()),f._drawForChecking&&A.img&&lc(A.img.pixelPerfect,V,f)===!1)hd(G,Z.x,Z.y,Z.width,Z.height,"#888888");else if(t.freeDraw)t.freeDraw(G,Z,A);else if(l){var r,a,Y,$,y=A._60o,U=rh(G,y),v=A._27Q,I=A._54o,N=A.shapeGradientPack,n=A.gray,D=G.lineJoin,L=G.lineCap,h=function(i){return n?j.toGrayColor(i):i};"roundRect"===l?r=b("shape.corner.radius"):"polygon"===l?r=b("shape.polygon.side"):"arc"===l&&(r=b("shape.arc.from"),a=b("shape.arc.to"),Y=b("shape.arc.close"),$=b("shape.arc.oval")),G.lineJoin=A._62o,G.lineCap=A._61o;var k=h(A._53o);if(k||v||N){var s=A.shapeClipRect,F=A.shapeClipColor;if(s&&(G.save(),F||(G.beginPath(),G.rect(s.x,s.y,s.width,s.height),G.clip())),Ql(G,l,Z,r,a,Y,$),N?oh(G,N):v?Zo(G,v,h(A.bodyColor),null,V,f):mi(G,k,A.shapeGradient,h(A._59o),Z),G.fill(),s){if(F)G.globalCompositeOperation="multiply",G.fillStyle=F,G.clip(),G.fillRect(s.x,s.y,s.width,s.height);else{var W=b("shape.fill.clip.gradient");if(W!=O&&W>0){G.globalCompositeOperation="destination-out";var Q=bp(G,s,b("shape.fill.clip.direction"),W);G.fillStyle=Q.gradient;var H=Q.rect;G.clip(),G.fillRect(H.x,H.y,H.width,H.height)}}G.restore()}N&&G.restore(),G!==U&&Ql(U,l,Z,r,a,Y,$)}else Ql(U,l,Z,r,a,Y,$);var K=A.shapeForeground;if(K){G.save();var m=A.shapeForegroundClipRect,x=A.shapeForegroundClipColor;if(m&&!x&&(G.beginPath(),G.rect(m.x,m.y,m.width,m.height),G.clip()),Ql(G,l,Z,r,a,Y,$),mi(G,K,b("shape.foreground.gradient"),h(b("shape.foreground.gradient.color")),Z),G.fill(),m)if(x)G.globalCompositeOperation="multiply",G.fillStyle=x,G.clip(),G.fillRect(m.x,m.y,m.width,m.height);else{var W=b("shape.foreground.clip.gradient");if(W!=O&&W>0){G.globalCompositeOperation="destination-out";var Q=bp(G,m,b("shape.foreground.clip.direction"),W);G.fillStyle=Q.gradient;var H=Q.rect;G.clip(),G.fillRect(H.x,H.y,H.width,H.height)}}G.restore()}if(I>0){var C=b("shape.border.width.absolute");C&&(G.save(),G.setTransform(1,0,0,1,0,0)),G.lineWidth=I;var E=h(A._55o);G.strokeStyle=E,G.stroke(),C&&G.restore(),A._56o&&kn(G,E,h(A._57o),I,f._zoom,A._58o)}if(hr(G,y),b("shape.dash")){var R=b("shape.dash.width")||I;if(R>0){y=b("shape.dash.pattern");var U=rh(G,y,t._2Q("shape.dash.offset"));U!==G&&Ql(U,l,Z,r,a,Y,$),t._1Q(G,"shape",R,y)}}ri(G,k,A._63o,Z),G.lineJoin=D,G.lineCap=L}else{var g=t.interactiveInfo;g&&(G.interactiveInfo=g.bodyInfo={compInfos:[],matrix:new Hm(J,w.x,w.y,e.x,e.y)}),A.gray&&(G.compGray=!0);var q=A.img;q&&q.cacheRule!=O&&(q=kc(G,q,A.stretch,Z.width,Z.height,V,f,A.bodyColor)),Dk(G,q,A.stretch,Z.x,Z.y,Z.width,Z.height,V,f,A.bodyColor),G.compGray=!1,G.interactiveInfo=O}if(B)if(i)G.globalCompositeOperation="multiply",G.fillStyle=i,G.clip(),G.fillRect(B.x,B.y,B.width,B.height);else{var W=b("clip.gradient");if(W!=O&&W>0){G.globalCompositeOperation="destination-out";var Q=bp(G,B,b("clip.direction"),W);G.fillStyle=Q.gradient;var H=Q.rect;G.clip(),G.fillRect(H.x,H.y,H.width,H.height)}}G.restore()}t._39O(G,A)},_48O:function(){},_47O:function(){}});var jj=function(y,q){Ck(jj,this,[y,q])},Uc=function(U,Z,V,D){var n=rs(U,Z);return V=D?u(V,n):Ro(V,n),n?V/=n:V=0,{x:U.x+(Z.x-U.x)*V,y:U.y+(Z.y-U.y)*V}};kk(jj,Pr,{_3O:function(){var y,k=this,g=k._data,M=k.gv,V=k.s,B=V(Jq),G=g.isLooped(),$=V("edge.width"),W=V("edge.center"),_=V("edge.offset"),c=M.getBorderColor(g),A=c?V("border.width"):0,p=k.getSelectWidth(),X=g._40I,H=g._41I,T=k._78o=X&&H?{looped:G,type:B,width:$,center:W,color:k.getBodyColor("edge.color"),borderColor:c,borderWidth:A,_97o:p?k.getSelectColor():O,selectWidth:p,pattern:V("edge.pattern"),cap:V("edge.cap"),join:V("edge.join"),is3d:V("edge.3d"),_67o:V("edge.3d.color"),_66o:V("edge.3d.accuracy"),gray:V("2d.gray")}:O;if(T){var x=j.getEdgeType(B);if(x){var v=x(g,Xh(k,M,g,G,B),M,k._19Q);v.points&&v.points.size()>1?(T.edgeTypeInfo=v,y=pr(T.edgeTypeInfo.points)):v[Gh]&&v.rect&&(T.edgeTypeInfo=v,y=v.rect)}else{var f=V("edge.source.anchor.x"),K=V("edge.source.anchor.y"),Y=V("edge.target.anchor.x"),S=V("edge.target.anchor.y"),q=Ui(M,g,"source"),U=Ui(M,g,"target");if(B===Nj){var z=T.points=V(tn)||jf,h=z.size();T.segments=V("edge.segments");var J=f!==n||K!==n||_n(X),N=Y!==n||S!==n||_n(H);if(!W)if(_)J||(q=Uc(q,h?z.get(0):U,_,h)),N||(U=Uc(U,h?z.get(h-1):q,_,h));else{var I;J||(I=lm(q,h?z.get(0):U,Hq(M,X)),I&&(q={x:I[0],y:I[1]})),N||(I=lm(h?z.get(h-1):q,U,Hq(M,H)),I&&(U={x:I[0],y:I[1]}))}y=ur(pr(T.points),pr(q,U))}else{var u=Xh(k,M,g,G,B);if(k._19Q||(u=-u),G)q=qk(q),q.x=M.getNodeRect(X).x,T.radius=u,y={x:q.x-u,y:q.y-u,width:2*u,height:2*u};else{var e=rs(q,U),o=Ro(_,e),a={x:o,y:u},w={x:e-o,y:u},F=E(U.y-q.y,U.x-q.x),r=T.mat=new eg(F);if(T.orienAngle=F,T.angle=U.x<q.x?F+t:F,T.rect={x:a.x,y:a.y,width:w.x-a.x,height:0},T.origin=q,a=r.tf(a),a.x+=q.x,a.y+=q.y,w=r.tf(w),w.x+=q.x,w.y+=q.y,W){var Z={x:e,y:0};Z=r.tf(Z),Z.x+=q.x,Z.y+=q.y,y=pr([q,a,w,Z]),T.c1=q,T.c2=Z}else y=pr(a,w);q=a,U=w}}T.sourcePoint=q,T.targetPoint=U,g._lastSourcePoint=q,g._lastTargetPoint=U}var s=0;V("edge.dash")&&(s=V("edge.dash.width")||$);var L="square"===T.cap?.71:.5;Zm(y,P(s*L,$*L+A+p),T.join),k._68o(y)}},getRotation:function(g,j,w){g=g||0;var _=this._78o;if(_){var Y,p=_.angle,o=_.points,n=_.edgeTypeInfo;if(p!=O)return j?_.orienAngle+g:p+g;if(n&&n[Gh])return n.getRotation?n.getRotation(this,g,j,w):0;if(n&&n.points){var U=n.points;return Y=U.size(),ho[w]?Y&&0===Y%2?jg(U.get(Y/2-1),U.get(Y/2),j,g):g:he[w]?jg(U.get(0),U.get(1),j,g):jg(U.get(Y-2),U.get(Y-1),j,g)}if(o)return Y=o.size(),ho[w]?Y&&0===Y%2?jg(o.get(Y/2-1),o.get(Y/2),j,g):g:he[w]?jg(_.sourcePoint,Y?o.get(0):_.targetPoint,j,g):jg(Y?o.get(Y-1):_.sourcePoint,_.targetPoint,j,g)}return g},getPosition:function(b,Q,X,p,N){var k=this._78o;if(k){var K,r=k.type,R=k.points,G=k.edgeTypeInfo,P=k.sourcePoint,t=k.targetPoint;if(!r)return k.looped?{x:P.x-k.radius+Q,y:P.y+X}:(N&&P&&t&&(P.x>t.x||P.x===t.x&&P.y>t.y)&&(b=Uo[b],X=-X),K=Ke(b,k.rect,p),K.x+=Q,K.y+=X,K=k.mat.tf(K),K.x+=k.origin.x,K.y+=k.origin.y,K);if(G&&G[Gh])return G.getPosition?G.getPosition(this,b,Q,X,p,N):{x:(P.x+t.x)/2,y:(P.y+t.y)/2};if(R){var K,d=R.size();if(ho[b]){if(d){var A=d%2;if(0===A)return dm(R.get(d/2-1),R.get(d/2),b,Q,X,p,N);K=R.get((d-A)/2)}else K={x:(P.x+t.x)/2,y:(P.y+t.y)/2};return K=Ke(b,{x:K.x,y:K.y,width:0,height:0},p),K.x+=Q,K.y+=X,K}return he[b]?dm(P,d?R.get(0):t,b,Q,X,p,N):dm(d?R.get(d-1):P,t,b,Q,X,p,N)}if(G){var F=G.points,d=F.size();if(ho[b]){var A=d%2;return 0===A?dm(F.get(d/2-1),F.get(d/2),b,Q,X,p,N):(K=F.get((d-A)/2),K=Ke(b,{x:K.x,y:K.y,width:0,height:0},p),K.x+=Q,K.y+=X,K)}return he[b]?dm(F.get(0),F.get(1),b,Q,X,p,N):dm(F.get(d-2),F.get(d-1),b,Q,X,p,N)}}return yk},_42:function(p){this._78o&&jj.superClass._42.call(this,p)},drawPath:function(Z,X){Z.beginPath();var e=X.type,i=X.points,t=X.segments,I=X.edgeTypeInfo;if(!e||i){var C=X.sourcePoint,v=C.x,G=C.y,R=X.targetPoint,O=R.x,m=R.y;if(e)if(t){var n=new zf({x:v,y:G});n.addAll(i),n.add({x:O,y:m}),Ri(Z,n,t)}else Z.moveTo(v,G),i.each(function(K){Z.lineTo(K.x,K.y)}),Z.lineTo(O,m);else X.looped?Z.arc(v,G,X.radius,0,A,!0):X.center?(Z.moveTo(X.c1.x,X.c1.y),Z.lineTo(v,G),Z.lineTo(O,m),Z.lineTo(X.c2.x,X.c2.y)):(Z.moveTo(v,G),Z.lineTo(O,m))}else I&&(I.points?Ri(Z,I.points,I.segments):I[Gh]&&I[Gh](Z,I))},_80o:function(E){var q=this,I=q.s,x=q._78o,J=x.width,D=x.selectWidth,n=x.borderWidth,O=E.lineJoin,z=E.lineCap,$=x.gray,f=x.pattern;E.lineJoin=x.join,E.lineCap=x.cap,q.drawPath(rh(E,f),x);var g=I("edge.width.absolute");g&&(E.save(),E.setTransform(1,0,0,1,0,0)),D&&(E.strokeStyle=x._97o,E.lineWidth=J+2*(n+D),E.stroke()),n&&(E.strokeStyle=$?j.toGrayColor(x.borderColor):x.borderColor,E.lineWidth=J+2*n,E.stroke());var A=$?j.toGrayColor(x.color):x.color,v=$?j.toGrayColor(x._67o):x._67o;if(E.strokeStyle=A,E.lineWidth=J,E.stroke(),x.is3d&&kn(E,A,v,J,q.gv._zoom,x._66o),hr(E,f),I("edge.dash")){f=I("edge.dash.pattern");var r=rh(E,f,q._2Q("edge.dash.offset"));r!==E&&q.drawPath(r,x),q._1Q(E,"edge",I("edge.dash.width")||J,f)}g&&E.restore(),E.lineJoin=O,E.lineCap=z},_48O:function(){},_47O:function(){}});var _j=function(j,i){Ck(_j,this,[j,i])};kk(_j,Re,{_3O:function(){var E,B,n=this,W=n.s,J=n._data,i=n.gv;if(n._88I=O,J.isExpanded()&&J.eachChild(function(q){if(De(q)){var x=i.getBoundsForGroup(q);x&&(B||(B=[]),B.push(x),E=ur(E,x))}}),E){var j=i.getLabel(J),z=W("group.type"),P=W("group.border.width")||0,t=W("group.border.width.absolute"),N=P/2;t&&(P/=i._zoom),E=wq(z,B,E),qj(E,J,"group.padding",1),gn(E,P);var y=n._88I={type:z,rect:E,_64o:E};if(!z&&j!=O){var F,H=n.labelInfo={label:j,color:W("group.title.color"),font:W("group.title.font"),align:W("group.title.align")},Z=Wc(H,j),D=Z.width+P,b=Z.height+P,k=W("group.title.align"),R=W("group.title.orientation");if(R===nh||R===$c?(E.height+=P,D>E.width&&(E.width=D)):(R===dj||R===xq)&&(E.width+=P,D>E.height&&(E.height=D)),F=k===dj?E.x:k===xq?E.x+E.width-D:E.x+E.width/2-D/2,R===$c)y.titleRect={x:E.x,y:E.y+E.height,width:E.width,height:b},y.rect={x:E.x,y:E.y,width:E.width,height:E.height+b},H.rect={x:F,y:E.y+E.height,width:D,height:b};else if(R===dj){var u=y.titleRect={x:E.x-b,y:E.y,width:b,height:E.height};y.rect={x:E.x-b,y:E.y,width:E.width+b,height:E.height},H.rect={x:u.x+b/2-E.height/2,y:u.y+E.height/2-b/2,width:E.height,height:b},H.rotation=-Math.PI/2}else if(R===xq){var u=y.titleRect={x:E.x+E.width,y:E.y,width:b,height:E.height};y.rect={x:E.x,y:E.y,width:E.width+b,height:E.height},H.rect={x:u.x+b/2-E.height/2,y:u.y+E.height/2-b/2,width:E.height,height:b},H.rotation=Math.PI/2}else y.titleRect={x:E.x,y:E.y-b,width:E.width,height:b},y.rect={x:E.x,y:E.y-b,width:E.width,height:E.height+b},H.rect={x:F,y:E.y-b-N,width:D,height:b+P}}n._40O(y,W("group.border.width")/2)}else _j.superClass._3O.call(n)},getPosition:function(i,U,h,x){var R=this._88I;if(R){var e=Ke(i,R.rect,x);return e.x+=U,e.y+=h,e}return _j.superClass.getPosition.apply(this,arguments)},_24O:function(M,p){var h=this._88I;(!h||h.type||"label2"===M)&&_j.superClass._24O.call(this,M,p)},_80o:function(q){var p=this,J=p._88I;if(J){var C=p._data,$=p.s,D=p.gv,j=J.type,Z=J.rect,P=J._64o,b=J.titleRect,k=p.getBodyColor(),V=co($("group.image"),k),Q=$("group.image.stretch"),_=p.getBodyColor("group.background"),l=co($("group.repeat.image"),k),y=$("group.gradient.pack"),o=$("group.gradient"),v=$("group.gradient.color"),i=$("group.border.width"),Y=$("group.border.color"),F=$("group.border.pattern"),s=$("group.title.orientation"),f=$("group.depth"),N=$("group.border.radius"),R=$("group.border.join"),X=$("group.border.cap"),M=$("group.border.width.absolute");if(M&&(i/=D._zoom),j){var w=q.lineJoin,T=q.lineCap;if(q.lineJoin=R,q.lineCap=X,V){if(q.save(),Ql(q,j,Z,N),q.clip(),Dk(q,V,Q,Z.x,Z.y,Z.width,Z.height,C,D,k),q.restore(),i>0){var H=rh(q,F);Ql(H,j,Z,N),q.lineWidth=i,q.strokeStyle=Y,q.stroke(),hr(q,F)}}else{var H=rh(q,F);_||l||y?(Ql(q,j,Z,N),y?oh(q,y):l?Zo(q,l,k,null,C,D):mi(q,_,o,v,Z),q.fill(),y&&q.restore(),q!==H&&Ql(H,j,Z,N)):Ql(H,j,Z,N),i>0&&(q.lineWidth=i,q.strokeStyle=$("group.border.color"),q.stroke()),hr(q,F),j===Dl&&ri(q,_,f,Z)}q.lineJoin=w,q.lineCap=T}else{var d=$("group.title.background");if((!N||0>N)&&(N=0),V)Dk(q,V,Q,P.x,P.y,P.width,P.height,C,D,p.getBodyColor());else if(_||l)if(l?Zo(q,l,k,null,C,D):mi(q,_,o,v,P),0===i)Ql(q,Dl,P),q.fill(),ri(q,_,f,P);else{switch(q.beginPath(),s){case $c:zi(q,P.x,P.y,P.width,P.height,N,N,0,0);break;case dj:zi(q,P.x,P.y,P.width,P.height,0,N,0,N);break;case xq:zi(q,P.x,P.y,P.width,P.height,N,0,N,0);break;case nh:zi(q,P.x,P.y,P.width,P.height,0,0,N,N)}q.fill()}if(b&&d)if(0===i)hd(q,b.x,b.y,b.width,b.height,d),ri(q,d,f,b);else{switch(q.beginPath(),q.fillStyle=d,s){case $c:zi(q,b.x,b.y,b.width,b.height,0,0,N,N);break;case dj:zi(q,b.x,b.y,b.width,b.height,N,0,N,0);break;case xq:zi(q,b.x,b.y,b.width,b.height,0,N,0,N);break;case nh:zi(q,b.x,b.y,b.width,b.height,N,N,0,0)}q.fill()}if(i>0){var H=rh(q,F);if(Ql(H,"roundRect",Z,N),q.save(),q.lineWidth=i,q.strokeStyle=Y,q.lineJoin=R,q.lineCap=X,q.closePath(),q.stroke(),b&&$("group.splitLine")){var g=b.x,K=b.y,r=b.width,B=b.height;q.beginPath(),s===$c?(q.moveTo(g,K),q.lineTo(g+r,K)):s===dj?(q.moveTo(g+r,K),q.lineTo(g+r,K+B)):s===xq?(q.moveTo(g,K),q.lineTo(g,K+B)):(q.moveTo(g,K+B),q.lineTo(g+r,K+B))}q.stroke(),q.restore(),hr(H,F)}}p._39O(q,J)}else _j.superClass._80o.call(p,q)}});var ih=function(O,U){Ck(ih,this,[O,U])};kk(ih,Re,{_80o:function(Z){this._39O(Z,this._83o)}});var gg=function(y,Y){Ck(gg,this,[y,Y])};kk(gg,Re,{_3O:function(){var K=this,G=K._data,i=K.s,V=K.gv,s=G.getPoints(),_=V.getBorderColor(G),z=_?i("border.width"):0,l=K.getSelectWidth(),n=i("shape.border.width"),Q=G.getRect(),L=G.getAnchorRect(),e=V.getBodyColor(G),B=K._99o=s.isEmpty()?O:{rect:Q,rotation:G.getRotation(),fillRule:i("shape.fill.rule"),scale:G.getScale(),position:G.p(),points:s,segments:G.getSegments(),bodyColor:e,borderColor:_,borderWidth:z,_94o:i("shape.border.3d"),_95o:i("shape.border.3d.color"),_96o:i("shape.border.3d.accuracy"),_97o:l?K.getSelectColor():O,selectWidth:l,_53o:i("shape.background"),_27Q:co(i("shape.repeat.image"),e),shapeGradientPack:i("shape.gradient.pack"),_54o:n,_55o:i("shape.border.color"),shapeGradient:i("shape.gradient"),_59o:i("shape.gradient.color"),_60o:i("shape.border.pattern"),_61o:i("shape.border.cap"),_62o:i("shape.border.join"),shapeForeground:i("shape.foreground"),gray:i("2d.gray")};if(B){L.x+=B.position.x,L.y+=B.position.y,B.gradientRect=L;var c=G.getScale(),I=P(1,P(w(c.x),w(c.y)));i("shape.dash")&&i("shape.dash.width")>n&&(n=i("shape.dash.width"));var N,r=i("shape.border.width.absolute");N=r?(n+z+l)/K.gv._zoom/I:n*("square"===B._61o?.71:.5)+z+l/K.gv._zoom/I,N&&(N*=I,Q=qk(Q),Zm(Q,N,B._62o)),K._68o(Q);var h=i("clip.percentage");1>h&&(0>h&&(h=0),B.clipRect=Ji(G.getAnchorRect(),i("clip.direction"),h),B.clipColor=i("clip.color"));var W=i("shape.fill.clip.percentage");1>W&&(0>W&&(W=0),B.shapeClipRect=Ji(G.getAnchorRect(),i("shape.fill.clip.direction"),W),B.shapeClipColor=i("shape.fill.clip.color"));var f=i("shape.foreground.clip.percentage");1>f&&(0>f&&(f=0),B.shapeForegroundClipRect=Ji(G.getAnchorRect(),i("shape.foreground.clip.direction"),f),B.shapeForegroundClipColor=i("shape.foreground.clip.color"))}},getPosition:function(l,Y,b,w){var U=this._99o;if(U){var P=Ke(l,U.rect,w);return P.x+=Y,P.y+=b,P}return yk},_42:function(m){this._99o&&gg.superClass._42.call(this,m)},_80o:function(b){var g,l=this,d=l.s,X=l._99o,D=X.position,e=X.scale,c=X.rotation,f=X.borderWidth,Y=X.selectWidth/l.gv._zoom,C=X._27Q,N=X.shapeGradientPack,V=X._54o,P=X.clipRect,z=X.clipColor,R=X.shapeClipRect,L=X.shapeClipColor,v=X.points,B=X.segments,y=l._data.isClosePath(),_=X.fillRule,Q=X.gray,x=function(x){return Q?j.toGrayColor(x):x},A=x(X._53o),H=A||C||N;b.save(),cl(b,D.x,D.y),gc(b,c),eb(b,e.x,e.y),P&&!z&&(b.beginPath(),b.rect(P.x,P.y,P.width,P.height),b.clip()),H&&R&&(b.save(),L||(b.beginPath(),b.rect(R.x,R.y,R.width,R.height),b.clip())),cl(b,-D.x,-D.y);var r=X._60o,M=rh(b,r),i=b.lineJoin,K=b.lineCap;b.lineJoin=X._62o,b.lineCap=X._61o;var s=x(X.bodyColor);if(H){if(Ri(b,v,B,y),N?oh(b,N):C?Zo(b,C,s,null,l._data,l.gv):(g=s?s:A,mi(b,g,X.shapeGradient,x(X._59o),X.gradientRect)),b.fill(_),R){if(L)cl(b,D.x,D.y),b.globalCompositeOperation="multiply",b.fillStyle=L,b.clip(),b.fillRect(R.x,R.y,R.width,R.height);else{var U=d("shape.fill.clip.gradient");if(U!=O&&U>0){cl(b,D.x,D.y),b.globalCompositeOperation="destination-out";var t=bp(b,R,d("shape.fill.clip.direction"),U);b.fillStyle=t.gradient;var T=t.rect;b.clip(),b.fillRect(T.x,T.y,T.width,T.height)}}b.restore(),cl(b,-D.x,-D.y)}N&&b.restore(),M!==b&&Ri(M,v,B,y)}else Ri(M,v,B,y);var k=X.shapeForeground;if(k){b.save();var q=X.shapeForegroundClipRect,J=X.shapeForegroundClipColor;if(q&&!J&&(cl(b,D.x,D.y),b.beginPath(),b.rect(q.x,q.y,q.width,q.height),b.clip(),cl(b,-D.x,-D.y)),Ri(b,v,B,y),mi(b,k,d("shape.foreground.gradient"),x(d("shape.foreground.gradient.color")),X.gradientRect),b.fill(_),q)if(J)cl(b,D.x,D.y),b.globalCompositeOperation="multiply",b.fillStyle=J,b.clip(),b.fillRect(q.x,q.y,q.width,q.height);else{var U=d("shape.foreground.clip.gradient");if(U!=O&&U>0){cl(b,D.x,D.y),b.globalCompositeOperation="destination-out";var t=bp(b,q,d("shape.foreground.clip.direction"),U);b.fillStyle=t.gradient;var T=t.rect;b.clip(),b.fillRect(T.x,T.y,T.width,T.height)}}b.restore()}var o=d("shape.border.width.absolute");if(o&&(b.save(),b.setTransform(1,0,0,1,0,0)),Y&&(b.strokeStyle=X._97o,b.lineWidth=V+2*(f+Y),b.stroke()),f&&(b.strokeStyle=x(X.borderColor),b.lineWidth=V+2*f,b.stroke()),V&&(g=x(X._55o),!A&&s&&(g=s),b.strokeStyle=g,b.lineWidth=V,b.stroke(),X._94o&&kn(b,g,x(X._95o),V,l.gv._zoom,X._96o)),hr(b,r),d("shape.dash")){var n=d("shape.dash.width")||V;if(n>0){r=d("shape.dash.pattern");var M=rh(b,r,l._2Q("shape.dash.offset"));M!==b&&Ri(M,v,B,y),l._1Q(b,"shape",n,r)}}if(o&&b.restore(),b.lineJoin=i,b.lineCap=K,P)if(z)cl(b,D.x,D.y),b.globalCompositeOperation="multiply",b.fillStyle=z,b.clip(),b.fillRect(P.x,P.y,P.width,P.height);else{var U=d("clip.gradient");if(U!=O&&U>0){cl(b,D.x,D.y),b.globalCompositeOperation="destination-out";var t=bp(b,P,d("clip.direction"),U);b.fillStyle=t.gradient;var T=t.rect;b.clip(),b.fillRect(T.x,T.y,T.width,T.height)}}b.restore()},_48O:function(){},_47O:function(){}});var wk=function(E,Q){Ck(wk,this,[E,Q])};kk(wk,gg,{getRotation:function(Q,D,I){Q=Q||0;var $=this._data.getPoints(),k=$.size();return k>1?ho[I]?k&&0===k%2?jg($.get(k/2-1),$.get(k/2),D,Q):Q:he[I]?jg($.get(0),$.get(1),D,Q):jg($.get(k-2),$.get(k-1),D,Q):Q},getPosition:function(O,h,B,U,v){var d=this._data.getPoints(),H=d.size();if(H>1){if(ho[O]){var Z=H%2;if(0===Z)return dm(d.get(H/2-1),d.get(H/2),O,h,B,U,v);var m=d.get((H-Z)/2),q={x:m.x,y:m.y,width:0,height:0};return m=Ke(O,q,U),m.x+=h,m.y+=B,m}return he[O]?dm(d.get(0),d.get(1),O,h,B,U,v):dm(d.get(H-2),d.get(H-1),O,h,B,U,v)}return yk}});var ln=function(O,S){Ck(ln,this,[O,S])};kk(ln,Re,{_3O:function(){var g=this;ln.superClass._3O.call(g);var G=g.s,$=g._83o;g._82o=$.img||$.shape?O:{background:g.getBodyColor("grid.background"),depth:G("grid.depth"),rect:$.rect,_88o:G("grid.cell.depth"),cellBorderColor:G("grid.cell.border.color"),_89o:G("grid.row.count"),_90o:G("grid.column.count"),block:G("grid.block"),_91o:G("grid.block.color"),_92o:G("grid.block.padding"),_93o:G("grid.block.width")}},_80o:function(l){var M=this,i=M._82o;if(!i)return ln.superClass._80o.call(M,l),void 0;var L,f,h=M._data,Y=i.background,S=i.rect,v=i.block,Q=i._91o,D=i._92o,e=i._93o,j=i._88o,T=i.cellBorderColor,C=i._89o,B=i._90o;if(Y)if(hd(l,S.x,S.y,S.width,S.height,Y),ri(l,Y,i.depth,S),j)for(L=0;C>L;L++)for(f=0;B>f;f++)S=h.getCellRect(L,f),S&&ri(l,Y,j,S);else if(T){for(l.beginPath(),L=0;C>L;L++)for(f=0;B>f;f++)S=h.getCellRect(L,f),S&&l.rect(S.x,S.y,S.width,S.height);l.strokeStyle=T,l.lineWidth=1,l.stroke()}if("h"===v)for(L=0;C>L;L++)S=ur(h.getCellRect(L,0),h.getCellRect(L,B-1)),gn(S,D),Vi(l,Q,S.x,S.y,S.width,S.height,e);else if("v"===v)for(f=0;B>f;f++)S=ur(h.getCellRect(0,f),h.getCellRect(C-1,f)),gn(S,D),Vi(l,Q,S.x,S.y,S.width,S.height,e);M._39O(l,M._83o)}});var fi=function(u,f){Ck(fi,this,[u,f])};kk(fi,Re,{_checkEmptyRect:!1,_81o:function(){var N=this._data,F=fi.superClass._81o.call(this),r=N.s("text");if(r!=O){var X,e,G=N.s("text.font"),l=N.s("text.align"),P=N.s("text.vAlign"),c=Pi(G,r),x=c.width,S=c.height,m=N.getAnchor(),j=N.getWidth(),o=N.getHeight();"left"===l?X=-j*m.x:"center"===l?X=-j*m.x+(j-x)/2:"right"===l&&(X=j*(1-m.x)-c.width),"top"===P?e=-o*m.y:"middle"===P?e=-o*m.y+(o-S)/2:"bottom"===P&&(e=o*(1-m.y)-c.height);var J,y=N.getMatrix();if(J=pr([y.tf(X,e),y.tf(X+x,e),y.tf(X+x,e+S),y.tf(X,e+S)]),F=ur(F,J),F&&N.s("text.shadow")){var T=qk(F);T.x+=N.s("text.shadow.offset.x"),T.y+=N.s("text.shadow.offset.y"),gn(T,N.s("text.shadow.blur")),F=ur(F,T)}}return F}});var Xb=km.Interactor=function(l){this.gv=this._graphView=l};wp("Interactor",L,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(F){this.gv.fi(F)},setCursor:function(P){Lr||this.gv.setCursor(P)},startDragging:function(P){var e=this;e._lastClientPoint=up(P),e._lastLogicalPoint=e.gv.lp(P),Bi(e,P)},clearDragging:function(){var h=this;h._lastClientPoint=h._lastLogicalPoint=h._logicalPoint=O},autoScroll:function(l){return this.gv.autoScroll(l,this._lastClientPoint)}});var Zj=O,gs=function(F){Zj.handleWindowTouchMove(F)},gi=function(W){Zj.handleWindowTouchEnd(W),X(m,is,gs),X(m,hj,gi),Zj=O},ui=function(N){Zj.handleWindowMouseMove(N)},Sc=function(W){Zj.handleWindowMouseUp(W),X(m,sm,ui),X(m,Dh,Sc),Zj=O},ul=function(C,E){if(C!==Zj){var d=Hh(E);Zj?d?Zj.handleWindowTouchEnd(E):Zj.handleWindowMouseUp(E):d?(q(m,is,gs),q(m,hj,gi)):(q(m,sm,ui),q(m,Dh,Sc)),Zj=C}},bd=function($){var S=this;S.gv=$,S._is2d=$ instanceof km.GraphView,S._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Od,"wheel"].forEach(function(m){S.addListener(m)}),S.initImageResource()};kk(bd,Xb,{enableVR:function(O){var Q=this;if(!!Q._vrEnable!==O)if(Q._vrEnable=O,O)Q.gv.vr.mp(Q.onVRControllerChange,Q);else if(Q.gv.vr.ump(Q.onVRControllerChange,Q),Q._vrRayPolyline){var X=Q.gv.dm();X.remove(Q._vrRayPolyline),X.remove(Q._vrRayHitPoint),Q._vrRayPolyline=n,Q._vrRayHitPoint=n}},onVRControllerChange:function(B){var E=this,D=B.property,n=B.newValue,h=E.gv.vr.getController(n.id),I=h.getRay();I&&("gamepad.button.trigger"===D?"down"===n._62O?E.handle_mousedown(I):E.handleWindowMouseUp(I):"gamepad.pose"===D&&(E.handle_mousemove(I),E.handleWindowMouseMove(I)))},drawVRRay:function(T,P,y){var m,C=this,M=C.gv,f=C._vrRayPolyline,p=!1;if(f)m=C._vrRayHitPoint;else{var u=M.dm();C._vrRayPolyline=f=new Y.Polyline,C._vrRayHitPoint=m=new Y.Node,m.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),m.setAnchor3d(.5,.5,.499);var G=.2/M.vr.measureOflength;m.s3(G,G,G),f.s("intersect",!1),m.s("intersect",!1),u.add(f),u.add(m),p=!0}if(P){var r=y.world,F=y.worldNormal,w=r.x,t=r.y,j=r.z;f.s("shape.border.color","red"),f.setPoints([{x:T.origin.x,y:T.origin.z,e:T.origin.y},{x:w,y:j,e:t}]),m.s("3d.visible",!0),m.p3(w,t,j),m.lookAtDirection([F.x,F.y,F.z],"front")}else{f.s("shape.border.color","blue");var h=new Y.Math.Vector3;h.copy(T.direction).setLength(1e3/C.gv.vr.measureOflength).add(T.origin),f.setPoints([{x:T.origin.x,y:T.origin.z,e:T.origin.y},{x:h.x,y:h.z,e:h.y}]),m.s("3d.visible",!1)}M.fi({kind:"vrRayIntersect",ray:T,data:P,intersect:y,polyline:f,hitNode:m,begin:p})},setPreventEventDefault:function(g,N){var i=this,R=i._eventListeners[g];R?R._prevent=N:i._eventListeners[g]=R={_removal:n,_prevent:N}},removeListener:function(_){var V=this,c=V._eventListeners[_];c&&c._removal&&(c._removal(),c._removal=n)},addListener:function(J){var z=this,G=z._eventListeners[J];if(G||(z._eventListeners[J]=G={_removal:n,_prevent:!0}),!G||!G._removal){var U=function(f){G._prevent&&j.preventDefault(f),z.disabled||("wheel"===J?Om(z,f):z["handle_"+J](f))};q(z.gv.getView(),J,U),G._removal=function(){X(z.gv.getView(),J,U)}}},handleWindowTouchMove:function(H){this.handleWindowMouseMove(H)},handleWindowMouseMove:function(l){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",l):(this.handleDownInfo("onBeginDrag",l),this.isDragging=!0))},handleWindowTouchEnd:function(u){this.handleWindowMouseUp(u)},handleWindowMouseUp:function(l){if(this.isDragging&&(this.handleDownInfo("onEndDrag",l),this.isDragging=!1),this.downInfo){var Y=this.handle("onUp",l);if(Y&&Y.data===this.downInfo.data){this.handleMissingUp(l);var b=this,B=2===l.button?"onContextMenu":"onClick";if(!b._dbclickTimer)return b._dbclickTimer=T(function(){delete b._dbclickTimer,b.handleClick(l,B,Y),this.downInfo=O},j.clickDelay),void 0;r(b._dbclickTimer),delete b._dbclickTimer,B="onDoubleClick",b.handleClick(l,B,Y)}else this.handleDownInfo("onUp",l);this.downInfo=O}},handle_mouseleave:function(e){var I=this,o=I.gv,S=I.currentInfo?I.currentInfo.data:O;if(S){S.s("onLeave")&&S.s("onLeave")(e,S,o),I.fire("data","onLeave",e,S);var E=I.currentInfo?I.currentInfo.hits:O;if(E)for(var x in E)I.handleLeave(e,x);I.currentInfo=O}},handle_mousewheel:function(Z){Z.scrollDelta=Z.wheelDelta/40,this.handle("onScroll",Z)},handle_DOMMouseScroll:function(n){n.scrollDelta=2===n.axis?-n.detail:0,this.handle("onScroll",n)},handle_touchstart:function(d){this.handle_mousedown(d)},handle_touchmove:function(v){this.handle("onMove",v)},handle_mousedown:function(G){this.isDragging&&(this.handleDownInfo("onEndDrag",G),this.isDragging=!1),this.downInfo=this.handle("onDown",G),this.downInfo&&ul(this,G)},handle_mousemove:function(h){var N=this,l=N.gv;N._hoverTimer&&(r(N._hoverTimer),delete N._hoverTimer);var m,K,d,n=N.handle("onMove",h),o=this.currentInfo?this.currentInfo.data:O,E=this.currentInfo?this.currentInfo.hits:O;if(n&&(K=n.data,d=n.hits,N._hoverTimer=T(function(){r(N._hoverTimer),delete N._hoverTimer,N.handle("onHover",h,n)},l.getHoverDelay()||j.hoverDelay)),K!==o){if(o&&(o.s("onLeave")&&o.s("onLeave")(h,o,l),this.fire("data","onLeave",h,o)),K&&(K.s("onEnter")&&K.s("onEnter")(h,K,l),this.fire("data","onEnter",h,K)),E)for(m in E)this.handleLeave(h,m);if(d)for(m in d){var P=d[m],x=K._interactPrefix=P.prefix,X=x&&K.a(x+"onEnter")||P.target.onEnter;X&&X.call(P.target,h,K,l,P.point,P.width,P.height),this.fire(P.type,"onEnter",P.event,P.data,P.image,P.comp,P.point,P),K._interactPrefix=null}}else{if(E)for(m in E)d&&d[m]||this.handleLeave(h,m);if(d)for(m in d)if(!E||!E[m]){var P=d[m],x=K._interactPrefix=P.prefix,X=x&&K.a(x+"onEnter")||P.target.onEnter;X&&X.call(P.target,h,K,l,P.point,P.width,P.height),this.fire(P.type,"onEnter",P.event,P.data,P.image,P.comp,P.point,P),K._interactPrefix=null}}this.currentInfo=n},handle:function(l,B,x){var I,Q=this,o=Q.gv;if(Q._is2d){if(x=x||o.getDataInfoAt(B),!x||!o.isInteractive(x.data))return;if(I=x.ui.interactiveInfo){var G,D=x.data;if(D.s(l)&&D.s(l)(B,D,o),this.fire("data",l,B,D),"body"===x.part&&I.bodyInfo)G="body",x.hits=this.handleImage(G,o.getImage(D),l,B,D,x.point,I.bodyInfo);else if("icons"===x.part&&I._38o){var j=I._38o[x.name];j&&j[x.index]&&(G="icons|"+x.name+"|"+x.index,x.hits=this.handleImage(G,x.icon,l,B,D,x.point,j[x.index]))}}return x}var D,Z;if(!x)if(B&&B instanceof Y.Math.Ray){var W=o.vr.intersectWorld(B);if(D=W.data,Z=W.intersect,Q.drawVRRay(B,D,Z),!D)return;var u=o.getData3dUI(D);if(I=u.interactiveInfo,!I)return;x={data:D,part:Z.part,ui:u}}else{if(x=o.getDataInfoAt(B),!x)return;x&&(x={data:x.data,part:x.part})}if(o.isInteractive(x.data)){if(!Z){D=x.data;var u=o.getData3dUI(D);if(x.ui=u,I=u.interactiveInfo,!I)return x;if(Z=o.intersectObject(B,D),!Z)return}D.s(l)&&D.s(l)(B,D,o),this.fire("data",l,B,D);var m,H=Z.part;return"body"!==H&&(m=D.s(H+".image")||D.s("shape3d."+H+".image")),m||(m=D.s("all.image")||D.s("shape3d.image")),I="object"==typeof m?I[m.uuid]:I[m],I&&I.bodyInfo?(x.part="body",x.interactiveInfo=I,x.point=this._convertUVToPoint(Z.uv,I),x.image=m,x.hits=this.handleImage("body",m,l,B,D,x.point,I.bodyInfo),x):x}},_handleLeaveOrMissing:function(B,b,v){var w="leave"===B?this.currentInfo:this.downInfo;if(w){var E=w.interactiveInfo||w.ui.interactiveInfo;if(E){var c,e,l=w.data;if(this._is2d){if(e=this.gv.lp(b),"body"===w.part&&E.bodyInfo)c="body","leave"===B?this.handleLeaveImage(v,c,this.gv.getImage(l),b,l,e,E.bodyInfo):this.handleMissingUpImage(c,this.gv.getImage(l),b,l,e,E.bodyInfo);else if("icons"===w.part&&E._38o){var F=E._38o[w.name];F&&F[w.index]&&(c="icons|"+w.name+"|"+w.index,"leave"===B?this.handleLeaveImage(v,c,w.icon,b,l,e,F[w.index]):this.handleMissingUpImage(c,w.icon,b,l,e,F[w.index]))}}else{if(!E.bodyInfo)return;var H=this.gv.intersectObject(b,l);e=H&&H.uv?this._convertUVToPoint(H.uv,E):{x:1/0,y:1/0},"leave"===B?this.handleLeaveImage(v,"body",w.image,b,l,e,E.bodyInfo):this.handleMissingUpImage("body",w.image,b,l,e,E.bodyInfo)}}}},handleClick:function(p,s,J){var W=this,o=this.downInfo;if(o&&J){var C,G=J.interactiveInfo||J.ui.interactiveInfo,B=J.data,e=this.gv;if(B.s(s)&&B.s(s)(p,B,e),W.fire("data",s,p,B),G)if(this._is2d){if(o.part===J.part){var P=e.lp(p);"body"===J.part&&G.bodyInfo&&(C="body",this.handleClickImage(C,e.getImage(B),s,p,B,P,G.bodyInfo,J))}}else{if(!G.bodyInfo)return;var r=e.intersectObject(p,B);if(!r)return;P=this._convertUVToPoint(r.uv,G),this.handleClickImage("body",o.image,s,p,B,P,G.bodyInfo,J)}}},handleDownInfo:function(c,i){if(this.downInfo){var Y=this.downInfo,E=this.gv,W=Y.interactiveInfo||Y.ui.interactiveInfo;if(W){var v,M=Y.data;if(M.s(c)&&M.s(c)(i,M,E),this.fire("data",c,i,M),this._is2d){var R=E.lp(i);if("body"===Y.part&&W.bodyInfo)v="body",this.handleDownInfoImage(v,E.getImage(M),c,i,M,R,W.bodyInfo);else if("icons"===Y.part&&W._38o){var D=W._38o[Y.name];D&&D[Y.index]&&(v="icons|"+Y.name+"|"+Y.index,this.handleDownInfoImage(v,Y.icon,c,i,M,R,D[Y.index]))}}else{if(!W.bodyInfo)return;var u=E.intersectObject(i,M);if(!u)return;R=this._convertUVToPoint(u.uv,W),this.handleDownInfoImage("body",Y.image,c,i,M,R,W.bodyInfo)}}}},fire:function(I,j,q,y,U,Q,R,s){this.gv.fi({kind:j,type:I,event:q,data:y,image:U,comp:Q,view:this.gv,point:R,width:s?s.width:n,height:s?s.height:n})},handleImage:function(R,L,v,Z,Q,I,A){var c={};if(L&&(L=co(L))){var N=this.gv,K=A.rect,J=this.convertPoint(I,A);J.inRect&&(L[v]&&L[v](Z,Q,N,J,K.width,K.height),this.fire("image",v,Z,Q,L,n,J,K),c[R+"|image"]={target:L,type:"image",image:L,data:Q,event:Z,point:J,width:K.width,height:K.height});for(var u=A.compInfos,U=L,E=u.length-1;E>=0;E--){var j=u[E],w=j.comp;if(J=this.convertPoint(I,j,U,w,N,Q),J.inRect){K=j.rect;var h=Q._interactPrefix=j.prefix,m=h&&Q.a(h+v)||w[v];m&&m.call(w,Z,Q,N,J,K.width,K.height),this.fire("comp",v,Z,Q,L,w,J,K),(L=K.image)&&(L[v]&&L[v](Z,Q,N,J,K.width,K.height),this.fire("image",v,Z,Q,L,n,J,K)),Q._interactPrefix=null,c[R+"|"+E]={target:w,type:"comp",comp:w,image:L,data:Q,event:Z,point:J,width:K.width,height:K.height,prefix:h},L&&(c[R+"|"+E+"|image"]={target:L,type:"image",image:L,data:Q,event:Z,point:J,width:K.width,height:K.height,prefix:h})}}}return c},handleLeave:function(v,I){return this._handleLeaveOrMissing("leave",v,I)},handleMissingUp:function(t){return this._handleLeaveOrMissing("missing",t)},handleLeaveImage:function(D,M,k,G,h,P,Q){if(k&&(k=co(k))){var B=this.gv,y=Q.rect,R=this.convertPoint(P,Q);D===M+"|image"&&(k.onLeave&&k.onLeave(G,h,B,R,y.width,y.height),this.fire("image","onLeave",G,h,k,n,R,y));for(var E=Q.compInfos,C=k,m=E.length-1;m>=0;m--){var J=E[m],z=J.comp;R=this.convertPoint(P,J,C,z,B,h),y=J.rect;var W=h._interactPrefix=J.prefix;if(D===M+"|"+m){var e=W&&h.a(W+"onLeave")||z.onLeave;e&&e.call(z,G,h,B,R,y.width,y.height),this.fire("comp","onLeave",G,h,k,z,R,y)}(k=y.image)&&D===M+"|"+m+"|image"&&(k.onLeave&&k.onLeave(G,h,B,R,y.width,y.height),this.fire("image","onLeave",G,h,k,n,R,y)),h._interactPrefix=null}}},handleMissingUpImage:function(V,B,q,x,I,u){var c="onUp",d=this.downInfo.hits;if(d&&B&&(B=co(B))){var h=this.gv,L=u.rect,D=this.convertPoint(I,u);!D.inRect&&d[V+"|image"]&&(B[c]&&B[c](q,x,h,D,L.width,L.height),this.fire("image",c,q,x,B,n,D,L));for(var S=u.compInfos,m=B,X=S.length-1;X>=0;X--){var j=S[X],k=j.comp;if(D=this.convertPoint(I,j,m,k,h,x),!D.inRect){L=j.rect;var o=x._interactPrefix=j.prefix;if(d[V+"|"+X]){var g=o&&x.a(o+c)||k[c];g&&g.call(k,q,x,h,D,L.width,L.height),this.fire("comp",c,q,x,B,k,D,L)}(B=L.image)&&d[V+"|"+X+"|image"]&&(B[c]&&B[c](q,x,h,D,L.width,L.height),this.fire("image",c,q,x,B,n,D,L)),x._interactPrefix=null}}}},handleDownInfoImage:function(E,G,z,$,h,t,O){var i=this.downInfo.hits;if(i&&G&&(G=co(G))){var T=this.gv,j=O.rect,C=this.convertPoint(t,O);i[E+"|image"]&&(G[z]&&G[z]($,h,T,C,j.width,j.height),this.fire("image",z,$,h,G,n,C,j));for(var X=O.compInfos,F=G,k=X.length-1;k>=0;k--){var Y=X[k],u=Y.comp;C=this.convertPoint(t,Y,F,u,T,h),j=Y.rect;
var W=h._interactPrefix=Y.prefix;if(i[E+"|"+k]){var V=W&&h.a(W+z)||u[z];V&&V.call(u,$,h,T,C,j.width,j.height),this.fire("comp",z,$,h,G,u,C,j)}(G=j.image)&&i[E+"|"+k+"|image"]&&(G[z]&&G[z]($,h,T,C,j.width,j.height),this.fire("image",z,$,h,G,n,C,j)),h._interactPrefix=null}}},handleClickImage:function(H,G,W,c,R,w,Z,C){var I=this.downInfo.hits,D=C.hits;if(I&&G&&(G=co(G))){var X=this.gv,J=Z.rect,f=this.convertPoint(w,Z);I[H+"|image"]&&(G[W]&&G[W](c,R,X,f,J.width,J.height),this.fire("image",W,c,R,G,n,f,J));for(var o=Z.compInfos,j=G,b=o.length-1;b>=0;b--){var N=o[b],V=N.comp;f=this.convertPoint(w,N,j,V,X,R),J=N.rect;var t=R._interactPrefix=N.prefix;if(I[H+"|"+b]&&D[H+"|"+b]){var S=t&&R.a(t+W)||V[W];S&&S.call(V,c,R,X,f,J.width,J.height),this.fire("comp",W,c,R,G,V,f,J)}(G=J.image)&&I[H+"|"+b+"|image"]&&(G[W]&&G[W](c,R,X,f,J.width,J.height),this.fire("image",W,c,R,G,n,f,J)),R._interactPrefix=null}}},initImageResource:function(){j.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(u,s){if(!u)return{x:1/0,y:1/0};var W=s.bodyInfo.rect,L=u.clone(),D=u.multiply({x:W.width,y:W.height});return D.local=L,D},convertPoint:function(M,D,i,u,g,o){var L=D.rect,Q=D.matrix.applyInverse(M).sub(L),H=Q.x>=0&&Q.y>=0&&Q.x<=L.width&&Q.y<=L.height;if(!H)return Q;if(u&&lc(u.pixelPerfect,o,g)){var L,R=1;this._is2d?(R=g.getZoom(),L=Vp(M.x,M.y,n,R)):L=Vp(M.x,M.y);var q=!1,E=L.x,f=L.y,l=L.width,t=L.height,r=j.hitMaxArea,b=l*t*R*R;if(b>r){var G=Math.sqrt(r/b);R*=G}l*=R,t*=R,2>l&&(l=2),2>t&&(t=2),E*=R,f*=R;var C=$h(l,t),J=new Hm(0,-E,-f,R,R);J.append(D.matrix),g._drawForChecking=!0,u.transform=J,D.refRect&&D.refRect.fitSize&&(u.refRect=D.refRect);var W=i.comps;i.comps=[u],vf(C,i,0,0,l,t,o,self),i.comps=W,delete u.refRect,delete u.transform,g._drawForChecking=!1;try{for(var $=0,T=C.getImageData(0,0,l,t).data;$<T.length;$+=4)if(0!==T[$+3]){q=!0;break}C.restore()}catch(K){Ie=O,q=!1}Q.inRect=q}else Q.inRect=!0;return Q}});var un=km.DefaultInteractor=function(C){Ck(un,this,[C])};wp("DefaultInteractor",Xb,{handle_mousedown:function(z){zh(z);var T=this,x=T.gv,M=x.getDataAt(z);if(x.setFocus(z)&&!x._editing&&!x._scrolling){vl(z)?x.handleDoubleClick(z,M):x.handleClick(z,M);var S=Bq(z);!ym()&&!S&&M&&(x.isMovable(M)||x._39Q(M))||!x.isPannable()||!mg(z)&&!S||_e(z)||(T._tx=x.tx(),T._ty=x.ty(),T.startDragging(z))}},handleWindowMouseUp:function(Q){var R=this,u=R.gv;u._panning&&(delete u._panning,u.onPanEnded(),R.fi({kind:"endPan",event:Q})),delete R._tx,delete R._ty,R.clearDragging()},handle_mousemove:function(L){var g=this,e=g.gv;g._hoverTimer&&(r(g._hoverTimer),delete g._hoverTimer),g._hoverTimer=T(function(){g.fi({kind:"hover",event:L}),r(g._hoverTimer),delete g._hoverTimer},e.getHoverDelay()||j.hoverDelay)},handle_touchmove:function($){this.handle_mousemove($)},handleWindowMouseMove:function(d){var P=this,J=P.gv;P.fi({kind:J._panning?"betweenPan":"beginPan",event:d}),J._panning=1;var H=xf(J,d,P._lastClientPoint);J.setTranslate(P._tx+H.x,P._ty+H.y)},handle_mousewheel:function(S){this.gv.handleScroll(S,S.wheelDelta)},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)}});var Ge=km.SelectInteractor=function(T){Ck(Ge,this,[T])};wp("SelectInteractor",Xb,{_42:function(){var h=this,P=h.gv,M=P.getZoom(),x=h.mark,j=h.div;j||(j=h.div=Tj(),cr(h.getView(),j));var Z={};Z.x=x.x*M+P.tx(),Z.y=x.y*M+P.ty(),Z.width=x.width*M,Z.height=x.height*M,dg(j,Z),this.intersects()?(j.style.border="",j.style.background=P.getRectSelectBackground()):(j.style.background="",j.style.border="1px solid "+P.getRectSelectBorderColor())},handle_mousedown:function(q){var E=this,u=E.gv;if(E._57I=O,E.pendingClickThrough=O,!(u._editing||u._scrolling||ym()||Bq(q))){var l=u.getDataAt(q),i=u.sm();l?_e(q)?i.co(l)?i.rs(l):i.as(l):i.co(l)?l instanceof nk&&l.isClickThroughEnabled()&&mg(q)&&(E.pendingClickThrough=up(q)):i.ss(l):_e(q)||!u.isPannable()?mg(q)&&(_e(q)||i.cs(),u.isRectSelectable()&&(E.startDragging(q),u._77O=1)):mg(q)&&(E._57I=up(q))}},handle_mouseup:function(H){var L=this,Z=L.gv,a=L._57I;if(a&&(rs(a,up(H))<=1&&Z.sm().cs(),L._57I=O),L.pendingClickThrough){if(rs(L.pendingClickThrough,up(H))<=1){var A=Z.getDataAt(H);if(A instanceof nk&&A.isClickThroughEnabled()){var S=Z.getDataAt(H,function(Q){var V=Q.getParent()===A&&Z.isSelectable(Q,!0);return V});S&&(H.clickThrough=!0,Z.sm().ss(S))}}L.pendingClickThrough=O}},handleWindowMouseUp:function(d){this.clear(d)},handleWindowMouseMove:function(o){var M=this,v=M.gv;M._logicalPoint=v.lp(o),M.mark?(M.fi({kind:"betweenRectSelect",event:o}),v.isPannable()&&M.autoScroll(o),M.redraw()):M.fi({kind:"beginRectSelect",event:o}),M.mark=pr(M._lastLogicalPoint,M._logicalPoint),M.redraw()},intersects:function(){var f=this,z=f._lastLogicalPoint,h=f._logicalPoint;return z.x>h.x||z.y>h.y},clear:function(A){var a=this,M=a.gv,Q=a.mark;if(a._57I=O,a.pendingClickThrough=O,a._lastLogicalPoint){if(Q){if(0!==Q.width&&0!==Q.height){var s=M.getDatasInRect(Q,a.intersects());if(!s.isEmpty()){var i=M.sm(),w=i.toSelection();s.each(function(M){i.co(M)?w.remove(M):w.add(M)}),i.ss(w)}}go(a.div),delete a.div,delete a.mark,a.redraw(),a.fi({kind:"endRectSelect",event:A}),M.onRectSelectEnded()}a.clearDragging(),delete M._77O}},redraw:function(){var g=this;g._draw||(g._draw=1,T(function(){g.mark&&g._42(),delete g._draw},16))}});var Hj=km.MoveInteractor=function(e){Ck(Hj,this,[e])};wp("MoveInteractor",Xb,{handle_mousedown:function(d){var o=this,Y=o.gv;if(mg(d)&&!Y._editing&&!Y._scrolling&&!ym()){var R=Y.getSelectedDataAt(d);!R||Y._39Q(R)&&!Y.isMovable(R)?Y._focusData=O:(o._data=R,Y.handleMouseDown&&Y.handleMouseDown(d,R),o.startDragging(d),Y.isMovable(R)&&(Y._moving=1))}},handleWindowMouseUp:function(s){var p=this,q=p.gv;q.handleMouseUp&&q.handleMouseUp(s,p._data),p.clear(s)},handleWindowMouseMove:function(J){var u=this,s=u._data,I=u.gv;if((!I._93O||!I._93O(J,s))&&I._moving){u._logicalPoint||u.fi({kind:"prepareMove",event:J});var S=u._logicalPoint?"betweenMove":"beginMove",H={kind:S,event:J},Q=u._logicalPoint=I.lp(J);"beginMove"!==S||u._alreadyBeginTransaction||(u._alreadyBeginTransaction=!0,I.getDataModel().beginTransaction());var A=u._calcShift(S,J),m=A.x,B=A.y,g=u.gv.getMoveMode(J,s);g&&("x"===g?B=0:"y"===g?m=0:"xy"!==g&&(m=B=0)),I.moveSelection(m,B),u._lastLogicalPoint=Q,u.autoScroll(J),u.fi(H)}},_calcShift:function(){var g=this,H=g._logicalPoint,T=g._lastLogicalPoint,L=H.x-T.x,r=H.y-T.y;return{x:L,y:r}},clear:function(s){var d=this,A=d.gv;d._lastLogicalPoint&&(d._lastLogicalPoint=d._data=A._moving=O,d._logicalPoint&&(d.fi({kind:"endMove",event:s}),A.onMoveEnded()),d.clearDragging()),d._alreadyBeginTransaction&&(d._alreadyBeginTransaction=!1,A.getDataModel().endTransaction())}});var Pn=km.TextEditInteractor=function(b){Ck(Pn,this,[b]),this.init()};wp("TextEditInteractor",Xb,{init:function(){var i=this,w=this.input=d.createElement("input"),g=w.style;w.text="text",g.border="1px solid #d8d8d8",g.position="absolute",g.padding="2px 3px",g.outline="none",g.marginLeft="-90px",g.marginTop="-16px",g.backgroundColor="rgba(255,255,255, 0.9)",g.fontSize="14px",g.width="180px",g.height="32px",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.textAlign="center",g.boxSizing="border-box",q(w,"keyup",function(N){Vm(N)&&i.endTextEdit()}),q(w,"focus",function(){w.select()});var r=this.textarea=d.createElement("textarea"),G=this.wrap=d.createElement("div");G.appendChild(r),g=r.style,g.margin=0,g.padding="4px",g.overflow="hidden",g.boxSizing="border-box",g.position="absolute",g.outline="none",g.backgroundColor="transparent",g.resize="none",g.textAlign="center",g.fontSize="14px",g.border="none",g.borderWidth=0,g.width="100%",g.top="50%",g=G.style,g.boxSizing="border-box",g.margin=0,g.padding=0,g.position="absolute",g.boxShadow="0 0 13px rgba(16,142,233, 0.5)",g.border="1px solid #d8d8d8",g.backgroundColor="rgba(255,255,255, 0.9)",g.width="180px",g.marginLeft="-90px",q(r,"keydown",function(b){return(Hc()||_e())&&Vm(b)?(i.endTextEdit(),void 0):(i.calculateTextareaHeight(String.fromCharCode(b.keyCode)),void 0)}),q(r,"focus",function(){r.select()});var x=function(t){t.stopPropagation()};q(w,"mousedown",x),q(w,"touchstart",x),q(r,"mousedown",x),q(r,"touchstart",x),i.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],i.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",i.handleWindowClick=function(E){var g=i._editingDOM;if(g){var J=g.getBoundingClientRect(),B=up(E);Mg(J,B)||i.endTextEdit()}}},handle_mousedown:function(l){var m=this,F=m.gv;if(vl(l)&&!F._editing){var Z=F.getDataAt(l);if(Z){var P=F.getTextEditInfo(Z);P&&(this._editInfo=P,this._editTarget=Z,F._editing=!0,P.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var J=this,y=J.gv,u=J._editTarget,$=J.getTargetValue(),H=J.textarea,Y=J.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===$||$===n)&&($=""),H.value=$,J._editingDOM=H,y.getView().appendChild(Y),this.layoutHTML(Y,u),this.calculateTextareaHeight(),T(function(){H.focus(),q(m,"mousedown",J.handleWindowClick),q(m,"touchstart",J.handleWindowClick)},10)},handleTextEdit:function(){var d=this,W=d.gv,v=d._editTarget,b=d.getTargetValue(),Z=d.input;(null===b||b===n)&&(b=""),Z.value=b,d._editingDOM=Z,W.getView().appendChild(Z),this.layoutHTML(Z,v),T(function(){Z.focus(),q(m,"mousedown",d.handleWindowClick),q(m,"touchstart",d.handleWindowClick)},10)},layoutHTML:function(p,D){var _=this.gv,O=_.getZoom();if(D instanceof Y.Node){var W=D.getRect();p.style.left=(W.x+W.width/2)*O+_.tx()+"px",p.style.top=(W.y+W.height/2)*O+_.ty()+"px"}else if(D instanceof Y.Edge){var R=_.getDataUI(D),W=R._6I;p.style.left=(W.x+W.width/2)*O+_.tx()+"px",p.style.top=(W.y+W.height/2)*O+_.ty()+"px"}},endTextEdit:function(){var t=this,Z=t._editInfo.isMultiline?t.wrap:t.input,v=t._editInfo.isMultiline?t.textarea:t.input;t.setTargetValue(v.value),t.gv.getView().removeChild(Z),t.gv._editing=!1,delete t._editingDOM,X(m,"mousedown",t.handlelick),X(m,"touchstart",t.handleWindowClick)},setTargetValue:function(E){var G=this,n=G._editTarget,A=G._editInfo,b=A.accessType,C=A.name;if(C&&b||(b="p",C="name"),"p"===b){var f=Y.Default.setter(C);n[f](E)}else"a"===b?n.a(C,E):n.s(C,E)},getTargetValue:function(){var p=this,s=p._editTarget,F=p._editInfo,W=F.accessType,Z=F.name;if(Z&&W||(W="p",Z="name"),"p"===W){var N=Y.Default.getter(Z);return s[N]()}return"a"===W?s.a(Z):s.s(Z)},createHiddenTextarea:function(){this.hiddenTextarea=d.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(h,B){if(B&&this.computedStyleCache)return this.computedStyleCache;var g=this,U=m.getComputedStyle(h),o=U.getPropertyValue("box-sizing")||U.getPropertyValue("-moz-box-sizing")||U.getPropertyValue("-webkit-box-sizing"),A=parseFloat(U.getPropertyValue("padding-bottom"))+parseFloat(U.getPropertyValue("padding-top")),y=parseFloat(U.getPropertyValue("border-bottom-width"))+parseFloat(U.getPropertyValue("border-top-width")),Y=g.SIZING_STYLE.map(function(J){return J+":"+U.getPropertyValue(J)}).join(";"),u={sizingStyle:Y,paddingSize:A,borderSize:y,boxSizing:o};return B&&(this.computedStyleCache=u),u},calculateTextareaHeight:function(q){q=q||"";var H=this,e=H.textarea,P=H.hiddenTextarea,V=H.wrap,W=32,s=H.calculateHTMLStyle(e,!1),B=s.paddingSize,h=s.borderSize,X=s.boxSizing,T=s.sizingStyle;P.setAttribute("style",T+";"+H.HIDDEN_TEXTAREA_STYLE),P.value=e.value+q;var Z=P.scrollHeight;"border-box"===X?Z+=h:"content-box"===X&&(Z-=B),e.style.height=Z+"px",e.style.marginTop=0-.5*Z+"px",V.style.height=Math.max(Z,W)+"px",V.style.marginTop=Z*-.5+"px"}});var tp=km.ScrollBarInteractor=function(d){Ck(tp,this,[d])};wp("ScrollBarInteractor",Xb,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(o){var U=this.gv.getViewRect();return this._41o()&&(U.x+U.width-this.gv.lp(o).x)*this.gv.getZoom()<ah},isH:function(v){var B=this.gv.getViewRect();return this._40o()&&(B.y+B.height-this.gv.lp(v).y)*this.gv.getZoom()<ah},handle_mousemove:function(O){this.handle_touchmove(O)},handle_touchmove:function(n){if(!_q&&mg(n)&&this.gv.isScrollBarVisible()){var r=this,d=r.isV(n),l=r.isH(n);(d||l)&&r.gv.showScrollBar(),r.gv._scrolling=d||l}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(l){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=O,this.fi({kind:"endScroll",event:l})},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(B){var $=this;if($.gv.setFocus(B),zh(B),$.handle_touchmove(B),!(Am(B)>1)&&$.gv._scrolling&&$.gv.isScrollBarVisible()){$._cp=up(B),$._tx=$.gv.tx(),$._ty=$.gv.ty();var s=$.isV(B);$._state=s?"vScroll":"hScroll",Bi($,B),$.fi({kind:"beginScroll",event:B})}},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(N){var F=up(N),e=this.gv.getViewRect(),q=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-F.y)*q.height/e.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-F.x)*q.width/e.width),this.fi({kind:"betweenScroll",event:N})}});var Dj=km.TouchInteractor=function(Z,S){S=S||{},S.selectable===n&&(S.selectable=!0),S.movable===n&&(S.movable=!0),S.pannable===n&&(S.pannable=!0),S.pinchable===n&&(S.pinchable=!0),S.editable===n&&(S.editable=!0),this.params=S,Ck(Dj,this,[Z])};wp("TouchInteractor",Xb,{ms_edit:1,setUp:function(){var B=this;Dj.superClass.setUp.call(B),Lr&&B.params.editable&&B.gv.setEditInteractor(B)},tearDown:function(){var r=this;Dj.superClass.tearDown.call(r),Lr&&r.params.editable&&r.gv.setEditInteractor(O)},clear:function(t){var v=this,W=v.gv;W._moving&&(v.fi({kind:"endMove",event:t}),delete W._moving,W.onMoveEnded(),W.dm().endTransaction()),W._panning&&(v.fi({kind:"endPan",event:t}),delete W._panning,W.onPanEnded()),W._pinching&&(v.fi({kind:"endPinch",event:t}),delete W._pinching,W.onPinchEnded()),W._editing&&(v._46O(t),v._77I=v._node=v._edge=v._shape=v._rect=v._89I=v._index=W._editing=O),v.pendingClickThrough=v._moving=v._panning=v._pinching=v._editing=v._57I=v._data=v._beginHistory=O,v.clearDragging()},handle_touchstart:function(e){var i=this;if(!i.gv._editing){zh(e),i._57I=O,i.pendingClickThrough=O;var a=i.params,t=i.gv,M=t.sm(),I=t.getDataAt(e),E=Am(e);if(1===E){if(vl(e))return t.handleDoubleClick(e,I),void 0;t.handleClick(e,I),I&&(t.handleMouseDown&&t.handleMouseDown(e,I),i._data=I),a.selectable||(I=O),I&&(M.co(I)?I instanceof nk&&I.isClickThroughEnabled()&&(i.pendingClickThrough=up(e)):M.ss(I),a.editable&&t.isEditable(I)&&i._79I(e,I,!0)?(i._editing=1,i.startDragging(e)):a.movable&&t.isMovable(I)&&(i._moving=1,i.startDragging(e))),I&&t.isMovable(I)||(i._57I=up(e),a.pannable&&t.isPannable()&&(i._panning=1,i.startDragging(e),i._translate={x:t.tx(),y:t.ty()}))}else if(a.pinchable&&2===E){if(I&&t._39Q(I))return;i._pinching=1,i.startDragging(e);var x=t.getView(),T=t.getZoom(),L=x.getBoundingClientRect(),N=e.touches[0],Q=e.touches[1],Y={x:(N.clientX+Q.clientX)/2-L.left,y:(N.clientY+Q.clientY)/2-L.top};Y.x-=t.tx(),Y.y-=t.ty(),Y.x/=T,Y.y/=T,i._p=Y,i._d=Im(e)}}},handle_touchend:function(u){var m=this,g=m.gv,P=m._57I,Z=m._data;if(P&&(rs(P,up(u))<=1&&!g.getDataAt(u)&&g.sm().cs(),m._57I=O),Z&&g.handleMouseUp&&g.handleMouseUp(u,Z),m.pendingClickThrough){if(rs(m.pendingClickThrough,up(u))<=1){var Z=g.getDataAt(u);if(Z instanceof nk&&Z.isClickThroughEnabled()){var R=g.getDataAt(u,function(m){var o=m.getParent()===Z&&g.isSelectable(m,!0);return o});R&&(u.clickThrough=!0,g.sm().ss(R))}}m.pendingClickThrough=O}},handleWindowTouchEnd:function(k){this.clear(k)},handleWindowTouchMove:function(l){var N=this,_=N.gv,S=Am(l);if(1===S){var g=up(l),C=xf(_,g,N._lastClientPoint),U=rs({x:0,y:0},C);if(N._editing&&(N._beginHistory||(N._beginHistory=1,_.dm().beginTransaction()),_._editing=1,N._78I(l)),N._moving){if(!_._moving&&U<j.touchMoveThreshold)return;N._beginHistory||(N._beginHistory=1,_.dm().beginTransaction()),N.handleMove(l)}else if(N._panning){if(!_._panning&&U<j.touchMoveThreshold)return;_.setTranslate(N._translate.x+C.x,N._translate.y+C.y),N.fi({kind:_._panning?"betweenPan":"beginPan",event:l}),_._panning=1}}else if(2===S&&N._pinching){var H=Im(l);_.handlePinch(N._p,H,N._d),N._d=H,N.fi({kind:_._pinching?"betweenPinch":"beginPinch",event:l}),_._pinching=1}},handleMove:function(h){var e=this,U=e.gv,Y=U.lp(h);U._93O&&U._93O(h,e._data)||(U.moveSelection(Y.x-e._lastLogicalPoint.x,Y.y-e._lastLogicalPoint.y),e._lastLogicalPoint=Y,e.autoScroll(h),e.fi({kind:U._moving?"betweenMove":"beginMove",event:h}),U._moving=1)}});var Y=m.ht,mn=Y.graph._editor={Math:Y.Math,Guide:{}};mn.getStyle=function(c){var q,g=mn.StyleMap;return g&&(q=g[c],q!==n)?q:mn.DefaultStyleMap[c]},mn.setStyle=function(E,N){var z=mn.StyleMap;z||(z=mn.StyleMap={}),z[E]=N},mn.inEdit=function(v){return v._inXEdit===!0},mn.startEdit=function(e){e._inXEdit=!0,mn.Inject.doInject(e)},mn._46O=function(L){L._inXEdit=!1,mn.Inject.undoInject(L)},mn.toScreenPosition=function(W,p){var U=W.tx(),n=W.ty(),m=W._zoom;return new mn.Math.Vector2(p.x*m+U,p.y*m+n)},mn.checkHit=function(D,U,c){return D.distanceTo(U)<c?!0:!1},mn.toWorldPosition=function($,e){var S=$.tx(),x=$.ty(),g=$._zoom;return{x:(e.x-S)/g,y:(e.y-x)/g}},mn.setAntialias=function(J,R){for(var h,A=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],f=0,N=A.length;N>f&&(h=A[f],!(h in J));f++);J[h],J[h]=R},mn.getTargetCornersOnScreen=function(C,Y){if(!Y)return null;var n,F=[];if(Yn(Y,C)){var x=Hq(C,Y);n=[{x:x.x,y:x.y},{x:x.x+x.width,y:x.y},{x:x.x+x.width,y:x.y+x.height},{x:x.x,y:x.y+x.height}]}else{if(!Y.getCorners)return null;n=Y.getCorners()}return n.forEach(function(j){var T=mn.toScreenPosition(C,j);F.push(T.x,T.y)}),F},mn.log=function(){};var Qk=mn.Inject={_modules:[]};Qk.registAsModule=function($,p){var A={},c={};for(var N in $){var Z=p.prototype[N];A[N]=Z}$.getBackup=function(B){return A[B]},$.getBackups=function(){return A},c.doInject=function(){for(var B in $)"getBackup"!==B&&(p.prototype[B]=$[B])},c.undoInject=function(){for(var G in $)"getBackup"!==G&&(p.prototype[G]=A[G])},Qk._modules.push(c)},Qk.doInject=function(k){for(var C,w=Qk._modules,F=0,o=w.length;o>F;F++)C=w[F],C.doInject(k)},Qk.undoInject=function(c){for(var g,J=Qk._modules,r=0,$=J.length;$>r;r++)g=J[r],g.undoInject(c)};var Xb=Y.graph.EditInteractor=function(f){var t=this,B=d.createElement("canvas");B.className="editCanvas",B.style.position="absolute",t._styleMap={},t._canvas=B,t._context=B.getContext("2d"),Xb.superClass.constructor.call(t,f),this._editDetail=!1,mn.setAntialias(t._context,!1),t._subModules=[new mn.Anchor(t),new mn.RotateX(t),new mn.MoveDummy(t),new mn.Rect(t),new mn.Curve(t),new mn.MoveHelper(t)],t._gridGuide=new mn.Guide.Grid(t),t._rectGuide=new mn.Guide.Rect(t),t._hoverGuide=new mn.Guide.Hover(t)},dl=Xb;Y.Default.def(Xb,Y.graph.Interactor,{ms_edit:1,ms_fire:1}),L.defineProperties(Xb.prototype,{editDetail:{get:function(){var r=!!this._editDetail;return r},set:function(P){var n=this,S=n._editDetail;S!==P&&(n._editDetail=P,n.gv._editing=P,n.fp("editDetail",S,P),n.fp("pointsEditingMode",S,P),n.fi({kind:P?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(J){(!this._editDetail||J)&&(this.gv._editing=J,J||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(f){this._editing=f,this.gvEditing=f}},pointsEditingMode:{get:function(){return this.editDetail},set:function(C){var T=this;T.editDetail!==C&&(C?T._tryEnterEditDetailMode():T._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var q=this._gridEnabled;if(!q)return!1;var B=this.gv;return B?!0:!0},set:function(i){i!==this._gridEnabled&&(this._gridEnabled=i,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(d){d!==this._agEnabled&&(this._agEnabled=d,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Xb.prototype.getSubModule=function(E){var B,y,u,j=this._subModules;for(y=0,u=j.length;u>y;y++)if(B=j[y],B.catalog===E)return B},Xb.prototype.invokeSubModule=function(v,i){var $=this,f=$._subModules;if(f)for(var t,O,N,p=Array.prototype.slice.call(arguments,2),H=0,e=f.length;e>H;H++)if(t=f[H],O=t[v],O&&(N=O.apply(t,p),N!=n&&i))return t},Xb.prototype.invokeSubModuleInverse=function(B,l){var d=this,i=d._subModules;if(i)for(var O,$,H,J=Array.prototype.slice.call(arguments,2),j=i.length-1;j>=0;j--)if(O=i[j],$=O[B],$&&(H=$.apply(O,J),H!=n&&l))return O},Xb.prototype.setUp=function(){mn.log("setUp");var s=this,j=s.gv,R=j.getView(),d=s._canvas;Xb.superClass.setUp.call(s),j.setEditInteractor(s),j._79O?R.insertBefore(d,j._79O):R.appendChild(d),mn.startEdit(j),s.invokeSubModule("setUp"),j.dm().mm(s._onDataModelChanged,s),j.dm().md(s._onDataPropertyChanged,s)},Xb.prototype.tearDown=function(){mn.log("tearDown");var o=this,I=o.gv,G=I.getView();o._resetCustomCursorStyle(),Xb.superClass.tearDown.call(o),I.dm().umm(o._onDataModelChanged,o),I.dm().umd(o._onDataPropertyChanged,o),I.setEditInteractor(null),G.removeChild(o._canvas),o._drawTimer&&(r(o._drawTimer),o._drawTimer=null),mn._46O(I),o.invokeSubModule("tearDown")},Xb.prototype._onDataModelChanged=function(u){var C=this;("clear"===u.kind||"remove"===u.kind&&C.editDetail&&u.data===C.getSubModule("Curve").target)&&(C.editDetail=!1,C._42())},Xb.prototype._onDataPropertyChanged=function(W){var I=this;if(I.editDetail){var n=I.getSubModule("Curve"),D=W.data;D===n.target&&(D._writing||n._handleDataChanged(W))}},Xb.prototype.clear=function(){mn.log("clear")},Xb.prototype.redraw=function(){this._42()},Xb.prototype._42=function(){var r=this;r._drawTimer||(r._drawTimer=T(function(){r._drawTimer=null,r.drawImpl()},0))},Xb.prototype.drawImpl=function(){var N;for(N in{_42:!0})break;return function(){var E=this,_=E._canvas,Q=E.gv,F=Q.getWidth(),U=Q.getHeight(),k=E._context,D=Y.Default.getInternal(),z=m.devicePixelRatio;(_.width!==F||_.height!==U)&&D.setCanvas(_,F,U,z),k.clearRect(0,0,_.width,_.height);var g=E._getValidSelection();k.save(),k.scale(z,z),E._gridGuide._42(),E.invokeSubModuleInverse(N,!1,k,Q,g),E._rectGuide._42(),E._hoverGuide._42(),k.restore()}}(),Xb.prototype._getValidSelection=function(){var y=this,t=y.gv,a=t.sm().getSelection(),r=[];return a.each(function(h){t.isVisible(h)&&t.isEditable(h)&&r.push(h)}),r},Xb.prototype.handle_touchmove=function(N){return this.handle_mousemove(N)},Xb.prototype.handle_mousemove=function(r){if(!Y.Default.isDragging()){var O=this;if((O.editDetail||!ym()&&!Bq(r))&&!O.gv._externalEditing)if(O.gvEditing=!1,O._checkEdit(r))O.gvEditing=!0;else{if(!O.getStyle("hoverGuideVisible"))return;O.hoverData=O.gv.getDataAt(r),O._42()}}},Xb.prototype.handle_touchstart=function(M){return this.handle_mousedown(M)},Xb.prototype.handle_mousedown=function(D){zh(D);var m=this;if((m.editDetail||!ym()&&!Bq(D))&&!m.gv._externalEditing){if(vl(D)&&!D.clickThrough){if(m.editDetail){if(m._tryQuitEditDetailMode(D))return}else if(m._tryEnterEditDetailMode())return;m.gv.dm().beginTransaction();var J=m.invokeSubModule("handleDoubleClick",!0,D);if(m.gv.dm().endTransaction(),J)return}var K=m._checkEdit(D);K&&(m._downPosition=m._getLogicalPoint(D),m.gv.dm().beginTransaction(),K.startEdit(m,D),m.editing=!0)}},Xb.prototype._checkEdit=function(n){var I=this,C=I.gv,U=I._getLogicalPoint(n),V=I.invokeSubModule("check",!0,C,n,U)||null;return I._editMod=V,V},Xb.prototype.handleWindowTouchMove=function(p){return this.handleWindowMouseMove(p)},Xb.prototype.handleWindowMouseMove=function(O){var $=this,R=$._downPosition;if(R){var L=$._getLogicalPoint(O);if(L.distanceTo(R)<$.getStyle("moveSensitivity"))return;delete $._downPosition}var c=$._editMod;c&&c.handleEdit($.gv,O)},Xb.prototype._getLogicalPoint=function(Z){var A=this,I=Y.Default.getLogicalPoint(Z,A._canvas);return new mn.Math.Vector2(I)},Xb.prototype.handleWindowTouchEnd=function(D){return this.handleWindowMouseUp(D)},Xb.prototype.handleWindowMouseUp=function(){var F;for(F in{_46O:!0})break;return function(i){var T=this;T.editing=!1,T.setCursor("default"),T.invokeSubModule(F,!1,i),T._42(),T.gv.dm().endTransaction()}}(),Xb.prototype.handle_mousewheel=function(x){var l=this;zh(x),l.invokeSubModule("preHandleScroll",!0)||l.gv.handleScroll(x,x.wheelDelta)},Xb.prototype.handleDelete=function(){var T=this;if(!T.editDetail){T.gv.dm().beginTransaction();var K=T.invokeSubModule("handleNormalStateDelete",!0);return T.gv.dm().endTransaction(),K||T.gv.removeSelection(),void 0}T.gv.dm().beginTransaction(),T.invokeSubModule("handleDelete",!0),T.gv.dm().endTransaction(),T._42()},Xb.prototype.handle_keydown=function(J){var e=this;if((J.metaKey||J.ctrlKey)&&e._42(),ym(J)&&!e.editing)return e.gvEditing=!1,e.setCursor("default"),e._42(),void 0;var f=Vm(J);return e.editDetail?((f||Le(J))&&(e.editDetail=!1,e._42()),e.gv.dm().beginTransaction(),e.invokeSubModule("handle_keydown",!0,J),e.gv.dm().endTransaction(),void 0):(e.gv.dm().beginTransaction(),e.invokeSubModule("handleNormalStateKeyDown",!0,J),e.gv.dm().endTransaction(),f&&e._tryEnterEditDetailMode(),void 0)},Xb.prototype.handle_keyup=function(a){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,a),this.gv.dm().endTransaction()},Xb.prototype._tryEnterEditDetailMode=function(){var G=this;return!G.editDetail&&G.invokeSubModule("canEnterEditDetailMode",!0)&&1===G._getValidSelection().length?(G.editDetail=!0,G._42(),!0):void 0},Xb.prototype._tryQuitEditDetailMode=function(t){var w=this;return w.editDetail?!t||w.invokeSubModule("canQuitEditDetailMode",!0,t)?(w.editDetail=!1,w._42(),!0):!1:!1},Xb.prototype.setStyle=function(r,$,G){var S=this;G?mn.setStyle(r,$):S._styleMap[r]=$,"baseColor"===r&&(Rk=$),S.fp("styleChanged",null,{key:r,value:$,base:G}),S._42()},Xb.prototype.getStyle=function(H){var w=this,f=w._styleMap[H];return f!==n?f:mn.getStyle(H)},Xb.prototype.setCursor=function(E){this._resetCustomCursorStyle(),Y.graph.EditInteractor.superClass.setCursor.call(this,E)},Xb.prototype._drawHostGuide=function(I){var W=this,O=W._context,E=W.gv;mn.Icons.DrawIcon(W,O,mn.Icons.NodeHoverGuide,I.corners);var f=I.host;if(f){var l=E.getAttachPoints(f);if(l&&l.length)for(var q=0,P=l.length;P>q;q++){var s=l[q],c=xn(E,f,0,s.offsetX||0,s.offsetY||0,s.x,s.y);c=mn.toScreenPosition(E,c),c.isAttach=I.attach===q,mn.Icons.DrawIcon(W,O,mn.Icons.AttachPoint,c)}}},Xb.prototype._resetCustomCursorStyle=function(){var q=this;if(q._customStyle){var r=this.gv.getView();r.classList&&r.classList.remove&&r.classList.remove(q._customStyle),q._customStyle=null}},Xb.prototype._setRotateCursor=function(N){var B=this,r=B._cursorFactory;r||(r=B._cursorFactory=new mn.CursorFactory(B));var O=r.getRotateCursor(N),l=B.gv.getView();B._resetCustomCursorStyle(),B._customStyle=O,l.classList&&l.classList.add&&l.classList.add(O)};var nn=mn.Group=function(v){var u=this;u._entities=v,u._64O=0,u._position={x:0,y:0},u._scale={x:1,y:1},u._anchor={x:.5,y:.5},u._anchor2={x:.5,y:.5}};nn.prototype={},nn.prototype.constructor=nn;var Eg=null;nn.findOrCreateGroup=function(q){if(Eg&&Eg.checkIsMe(q))return Eg;var p=new mn.Group(q);return p.getKeyOb()?(Eg=p,p):void 0},nn.prototype.checkIsMe=function(r){var K=this._entities;if(K.length!==r.length)return!1;var $,W={},Q=r.length;for($=0;Q>$;$++)W[r[$]._id]=!0;for($=0;Q>$;$++)if(!W[K[$]._id])return!1;return!0},nn.prototype.getRotation=function(){return this._64O},nn.prototype.getPosition=function(){return this._position},nn.prototype.getAnchor=function(){return this._anchor},nn.prototype.getWidth=function(){return this._width},nn.prototype.getScale=function(){return this._scale},nn.prototype.getSize=function(){return{width:this._width,height:this._height}},nn.prototype.getHeight=function(){return this._height},nn.prototype.getKeyOb=function(){for(var B=this._entities,R=B.length-1;R>=0;R--){var w=B[R];if(this.isNode(w))return w}},nn.prototype.getAnchor2=function(){var Y=this,g=Y.rotateCenter;if(g)return g;var b=Y.getKeyOb();if(!b)return Y._anchor;var M=Y._anchor2,w=b.getMatrix();return w.tf({x:b.getWidth()*(M.x-b.getAnchor().x),y:b.getHeight()*(M.y-b.getAnchor().y)})},nn.prototype.setAnchor2=function(p,e){var H=this,f=H.getKeyOb();if(f){var O,Z=f.getMatrix();O="number"==typeof p?{x:p,y:e}:p;var c=Z.tfi(O);H._anchor2={x:f.getAnchor().x+c.x/f.getWidth(),y:f.getAnchor().y+c.y/f.getHeight()}}},nn.prototype.setRotation=function(){},nn.prototype.beginRotate=function(X){this.rotateCenter=X.pos,this.rotateMode=X.groupRotateMode},nn.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},nn.prototype.addRotation=function(D,r,L){return"batch"===r?this._addRotationInBatchMode(D,L):"block"===r?this._addRotationInBlockMode(D,L):void 0},nn.prototype._addRotationInBlockMode=function(D,s){var u=this,L=u.rotateCenter||u.getPosition();u._entities.forEach(function(O){if(u.isNode(O)&&(!s||s(O))){var Y=O.getMatrix();Y.translate(-L.x,-L.y),Y.rotate(D),Y.translate(L.x,L.y);var N=Math.sign(O.getScale().x);O.setRotation(E(Y.b*N,Y.a*N)),O.setPosition(Y.tx,Y.ty)}})},nn.prototype._addRotationInBatchMode=function(B,Q){var t=this,H=t._anchor2;t._entities.forEach(function(s){if(t.isNode(s)&&(!Q||Q(s))){var W=s.getAnchor(),f=s.getMatrix(),R=f.tf({x:s.getWidth()*(H.x-W.x),y:s.getHeight()*(H.y-W.y)}),x=new mn.Math.Matrix2d;x.set(f.a,f.b,f.c,f.d,f.tx,f.ty),x.translate(-R.x,-R.y),x.rotate(B),x.translate(R.x,R.y);var F=Math.sign(s.getScale().x);s.setRotation(E(x.b*F,x.a*F)),s.setPosition(x.tx,x.ty)}})},nn.prototype.setPosition=function(P){var a,w,u,z,k=this,o=k._position,n=P.x-o.x,x=P.y-o.y,A=k._entities;for(w=0,u=A.length;u>w;w++)a=A[w],De(a)&&(z=a.getPosition(),a.setPosition(z.x+n,z.y+x));k._position=P},nn.prototype.setScale=function(F,E){var V=this,o=F/V._scale.x,R=E/V._scale.y;V._adjustChildScaleOrSize(o,R,"size"),V._scale={x:F,y:E}},nn.prototype.getRect=function(){var t=this,I=t._position,d=t._width,f=t._height;return{x:I.x-d/2,y:I.y-f/2,width:d,height:f}},nn.prototype.setSize=function(A,_){var u=this,A=Math.max(1,A),_=Math.max(1,_),F=A/u._width,E=_/u._height;u._adjustChildScaleOrSize(F,E,"size"),u._width=A,u._height=_},nn.prototype._adjustChildScaleOrSize=function(j,A,a){var I,Q,P,v,p,X,d,g,K,h,W,k,D,V,Z=this,s=Z._position,y=Z._entities,G=new mn.Math.Matrix2d;for(Q=0,P=y.length;P>Q;Q++)if(I=y[Q],Z.isNode(I)){if(v=I.getPosition(),p=I.getRotation(),X=I.getWidth(),d=I.getHeight(),g=I.getScale(),W=g.x*X,k=g.y*d,G.identity().scale(W,k).rotate(p).translate(v.x,v.y).translate(-s.x,-s.y).rotate(-Z._64O),p=E(G.b*Math.sign(W),G.a*Math.sign(W)),G.scale(j,A),K=Math.cos(p),h=Math.sin(p),Math.abs(K)<.001?(D=G.b/h,V=-G.c/h):(D=G.a/K,V=G.d/K),"scale"===a)I.setScale(D/X,V/d);else if("size"===a){var u=D/g.x,x=V/g.y;I.setScale(uf(D)*Math.abs(g.x),uf(V)*Math.abs(g.y)),I.setSize(Math.max(.1,Math.abs(u)),Math.max(.1,Math.abs(x)))}G.rotate(Z._64O).translate(s.x,s.y),I.setPosition(G.tx,G.ty)}},nn.prototype.getMatrix=function(){var a=this,d=a._position,i=Y.Default.getInternal(),K=a._scale;return new i.Mat(a._64O,d.x,d.y,K.x,K.y)
},nn.prototype.toGlobal=function(f){return this.getMatrix().tf(f)},nn.prototype.getCorners=function(){var f=this,h=f._width,V=f._height,D=f._anchor,G=-h*D.x,B=-V*D.y,w=f.getMatrix();return[w.tf(G,B),w.tf(G,B+V),w.tf(G+h,B+V),w.tf(G+h,B)]},nn.prototype.calcInfo=function(){var m,O,C,i,A,N,t=this,R=[],H=t._entities,J=t._64O;for(i=0,A=H.length;A>i;i++)N=H[i],t.isNode(N)&&N.getCorners&&R.push.apply(R,N.getCorners());if(R.length){var X=Math.cos(-J),b=Math.sin(-J),Y=1/0,_=-1/0,$=1/0,l=-1/0;for(i=0,A=R.length;A>i;i++)C=R[i],m=C.x,O=C.y,C.x=X*m-b*O,C.y=b*m+X*O,Y=Math.min(Y,C.x),_=Math.max(_,C.x),$=Math.min($,C.y),l=Math.max(l,C.y);t._width=(_-Y)/t._scale.x,t._height=(l-$)/t._scale.y,X=Math.cos(J),b=Math.sin(J);var v=t._anchor;m=Y+(_-Y)*v.x,O=$+(l-$)*v.y,t._position={x:X*m-b*O,y:b*m+X*O}}},nn.prototype.isNode=function(F){return De(F)?Yn(F)?F.size()?!1:!0:!0:!1},nn.prototype._42=function(B,T,P){var A,k,e,C,Y,d,K,x,V=this,E=V._entities,l=V.rotateMode;for("batch"===l&&(x=V.getKeyOb()),A=0,k=E.length;k>A;A++)e=E[A],V.isNode(e)&&(d=e.getRect(),C=mn.toScreenPosition(P,{x:d.x,y:d.y}),Y=mn.toScreenPosition(P,{x:d.x+d.width,y:d.y+d.height}),K={min:C,max:Y},e===x&&(K.isKeyOb=!0),mn.Icons.DrawIcon(B,T,mn.Icons.GroupSubEntityRect,K))};var dr=mn.CurveActiving=function(G,g){this._curve=G,this._interactor=G._interactor,this.silent=!0;for(var p in g)this[p]=g[p];delete this.silent};dr.prototype={},dr.prototype.constructor=dr,L.defineProperties(dr.prototype,{point:{get:function(){return this._point},set:function(W){var s=this;s._point=W,s.editingCtrl||s.silent||s._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(f){var w=this;w._pairs=f,w.editingCtrl&&!w.silent&&w._firePointChange()}}}),dr.prototype._firePointChange=function(){var J=this,z=J.getCurrentEditingPoint(),g=J._interactor;if(!z)return g.fi({kind:"selectPoint"}),void 0;var R=this._curve.target;if(R){var o=mn.getDataMatrix(R).invert(),I=z.e;z=o.apply(mn.toWorldPosition(g.gv,z)),z.e=I;var T=J._lastFirePoint;T&&Math.abs(z.x-T.x)<1e-5&&Math.abs(z.y-T.y)<1e-5&&(z.e==n&&T.e==n||Math.abs(z.e-T.e)<1e-5)||(J._lastFirePoint=z,g.fi({kind:"selectPoint",x:z.x,y:z.y,e:z.e}))}},dr.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},dr.prototype.getCurrentEditingPoint=function(){var L=this,W=L.editingCtrl;if(W){var t=L.pairs;if(t){var K=t[W.pairId];if(K){var S=K[W.type];if(S)return S}}}return L._point};var Sl=mn.CursorFactory=function(I){var i=this;i._interactor=I,i._rotateCursorStyles={}};Sl.prototype={},Sl.prototype.constructor=Sl,Sl.prototype.getRotateCursor=function(N){var i=this;0>N&&(N+=2*Math.PI);var l=i._interactor,v=l.getStyle("rotateCursorSize"),G=l.getStyle("rotateCursorRound"),g=Math.round(180*(N/Math.PI)/G);g*G>=360&&(g=0);var s=i._rotateCursorStyles,c="htCustomRotateStyle_"+v+"_"+G+"_"+g;return s[c]||(i._produceRotateCursor(c,v,G,g),s[c]=!0),c},Sl.prototype._produceRotateCursor=function(O,H,v,x){var f=this;f._interactor;var n=f._canvas;n||(n=f._canvas=d.createElement("canvas")),n.width=n.height=H*devicePixelRatio,n.style.width=n.style.height=H+" px";var l=n.getContext("2d");mn.setAntialias(l,!1),l.scale(devicePixelRatio,devicePixelRatio);var A,I,a,s,D,C=Math.round(H/2),j=""+C+" "+C+",auto !important;",E=4;A=Math.PI/180*x*v,l.clearRect(0,0,H,H),l.save(),l.scale(H/32,H/32),l.translate(16,15),l.rotate(A+Math.PI/2),l.beginPath(),l.moveTo(-8,0),l.lineTo(-8,E),l.lineTo(-8+E,E),l.moveTo(8,0),l.lineTo(8,E),l.lineTo(8-E,E),l.moveTo(-8,E),l.quadraticCurveTo(0,-6,8,E),l.restore(),l.lineCap="round",l.lineJoin="miter",l.strokeStyle="white",l.lineWidth=4,l.stroke(),l.strokeStyle="black",l.lineWidth=2,l.stroke(),I=JSON.stringify(n.toDataURL()),s="cursor:url("+I+")"+j,1!==devicePixelRatio&&(a='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+H+'px" height="'+H+'px"><image xlink:href='+I+' width="'+H+'" height="'+H+'"/></svg>',s+="cursor:url(data:image/svg+xml;base64,"+btoa(a)+")"+j,s+="cursor:-webkit-image-set(url("+I+")"+devicePixelRatio+"x,url("+I+")1x)"+j),D=d.createElement("style"),D.textContent="body."+O+" *, ."+O+"{"+s+"}",d.head.appendChild(D)};var Dm=mn.Guide.Grid=function(E){var T=this;T._interactor=E,T._alignmentGuideId=0,T._xAlignmentGuide=[],T._yAlignmentGuide=[]};Dm.prototype={},Dm.prototype.constructor=Dm,L.defineProperties(Dm.prototype,{gridBlockSize:{get:function(){var l=this;return l._gridBlockSize||l._interactor.getStyle("gridBlockSize")},set:function(b){this._gridBlockSize=b,this._interactor._42()}},gridThickLinesEvery:{get:function(){var J=this;return J._gridThickLinesEvery||J._interactor.getStyle("gridThickLinesEvery")},set:function(S){this._gridThickLinesEvery=S,this._interactor._42()}},gridEnabled:{get:function(){var n=this,z=n._interactor;return z.gridEnabled&&n.isValidGrid()}}}),Dm.prototype._42=function(){var Y=this,M=Y._interactor;Y.gridEnabled&&Y.drawGrid(),M.alignmentGuideEnabled&&Y.drawAlignmentGuide()},Dm.prototype.makeMatrix=function(){var O=this,o=O._interactor.getStyle("gridAngle"),f=O._interactor.getStyle("gridRotation"),V=new mn.Math.Matrix2d,k=Math.sin(o),p=Math.cos(o);return V.set(1,0,p,k,0,0),V.rotate(f),V},Dm.prototype.isValidGrid=function(){var Y=this,g=Math.PI,w=Y._interactor,x=w.gv;if(x._zoom<w.getStyle("gridZoomThreshold"))return!1;var N=w.getStyle("gridAngle"),V=Math.abs(180*(N%g/g)),u=1-1e-8;return u>V||V>180-u?!1:!0},Dm.prototype.drawAlignmentGuide=function(){var T=this,b=T._interactor,m=b.gv,d=b._canvas,R=b._context,M=d.width,t=d.height,V=m.tx(),r=m.ty(),Y=m._zoom;R.beginPath(),R.strokeStyle=b.getStyle("gridAlignmentGuideColor"),R.lineWidth=1,T._xAlignmentGuide.forEach(function(Q){var O=Q.p*Y+V;R.moveTo(O,0),R.lineTo(O,t)}),T._yAlignmentGuide.forEach(function(D){var m=D.p*Y+r;R.moveTo(0,m),R.lineTo(M,m)}),R.stroke()},Dm.prototype.drawGrid=function(){function N(P,V,S,O){var T=mn.toScreenPosition(b,C.apply({x:P,y:V})),A=mn.toScreenPosition(b,C.apply({x:S,y:O}));E.moveTo(T.x,T.y),E.lineTo(A.x,A.y)}var G=this,x=G._interactor,T=G.gridBlockSize,B=G.gridThickLinesEvery,u=x.getStyle("gridThickColor"),k=x.getStyle("gridLightColor"),b=x.gv,q=x._canvas,E=x._context,A=q.width,r=q.height,C=G.makeMatrix(),h=C.applyInverse(mn.toWorldPosition(b,{x:0,y:0})),X=C.applyInverse(mn.toWorldPosition(b,{x:A,y:0})),w=C.applyInverse(mn.toWorldPosition(b,{x:0,y:r})),s=C.applyInverse(mn.toWorldPosition(b,{x:A,y:r})),Y=Math.min(h.x,X.x,w.x,s.x),o=Math.max(h.x,X.x,w.x,s.x),M=Math.min(h.y,X.y,w.y,s.y),L=Math.max(h.y,X.y,w.y,s.y);A=o-Y,r=L-M;var y=Math.ceil(Y/T),U=Math.floor(o/T),K=Math.ceil(M/T),H=Math.floor(L/T);b.tx(),b.ty(),b._zoom;var S,F,p;for(E.save(),E.lineWidth=1,E.beginPath(),E.strokeStyle=u,p=Math.ceil(y/B)*B;U>=p;p+=B)S=p*T,N(S,M,S,L);for(p=Math.ceil(K/B)*B;H>=p;p+=B)F=p*T,N(Y,F,o,F);for(E.stroke(),E.beginPath(),E.strokeStyle=k,p=y;U>=p;p++)0!==p%B&&(S=p*T,N(S,M,S,L));for(p=K;H>=p;p++)0!==p%B&&(F=p*T,N(Y,F,o,F));E.stroke(),E.restore()},Dm.prototype.getAlignmentGuides=function(){var m=this;return{x:m._xAlignmentGuide,y:m._yAlignmentGuide}},Dm.prototype.addAlignmentGuide=function(T,V,L){var y=this,m="x"===T?y._xAlignmentGuide:y._yAlignmentGuide,L=L?L:++y._alignmentGuideId,J={p:V,id:L};if(m.length){var A=y._findClosestAlignmentGuide(J.p,m);A.dis<0?m.splice(A.index+1,0,J):m.splice(A.index,0,J)}else m.push(J);return y._interactor._42(),L},Dm.prototype.findClosest=function(p,F,B){var X=this,H=X._interactor,h=H.gv;B&&(p=mn.toWorldPosition(h,p));var U,k,q,Y=1/0,S=1/0,m=p.x,a=p.y;if(X.gridEnabled){var C=X.gridBlockSize,w=X.makeMatrix(),G=w.applyInverse(p);G=w.apply({x:Math.round(G.x/C)*C,y:Math.round(G.y/C)*C}),Y=G.x-m,S=G.y-a,q=!0}if(H.alignmentGuideEnabled&&(U=X._findClosestAlignmentGuide(m,X._xAlignmentGuide).dis,k=X._findClosestAlignmentGuide(a,X._yAlignmentGuide).dis,Math.abs(U)<Math.abs(Y)&&(Y=U,q=!0),Math.abs(k)<Math.abs(S)&&(S=k,q=!0)),q){q=!1;var O=h._zoom,d=H.getStyle("smartGuideThreshold")/O,A={};if(Math.abs(Y)<d&&"y"!==F&&(A.x=B?Y*O:Y,q=!0),Math.abs(S)<d&&"x"!==F&&(A.y=B?S*O:S,q=!0),q)return A}},Dm.prototype._findClosestAlignmentGuide=function(d,q){if(!q.length)return{dis:1/0};for(var s,N=0,x=q.length-1;x-N>1;)s=Math.floor((N+x)/2),q[s].p<d?N=s:x=s;var V=q[N].p-d,k=q[x].p-d;return Math.abs(V)<=Math.abs(k)?{line:q[N],dis:V,index:N}:{line:q[x],dis:k,index:x}},Dm.prototype.removeAllAlignmentGuide=function(C){var L=this;"y"!==C&&(L._xAlignmentGuide=[]),"x"!==C&&(L._yAlignmentGuide=[]),L._interactor._42()},Dm.prototype.removeAlignmentGuide=function(t){for(var Q,p,G,u=this,c=u._xAlignmentGuide,C=0;2>C;C++)for(c=0===C?u._xAlignmentGuide:u._yAlignmentGuide,Q=0,p=c.length;p>Q;Q++)if(G=c[Q],G.id===t)return c.splice(Q,1),u._interactor._42(),{axis:0===C?"x":"y",position:G.p};return!1},Dm.prototype.adjustAlignmentGuide=function(U,H){var s=this,G=s.removeAlignmentGuide(U);return G?(s.addAlignmentGuide(G.axis,H,U),!0):!1};var Xq=mn.Guide.Rect=function(J){var g=this;g._interactor=J};Xq.prototype={},Xq.prototype.constructor=Xq,Xq.prototype.gatherRects=function(){var e,d,p,y,A=this,g=A._interactor.gv,r=[],C=[],V={x:r,y:C},l={},a=g.getDataModel(),Z=a.a("width"),f=a.a("height");Z&&f&&(e=0,d=0,p=Z,y=f,r.push({node:a,type:0,p:e},{node:a,type:1,p:e+p/2},{node:a,type:2,p:e+p}),C.push({node:a,type:0,p:d},{node:a,type:1,p:d+y/2},{node:a,type:2,p:d+y}),l[a._id||0]={x:e,y:d,width:p,height:y}),a.each(function(k){if(De(k)&&!g.isSelected(k)&&g.isVisible(k)&&g.isValidGuideLineSource(k)){var u=!1;if(g.sm().getSelection().each(function(a){u||(k.isHostOn(a)?u=!0:k.isDescendantOf(a)&&(u=!0))}),!u){var a=k.getRect();e=a.x,d=a.y,p=a.width,y=a.height,r.push({node:k,type:0,p:e},{node:k,type:1,p:e+p/2},{node:k,type:2,p:e+p}),C.push({node:k,type:0,p:d},{node:k,type:1,p:d+y/2},{node:k,type:2,p:d+y}),l[k._id]=a}}}),r.sort(function($,P){return $.p-P.p}),C.sort(function(e,D){return e.p-D.p}),A._grid=V,A._87I=l},Xq.prototype.gatherLines=function(g,_,h){var d,r,A,q,T,Q,l,b,P,Z,G,o,B=this,E=[B.findClosest({x:g.x,y:g.y},_),B.findClosest({x:g.x+g.w/2,y:g.y+g.h/2},_),B.findClosest({x:g.x+g.w,y:g.y+g.h},_)],S={},e=B._87I;h=h||255;var s,C;for(B._guideLine=[],d=0;2>d;d++)for(S={},0===d?(q="y",b=g.x,P=b+g.w):(q="x",b=g.y,P=b+g.h),r=0;3>r;r++)T=E[r],T&&isFinite(T[q])&&(s=1<<3*d+r,h&s&&(Q=T[q+"Line"],l=Q.node,C=l._id||0,S[C]||(S[C]=!0,o=e[C],"y"===q?(Z=o.x,G=o.x+o.width):(Z=o.y,G=o.y+o.height),A=Q.p,B._guideLine.push({type:q,a:b,b:P,c:Z,d:G,p:A,center:1===Q.type}))))},Xq.prototype._binarySearchClosest=function(L,T){if(!T.length)return{dis:1/0};for(var P,W=0,p=T.length-1;p-W>1;)P=Math.floor((W+p)/2),T[P].p<L?W=P:p=P;var N=T[W].p-L,_=T[p].p-L;return Math.abs(N)<=Math.abs(_)?{line:T[W],dis:N}:{line:T[p],dis:_}},Xq.prototype.findClosest=function(O,G,E){var d=this,f=d._interactor,n=f.gv,Q=d._grid;E&&(O=mn.toWorldPosition(n,O));var K,D=d._binarySearchClosest(O.x,Q.x),I=d._binarySearchClosest(O.y,Q.y),A=D.dis,r=I.dis,R=n._zoom,v=f.getStyle("smartGuideThreshold")/R,S={};return Math.abs(A)<v&&"y"!==G&&(S.x=E?A*R:A,S.xLine=D.line,K=!0),Math.abs(r)<v&&"x"!==G&&(S.y=E?r*R:r,S.yLine=I.line,K=!0),K?S:void 0},Xq.prototype._42=function(){var c=this,k=c._guideLine;if(k&&!Y.Default.isCtrlDown()){var w=c._interactor;if(w.getStyle("guideLineVisible")){var E,L,r,Z,m,j,a,i,g,N,p,v,z,R,x,A,e,$=w.gv,q=w._context,W=$.tx(),P=$.ty(),O=$._zoom,M=w.getStyle("guideLineTextSpacing");for(E=0,L=k.length;L>E;E++)r=k[E],i=r.type,g=r.p,N=r.a,p=r.b,v=r.c,z=r.d,R=Math.min(N,v),x=Math.max(p,z),"x"===i?(Z=g*O+W,m=R*O+P,j=Z,a=x*O+P):(Z=R*O+W,m=g*O+P,j=x*O+W,a=m),mn.Icons.DrawIcon(w,q,mn.Icons.MoveLineGuide,{rect:[Z,m,j,a],center:r.center}),z>=N&&p>=v||(R=N>z?z:p,x=N>z?N:v,e=x-R,"x"===i?(r.center2center||(Z-=M,j=Z),m=R*O+P,a=x*O+P,A=mn.Icons.MoveLineGuideDistanceV):"y"===i&&(r.center2center||(m-=M,a=m),Z=R*O+W,j=x*O+W,A=mn.Icons.MoveLineGuideDistanceH),mn.Icons.DrawIcon(w,q,A,{x0:Z,y0:m,x1:j,y1:a,dis:e}))}}},Xq.prototype.clear=function(){this._guideLine=null};var Ir=mn.Guide.Hover=function(t){var Q=this;Q._interactor=t};Ir.prototype={},Ir.prototype.constructor=Ir,L.defineProperties(Ir.prototype,{}),Ir.prototype._42=function(){var S=this._interactor;if(S.getStyle("hoverGuideVisible")&&!S.gvEditing){var f=S.hoverData,A=S.gv;if(!De(f)||A.isSelected(f))return S.hoverData=null,void 0;var B=Hq(A,f),v=mn.toScreenPosition(A,{x:B.x,y:B.y}),m=mn.toScreenPosition(A,{x:B.x+B.width,y:B.y+B.height});mn.Icons.DrawIcon(S,S._context,mn.Icons.HoverDataRect,{min:v,max:m,color:S.getStyle("hoverGuideColor")||S.getStyle("baseColor")})}},mn.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var on=mn.Icons={},vn=1e4,fd=null,Rk=mn.DefaultStyleMap.baseColor,Qf="rgb(183,232,135)",Qn="rgb(255,204,153)",tl=6;Y.Default.setImage("Icons.RectPoint",{width:tl,height:tl,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Rk}},rect:[0,0,tl,tl]}]}),on.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var l=on.GroupSubEntityRect.data;if(!l)return[];var w=l.min,r=l.max;return[w.x,w.y,w.x,r.y,r.x,r.y,r.x,w.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return on.GroupSubEntityRect.data.isKeyOb?Rk:Rk}}}]};var uc=4;on.HoverDataRect={comps:[{type:"shape",points:{func:function(){var H=on.HoverDataRect.data;if(!H)return[];var O=H.min,d=H.max,w=uc;return O.x-=w,O.y-=w,d.x+=w,d.y+=w,[O.x,O.y,O.x,d.y,d.x,d.y,d.x,O.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return on.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},on.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[on.Line.data.P1.x,on.Line.data.P1.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[on.Line.data.P2.x,on.Line.data.P2.y],tl,tl]}}}]},on.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return on.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},on.Rect={comps:[{type:"shape",points:{func:function(){var Q=on.Rect.data;if(!Q)return[];var Y=Q.LT,x=Q.LB,s=Q.RB,V=Q.RT;return[Y.x,Y.y,x.x,x.y,s.x,s.y,V.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Rk}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},rect:{func:function(){return[[on.Rect.data.LT.x,on.Rect.data.LT.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},rect:{func:function(){return[[on.Rect.data.LB.x,on.Rect.data.LB.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},rect:{func:function(){return[[on.Rect.data.RB.x,on.Rect.data.RB.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},rect:{func:function(){return[[on.Rect.data.RT.x,on.Rect.data.RT.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},visible:{func:function(){return on.Rect.data.L?!0:!1}},rect:{func:function(){return[[on.Rect.data.L.x,on.Rect.data.L.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},visible:{func:function(){return on.Rect.data.R?!0:!1}},rect:{func:function(){return[[on.Rect.data.R.x,on.Rect.data.R.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},visible:{func:function(){return on.Rect.data.T?!0:!1}},rect:{func:function(){return[[on.Rect.data.T.x,on.Rect.data.T.y],tl,tl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return on.Rect.data.rotation}},visible:{func:function(){return on.Rect.data.B?!0:!1}},rect:{func:function(){return[[on.Rect.data.B.x,on.Rect.data.B.y],tl,tl]}}}]};var dn=16;Y.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Rk}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Rk}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),on.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[on.Anchor.data.POS.x,on.Anchor.data.POS.y],dn,dn]}}}]},on.TipShiftX=12,on.TipShiftY=12;var ss=[8,28];on.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[on.TipHelper.data.helperPos.x,on.TipHelper.data.helperPos.y,ss[0]*on.TipHelper.data.size,ss[1]]}},background:{func:function(){return fd.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return on.TipHelper.data.text}},rect:{func:function(){return[on.TipHelper.data.helperPos.x,on.TipHelper.data.helperPos.y,ss[0]*on.TipHelper.data.size,ss[1]]}},color:{func:function(){return fd.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Jr=7;on.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!on.ShapePoint.data.dynamicVisible}},rect:{func:function(){var s=on.ShapePoint.data.point,I=on.ShapePoint.data.size||Jr;return[s,I+10,I+10]}},background:{func:function(){var g=Date.now(),b=on.ShapePoint.data.dynamicPeriod||1500,j=Math.sin(g%b/b*Math.PI);return"rgba(27,124,22,"+.5*j+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var K=on.ShapePoint.data.point,Q=on.ShapePoint.data.size||Jr;return[K,Q,Q]}},background:{func:function(){var K=on.ShapePoint.data.isEnd;return K?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return on.ShapePoint.data.color||Rk}}},{type:"rect",visible:{func:function(){return!!on.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Rk}},rect:{func:function(){var G=5;return[on.ShapePoint.data.point,G,G]}}}]},on.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!on.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return on.ShapeBgCurve.data.P}},segments:{func:function(){return on.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var U=Date.now(),c=on.ShapeBgCurve.data.dynamicPeriod||1500,n=Math.sin(U%c/c*Math.PI);return"rgba(27,124,22,"+.3*n+")"}}},{type:"shape",points:{func:function(){return on.ShapeBgCurve.data.P}},segments:{func:function(){return on.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return on.ShapeBgCurve.data.color||Rk}}}]};var md=8;on.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var L=on.ShapeHighlighPoint.data;return[[L.x,L.y],md,md]}},background:{func:function(){return fd.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var hp=10;on.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var k=on.ShapeHighlighRealPoint.data;return[[k.x,k.y],hp,hp]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Rk}}}]};var og=8;on.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var x=on.ShapeHighlighCtrlPoint.data,o=x.x,M=x.y,F=og/2;return[o-F,M-F,o-F,M+F,o+F,M+F,o+F,M-F]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return fd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return fd.getStyle("shapeCtrlPointBorderColor")||Rk}}}]};var mo=3;on.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return on.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:mo,borderColor:{func:function(){return fd.getStyle("curveHighlightColor")}}}]},on.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return on.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},on.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return on.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return on.MoveLineGuide.data.center?Qf:Qn}}}]};var yl=5;on.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var Y=on.MoveLineGuideDistanceH.data,y=Y.x0,W=Y.y0;return[y,W-yl,y,W+yl]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Qn},{type:"shape",points:{func:function(){var U=on.MoveLineGuideDistanceH.data,n=U.x1,N=U.y1;return[n,N-yl,n,N+yl]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Qn},{type:"text",text:{func:function(){return Math.round(on.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var N=on.MoveLineGuideDistanceH.data;return[[(N.x0+N.x1)/2,N.y0-10],20,20]}},color:Qn,font:"12px Arial",align:"center"}]},on.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var o=on.MoveLineGuideDistanceV.data,b=o.x0,h=o.y0;return[b-yl,h,b+yl,h]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Qn},{type:"shape",points:{func:function(){var l=on.MoveLineGuideDistanceV.data,M=l.x1,$=l.y1;return[M-yl,$,M+yl,$]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Qn},{type:"text",text:{func:function(){return Math.round(on.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var l=on.MoveLineGuideDistanceV.data;return[[l.x0-10,(l.y0+l.y1)/2],20,20]}},color:Qn,font:"12px Arial",align:"center"}]},Y.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),on.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var S=on.EdgeElevationGuide.data,r=S.x,U=S.y,Y=fd.getStyle("curveElevationIntersectSize"),u=fd.getStyle("curveElevationGuideShift");return r+=u[0],U+=u[1],[r-Y,U-Y,2*Y,2*Y]}}}]},Y.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),Y.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),on.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return on.ConnectGuide.data.rotation}},rect:{func:function(){var S=on.ConnectGuide.data.connect;S.x,S.y;var T=fd.getStyle("connectGuideIntersectSize");return[[S.x,S.y],2*T,2*T]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var c=on.ConnectGuide.data.cursorPos||on.ConnectGuide.data.connect,w=fd.getStyle("connectGuideIntersectSize");return[[c.x,c.y],2*w-2,2*w-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var U=on.ConnectGuide.data.connect,C=on.ConnectGuide.data.cursorPos||U;return[U.x,U.y,U.x+.5*(C.x-U.x),U.y,C.x+.5*(U.x-C.x),C.y,C.x,C.y]}}}]},Y.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),Y.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),on.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var l=on.ConnectGuideGarbage.data.hover;return l?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var $=on.ConnectGuideGarbage.data,_=fd.getStyle("connectGuideGarbageIntersectsize");return $.hover&&(_+=5),[[$.x,$.y],2*_,2*_]}}}]};var Um=6;on.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return on.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Z=on.ShapeActivingCtrl.data;return[Z.point.x,Z.point.y,Z.c1.x,Z.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Rk}}},{type:"shape",visible:{func:function(){return on.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var N=on.ShapeActivingCtrl.data;return[N.point.x,N.point.y,N.c2.x,N.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Rk}}},{type:"shape",visible:{func:function(){return on.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var S=on.ShapeActivingCtrl.data.c1,T=S.x,u=S.y,v=Um/2;return"c1"===on.ShapeActivingCtrl.data.hl&&(v+=.5),[T-v,u-v,T-v,u+v,T+v,u+v,T+v,u-v]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return fd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===on.ShapeActivingCtrl.data.hl?fd.getStyle("shapeCtrlPointHighlightBorder")||Rk:fd.getStyle("shapeCtrlPointBorderColor")||Rk}}},{type:"shape",visible:{func:function(){return on.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var q=on.ShapeActivingCtrl.data.c2,V=q.x,P=q.y,W=Um/2;return"c2"===on.ShapeActivingCtrl.data.hl&&(W+=.5),[V-W,P-W,V-W,P+W,V+W,P+W,V+W,P-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return fd.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===on.ShapeActivingCtrl.data.hl?fd.getStyle("shapeCtrlPointHighlightBorder")||Rk:fd.getStyle("shapeCtrlPointBorderColor")||Rk}}}]},on.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Rk}},rect:{func:function(){return[[on.RoundPoint.data.x,on.RoundPoint.data.y],tl,tl]}}}]},on.AttachPoint={comps:[{type:"rect",background:{func:function(){return on.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Rk}},rect:{func:function(){var P=on.AttachPoint.data.isAttach?tl+4:tl;return[[on.AttachPoint.data.x,on.AttachPoint.data.y],P,P]}}}]},on.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return on.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return on.SimpleRect.data.color||Rk}},rect:{func:function(){var x=on.SimpleRect.data;return[x.x,x.y,x.width,x.height]}}}]},Y.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),on.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var I=on.MoveDummy.data;
return[[I.pos.x,I.pos.y],2*I.size,2*I.size]}}}]},mn.Icons.DrawIcon=function(g,W,N,D){N.width=N.height=vn,N.data=D,fd=g,Y.Default.drawImage(W,N,0,0,vn,vn)},mn.Icons.MapPoints=function(D,e){for(var Y=0,c=D.length;c>Y;Y++)D[Y]/=e},mn.roundTo=function(u,R,z){var U=Math.abs(u%R);return z>U||z>R-U?R*Math.round(u/R):u},mn.toFixed=function(x){return Math.round(100*x)/100},mn.getDataMatrix=function(q){if(q instanceof Y.Shape){var l=new Y.Math.Matrix2d,e=q.getPosition();return l.translate(-e.x,-e.y).scale(q.getScale().x,q.getScale().y).rotate(q.getRotation()).translate(e.x,e.y),l}return q.getMatrix?q.getMatrix():new Y.Math.Matrix2d};var rf=mn.Math.Curve=function(){this._curves=[]};rf.prototype={},rf.prototype.constructor=rf,rf.prototype.createFromHtShape=function(H,c,V){c instanceof Y.List&&(c=c.toArray());var f,J,S,i,o,y,z,B=this,F=null,C=null,M=0,x=mn.Math.Vector2,L=mn.Math.CubicBezier,w=function(U){return new x(H[U],H[U+1],V?V[U/2]:n)};for(J=0,S=c.length;S>J;J++){switch(i=c[J],o=null,i){case 1:C=w(M),F=C,M+=2;break;case 2:f=w(M),M+=2,o=new L(C,C.clone(),f.clone(),f),C=f;break;case 3:y=w(M),f=w(M+2),M+=4,o=new L(C,y.clone().sub(C).multiplyScalar(2/3).add(C),y.clone().sub(f).multiplyScalar(2/3).add(f),f),C=f;break;case 4:y=w(M),z=w(M+2),f=w(M+4),M+=6,o=new L(C,y,z,f),C=f;break;case 5:if(!F)break;o=new L(C,C.clone(),F.clone(),F),C=null,F=null}o&&(o._index=B._curves.length,B._curves.push(o))}},rf.prototype.checkPoint=function(H,e){var W,Z,_,u,f,m=this,K=m._curves;for(W=0,Z=K.length;Z>W;W++)if(u=K[W],f=u.intersectRect(H,e,e),f.length)return _=0,f.forEach(function(h){_+=h.t}),_/=f.length,H=u.getPointAt(_),H.t=_,{bezier:u,intersection:H}},rf.prototype.insertKnot=function(F,J){var C=F.insertKnot(J),K=this,R=K._curves;R.splice(F._index,1,C[0],C[1])},rf.prototype._isCloseEnough=function(U,q){return Math.abs(U.x-q.x)<1e-6&&Math.abs(U.y-q.y)<1e-6},rf.prototype._isSamePoint=function(c,S){return c===S},rf.prototype.moveRealPoint=function(U,m){var r=this,q=r._curves,B=m.clone().sub(U);q.forEach(function(t){var J=t._p1;t._p2,t._p3;var x=t._p4;r._isSamePoint(J,U)&&(t._p2.add(B),t._p1=m),r._isSamePoint(x,U)&&(t._p3.add(B),t._p4=m)})},rf.prototype.moveCtrlDueToRealPointMovement=function(W,m){var j=this,P=j._curves,p=function(I){I.add(m),I.e&&m.e&&(I.e+=m.e)};P.forEach(function(J){var G=J._p1;J._p2,J._p3;var P=J._p4;j._isSamePoint(G,W)&&p(J._p2),j._isSamePoint(P,W)&&p(J._p3)})},rf.prototype.moveCtrlPoint=function(s,y,O){var G=s[O];if(G){G.e!==n&&(y.e=G.e);var b=this,A=b._curves;y.clone().sub(G),A.forEach(function(d){var k;"c2"===O?k="_p2":"c1"===O&&(k="_p3"),b._isSamePoint(d[k],G)&&(d[k]=y)}),s[O]=y}},rf.prototype.deleteRealPoint=function(P,E){var M,G,N,H,e,o,J,k=this,v=k._curves,B={},n=[],m=mn.Math.CubicBezier;for(G=0,N=v.length;N>G;G++)M=v[G],H=M._p1,e=M._p2,o=M._p3,J=M._p4,(B[G]||!k._isSamePoint(H,P))&&(k._isSamePoint(J,P)?N>G+1&&k._isSamePoint(v[G+1]._p1,P)&&(E||n.push(new m(H,e,v[G+1]._p3,v[G+1]._p4))):n.push(M));k._curves=n},rf.prototype.findPairs=function(k,Y){var j,h,p,e,v,I,W,t,n=this,y=n._curves,i={},Q=[];for(h=0,p=y.length;p>h;h++)j=y[h],e=j._p1,v=j._p2,I=j._p3,W=j._p4,!i[h]&&n._isSamePoint(e,k)&&(Y?Q.push({point:e,r2:W}):Q.push({point:e,c2:v})),n._isSamePoint(W,k)&&(t=Y?{point:W,r1:e}:{point:W,c1:I},p>h+1&&n._isSamePoint(y[h+1]._p1,k)&&(Y?t.r2=y[h+1]._p4:t.c2=y[h+1]._p2,i[h+1]=!0),Q.push(t));return Q},rf.prototype.toHtShape=function(){var s=this,d=s._curves,w=[],c=[],F={x:1/0,y:1/0};return d.forEach(function(G){var X=G._p1,q=G._p2,K=G._p3,E=G._p4;return s._isCloseEnough(X,F)||(w.push(1),c.push(X.clone())),F=E,s._isCloseEnough(X,q)&&s._isCloseEnough(K,E)?(w.push(2),c.push(E.clone()),void 0):(w.push(4),c.push(q.clone(),K.clone(),E.clone()),void 0)}),{segments:w,points:c}};var _r=mn.Math.CubicBezier=function(p,q,l,V){var I=this;I._id=mn.Math.CubicBezier._globalId++,I._p1=p,I._p2=q,I._p3=l,I._p4=V};_r._globalId=1,_r.prototype={},_r.prototype.constructor=_r,_r.prototype.toString=function(){return this._id},_r.prototype.intersectRect=function(b,C,D){var d=C/2,Z=D/2,Y=b.x,y=b.y,n=mn.Math.Vector2,T=new n(-d+Y,-Z+y),V=new n(d+Y,Z+y),i=new n(V.x,T.y),q=new n(T.x,V.y),A=this,H=A.intersectLine(T,i),J=A.intersectLine(i,V),M=A.intersectLine(V,q),p=A.intersectLine(q,T),O=H.concat(J).concat(M).concat(p);return O},_r.prototype.intersectLine=function(Y,L){var g,t,d,f,h,r,u,A,O,b,z,e,I,w=this,x=Y.clone().min(L),k=Y.clone().max(L);f=w._p1,h=w._p2,r=w._p3,u=w._p4,g=f.clone().multiplyScalar(-1),t=h.clone().multiplyScalar(3),d=r.clone().multiplyScalar(-3),z=g.add(t).add(d).add(u),g=f.clone().multiplyScalar(3),t=h.clone().multiplyScalar(-6),d=r.clone().multiplyScalar(3),b=g.add(t).add(d),g=f.clone().multiplyScalar(-3),t=h.clone().multiplyScalar(3),O=g.add(t),A=f.clone(),I=new mn.Math.Vector2(Y.y-L.y,L.x-Y.x),e=Y.x*L.y-L.x*Y.y;for(var W=w.getRoots(I.dot(z),I.dot(b),I.dot(O),I.dot(A)+e),i=new Array,K=0,B=W.length;B>K;K++){var m=W[K];if(!(0>m||m>1)){var s=f.clone().lerp(h,m),J=h.clone().lerp(r,m),R=r.clone().lerp(u,m),$=s.lerp(J,m),_=J.lerp(R,m),l=$.lerp(_,m);l.t=m,Y.x==L.x?x.y<=l.y&&l.y<=k.y&&i.push(l):Y.y==L.y?x.x<=l.x&&l.x<=k.x&&i.push(l):l.x>=x.x&&l.y>=x.y&&l.x<=k.x&&l.y<=k.y&&i.push(l)}}return i},_r.prototype.solveTForPoint=function(D){var H,m,L,y,g=this;H=g._p1.x-D.x,m=g._p2.x-D.x,L=g._p3.x-D.x,y=g._p4.x-D.x;for(var F=g.getRoots(y-3*L+3*m-H,3*L-6*m+3*H,3*m-3*H,H),v=n,c=1/0,a=0,d=F.length;d>a;a++){var o=F[a];if(!(0>o||o>1)){var r=g._p1.clone().lerp(g._p2,o),B=g._p2.clone().lerp(g._p3,o),W=g._p3.clone().lerp(g._p4,o),R=r.lerp(B,o),C=B.lerp(W,o),Z=R.lerp(C,o);Z.t=o;var z=Math.abs(Z.y-D.y);c>z&&(c=z,v=Z)}}return v},_r.prototype.getPointAt=function(J){var T=this,d=T._p1,x=T._p2,B=T._p3,h=T._p4,D=d.clone().lerp(x,J),N=x.clone().lerp(B,J),M=B.clone().lerp(h,J),l=D.lerp(N,J),F=N.lerp(M,J);return l.lerp(F,J)},_r.prototype.getRoots=function(w,V,h,B){var z,c,N,R,X,D=new Array;if(Math.abs(w)<1e-6){var z=V,c=h/z,N=B/z,R=c*c-4*N;if(R>0){var X=Math.sqrt(R);D.push(.5*(-c+X)),D.push(.5*(-c-X))}else 0==R&&D.push(.5*-c)}V/=w,h/=w,B/=w,z=(3*h-V*V)/3,c=(2*V*V*V-9*h*V+27*B)/27;var g=V/3,U=c*c/4+z*z*z/27,t=c/2;if(Math.abs(U)<=1e-6&&(U=0),U>0){var s,m,X=Math.sqrt(U);s=-t+X,m=s>=0?Math.pow(s,1/3):-Math.pow(-s,1/3),s=-t-X,s>=0?m+=Math.pow(s,1/3):m-=Math.pow(-s,1/3),D.push(m-g)}else if(0>U){var i=Math.sqrt(-z/3),x=Math.atan2(Math.sqrt(-U),-t)/3,W=Math.cos(x),A=Math.sin(x),v=Math.sqrt(3);D.push(2*i*W-g),D.push(-i*(W+v*A)-g),D.push(-i*(W-v*A)-g)}else{var s;s=t>=0?-Math.pow(t,1/3):Math.pow(-t,1/3),D.push(2*s-g),D.push(-s-g)}return D},_r.prototype._70I=function(){var D=this;return D._p1.distanceToSquared(D._p2)<1e-10&&D._p3.distanceToSquared(D._p4)<1e-10},_r.prototype.insertKnot=function(w){var U=this,M=U._p1,O=U._p2,K=U._p3,R=U._p4,g=M.clone().lerp(O,w),c=O.clone().lerp(K,w),m=K.clone().lerp(R,w),h=g.clone().lerp(c,w),r=c.clone().lerp(m,w),e=h.clone().lerp(r,w);return U._70I()?(M.clone().lerp(R,w),[new mn.Math.CubicBezier(M,M.clone(),e.clone(),e),new mn.Math.CubicBezier(e,e.clone(),R.clone(),R)]):[new mn.Math.CubicBezier(M,g,h,e),new mn.Math.CubicBezier(e,r,m,R)]};var jj=Y.Default.getInternal().ui().EdgeUI,qr={_47O:function(f){var E=this,v=qr.getBackups()._47O;mn.inEdit(E.gv)||v.call(E,f)}};mn.Inject.registAsModule(qr,jj);var Re=Y.Default.getInternal().ui().NodeUI,um={_47O:function($){var D=this,X=um.getBackups()._47O;mn.inEdit(D.gv)||X.call(D,$)},getSelectWidth:function(){var S=this,W=S.gv,L=S._data;if(W.isEditable(L)&&mn.inEdit(W))return 0;var h=um.getBackup("getSelectWidth");return h.call(S)}};mn.Inject.registAsModule(um,Re);var Zd=Y.graph.GraphView,Fd={_editPointSize:function(){var U=Y.Default.isTouchable,O=mn.getStyle("pointSize");return O[U?0:1]}(),isPointEditable:function(p){var w=this;if(mn.inEdit(w))return w._pointEditableFunc?w._pointEditableFunc(p):!0;var Q=Fd.getBackup("isPointEditable");Q.call(w,p)},isEditable:function(z){var $,L=this,H=Fd.getBackup("isEditable");if($=z instanceof mn.Group?!0:H.call(L,z),!mn.inEdit(L))return $;if(!(z instanceof Y.Edge))return $;if(!z.s("2d.editable"))return!1;var y=L.getEditableFunc();return y?y(z):!0},_42:function(r,V){var n=this,i=Fd.getBackups()._42;if(i.call(n,r,V),mn.inEdit(n)){var s=n.getEditInteractor();s.drawImpl()}}};mn.Inject.registAsModule(Fd,Zd);var gg=Y.Default.getInternal().ui().ShapeUI,_f={_47O:function(m){var H=this,k=_f.getBackups()._47O;mn.inEdit(H.gv)||k.call(H,m)}};mn.Inject.registAsModule(_f,gg);var un=Y.graph.DefaultInteractor,Kg={handle_mousewheel:function(B){var N=this,k=Kg.getBackup("handle_mousewheel");mn.inEdit(N.gv)||k.call(N,B)}};mn.Inject.registAsModule(Kg,un);var Hj=Y.graph.MoveInteractor,Lo={_calcShift:function(p,m){var Q=this,r=Lo.getBackup("_calcShift"),W=Q.gv;if(!mn.inEdit(W))return r.call(Q,p,m);var Z=W.getEditInteractor(),b=Z.getSubModule("Move").calcShift(p,m,Q);return b||r.call(Q,p,m)},clear:function(q){var H=this,M=Lo.getBackup("clear");M.call(H,q);var Q=H.gv;if(mn.inEdit(Q)){var I=Q.getEditInteractor();I.getSubModule("Move").clear(q)}}};mn.Inject.registAsModule(Lo,Hj);var Xq=mn.Rect=function(L){this.catalog="Rect",this._interactor=L};Xq.prototype={},Xq.prototype.constructor=Xq,Xq.prototype.gatherInfo=function(T,m){var B=this;if(1===m.length){var r=m[0];return r instanceof Y.Shape&&r._70I()?B.gatherLine(T,r):Yn(r,T)?!1:B.gatherSingleTarget(T,r)}return m.length>1?B.gatherMultiTargets(T,m):!1},Xq.prototype.gatherSingleTarget=function(D,J){if(J.getCorners){var N,y=this,x=y.info;y.target=J,N=y.screenInfo={};var w=J.getCorners();x.LT=new mn.Math.Vector2(w[0]),x.LB=new mn.Math.Vector2(w[1]),x.RB=new mn.Math.Vector2(w[2]),x.RT=new mn.Math.Vector2(w[3]),x.T=x.LT.clone().add(x.RT).divideScalar(2),x.B=x.LB.clone().add(x.RB).divideScalar(2),x.L=x.LT.clone().add(x.LB).divideScalar(2),x.R=x.RT.clone().add(x.RB).divideScalar(2);for(var $ in x)N[$]=mn.toScreenPosition(D,x[$]);var I=y._interactor,n=I.getStyle("checkSize"),B=function(t,L,E){var o=L.clone().sub(t).setLength(-n),B=E.clone().sub(t).setLength(-n),z=o.add(B).add(t);return z};return N.rotLT=B(N.LT,N.RT,N.LB),N.rotLB=B(N.LB,N.LT,N.RB),N.rotRB=B(N.RB,N.LB,N.RT),N.rotRT=B(N.RT,N.LT,N.RB),N.rotT=N.rotLT.clone().add(N.rotRT).divideScalar(2),N.rotB=N.rotLB.clone().add(N.rotRB).divideScalar(2),N.rotL=N.rotLT.clone().add(N.rotLB).divideScalar(2),N.rotR=N.rotRT.clone().add(N.rotRB).divideScalar(2),N.rotation=J.getRotation(),y.gatherConnectInfo(),!0}},Xq.prototype.gatherConnectInfo=function(){var B=this,V=B.target,p=B._interactor,R=B.screenInfo,t=p.gv;if(t.isConnectActionVisible(V)&&p.getStyle("connectGuideVisible")){var M;V.s&&(M=V.s("connectGuideShift")),M||(M=p.getStyle("connectGuideShift"));var K=V.getAnchor(),Y=V.getSize(),y=V.toGlobal({x:Y.width*(M[0]-K.x),y:Y.height*(M[1]-K.y)});y=mn.toScreenPosition(t,y),R.P1?y.add(R.P2.clone().sub(R.P1).setLength(M[2])):(y.add(R.RT.clone().sub(R.LT).setLength(M[2])),y.add(R.LB.clone().sub(R.LT).setLength(M[3]))),R.connect=y}},Xq.prototype.gatherMultiTargets=function(N,n){var E=mn.Group.findOrCreateGroup(n);if(!E)return!1;var P=this;return P.editing&&"rotate"!==P.editing.mode||E.calcInfo(),P.gatherSingleTarget(N,E)},Xq.prototype.gatherLine=function(J,$){this.target=$;var c=this.screenInfo={},P=$.getPoints(),m=mn.getDataMatrix($);return c.P1=mn.toScreenPosition(J,m.apply(P.get(0))),c.P2=mn.toScreenPosition(J,m.apply(P.get(1))),this.gatherConnectInfo(),!0},Xq.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Xq.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Xq.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Xq.prototype.check=function(M,t,b){if(Y.Default.isLeftButton(t)){var v=this;if(v.editing=null,v.tipInfo=null,v.screenInfo){var a=v.target,E=M.isEditable(a),G=v.screenInfo;if(E&&G.connect){var L=v._checkConnect(b);if(L)return L}if(G.P1)return v._checkLine(b);var x,A,W,F=null,_=v._interactor,I=_.getStyle("checkSize");if(E&&M.isRectEditable(a))for(A=0;A<mn.Rect.ResizeKeys.length;A++)if(W=mn.Rect.ResizeKeys[A],mn.checkHit(b,G[W],I)){F=W,x="resize";break}if(!F&&E&&M.isRotationEditable(a)&&!_.getStyle("rotateAsClock")){var q=_.getStyle("rotateCheckSize");for(A=0;A<mn.Rect.RotateKeys.length;A++)if(W=mn.Rect.RotateKeys[A],mn.checkHit(b,G[W],q)){F=W,x="rotate";break}}if(!F)return _.setCursor("default"),void 0;if("rotate"===x){var T,R=M.lp(t);if(a instanceof mn.Group){var p=_.getStyle("groupRotateModeKey");"string"==typeof p&&(p=[p]);for(var S=!1,D=0,r=p.length;r>D;D++)if(t[p[D]]){S=!0;break}var X=_.getStyle("groupRotateModeDefault");T=S?"batch"===X?"block":"batch":X}var i="batch"===T?a.getAnchor2():a.getPosition(),y=Math.atan2(R.y-i.y,R.x-i.x);_._setRotateCursor(y),v.editing={mode:x,key:F,pos:i,flipY:a.getScale().y<0,rotation:a.getRotation(),hitRot:y},T&&(v.editing.groupRotateMode=T)}else{var d=mn.Rect.ResizeKeys.indexOf(F),n=mn.Rect.ResizeDirection[d],o=Math.cos(a.getRotation()),h=Math.sin(a.getRotation()),K=n.x*Math.sign(a.getScale().x),u=n.y*Math.sign(a.getScale().y),f=Math.atan2(-h*K-o*u,o*K-h*u),N=(Math.round(f/(Math.PI/4))+8)%8,j=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(j);var H=a.getWidth(),B=a.getHeight(),O=a.getAnchor();v.editing={mode:x,key:F,rect:{x:-H*O.x,y:-B*O.y,width:H,height:B},anchor:O,matrix:a.getMatrix()}}return F}}},Xq.prototype._checkLine=function($){var X=this;X.screenInfo;var f,w=X._interactor.getStyle("checkSize");if(mn.checkHit($,X.screenInfo.P1,w))f="P1";else{if(!mn.checkHit($,X.screenInfo.P2,w))return this._interactor.setCursor("default"),void 0;f="P2"}return X.editing={mode:"line",key:f},f},Xq.prototype._checkConnect=function(m){var A=this,l=A.screenInfo,M=A._interactor,u=M.getStyle("connectGuideIntersectSize"),n=l.connect,T=m.x,O=n.x;if(O>T&&u>O-T&&Math.abs(n.y-m.y)<u||T>=O&&mn.checkHit(m,n,u)){var F="connect",I=j.getConnectAction(M.gv);if(A.editing={mode:F},I&&I.delete)if(A.target instanceof mn.Group){var z=!0;M.gv.sm().getSelection().each(function(o){I.delete.visible.call(null,M.gv,o)||(z=!1)}),A.editing.hasDeleteAction=z}else I.delete.visible.call(null,M.gv,A.target)&&(A.editing.hasDeleteAction=!0);return M.setCursor("default"),F}},Xq.prototype._fireEditEvent=function(d,C){var L=this._interactor,Y=this.editing;if(Y){var A=Y.mode;A="rotate"===A?"Rotation":"connect"===A?"Connection":"resize"===A?"Rect":A[0].toUpperCase()+A.slice(1),L.fi({kind:d+"Edit"+A,event:C})}},Xq.prototype.startEdit=function(d,$){d.startDragging($);var u=this;u._interactor.fi({kind:"prepareEdit",event:$});var X=u.editing,P=u.target;if(X){if(u._fireEditEvent("begin",$),"rotate"===X.mode)return X.groupRotateMode&&P.beginRotate(X),void 0;if("connect"!==X.mode)("line"===X.mode||P&&0===P.getRotation())&&(u._inSmartGuide=!0,u._interactor.rectGuide.gatherRects());else if(X.hasDeleteAction){var a=d.gv,Z=u._interactor.getStyle("connectGuideGarbageShift");X.garbageInfo={x:a.getWidth()*Z[0]+Z[2],y:a.getHeight()*Z[1]+Z[3],size:u._interactor.getStyle("connectGuideGarbageIntersectsize")},d._42()}}},Xq.prototype._46O=function(Q){var x,U,r=this,B=r.editing,o=r.target;if(B){if("connect"===B.mode&&!B.canceled&&!B.deleted)try{B.garbageInfo&&B.garbageInfo.hover?j.doDeleteConnectionAction(r._interactor.gv,o):j.doConnectAction(r._interactor.gv,o,B.target)}catch(P){console.error(P)}U=B.freezeFlag,x=r.editing.groupRotateMode,r._fireEditEvent("end",Q),r.editing=null}r.tipInfo=null,r._inSmartGuide&&(r._interactor.rectGuide.clear(),r._inSmartGuide=!1),x&&o&&o.endRotate(),o instanceof Y.Block&&(U===n?delete o._freezeSyncFromChildren:o._freezeSyncFromChildren=U,o.updateFromChildren())},Xq.prototype.handleNormalStateDelete=function(){var B=this,Q=B.editing;if(Q&&"connect"===Q.mode&&!Q.canceled&&!Q.deleted){if(Q.garbageInfo){try{j.doDeleteConnectionAction(B._interactor.gv,B.target)}catch(X){console.error(X)}Q.garbageInfo=null}return Q.cursorPos=null,Q.targetCorners=null,Q.deleted=!0,B._interactor._42(),!0}},Xq.prototype.handleNormalStateKeyDown=function(P){var i=this,E=i.editing;return!E||"connect"!==E.mode||E.canceled||E.deleted?void 0:Y.Default.isEsc(P)?(E.cursorPos=null,E.targetCorners=null,E.canceled=!0,i._interactor._42(),!0):void 0},Xq.prototype.handleEdit=function(T,V){var l=this,A=l.editing;if(A){var h,x,w,S,J,G=l.target,B=A.key,z=A.mode,P=T.lp(V),Z=l._interactor;if("connect"===z){if(A.canceled)return;if(A.deleted)return;A.cursorPos=Z._getLogicalPoint(V);var t=A.garbageInfo;return t&&mn.checkHit(A.cursorPos,t,t.size)?(t.hover=!0,A.target=null,A.targetCorners=null):(t&&(t.hover=!1),A.target=T.getDataAt(P,function(U){return T.isSelectable(U)?De(U)?!0:!1:!1})||null,A.targetCorners=mn.getTargetCornersOnScreen(T,A.target)),Z._42(),void 0}if("rotate"===z){var k,p,y=A.pos,I=Math.atan2(P.y-y.y,P.x-y.x);if(A.groupRotateMode?p=I-A.hitRot:(k=I-A.hitRot,p=A.rotation+k),p%=2*Math.PI,0>p&&(p+=2*Math.PI),!Y.Default.isCtrlDown(V)){var C,j;Hc(V)?(C=Z.getStyle("shiftRotateRound"),j=C/2):(C=Z.getStyle("rotateRound"),j=Z.getStyle("rotateSensitivity")),p=mn.roundTo(p,C,j)}A.groupRotateMode?(k=p-(A.lastRotation||0),0!==k&&(G.addRotation(k,A.groupRotateMode,function($){return T.isRotationEditable($)}),A.lastRotation=p)):G.setRotation(p),Z._setRotateCursor(I),p>Math.PI&&(p-=2*Math.PI);var i=180*(p/Math.PI);i=i.toFixed(2),h=""+i+"°"}else if("resize"===z){var K=A.rect;w=K.x,S=K.y;var b,M=K.width,u=K.height,e=A.anchor,v=A.matrix,E=G.s&&G.s("keepAspectRatio")||Z.getStyle("keepAspectRatio");Hc(V)&&(E=!E);var d=l._unionPointMode1,H=l._unionPointMode2;if(l._inSmartGuide&&!Y.Default.isCtrlDown(V)&&!E){var D;"L"===B||"R"===B?D="x":("T"===B||"B"===B)&&(D="y"),l._adsorbedToClosest(P,D),J=!0}b=v.tfi(P);var X;"LT"===B?(K=d(b,{x:w+M,y:S+u},M,u,E),X=9):"T"===B?(K=H({x:w,y:b.y},{x:w+M,y:S+u},M,u,E,"v"),X=1):"RT"===B?(K=d(b,{x:w,y:S+u},M,u,E),X=33):"L"===B?(K=H({x:b.x,y:S},{x:w+M,y:S+u},M,u,E,"h"),X=8):"R"===B?(K=H({x:w,y:S},{x:b.x,y:S+u},M,u,E,"h"),X=32):"LB"===B?(K=d(b,{x:w+M,y:S},M,u,E),X=12):"B"===B?(K=H({x:w,y:S},{x:w+M,y:b.y},M,u,E,"v"),X=4):"RB"===B&&(K=d(b,{x:w,y:S},M,u,E),X=36);var O=v.tf(K.x+K.width*e.x,K.y+K.height*e.y);G instanceof Y.Block&&(A.hasOwnProperty("freezeFlag")||(A.freezeFlag=G._freezeSyncFromChildren,G._freezeSyncFromChildren=!0)),G.setPosition(O),G.setSize(K.width,K.height),J&&(x=G.getRect(),Z.rectGuide.gatherLines({node:G,x:x.x,y:x.y,w:x.width,h:x.height},D,X)),h=""+Math.round(K.width)+" * "+Math.round(K.height)}else if("line"===z){if(Hc(V)){var o=G.getPoints(),r="P1"===B?o.get(1):o.get(0),L={x:P.x-r.x,y:P.y-r.y},m=Z.getStyle("shiftLineRotateRound"),g=l._shiftDirList;if(!g||l._shiftRotateRound!==m){l._shiftRotateRound=m,l._shiftDirList=g=[];for(var _=0;_<Math.PI;_+=m)g.push({x:N(_),y:c(_)})}for(var s,f=0,R=0,$=g.length;$>R;R++){var Q=g[R],q=Q.x*L.x+Q.y*L.y;Math.abs(q)>Math.abs(f)&&(f=q,s=Q)}P={x:r.x+s.x*f,y:r.y+s.y*f},Z.rectGuide.clear()}else l._inSmartGuide&&!Y.Default.isCtrlDown(V)&&(l._adsorbedToClosest(P),J=!0);var U=mn.getDataMatrix(G).applyInverse(P);G.setPoint("P1"===B?0:1,U,!0);var F=G.getPoints(),W=F.get(0),a=F.get(1);w=W.x-a.x,S=W.y-a.y,h=" "+Math.round(Math.sqrt(w*w+S*S))+" ",J&&(x=G.getRect(),Z.rectGuide.gatherLines({node:G,x:x.x,y:x.y,w:x.width,h:x.height}))}if(h){var n=Y.Default.getLogicalPoint(V,Z._canvas);n.x+=mn.Icons.TipShiftX,n.y+=mn.Icons.TipShiftY,l.tipInfo={helperPos:n,text:h,size:h.length}}l._fireEditEvent("between",V)}},Xq.prototype._unionPointMode1=function(C,m,T,z,A){if(A&&T&&z){var J=C.x-m.x,K=C.y-m.y;Math.abs(J*z)<Math.abs(K*T)?(K=Math.sign(K)*Math.abs(J*z/T),C.y=m.y+K):(J=Math.sign(J)*Math.abs(K*T/z),C.x=m.x+J)}return Y.Default.unionPoint(C,m)},Xq.prototype._unionPointMode2=function(i,q,v,C,P,g){var $=Y.Default.unionPoint(i,q);if(P&&v&&C){var h;"v"===g?(h=$.x+$.width/2,$.width=v*$.height/C,$.x=h-$.width/2):(h=$.y+$.height/2,$.height=C*$.width/v,$.y=h-$.height/2)}return $},Xq.prototype._adsorbedToClosest=function(p,Q){var D=this,f=D._interactor,j=f.rectGuide.findClosest(p,Q),m=f.gridGuide.findClosest(p,Q),q=1/0,o=1/0;j&&(isFinite(j.x)&&(q=j.x),isFinite(j.y)&&(o=j.y)),m&&(isFinite(m.x)&&Math.abs(m.x)<Math.abs(q)&&(q=m.x),isFinite(m.y)&&Math.abs(m.y)<Math.abs(o)&&(o=m.y)),isFinite(q)&&(p.x+=q),isFinite(o)&&(p.y+=o)},Xq.prototype._42=function(Z,f,v){var K=this;K.info={},K.screenInfo=null;var V=K._interactor;if(!V.editDetail&&K.gatherInfo(f,v)){var d=K.editing,o=d?d.groupRotateMode:null,U=K.screenInfo;if("block"!==o){if(U.P1?mn.Icons.DrawIcon(V,Z,mn.Icons.Line,U):mn.Icons.DrawIcon(V,Z,mn.Icons.Rect,U),U.connect&&(mn.Icons.DrawIcon(V,Z,mn.Icons.ConnectGuide,{rotation:U.rotation,connect:U.connect,cursorPos:d?d.cursorPos:null}),d)){if(d.targetCorners){for(var j={x:1/0,y:1/0},e={x:-1/0,y:-1/0},H=0,y=d.targetCorners.length;y>H;H+=2)j.x=Math.min(j.x,d.targetCorners[H]),e.x=Math.max(e.x,d.targetCorners[H]),j.y=Math.min(j.y,d.targetCorners[H+1]),e.y=Math.max(e.y,d.targetCorners[H+1]);mn.Icons.DrawIcon(V,Z,mn.Icons.HoverDataRect,{min:j,max:e,color:V.getStyle("hoverGuideColor")||V.getStyle("baseColor")})}d.garbageInfo&&mn.Icons.DrawIcon(V,Z,mn.Icons.ConnectGuideGarbage,d.garbageInfo)}K.tipInfo&&mn.Icons.DrawIcon(V,Z,mn.Icons.TipHelper,K.tipInfo)}K.target instanceof mn.Group&&K.target._42(V,Z,f)}};var Pg=mn.Anchor=function(B){this.catalog="Anchor",this._interactor=B};Pg.prototype={},Pg.prototype.constructor=Pg,Pg.prototype.gatherInfo=function(M,k){var u=this;if(1===k.length){var Z=k[0];if(!Z.getAnchor)return;if(Z instanceof Y.Shape&&Z._70I())return;if(Yn(Z,M))return;return u.gatherSingleTarget(M,k[0])}return k.length>1?u.gatherMultiTargets(M,k):!1},Pg.prototype.gatherSingleTarget=function(s,c){var L=this;return L.info.POS=c.getPosition(),L.screenInfo.POS=mn.toScreenPosition(s,L.info.POS),L.target=c,!0},Pg.prototype.gatherMultiTargets=function(o,_){var j=this,l=mn.Group.findOrCreateGroup(_);return l?(j.screenInfo.POS=mn.toScreenPosition(o,l.getAnchor2()),j.target=l,!0):!1},Pg.prototype.isVisible=function(){var w=this,Y=w._interactor;if(Y.getStyle("anchorVisible")===!1)return!1;var I=w.target;if(I){if(this.editing)return!0;var Z=I.getAnchor(),j=Y.getStyle("anchorOutsideVisibleThreshold");if(Z.x<-j||Z.x>1+j||Z.y<-j||Z.y>1+j)return!0;var k=I.getSize(),F=I.getScale(),Q=Math.min(Math.abs(k.width*F.x),Math.abs(k.height*F.y));if(Q*Y.gv._zoom<Y.getStyle("anchorHideThreshold"))return!1}return!0},Pg.prototype.check=function(R,o,x){if(Y.Default.isLeftButton(o)){var y=this,c=y._interactor;if(y.isVisible()&&c.getStyle("anchorMovable")!==!1){y.editing=null,y.tipInfo=null;var F=y.target;if(F&&R.isAnchorEditable(F)&&R.isEditable(F)){var W;if(y.screenInfo&&(W=y.screenInfo.POS)&&mn.checkHit(x,new mn.Math.Vector2(W),c.getStyle("checkSize"))){if(F instanceof mn.Group)return y.editing={},!0;var n=F.getWidth(),T=F.getHeight(),j=F.getAnchor();return y.editing={rect:{x:-n*j.x,y:-T*j.y,width:n,height:T},anchor:j,matrix:F.getMatrix()},!0}}}}},Pg.prototype.startEdit=function(X,M){X.startDragging(M),X.fi({kind:"beginEditAnchor",event:M})},Pg.prototype._46O=function(Y){var g=this;g.editing&&(g.editing=null,g._interactor.fi({kind:"endEditAnchor",event:Y})),g.tipInfo=null},Pg.prototype.handleEdit=function(c,g){var r=this,M=r.target;if(M){var h=r.editing;if(h){var B=c.lp(g),L=r._interactor;if(M instanceof mn.Group)return M.setAnchor2(B),L._42(),void 0;var Q=h.matrix,t=Q.tfi(B),y=h.rect,j=(t.x-y.x)/y.width,S=(t.y-y.y)/y.height;if(!Y.Default.isCtrlDown(g)){var E=L.getStyle("anchorRound"),O=L.getStyle("anchorSensitivity");j=mn.roundTo(j,E,O),S=mn.roundTo(S,E,O)}M.setAnchor(j,S,!0);var X=Y.Default.getLogicalPoint(g,L._canvas);X.x+=mn.Icons.TipShiftX,X.y+=mn.Icons.TipShiftY;var x=""+j.toFixed(2)+", "+S.toFixed(2);r.tipInfo={helperPos:X,text:x,size:x.length},L.fi({kind:"betweenEditAnchor",event:g})}}},Pg.prototype._42=function(_,k,V){var P=this;P.info={},P.screenInfo={};var S=P._interactor;S.editDetail||P.gatherInfo(k,V)&&P.isVisible()&&(mn.Icons.DrawIcon(S,_,mn.Icons.Anchor,P.screenInfo),P.tipInfo&&mn.Icons.DrawIcon(S,_,mn.Icons.TipHelper,P.tipInfo))};var ke=mn.MoveDummy=function(M){this.catalog="MoveDummy",this._interactor=M};ke.prototype={},ke.prototype.constructor=ke,ke.prototype.gatherInfo=function(){var I=this,r=this._interactor.getSubModule("Rect");if(r){var F=r.screenInfo;if(F){var U=I._interactor,h=I.getMovableTarget(r.target);if(h){var O=U.getStyle("moveDummyThreshold");if(O!==!1){var N=F.LT||F.P1,X=F.RT||F.P2,q=F.LB||N;if(N){var E=F.P1,T=Math.min(N.distanceTo(q),N.distanceTo(X));if(!(O!==!0&&T>O)){var J=U.getStyle("moveDummyPosition"),b=X.clone().sub(N),v=q.clone().sub(N),z=J[2],B=J[3];if(E){var G=U.getStyle("moveDummyLineExtraShift");G&&(z+=G[0],B+=G[1])}var k=N.clone().add(b.clone().multiplyScalar(J[0])).add(b.setLength(z)).add(v.clone().multiplyScalar(J[1])).add(v.setLength(B));return I.screenInfo.pos=k,I.screenInfo.size=U.getStyle("moveDummySensitivity"),!0}}}}}}},ke.prototype.getMovableTarget=function(g){var v=this._interactor.gv;if(De(g)){if(v.isMovable(g))return g}else if(g instanceof mn.Group)for(var D=g._entities,c=D.length-1;c>=0;c--){var i=D[c];if(De(i)&&v.isMovable(i))return i}return null},ke.prototype.getMoveInteractor=function(){for(var p,O,t,b=this._interactor.gv,g=b.getInteractors(),p=0,O=g.length;O>p;p++)if(t=g.get(p),t instanceof Hj)return t},ke.prototype.startEdit=function(v,J){v.startDragging(J);var M=this.getMoveInteractor();if(M){var Q=this.selectedTarget,d=v.gv;d._moving=1,M._data=Q,d.handleMouseDown&&d.handleMouseDown(J,Q)}},ke.prototype._46O=function(W){var t=this,K=t.getMoveInteractor();K&&(K.handleWindowMouseUp(W),t.selectedTarget=null)},ke.prototype.handleEdit=function(Q,R){var o=this.getMoveInteractor();o&&o.handleWindowMouseMove(R)},ke.prototype.check=function(H,m,U){if(this.selectedTarget=null,Y.Default.isLeftButton(m)&&!H._scrolling&&!ym()){var p=this;if(p.screenInfo){var i=p.screenInfo.pos;if(i&&!(U.distanceTo(i)>p.screenInfo.size)){var u=p._interactor;return p.selectedTarget=p.getMovableTarget(u.getSubModule("Rect").target),u.setCursor("default"),!0}}}},ke.prototype._42=function(_,T,O){var e=this;e.screenInfo={};var H=e._interactor;H.editDetail||e.gatherInfo(T,O)&&(!H.editing||e.selectedTarget)&&mn.Icons.DrawIcon(H,_,mn.Icons.MoveDummy,e.screenInfo)};var Wp=mn.RotateX=function(h){this.catalog="RotateX",this._interactor=h};Wp.prototype={},Wp.prototype.constructor=Wp,Wp.prototype.gatherInfo=function(u,z){var f=this;if(1===z.length){var d=z[0];return d instanceof Y.Shape&&d._70I()||Yn(d,u)?!1:f.gatherSingleTarget(u,d)}return z.length>1?f.gatherMultiTargets(u,z):!1},Wp.prototype.gatherSingleTarget=function(){var w=new Y.Math.Vector2,q=new Y.Math.Vector2,J=new Y.Math.Vector2,R=new Y.Math.Vector2,S=function(j,w){var K=j.x-w.x,Q=j.y-w.y;return K*K+Q*Q};return function(u,V){if(V.getCorners){var E=this,X=V.getCorners(),W=15,c=V.getPosition();w.copy(X[0]),J.copy(X[1]),R.copy(X[3]),q.copy(w).add(R).divideScalar(2).add(w.sub(J).setLength(W/u.getZoom()));var r=Math.max(S(c,X[0]),S(c,X[1]),S(c,X[2]),S(c,X[3]));return E.info.POS=q.clone(),E.screenInfo.POS=mn.toScreenPosition(u,E.info.POS),E.screenInfo.LEN=Math.sqrt(r)*u.getZoom()+W,E.screenInfo.CENTER=mn.toScreenPosition(u,c),E.target=V,!0}}}(),Wp.prototype.gatherMultiTargets=function(B,H){var D=this,Y=mn.Group.findOrCreateGroup(H);if(!Y)return!1;var D=this;return D.gatherSingleTarget(B,Y)},Wp.prototype.isVisible=function(){var A=this._interactor;if(!A.getStyle("rotateAsClock"))return!1;var m=this.target;if(!m)return!0;var y=A.gv;return y.isEditable(m)&&y.isRotationEditable(m)?!0:!1},Wp.prototype.check=function(e,b,O){var a=this,C=a._checkImpl(e,b,O);return(C||a._clockPainted)&&a._interactor._42(),C},Wp.prototype._checkImpl=function(l,R,Q){if(Y.Default.isLeftButton(R)){var u=this;u.editing=null,u.tipInfo=null;var v;if(u.screenInfo&&(v=u.screenInfo.POS)&&u.isVisible()){var y=u._interactor;if(mn.checkHit(Q,v,y.getStyle("checkSize"))){var q=u.target,X=l.lp(R),a=q.getPosition(),$=Math.atan2(X.y-a.y,X.x-a.x);return y._setRotateCursor($),u.editing={pos:a,rotation:q.getRotation(),hitRot:$,groupRotateMode:"block",screenInfo:{CENTER:u.screenInfo.CENTER,LEN:u.screenInfo.LEN}},!0}}}},Wp.prototype.startEdit=function(h,L){h.startDragging(L),h.fi({kind:"beginEditRotation",event:L}),this.target instanceof mn.Group&&this.target.beginRotate(this.editing)},Wp.prototype._46O=function(Q){var J=this;J.editing&&(J.editing=null,J._interactor.fi({kind:"endEditRotation",event:Q})),J.target instanceof mn.Group&&J.target.endRotate(),J.tipInfo=null},Wp.prototype.handleEdit=function(L,i){var s=this,h=s.editing;if(h){var N,C,P=s.target,S=L.lp(i),b=s._interactor,t=h.pos,v=Math.atan2(S.y-t.y,S.x-t.x),E=P instanceof mn.Group;if(E?C=v-h.hitRot:(N=v-h.hitRot,C=h.rotation+N),C%=2*Math.PI,0>C&&(C+=2*Math.PI),!Y.Default.isCtrlDown(i)){var O,H;Hc(i)?(O=b.getStyle("shiftRotateRound"),H=O/2):(O=b.getStyle("rotateRound"),H=b.getStyle("rotateSensitivity")),C=mn.roundTo(C,O,H)}E?(N=C-(h.lastRotation||0),0!==N&&(P.addRotation(N,h.groupRotateMode,function(h){return L.isRotationEditable(h)}),h.lastRotation=C)):P.setRotation(C),b._setRotateCursor(v),C>Math.PI&&(C-=2*Math.PI);var W=180*(C/Math.PI),Q=""+W.toFixed(2)+"°",u=Y.Default.getLogicalPoint(i,b._canvas);u.x+=mn.Icons.TipShiftX,u.y+=mn.Icons.TipShiftY,s.tipInfo={helperPos:u,text:Q,size:Q.length},b.fi({kind:"betweenEditRotation",event:i})}},Wp.prototype._42=function(v,f,x){var K=this;K._clockPainted=!1,K.info={},K.screenInfo={};var m=K._interactor;m.editDetail||K.gatherInfo(f,x)&&K.isVisible()&&(mn.Icons.DrawIcon(m,v,mn.Icons.RoundPoint,K.screenInfo.POS),K.tipInfo&&mn.Icons.DrawIcon(m,v,mn.Icons.TipHelper,K.tipInfo),K.editing&&K.drawClock(v))},Wp.prototype.drawClock=function(s){s.save();var R=this;R._clockPainted=!0;var n=R.editing||{},m=n.screenInfo||R.screenInfo,o=m.LEN,f=o+8,I=o+18;s.save(),s.translate(m.CENTER.x,m.CENTER.y),s.beginPath(),s.strokeStyle="rgb(150, 150, 150)";for(var V,t,Y,q,u,Z=0;360>Z;Z++)V=Z*Math.PI/180,0===Z%5&&(t=c(V)*o,Y=N(V)*o,q=c(V)*f,u=N(V)*f,s.moveTo(t,Y),s.lineTo(q,u)),0===Z%45&&(t=c(V)*o,Y=N(V)*o,q=c(V)*I,u=N(V)*I,s.moveTo(t,Y),s.lineTo(q,u));s.stroke(),s.rotate(-M);var v=n.lastRotation||R.target.getRotation();s.beginPath(),s.fillStyle="rgba(255, 0, 0, 0.1)",s.strokeStyle="rgb(157, 157, 157)",s.moveTo(0,0),s.arc(0,0,I,0,v,!1),s.fill(),s.beginPath(),s.moveTo(0+I,0),s.arc(0,0,I,0,v,!1),s.stroke(),s.restore()};var rf=mn.Curve=function(Y){this.catalog="Curve",this._interactor=Y};rf.prototype={},rf.prototype.constructor=rf,L.defineProperties(rf.prototype,{activing:{get:function(){return this._activing},set:function(e){var E=this;if(e)E._activing=new mn.CurveActiving(this,e),E._activing._firePointChange();else{var r=E._activing;r&&r.dispose(),E._activing=null}}}}),rf.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},rf.prototype.setUp=function(){var y=this,_=y._interactor;_&&_.gv.mp(y._onGraphviewPropertyChanged,y)},rf.prototype._onGraphviewPropertyChanged=function(b){("zoom"===b.property||"translateX"===b.property||"translateY"===b.property)&&this._handleDataChanged()},rf.prototype.tearDown=function(){var F=this,y=F._interactor;y&&y.gv.ump(F._onGraphviewPropertyChanged,F)},rf.prototype.canEnterEditDetailMode=function(){var f=this,s=f._interactor,v=s._getValidSelection();if(1===v.length){var n=v[0],o=n instanceof Y.Edge;if(n instanceof Y.Shape||o){if(o){var u=n.s("edge.type");if(u&&"points"!==u)return}var U=s.gv;if(U.isPointEditable(n)&&U.isEditable(n))return f.target=n,!0}}},rf.prototype.canQuitEditDetailMode=function(S){var c=this,M=c._interactor._getLogicalPoint(S);return c._checkEditRealPoint(M)?void 0:c._interactor.gv.getDataAt(S)!==c.target?!0:void 0},rf.prototype.preHandleScroll=function(){var D=this.editing;return D&&D.inEdit?!0:void 0},rf.prototype.getCurrentSelectintStatus=function(){var C=this;if(C.activing&&!C.activing.selections){if(C.activing.status!=n)return C.activing.status;var j=function(P){var b=C.activing.status;C.activing.status=P,C._interactor.fp("shapePointStatus",b,P)},q=mn.Curve.PointType,P=C.activing.point,E=C.activing.pairs;if(!E||1!==E.length)return j(q.Mirrored);var Q=E[0],f=Q.c1&&Q.c1.isNearEnough(P),o=Q.c2&&Q.c2.isNearEnough(P);if(!Q.c1||!Q.c2)return f||o?j(q.Straight):j(q.Disconnected);if(f&&o)return j(q.Straight);if(f||o)return j(q.Asymmetric);
var N=Q.c1.clone().sub(P),T=Q.c2.clone().sub(P);return Math.abs(N.x*T.y-N.y*T.x)>1e-5||N.x*T.x>0?j(q.Disconnected):Math.abs(N.length()-T.length())>1e-5?j(q.Asymmetric):j(q.Mirrored)}},rf.prototype.handle_keydown=function(I){var z=this;if(z._interactor.editDetail){var Q=mn.Curve.PointType;"1"===I.key?z._setCurrentSelectionStatus(Q.Straight):"2"===I.key?z._setCurrentSelectionStatus(Q.Mirrored):"3"===I.key?z._setCurrentSelectionStatus(Q.Disconnected):"4"===I.key&&z._setCurrentSelectionStatus(Q.Asymmetric)}},rf.prototype.setCurrentSelectionStatus=function(Q){var s=this,n=s._interactor;if(n){var e=n.gv;e.dm().beginTransaction(),this._setCurrentSelectionStatus(Q),e.dm().endTransaction()}},rf.prototype._setCurrentSelectionStatus=function(g){var e=this,t=e.activing;if(t){var E=e.getCurrentSelectintStatus();if(null!==E&&E!==g){t.status=g;var G=e.activing.point,B=e.activing.pairs;if(B&&1===B.length){var K=B[0],N=e.screenInfo.curve,C=mn.Curve.PointType,W=e._interactor,q=function(){e._writeToHt(),W.fp("shapePointStatus",E,g),e.check(W.gv,null,new mn.Math.Vector2(W._lastLogicalPoint))};if(g===C.Straight)return N.moveCtrlPoint(K,G,"c1"),N.moveCtrlPoint(K,G,"c2"),q(),void 0;if(E===C.Straight){var U=N.findPairs(G,!0),y=U[0],d=y.r1||G,M=y.r2||G,w=M.clone().sub(d).multiplyScalar(.25);return N.moveCtrlPoint(K,G.clone().sub(w),"c1"),N.moveCtrlPoint(K,G.clone().add(w),"c2"),q(),void 0}var J=K.c1,I=K.c2;if(J&&I){if(g===C.Mirrored)return N.moveCtrlPoint(K,G.clone().multiplyScalar(2).sub(I),"c1"),q(),void 0;if(g===C.Asymmetric&&E===C.Disconnected){var _=J.clone().sub(G).length(),w=G.clone().sub(I).setLength(_).add(G);return N.moveCtrlPoint(K,w,"c1"),q(),void 0}}t._firePointChange(),W.fp("shapePointStatus",E,g),e.check(W.gv,null,new mn.Math.Vector2(W._lastLogicalPoint))}}}},rf.prototype._handleDataChanged=function(){var J="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(f){var C=this;if(C.screenInfo&&C.target){if(f&&J.indexOf(f.property)<0)return;var w=C._interactor;C.gatherSingleTarget(w.gv,C.target,!0),C.check(w.gv,null,new mn.Math.Vector2(w._lastLogicalPoint)),w._42()}}}(),rf.prototype.gatherSingleTarget=function(m,X,l){var S,T,N=this;N.screenInfo&&N.screenInfo.curve&&(T=N.screenInfo.curve._curves);var G=N.editing;S=G?N.screenInfo:N.screenInfo={};var e,y,M=X instanceof Y.Edge;M?(e=X.s("edge.segments"),y=X.s("edge.points")||new Y.List):(e=X._58O,y=X._59O),S.S=e;var g,a=S.P=[],V=mn.getDataMatrix(X);if(X instanceof Y.Polyline||X instanceof Y.Edge&&N._interactor.getStyle("edgeElevationEditable"))g=X.getElevation&&X.getElevation()||0,S.E=[];else{var t=!1;y.each(function(b){b.e!==n&&(t=!0)}),t&&(S.E=[])}if(y.each(function(L){S.E&&S.E.push(L.e!=n?L.e:g),L=V.apply(L);var w=mn.toScreenPosition(m,L);a.push(w.x,w.y)}),M){var F=a.length,J=mn.toScreenPosition(m,X._lastSourcePoint||(F?{x:a[0],y:a[1]}:{x:0,y:0})),q=mn.toScreenPosition(m,X._lastTargetPoint||(F?{x:a[F-2],y:a[F-1]}:{x:0,y:0}));a.splice(0,0,J.x,J.y),a.push(q.x,q.y),S.E&&(S.E.splice(0,0,"head"),S.E.push("tail"))}if(!S.S||!S.S.size()){S.S=new Y.List,S.S.add(1);for(var o=0;o<a.length/2-1;o++)S.S.add(2)}if((!G||l)&&N.convertToCubicBezier(T),N.activing&&(l||!N.editing||"realPoint"===N.editing.type)){var d=S.curve.findPairs(N.activing.point);N.activing.pairs=d}},rf.prototype._convertToNewPoint=function(c,E,b,z){var W,A,m;for(W=0,A=E.length;A>W;W++){if(m=E[W],m._p1.isNearEnough(c)&&(!z||z.indexOf(m._p1)<0))return m._p1;if(m._p4.isNearEnough(c)&&(!z||z.indexOf(m._p4)<0))return m._p4}if(b)for(W=0,A=Math.min(b.length,A);A>W;W++){if(m=b[W],m._p1===c&&(!z||z.indexOf(E[W]._p1)<0))return E[W]._p1;if(m._p4===c&&(!z||z.indexOf(E[W]._p4)<0))return E[W]._p4}},rf.prototype.convertToCubicBezier=function(p){var L,t,M=this,A=new mn.Math.Curve,m=M.screenInfo;if(A.createFromHtShape(m.P,m.S,m.E),m.curve=A,M.activing){var k=A._curves;L=M.activing.point,t=M._convertToNewPoint(L,k,p);var C=[];if(t&&(M.activing.point=t,C.push(t)),M.activing.selections){var q=-1,r=M.activing.selections;r.forEach(function(d){q++,t=M._convertToNewPoint(d,k,p,C),t&&(r[q]=t,C.push(t))})}}},rf.prototype.check=function(k,o,X){if(!o||mg(o)||Bq(o)){var e=this;if(e._interactor.setCursor("default"),e.editing=null,e.highlight=null,e.tipInfo=null,e.edgeEditResult=null,e.screenInfo){if(ym()||o&&Bq(o))return e._interactor._42(),!0;if(e._checkEditCtrlPoint(X))return e._interactor._42(),!0;if(e._checkEditRealPoint(X))return e._interactor._42(),!0;if(e._checkEditElevation(X))return e._interactor._42(),!0;var U=e.screenInfo.curve,G=U.checkPoint(X,e._interactor.getStyle("curveIntersectSize"));if(G){var M=e.highlight={};M.type="insertKnot",M.bezier=G.bezier,M.point=G.intersection}return e._interactor._42(),!0}}},rf.prototype._checkEditRealPoint=function(S){var w,h,H,P,B,e,u=this,$=u.screenInfo.curve._curves,Z=u._interactor.getStyle("curvePointIntersectSize"),R=1/0;for(Z*=Z,H=0,P=$.length;P>H;H++)w=$[H],B=w._p1,e=S.distanceToSquared(B),R>e&&(R=e,h=B),B=w._p4,e=S.distanceToSquared(B),R>e&&(R=e,h=B);if(R>Z)return!1;var _=u.highlight={};return _.type="changeRealPoint",_.point=h,u.editing={type:"realPoint",point:h,shiftGuide:{point:h.clone(),dir:"x",limit:0}},u._interactor.setCursor("crosshair"),!0},rf.prototype._checkEditElevation=function(h){var v=this;if(!v._interactor.getStyle("curveElevationVisible"))return!1;var N=v.target;if(N instanceof Y.Edge&&!v._interactor.getStyle("edgeElevationEditable"))return!1;var t=v.activing;if(!t)return!1;var j=t.getCurrentEditingPoint();if(!j)return!1;var F=v._interactor,Q=F.getStyle("curveElevationGuideShift"),B=F.getStyle("curveElevationIntersectSize"),T=h.distanceToSquared({x:j.x+Q[0],y:j.y+Q[1]});if(!(T>B*B)){var H=v.highlight={};H.type="elevation";var R=new mn.Math.Vector2(h.x,h.y,j.e);return v.editing={type:"elevation",startPoint:R},v._interactor.setCursor("crosshair"),!0}},rf.prototype._checkEditCtrlPoint=function($){var c=this;if(c.activing&&!c.activing.selections){var j=c.getCurrentSelectintStatus();if(j!==mn.Curve.PointType.Straight){var P=c.activing.pairs;if(P){var U=c._interactor.getStyle("curvePointIntersectSize");U*=U;var k,y,R,Y,M,T,O,K,d,t=1/0;for(O=0,d=P.length;d>O;O++)for(Y=P[O],K=0;2>K;K++)M=0===K?"c1":"c2",Y[M]&&(T=$.distanceToSquared(Y[M]),t>T&&(t=T,k=Y,y=O,R=M));if(t>U)return!1;c.activing.hlpair=k,c.activing.hltype=R;var v=c.highlight={};return v.type="changeCtrlPoint",v.point=k[R],c.editing={type:"ctrlPoint",pair:k,pairId:y,ctrlType:R,direction:k[R].clone().sub(c.activing.point).normalize()},c._interactor.setCursor("crosshair"),!0}}}},rf.prototype.startEdit=function(B,u){B.startDragging(u);var R=this;R.highlight&&"insertKnot"===R.highlight.type&&(R.insertKnot(),R.gatherSingleTarget(R._interactor.gv,R.target),R.activing=null,R._checkEditRealPoint(R._interactor._getLogicalPoint(u)));var c=R._activing;if(c){var f=R.editing?R.editing.type:null;"ctrlPoint"===f?c.editingCtrl={pairId:R.editing.pairId,type:c.hltype}:"realPoint"===f&&(c.editingCtrl=!1)}var j=R.highlight,y=Y.Default.isCtrlDown(u);if(!j||ym()||Bq(u)){var o=R._interactor.gv;if(!o.setFocus(u)||o._scrolling)return;return y?R._multiSelect={startPoint:o.lp(u)}:o.isPannable()&&(mg(u)||Bq(u))&&(R._pan={tx:o.tx(),ty:o.ty()},B.fi({kind:"beginPan",event:u})),void 0}if("changeRealPoint"===j.type){var I,M=R.activing?R.activing.point:null,n=R.activing?R.activing.selections:null;if(y&&R.activing)M===j.point?(n?(R.activing={point:n[0]},n.length>1&&(n.splice(0,1),R.activing.selections=n)):R.activing=null,R.editing=null):n&&(I=n.indexOf(j.point))>=0?(n.length>1?n.splice(I,1):delete R.activing.selections,R.editing=null):n?(n.push(M),R.activing={point:j.point,selections:n}):R.activing={point:j.point,selections:[M]};else if(n)M===j.point||((I=n.indexOf(j.point))>=0?(n.splice(I,1,M),R.activing={point:j.point,selections:n}):R.activing={point:j.point});else{var N;M===j.point&&(N=R.activing.status),R.activing={point:j.point},N&&(R.activing.status=N)}B.fi({kind:"beginEditPoint",event:u})}},rf.prototype.insertKnot=function(){var S=this,b=S.highlight,F=S.screenInfo.curve;F.insertKnot(b.bezier,b.point.t),S._writeToHt()},rf.prototype._writeToHt=function(){var A,a,Q=this,Z=Q.screenInfo.curve,j=Z.toHtShape(),V=j.points,w=[],L=j.segments,J=Q._interactor.gv;J.dm().beginTransaction();var c,B,e=Q.target,q=e instanceof Y.Edge,s=mn.getDataMatrix(e).invert();B=e instanceof Y.Polyline||e instanceof Y.Edge&&Q._interactor.getStyle("edgeElevationEditable"),B&&(c=e.getElevation&&e.getElevation()||0);for(var O=0,l=V.length;l>O;O++)A=V[O],a=mn.toWorldPosition(J,A),a=s.apply(a),isFinite(A.e)&&A.e!==c&&(a.e=A.e),w.push(a);if(e._writing=!0,q){e.s("edge.type","points"),e.setStyle("edge.segments",L),e.setStyle("edge.points",w.slice(1,w.length-1)),e.setStyle("edge.source.offset.x",0),e.setStyle("edge.source.offset.y",0),e.setStyle("edge.target.offset.x",0),e.setStyle("edge.target.offset.y",0);var y=Q._nextChangeEdgeHost;delete Q._nextChangeEdgeHost,y&&("source"===y.type?e.setSource(y.host):e.setTarget(y.host)),Q._writeEdgeHostAnchor("source",w[0]),Q._writeEdgeHostAnchor("target",w[w.length-1])}else w.length?(e.setSegments(L),e.setPoints(w,!0)):e.removeFromDataModel();J.dm().endTransaction(),delete e._writing},rf.prototype._writeEdgeHostAnchor=function(R,k){var p=this,u=p.target,j=p._calcHostAnchor(u,R,k);j.index!==n?(u.setStyle("edge."+R+".index",j.index),u.setStyle("edge."+R+".percent",n),u.setStyle("edge."+R+".anchor.x",n),u.setStyle("edge."+R+".anchor.y",n)):j.percent!==n?(u.setStyle("edge."+R+".percent",j.percent),u.setStyle("edge."+R+".index",n),u.setStyle("edge."+R+".anchor.x",n),u.setStyle("edge."+R+".anchor.y",n)):(u.s("edge."+R+".anchor.x",j.x),u.s("edge."+R+".anchor.y",j.y),j.offsetX||j.offsetY?(u.s("edge."+R+".offset.x",j.offsetX),u.s("edge."+R+".offset.y",j.offsetY)):(u.s("edge."+R+".offset.x",0),u.s("edge."+R+".offset.y",0)))},rf.prototype._calcHostAnchor=function(W,p,Z,h){h||(h="source"===p?W.getSource():W.getTarget());var y=this._interactor.gv,u=y.calculateAttachPoint(h,Z);if(u)return u.info;if(_n(h)){var X=y.calculateEdgePosition(h,Z);return X}var k=h.getRotation(),q=h.getAnchor();Yn(h,y)&&(k=0);var w=h.getScale();if(k||w.x<0||w.y<0){var c=h.getMatrix(),Y=c.tfi(Z),o=h.getSize();return{x:Y.x/o.width+q.x,y:Y.y/o.height+q.y}}var P=Hq(y,h),a={x:(Z.x-P.x)/P.width,y:(Z.y-P.y)/P.height};return a},rf.prototype._handlePanning=function(F){var o=this,v=o._pan;if(v){v.started=!0;var x=o._interactor,d=x.gv,b=x._lastClientPoint,W=up(F),q=xf(d,W,b);d.setTranslate(v.tx+q.x,v.ty+q.y),o.gatherSingleTarget(x.gv,o.target),x._42(),x.fi({kind:"betweenPan",event:F})}},rf.prototype.handleEdit=function(G,V){var a=this,m=a.editing;if(a._pan)return a._handlePanning(V),void 0;if(a._multiSelect)return a._multiSelect.endPoint=G.lp(V),a._interactor.redraw(),void 0;if(m){m.inEdit=!0;var q,l,i,D=a._interactor._getLogicalPoint(V),s=Y.Default.isCtrlDown(V),c=Y.Default.isShiftDown(V),F=m.type,$=a.activing;if(a._guideInfo=null,"ctrlPoint"===F&&c){var P=a.editing.direction.clone();q=$.point;var O=P.dot(D.clone().sub(q));D=P.setLength(O).add(q)}else if("ctrlPoint"===F||"realPoint"===F){var P;if("realPoint"===F&&c){var J=a.editing.shiftGuide;l=J.point;var y=Math.abs(D.x-l.x),u=Math.abs(D.y-l.y);y>u&&y>J.limit&&"y"===J.dir&&(J.dir="x"),u>y&&u>J.limit&&"x"===J.dir&&(J.dir="y"),P=J.dir,"x"===P?(D.y=l.y,J.limit=Math.max(J.limit,y)):"y"===P&&(D.x=l.x,J.limit=Math.max(J.limit,u))}var A=a._isEditEdgeSourceTarget();if(A){var t=a._editEdgeSourceTarget(A,D,s);t&&(a.edgeEditResult=t,i=t.tipText)}else if(!s){var M=a._guidingToEdit(D,P),Z="realPoint"===F?a._interactor.gridGuide.findClosest(D,P,!0):null,K=1/0,X=1/0;Z&&(Z.x&&(K=Z.x),Z.y&&(X=Z.y));var I=!1;M&&(M.xList&&(Math.abs(M.x)<=Math.abs(K)?(I=!0,K=M.x):delete M.xList),M.yList&&(Math.abs(M.y)<=Math.abs(X)?(I=!0,X=M.y):delete M.yList),I&&(a._guideInfo=M)),isFinite(K)&&(D.x+=K),isFinite(X)&&(D.y+=X),I&&(M.v=D)}}var E=a.screenInfo.curve;if("realPoint"===m.type){q=m.point,q.e!==n&&(D.e=q.e),E.moveRealPoint(q,D),m.point=D,a.highlight.point=D;var w=$.status,k=$.selections;if(a.activing={point:D,status:w},k){var b=D.clone().sub(q),z=0;k.forEach(function(G){var p=G.clone().add(b);E.moveRealPoint(G,p),k[z++]=p}),a.activing.selections=k}}else if("ctrlPoint"===m.type){var o=$.pairs,N=o[m.pairId];E.moveCtrlPoint(N,D,m.ctrlType);var R=$.status,g=mn.Curve.PointType;if((R===g.Mirrored||R===g.Asymmetric)&&N.c1&&N.c2){var q=new mn.Math.Vector2($.point),Q="c1"===m.ctrlType?"c2":"c1";if(R===mn.Curve.PointType.Mirrored)E.moveCtrlPoint(N,q.clone().multiplyScalar(2).sub(D),Q);else if(R===g.Asymmetric){var O=N[Q].clone().sub(q).length(),H=q.clone().sub(N[m.ctrlType]).setLength(O).add(q);isNaN(H.x)||E.moveCtrlPoint(N,H,Q)}}$._firePointChange()}else if("elevation"===m.type){l=m.startPoint;var x=l.e+(l.y-D.y)/G._zoom;a._setCurrentPointImpl("e",x),$._firePointChange(),i="E: "+mn.toFixed(x)}var j=Y.Default.getLogicalPoint(V,a._interactor._canvas);if(j.x+=mn.Icons.TipShiftX,j.y+=mn.Icons.TipShiftY,!i){var v=mn.toWorldPosition(G,D);i=""+mn.toFixed(v.x)+", "+mn.toFixed(v.y)}a.tipInfo={helperPos:j,text:i,size:i.length},a._writeToHt(),a._interactor.fi({kind:"betweenEditPoint",event:V})}},rf.prototype._setCurrentPointImpl=function(d,U){var Y=this,b=Y._activing;if(!b)return!1;var T=Y.target;if(!T)return!1;var k=b.getCurrentEditingPoint();if(!k)return!1;var A=b.editingCtrl;if(!A)var D=k.clone();if("e"===d)k.e=U;else{var i;if("x"===d||"y"===d){var X=b._lastFirePoint;i="x"===d?{x:U,y:X?X.y:0}:{x:X?X.x:0,y:U}}else"object"==typeof d?(i=d,d.e!==n&&(k.e=d.e)):(i={x:arguments[0],y:arguments[1]},arguments[2]!==n&&(k.e=arguments[2]));var a=mn.getDataMatrix(T);i=mn.toScreenPosition(Y._interactor.gv,a.apply(i)),k.x=i.x,k.y=i.y}if(!A){var L=D.multiplyScalar(-1).add(k);k.e&&D.e&&(L.e=k.e-D.e);var r=Y.screenInfo.curve;r.moveCtrlDueToRealPointMovement(k,L);var S=b.selections;if(S){var K=0;S.forEach(function(m){var q=m.clone().add(L);isFinite(L.e)&&(q.e=(isFinite(m.e)?m.e:T.getElevation()||0)+L.e),r.moveRealPoint(m,q),S[K++]=q}),b.selections=S}}return!0},rf.prototype.setCurrentPoint=function(g,J){return this._setCurrentPointImpl(g,J)?(this._writeToHt(),!0):!1},rf.prototype._isEditEdgeSourceTarget=function(){var p=this,t=p.target;if(!(t instanceof Y.Edge))return!1;var R=p.editing.point,H=p.screenInfo.curve._curves;return R===H[0]._p1?"source":R===H[H.length-1]._p4?"target":!1},rf.prototype._editEdgeSourceTarget=function(x,v,I){var G,l=this,N=l.target;if(G="source"===x?N.getSource():N.getTarget()){var r,f=l._interactor.gv,H=mn.toWorldPosition(f,v),B=l._calcHostAnchor(N,x,H,G);if(r=B.index!==n||B.percent!==n?B.distance*f.getZoom()>l._interactor.getStyle("edgeHostEdgeMaxDistance"):l._interactor.getStyle("edgeHostDetectPerFrame")?!0:B.x<0||B.x>1||B.y<0||B.y>1?!0:!1){var p=f.getDataAt(H,function(w){return f.isSelectable(w)?f.isSourceTargetEditable(N,w,x)?N.canSetSourceTarget(w,x)?!0:!1:!1:!1});if(p){var z=l._calcHostAnchor(N,x,H,p);G=p,l._nextChangeEdgeHost={type:x,host:p},B=z}}var M,A,O;if(I||B.x===n)(B.percent!==n||B.index!==n)&&(A=B.point);else{var s=l._interactor.getStyle("anchorRound"),d=l._interactor.getStyle("anchorSensitivity");M=f.calculateAttachPoint(G,H),M?B=M.info:(B.x=mn.roundTo(B.x,s,d),B.y=mn.roundTo(B.y,s,d)),A=xn(f,G,0,B.offsetX||0,B.offsetY||0,B.x,B.y)}A&&(O=mn.toScreenPosition(f,A),v.x=O.x,v.y=O.y),l._edgeHostGuideInfo={corners:mn.getTargetCornersOnScreen(f,G),attach:M?M.index:-1,host:G};var e;return B.percent!==n?e="percent: "+B.percent.toFixed(2):B.index!==n?e="index: "+B.index:(e=""+B.x.toFixed(2)+", "+B.y.toFixed(2),(B.offsetX||B.offsetY)&&(e+=" offset: "+B.offsetX.toFixed(2)+", "+B.offsetY.toFixed(2))),{host:G,anchor:B,tipText:e}}},rf.prototype._guidingToEdit=function(q,X){var _,K,o=this;if(_=o.screenInfo.curve){K=_._curves;var N,l,t,T,H,v,f,w,k=1/0,n=1/0,u=[];for(o.editing&&"realPoint"===o.editing.type&&(w=o.editing.point),H=0,v=2*K.length;v>H;H++)f=K[Math.floor(H/2)][H%2?"_p4":"_p1"],u.indexOf(f)>=0||(u.push(f),w&&w===f||(t=f.x-q.x,T=f.y-q.y,Math.abs(t)<Math.abs(k)?(k=t,N=[f]):t===k&&N.push(f),Math.abs(T)<Math.abs(n)?(n=T,l=[f]):T===n&&l.push(f)));var E=o._interactor.getStyle("smartGuideThreshold");if((Math.abs(k)>E||"y"===X)&&(N=null),(Math.abs(n)>E||"x"===X)&&(l=null),N||l){var s=!1,C={};if(N&&(s=!0,C.xList=N,C.x=k),l&&(s=!0,C.yList=l,C.y=n),s)return C}}},rf.prototype._46O=function(O){var Y=this;Y.editing&&(Y.editing=null,Y._interactor.fi({kind:"endEditPoint",event:O})),Y._guideInfo=null,Y._edgeHostGuideInfo=null,Y._pan&&(Y._pan=null,Y._interactor.fi({kind:"endPan",event:O})),Y._multiSelect&&(Y._handleMultiSelect(Y._multiSelect),Y._multiSelect=null),Y.tipInfo=null,Y.edgeEditResult=null},rf.prototype._handleMultiSelect=function(U){if(U.startPoint&&U.endPoint){var c,v,B,a,Q,P=this,k=P._interactor,u=k.gv,L=mn.toScreenPosition(u,U.startPoint),h=mn.toScreenPosition(u,U.endPoint),x=Y.Default.unionPoint(L,h),T=P.screenInfo.curve._curves,m=[],C=function(j){j.x>=x.x&&j.y>=x.y&&j.x<=x.x+x.width&&j.y<=x.y+x.height&&m.indexOf(j)<0&&m.push(j)};for(c=0,v=T.length;v>c;c++)Q=T[c],C(Q._p1),C(Q._p4);if(m.length){var E=P.activing||{},d=E.selections||[];for(E.point&&d.push(E.point),c=0,v=d.length;v>c;c++)B=d[c],a=m.indexOf(B),a>=0?m[a]=n:m.push(B);var H=m;for(m=[],c=0,v=H.length;v>c;c++)H[c]&&m.push(H[c]);v=m.length,0===v?P.activing=null:1===v?P.activing={point:m[0]}:(B=m[v-1],P.activing={point:B,selections:m.splice(0,v-1)}),k.redraw()}}},rf.prototype._canDeletePoint=function(s,u){var H=this.target;if(!(H instanceof Y.Edge))return!0;var U=s._curves[0],f=s._curves[s._curves.length-1];return U._p1===u||f._p4===u?!1:!0},rf.prototype.handleDelete=function(){var q=this;if(q.activing&&q.screenInfo){var l=Y.Default.isShiftDown(),V=q.screenInfo.curve;q._canDeletePoint(V,q.activing.point)&&V.deleteRealPoint(q.activing.point,l),q.activing.selections&&q.activing.selections.forEach(function(Y){q._canDeletePoint(V,Y)&&V.deleteRealPoint(Y,l)}),q.activing=null,delete q.editing,delete q.tipInfo,delete q.edgeEditResult,delete q._pan,delete q._multiSelect,q._writeToHt(),q._interactor.fp("deleteShapePoint",!1,!0)}},rf.prototype.handleDoubleClick=function(E){var Z=this,$=Z._interactor._getLogicalPoint(E);if(Z.screenInfo&&Z._checkEditRealPoint($)){var g=Z.getCurrentSelectintStatus(),N=mn.Curve.PointType;return g=g===N.Mirrored?N.Straight:N.Mirrored,Z._setCurrentSelectionStatus(g),Z._interactor._42(),!0}},rf.prototype._drawHighlight=function(r){var $=this,B=$.highlight;if(B){var x=B.bezier,n=$._interactor;x&&mn.Icons.DrawIcon(n,r,mn.Icons.ShapeHighlightCurve,[x._p1.x,x._p1.y,x._p2.x,x._p2.y,x._p3.x,x._p3.y,x._p4.x,x._p4.y]);var I=B.point;I&&"insertKnot"===B.type&&mn.Icons.DrawIcon(n,r,mn.Icons.ShapeHighlighPoint,I)}},rf.prototype._drawGuide=function(a){var w=this,i=w._guideInfo;if(i){var p,L,q,C,e=i.v;for(p=0;2>p;p++)if(C=0===p?i.xList:i.yList)for(L=0,q=C.length;q>L;L++)mn.Icons.DrawIcon(w._interactor,a,mn.Icons.ShapeGuideLine,[e.x,e.y,C[L].x,C[L].y])}},rf.prototype._drawCurrentPoint=function(r){var K=this;if(K.activing){var U=K.activing,l=K.getCurrentSelectintStatus(),I=K._interactor;if(l!==mn.Curve.PointType.Straight){var m=U.pairs;U.hlpair,U.hltype;var s=U.selections,V=U.editingCtrl;if(m&&!s){var z,x,W;for(x=0,W=m.length;W>x;x++)z=m[x],V&&x===V.pairId&&z[V.type]?mn.Icons.DrawIcon(I,r,mn.Icons.ShapeActivingCtrl,{point:z.point,c1:z.c1,c2:z.c2,hl:V.type}):mn.Icons.DrawIcon(I,r,mn.Icons.ShapeActivingCtrl,z)}}mn.Icons.DrawIcon(I,r,mn.Icons.ShapeHighlighRealPoint,K.activing.point),s&&s.forEach(function(w){mn.Icons.DrawIcon(I,r,mn.Icons.ShapeHighlighRealPoint,w)})}},rf.prototype.clear=function(){var S=this;S.editing=null,S._guideInfo=null,S.activing=null,S.highlight=null},rf.prototype._42=function(o){var f=this;f.info={},f.editing||(f.screenInfo=null);var j=f._interactor;if(!j.editDetail)return f.clear(),void 0;var Z=j.gv;if(!f.target||!Z.isSelected(f.target)||!Z.isVisible(f.target))return j.editDetail=!1,f.clear(),void 0;if(f.gatherSingleTarget(Z,f.target),mn.Icons.DrawIcon(j,o,mn.Icons.ShapeBgCurve,f.screenInfo),f._interactor.getStyle("curveElevationVisible")&&(f.target instanceof Y.Polyline||f.target instanceof Y.Edge&&f._interactor.getStyle("edgeElevationEditable"))&&f.activing){var B=f.activing.getCurrentEditingPoint();B&&"string"!=typeof B.e&&mn.Icons.DrawIcon(j,o,mn.Icons.EdgeElevationGuide,B)}if(f._drawHighlight(o),f._drawCurrentPoint(o),f._getRealPoint().forEach(function(H){mn.Icons.DrawIcon(j,o,mn.Icons.ShapePoint,H)}),f._drawGuide(o),f.tipInfo&&f._interactor.getStyle("curveTipVisible")&&mn.Icons.DrawIcon(j,o,mn.Icons.TipHelper,f.tipInfo),f._edgeHostGuideInfo&&j._drawHostGuide(f._edgeHostGuideInfo),f.edgeEditResult&&f._drawEdgeHostHighlight(o,f.edgeEditResult.host,f.edgeEditResult.anchor),f._multiSelect&&f._multiSelect.endPoint){var D=Y.Default.unionPoint(mn.toScreenPosition(Z,f._multiSelect.startPoint),mn.toScreenPosition(Z,f._multiSelect.endPoint));D.color=Z.getRectSelectBorderColor(),o.save(),o.setTransform(1,0,0,1,0,0);var y=m.devicePixelRatio,K=D.borderWidth=Math.round(y);K/=2,D.x=Math.round(D.x*y)+K,D.y=Math.round(D.y*y)+K,D.width=Math.round(D.width*y),D.height=Math.round(D.height*y),mn.Icons.DrawIcon(j,o,mn.Icons.SimpleRect,D),o.restore()}},rf.prototype._drawEdgeHostHighlight=function(e,J,s){this.drawEdgeHostHighlight(e,J,s),this._interactor.redraw()},rf.prototype.drawEdgeHostHighlight=function(s,A,b){if(_n(A)){var U,e,l,H,S=this,o=S._interactor,G=o.gv,t=G.getDataUI(A),m=td(t),F=[];for(l=0,H=m.points.length;H>l;l++)e=mn.toScreenPosition(G,m.points.get(l)),F.push(e.x,e.y);m.segments&&(U=m.segments.toArray());var g=o.getStyle("edgeHostHighlighPeriod"),E=o.getStyle("edgeHostEdgeHighlighColor");mn.Icons.DrawIcon(o,s,mn.Icons.ShapeBgCurve,{P:F,S:U,color:E,dynamicVisible:b.index===n,dynamicPeriod:g}),E=o.getStyle("edgeHostPointHighlighColor");var P=us(t);for(l=0,H=P.length;H>l;l++){var h=P[l],y=mn.toScreenPosition(G,h);mn.Icons.DrawIcon(o,s,mn.Icons.ShapePoint,{point:{x:y.x,y:y.y},color:E,size:12,dynamicVisible:l===b.index,dynamicPeriod:g})}}},rf.prototype._getRealPoint=function(){var Y,f=this.screenInfo,q=f.P,p=f.S,N=-1,$=[],v=-1,e=p.length;return p.each(function(I){v++;var m=1;if(3===I)m=2;else if(4===I)m=3;else if(5===I)return;N+=m,Y=v+1>=e?!0:1===p.get(v+1)?!0:!1,$.push({point:{x:q[2*N],y:q[2*N+1]},segmentIndex:v,pointIndex:N,isEnd:Y})}),$},rf.prototype.getEditingPointsInfo=function(k){var G=this,q=G.activing;if(!q)return!1;var a=q.point;if(!a)return!1;var z=this._getRealPoint(),w=[{screen:a}];q.selections&&q.selections.forEach(function(O){w.push({screen:O})});var S,W,c=z.length;return w.forEach(function(Q){for(S=0;c>S;S++)if(W=z[S],Q.screen.isNearEnough(W.point)){Q.segmentIndex=W.segmentIndex,Q.pointIndex=W.pointIndex,Q.point=G.target.getPoints().get(W.pointIndex);break}}),k&&w.sort(function(K,O){return K.segmentIndex-O.segmentIndex}),w};var Bo=mn.MoveHelper=function(X){var q=this;q.catalog="Move",q._interactor=X};Bo.prototype={},Bo.prototype.constructor=Bo,Bo.prototype.calcShift=function(w,v,W){var $,P,q=this,z=q._interactor.gv,J=z.lp(v);if("beginMove"===w&&q._gatherGridInfo(W._lastLogicalPoint||J),$=q._target){var d=$.downPosition;if(d){var l=q._interactor.getStyle("moveSensitivity")/z._zoom;if(d.distanceTo(J)<l)return{x:0,y:0};delete $.downPosition}var t;P=Y.Default.isShiftDown(v),P&&(J=q._dealShiftDown(J),t=$.shiftGuide.dir);var U,C=$.rawPos={x:$.pos.x+J.x-$.lp.x,y:$.pos.y+J.y-$.lp.y};if(Y.Default.isCtrlDown(v)){if(U=q._calcShiftByAddon(),q._target.node instanceof mn.Group){var h=q._target.node;h._position.x+=U.x,h._position.y+=U.y}return U}var B=q._interactor.rectGuide;if($.node instanceof Y.Data&&$.node.s("2d.attachable")){var x=q._calcAttachNodeShift($.node,C);if(B.clear(),x)return x}for(var j,u=$.x+C.x,y=$.y+C.y,X={x:u,y:y},i={x:u+$.w/2,y:y+$.h/2},R={x:u+$.w,y:y+$.h},b=q._interactor.gridGuide,c=[B.findClosest(X,t),B.findClosest(i,t),B.findClosest(R,t),b.findClosest(X,t),b.findClosest(i,t),b.findClosest(R,t)],p=1/0,F=1/0,K=0,e=c.length;e>K;K++)j=c[K],j&&(u=j.x,y=j.y,isFinite(u)&&Math.abs(u)<Math.abs(p)&&(p=u),isFinite(y)&&Math.abs(y)<Math.abs(F)&&(F=y));if(isFinite(p)||(p=0),isFinite(F)||(F=0),U=q._calcShiftByAddon(p,F),q._target.node instanceof mn.Group){var h=q._target.node;h._position.x+=U.x,h._position.y+=U.y}var m=$.node;if(!Yn(m,z)){var Q=C.x+p,g=C.y+F;q._interactor.rectGuide.gatherLines({node:m,x:$.x+Q,y:$.y+g,w:$.w,h:$.h},t)}return U}},Bo.prototype._calcShiftByAddon=function(M,x){var U=this._target,S=U.rawPos,R=U.node.getPosition();return M=M||0,x=x||0,{x:S.x-R.x+M,y:S.y-R.y+x}},Bo.prototype._dealShiftDown=function(_){var i=this,u=i._target.shiftGuide,U=i._target.lp,C=Math.abs(_.x-U.x),X=Math.abs(_.y-U.y);C>X&&C>u.limit&&"y"===u.dir&&(u.dir="x"),X>C&&X>u.limit&&"x"===u.dir&&(u.dir="y");var D=u.dir;return"x"===D?(_.y=U.y,u.limit=Math.max(u.limit,C)):"y"===D&&(_.x=U.x,u.limit=Math.max(u.limit,X)),_},Bo.prototype._isAttachableLineShape=function(V){if(!V.getSegments)return!1;var a=V.getSegments();if(!a)return!0;a instanceof Y.List&&(a=a.getArray());for(var L=1,D=a.length;D>L;L++)if(2!==a[L])return!1;return!0},Bo.prototype._calcAttachNodeShift=function(){var o=new _h,m=new _h,X=new _h,r=new _h;return function(q,i){var h=this._interactor.gv,A=q.getHost(),$=h.getDataAt(i,function(v){return v.s("2d.hostable")?!0:!1});if($&&A!==$&&q.setHost($),!$)return this._edgeHostGuideInfo=null,q.setHost(null);var p=this._edgeHostGuideInfo={corners:mn.getTargetCornersOnScreen(h,$),host:$,attach:-1};if(this._isAttachableLineShape($)){for(var u,x,L,j,R,M,_=$.getPoints(),Q=_.size(),K=$.getPointsMatrix2d(),B=1/0,d=0;Q>d&&(d!==Q-1||$.isClosePath());d++)0!==d?m.copy(X):K.apply(_.get(d),m),K.apply(d===Q-1?_.get(0):_.get(d+1),X),o.copy(i).sub(m),r.copy(X).sub(m),u=r.length(),r.divideScalar(u),x=o.dot(r),0>x?x=0:x>u&&(x=u),r.multiplyScalar(x).add(m),L=o.copy(i).sub(r).lengthSq(),B>L&&(B=L,M=d,j=x,R=u);return Math.sqrt(B)*h.getZoom()>this._interactor.getStyle("attachThreshold")?(q.s({"attach.index":-1}),q.setHost(null),void 0):(q.s("attach.offset.opposite")&&(j=R-j),q.s({"attach.index":M,"attach.offset":q.s("attach.offset.relative")?j/R:j}),{x:0,y:0})}var v=h.calculateAttachPoint($,i);if(v){var H=v.point;return p.attach=v.index,this._calcShiftByAddon(H.x-i.x,H.y-i.y)}}}(),Bo.prototype._gatherGridInfo=function(W){var H,w=this,C=w._interactor,h=C._getValidSelection();if(h.length){if(1===h.length){if(H=h[0],!H.getRect)return w._target=null,void 0}else if(H=mn.Group.findOrCreateGroup(h),!H)return w._target=null,void 0}else{var h=C.gv.sm().getSelection();if(h.length&&(H=h.get(0),!H.getRect))return w._target=null,void 0}if(H){var o=H.getPosition(),Y=H.getRect();w._target={node:H,x:Y.x-o.x,y:Y.y-o.y,w:Y.width,h:Y.height,lp:{x:W.x,y:W.y},pos:{x:o.x,y:o.y},shiftGuide:{dir:"x",limit:0},downPosition:new mn.Math.Vector2(W)},C.rectGuide.gatherRects()}},Bo.prototype.clear=function(){var j=this;j._edgeHostGuideInfo=null,j._interactor.rectGuide.clear(),j._interactor._42()},Bo.prototype._42=function(){var I=this._edgeHostGuideInfo;I&&this._interactor._drawHostGuide(I)};var ql="directional",_c="point",Sj="spot",Gn="light.color",Jp={},ig=function(e,s){xh(s)&&Gm.test(s)?ro(e,s):Xj(s)&&s.modelType?lf(e,s):s===n?delete pf[e]:pf[e]=s},ph=function(d){return d},Xi=function(x){x=j.convertShape3dModelName(x);var C;if(Xj(x)){if(x.modelType){if(x.uuid){if(C=pf[x.uuid])return C}else x.uuid=Y.Math.generateUUID();return C===n&&(Wd&&Wd[x.uuid]||lf(x.uuid,x)),n}return x}return C=pf[x],x&&C===n&&Gm.test(x)&&(Wd&&Wd[x]||ro(x,x)),C},gm=function(c,N){c.frameStack?c.frameStack.push(N):c.frameStack=[N],c.bindFramebuffer(c.FRAMEBUFFER,N)},Se=function(W){var z=W.frameStack;if(z){if(z.pop(),z.length)return W.bindFramebuffer(W.FRAMEBUFFER,z[z.length-1]),void 0;W.frameStack=null}W.bindFramebuffer(W.FRAMEBUFFER,null)};Dq(j,{graph3dViewAttributes:O,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:t/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:kh,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:t,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:t/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:ig,getShape3dModel:Xi,convertShape3dModelName:ph,getShape3dModelMap:function(){return pf},getCachedShape3dModelMap:function(){return mq},createMatrix:function(R,B){Hr(R)||(R=[R]);for(var y=R.length-1;y>=0;y--){var a=R[y];B=Dn(a.mat,a.s3,a.r3,a.rotationMode,a.t3,B)}return B},transformVec:function(l,h){return $i(l,h)},glBindFrame:gm,glUnbindFrame:Se,createBoxModel:function(){return{vs:Ue,ns:Pk,uv:Xg,is:Il}},createRoundRectModel:function(Y,Z){return $p.roundRect(Y,Z)},createStarModel:function(Y,u){return $p.star(Y,u)},createRectModel:function(O,Q){return $p.rect(O,Q)},createTriangleModel:function(R,V){return $p.triangle(R,V)},createRightTriangleModel:function(V,n){return $p.rightTriangle(V,n)},createParallelogramModel:function(J,s){return $p.parallelogram(J,s)},createTrapezoidModel:function(B,T){return $p.trapezoid(B,T)},createSmoothSphereModel:function(o,y,n,g,e,I,l){return aq(new Wl(o,y,n,g,e,I,l))},createSphereModel:function(a,P,S,G,o,M,Y){return a?Bg(a,P,S,G,o,M,Y):j.createSmoothSphereModel()},createSmoothConeModel:function(M,V,Y,C,l){return yd(M,V,Y,C,l)},createConeModel:function(B,H,k,I,F,W){return B?$k(B,H,k,I,F,W):yd(W)},createSmoothCylinderModel:function(c,G,Q,J,I,r,w,d){return aq(new ej(c,G,Q,J,I,r,w,d))},createCylinderModel:function(G,u,Y,K,m,g,i,Z){return G?Hg(G,u,Y,K,m,g,i,Z):xe(g,i)},createSmoothTorusModel:function(k,t,E,m,S,R){return aq(new Vc(k,t,E,m,S,R))},createTorusModel:function(q,H,t,C,a,Z,U,_){return q?qd(q,H,t,C,a,Z,U,_):cp(Z,U)},createExtrusionModel:function(Z,T,_,O,Q,J,E,W){return Fj(Z,T,_,O,Q,J,E,W)},createSmoothRingModel:function(Z,d,C,z,H,e){for(var D=[],N=0;N<Z.length-1;N+=2)D.push({x:Z[N],y:Z[N+1]});for(Z=wj(D,d,C)[0],D=[],N=0;N<Z.length;N++){var O=Z[N];D.push(new vb(O.x,0,O.y))}return aq(new $e(D,e,z,H))},createTextGeometry:function(U,w){return aq(new sc(U,w))},loadFontFace:function(e,X){j.xhrLoad(e,function(_){if(!_)return X();var q;try{q=JSON.parse(_)}catch(D){q=JSON.parse(_.substring(65,_.length-2))}vi.loadFace(q),X&&X(q.familyName.toLowerCase())},X?null:{sync:!0})},createRingModel:function(s,A,D,x,W,g,C,f,V,I){for(var R=[],T=0;T<s.length-1;T+=2)R.push({x:s[T],y:s[T+1]});g=g||j.shapeSide,C=C||0,f=f||g;var H,z,U,Y,w,o,k,q,$,y,T,l,E,_,v,n,r,u,h=[],L=[],X=V?[]:O,i=V?[]:O,K=I?[]:O,J=I?[]:O,P=x?[]:O,m=x?[]:O,d=W?[]:O,Z=W?[]:O,s=wj(R,A,D),e=jb(s),Q=0,B=2*Math.PI/g;return s.forEach(function(F){if(U=F.length,U>1){if(Y=F[0],x)for(o=Y.x,q=Y.y,T=C;f>T;T++)l=T+1,E=T*B,_=l*B,v=c(E),n=N(E),r=c(_),u=N(_),P.push(v*o,q,-n*o,r*o,q,-u*o,0,q,0),m.push(.5-.5*v,.5-.5*n,.5-.5*r,.5-.5*u,.5,.5);for(y=0;U>y;y++){for(w=F[y],o=Y.x,k=w.x,q=Y.y,$=w.y,H=Q/e,Q+=rs(Y,w),z=Q/e,T=C;f>T;T++)l=T+1,E=T*B,_=l*B,v=c(E),n=N(E),r=c(_),u=N(_),h.push(v*k,$,-n*k,r*k,$,-u*k,v*o,q,-n*o,r*k,$,-u*k,r*o,q,-u*o,v*o,q,-n*o),L.push(T/g,z,l/g,z,T/g,H,l/g,z,l/g,H,T/g,H),V&&T===C&&(X.push(0,q,0,0,$,0,v*k,$,-n*k,v*k,$,-n*k,v*o,q,-n*o,0,q,0),i.push(0,.5-q,0,.5-$,2*k,.5-$,2*k,.5-$,2*o,.5-q,0,.5-q)),I&&l===f&&(K.push(0,q,0,r*k,$,-u*k,0,$,0,r*k,$,-u*k,0,q,0,r*o,q,-u*o),J.push(1,.5-q,1-2*k,.5-$,1,.5-$,1-2*k,.5-$,1,.5-q,1-2*o,.5-q));
Y=w}if(W)for(o=Y.x,q=Y.y,T=C;f>T;T++)l=T+1,E=T*B,_=l*B,v=c(E),n=N(E),r=c(_),u=N(_),d.push(r*o,q,-u*o,v*o,q,-n*o,0,q,0),Z.push(.5-.5*r,.5+.5*u,.5-.5*v,.5+.5*n,.5,.5)}}),{vs:h,uv:L,bottom_vs:d,bottom_uv:Z,top_vs:P,top_uv:m,from_vs:X,from_uv:i,to_vs:K,to_uv:J}}},!0),Dq(v,{"3d.move.mode":n,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":n,"edge.gradient.color":n,"edge.source.t3":n,"edge.target.t3":n,"light.type":_c,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":t/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Tr,"wf.short":!1,"wf.mat":n,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:n,"transparent.mask":!1,brightness:n,"select.brightness":.7,"repeat.uv.length":n,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":n,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":pj,"label.t3":n,"label.r3":n,"label.texture.scale":2,"label.rotationMode":je,"label.light":!1,"label.blend":n,"label.reverse.flip":!1,"label.reverse.color":bb,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":pj,"label2.t3":n,"label2.r3":n,"label2.texture.scale":2,"label2.rotationMode":je,"label2.light":!1,"label2.blend":n,"label2.reverse.flip":!1,"label2.reverse.color":bb,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":pj,"note.t3":n,"note.r3":n,"note.texture.scale":2,"note.rotationMode":je,"note.light":!1,"note.blend":n,"note.reverse.flip":!1,"note.reverse.color":bb,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":pj,"note2.t3":n,"note2.r3":n,"note2.texture.scale":2,"note2.rotationMode":je,"note2.light":!1,"note2.blend":n,"note2.reverse.flip":!1,"note2.reverse.color":bb,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:n,"shape3d.color":Pb,"shape3d.top.color":n,"shape3d.bottom.color":n,"shape3d.from.color":n,"shape3d.to.color":n,"shape3d.image":n,"shape3d.top.image":n,"shape3d.bottom.image":n,"shape3d.from.image":n,"shape3d.to.image":n,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":n,"shape3d.side.to":n,"shape3d.smooth":n,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":n,"shape3d.opacity":n,"shape3d.reverse.flip":!1,"shape3d.reverse.color":bb,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":n,"shape3d.uv.scale":n,"shape3d.top.uv.offset":n,"shape3d.top.uv.scale":n,"shape3d.bottom.uv.offset":n,"shape3d.bottom.uv.scale":n,"shape3d.from.uv.offset":n,"shape3d.from.uv.scale":n,"shape3d.to.uv.offset":n,"shape3d.to.uv.scale":n,"shape3d.top.cap":n,"shape3d.bottom.cap":n,"shape3d.start.angle":0,"shape3d.sweep.angle":A,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":n,"texture.filter":n,"texture.filter.min":n,"texture.filter.mag":n,"csg.cull.color":n,"csg.cull.box":!0,"all.light":!0,"all.visible":!0,"all.color":Pb,"all.image":n,"all.blend":n,"all.opacity":n,"all.reverse.flip":!1,"all.reverse.color":bb,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":n,"all.uv.offset":n,"all.uv.scale":n,"all.discard.selectable":!0,mat:n,"left.mat":n,"right.mat":n,"top.mat":n,"bottom.mat":n,"front.mat":n,"back.mat":n,"edge.source.anchor.elevation":n,"edge.target.anchor.elevation":n},!0);var Dg,Ni=!1,Mq=[0,0,0,0],rk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:dj,2:xq,3:nh,4:$c,5:pj,6:qp}},tj=function(J,r,N,t){if(r.getFaceVisible(J,N)){var e=mk(J,r.getFaceMat(J,N)||r.getMat(J));J.appendAnchorMatrix3d(e),ok(r,e);var i=r._26I;r.getFaceReverseCull(J,N)?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),gl(i,r._prg.uFixPickReverseColor,rk[N]),Gc(i),cs(i,t,6),to(i),Ih(r)}},wh=function(e){return e instanceof ze},As=function(d){return[d.x,d.e||0,d.y]},Ob=function(p,a,v){for(var a=Yr(a),M=a[0],B=a[1],u=a[2];v--;)p.push(M,B,u)},od=function(t,N,l){for(var N=Yr(N),P=N[0],Z=N[1],z=N[2],b=N[3];l--;)t.push(P,Z,z,b)},Uf=function($,c,r){if(c)for(var i,A,E,N=c[0],j=c[1],Y=c[2],d=c[4],h=c[5],M=c[6],I=c[8],y=c[9],B=c[10],a=c[12],L=c[13],w=c[14],l=r.length,g=0,g=0;l>g;g+=3)i=r[g],A=r[g+1],E=r[g+2],$.push(N*i+d*A+I*E+a,j*i+h*A+y*E+L,Y*i+M*A+B*E+w);else zr($,r)},Rm=function(G,O){var z=O.s("light.intensity"),H=Yr(O.s(Gn)),M=H[0],x=H[1],L=H[2];1!==z&&(M*=z,x*=z,L*=z),G.push(M,x,L,O.s("light.disabled")?1:0)},ei=function(X,d,Y){gl(d,Y.uHeadlightRange,X._headlightRange),gl(d,Y.uHeadlightAmbientIntensity,X._headlightAmbientIntensity);var q=X._headlightIntensity,H=Yr(X._headlightColor);1!==q&&(H=[H[0]*q,H[1]*q,H[2]*q]),gl(d,Y.uHeadlightColor,[H[0],H[1],H[2],X._headlightDisabled?1:0]);var O=X._59O,A=X._spots,f=X._dirs;if(O.length){var V=[],m=[],z=[];O.forEach(function(R){Rm(V,R),zr(m,X._transformPointToViewSpace(R.p3())),z.push(R.s("light.range"))}),d.uniform4fv(Y.uPointColor,V),d.uniform1fv(Y.uPointRange,z),d.uniform3fv(Y.uPointPosition,m)}if(A.length){var G=[],E=[],C=[],J=[],b=[],S=[];A.forEach(function(v){Rm(G,v),zr(E,X._transformPointToViewSpace(v.p3())),zr(b,X._transformDirectionToViewSpace(v.p3(),v.s("light.center"))),C.push(v.s("light.range")),J.push(c(v.s("light.angle")/2)),S.push(v.s("light.exponent"))}),d.uniform4fv(Y.uSpotColor,G),d.uniform1fv(Y.uSpotRange,C),d.uniform1fv(Y.uSpotAngle,J),d.uniform1fv(Y.uSpotExponent,S),d.uniform3fv(Y.uSpotPosition,E),d.uniform3fv(Y.uSpotDirection,b)}if(f.length){var w=[],R=[];f.forEach(function($){Rm(w,$),zr(R,X._transformDirectionToViewSpace($.p3()))}),d.uniform4fv(Y.uDirColor,w),d.uniform3fv(Y.uDirDirection,R)}},He=function(u){return Math.max(j.graph3dViewMinPhi+Wg,Math.min(j.graph3dViewMaxPhi-Wg,u))},pg=function(){return.05+U()/2},zp=function(U,L,q,Z){var J,w=U.getEye();return U.isOrtho()?(J=hi(U.getCenter(),w),J[0]+=Z[0],J[1]+=Z[1],J[2]+=Z[2]):J=w,wo(L,q,Z,J)},wo=function(q,D,b,i){var y=Lg(q,D),t=hi(i,b,!0),S=Lg(t,D);if(w(S)<Wg)return O;var L=(y-Lg(b,D))/S;return[b[0]+t[0]*L,b[1]+t[1]*L,b[2]+t[2]*L]},ls=function(I,E){return{x:2*I.x-E.x,y:2*I.y-E.y}},$b=function(G,H,X,J){var s,b;if(!G)return s=E(H.y-X.y,X.x-H.x),{x:H.x+J*N(s),y:H.y+J*c(s)};if(!X)return s=E(G.y-H.y,H.x-G.x),{x:H.x+J*N(s),y:H.y+J*c(s)};var v=hi([G.x,G.y,0],[H.x,H.y,0],!0),z=hi([X.x,X.y,0],[H.x,H.y,0],!0),B=-(v[0]+z[0])/2,R=-(v[1]+z[1])/2,a=e(B*B+R*R);if(Wg>a)return s=E(G.y-H.y,H.x-G.x),{x:H.x+J*N(s),y:H.y+J*c(s)};var g=G.x-H.x,r=G.y-H.y,k=X.x-H.x,$=X.y-H.y,t=e(g*g+r*r),w=e(k*k+$*$);s=l(Lg(v,z))/2,b=v[1]*z[0]-v[0]*z[1]>0?-1:1,B/=a,R/=a;var T=J/N(s),o=P(t,w)/c(s);a=Math.min(T,o);var D={x:H.x+b*a*B,y:H.y+b*a*R};return X.b&&T>w/c(s)&&(D.adjust=!0),D},Zf=function(w){var C=w[1],R=w[2],B=w[3],c=w[6],O=w[7],W=w[11];w[1]=w[4],w[2]=w[8],w[3]=w[12],w[4]=C,w[6]=w[9],w[7]=w[13],w[8]=R,w[9]=c,w[11]=w[14],w[12]=B,w[13]=O,w[14]=W},os=function(i){var f=i[0],U=i[1],o=i[2],D=i[3],A=i[4],l=i[5],d=i[6],G=i[7],Y=i[8],s=i[9],q=i[10],T=i[11],w=i[12],L=i[13],m=i[14],g=i[15],x=f*l-U*A,$=f*d-o*A,v=f*G-D*A,y=U*d-o*l,X=U*G-D*l,c=o*G-D*d,k=Y*L-s*w,E=Y*m-q*w,n=Y*g-T*w,N=s*m-q*L,p=s*g-T*L,j=q*g-T*m,S=x*j-$*p+v*N+y*n-X*E+c*k;return S?(S=1/S,i[0]=(l*j-d*p+G*N)*S,i[1]=(o*p-U*j-D*N)*S,i[2]=(L*c-m*X+g*y)*S,i[3]=(q*X-s*c-T*y)*S,i[4]=(d*n-A*j-G*E)*S,i[5]=(f*j-o*n+D*E)*S,i[6]=(m*v-w*c-g*$)*S,i[7]=(Y*c-q*v+T*$)*S,i[8]=(A*p-l*n+G*k)*S,i[9]=(U*n-f*p-D*k)*S,i[10]=(w*X-L*v+g*x)*S,i[11]=(s*v-Y*X-T*x)*S,i[12]=(l*E-A*N-d*k)*S,i[13]=(f*N-U*E+o*k)*S,i[14]=(L*$-w*y-m*x)*S,i[15]=(Y*y-s*$+q*x)*S,void 0):O},Bs=function(B,f){if(f){var _=f[0],i=f[1],W=f[2];B[12]=B[0]*_+B[4]*i+B[8]*W+B[12],B[13]=B[1]*_+B[5]*i+B[9]*W+B[13],B[14]=B[2]*_+B[6]*i+B[10]*W+B[14],B[15]=B[3]*_+B[7]*i+B[11]*W+B[15]}},Dc=function(z,b){if(b){var i=b[0],f=b[1],q=b[2];z[0]=z[0]*i,z[1]=z[1]*i,z[2]=z[2]*i,z[3]=z[3]*i,z[4]=z[4]*f,z[5]=z[5]*f,z[6]=z[6]*f,z[7]=z[7]*f,z[8]=z[8]*q,z[9]=z[9]*q,z[10]=z[10]*q,z[11]=z[11]*q}},cd=function(L,x,V){var Z=x[0],R=x[1],U=x[2],f=x[3],M=x[4],D=x[5],c=x[6],o=x[7],O=x[8],b=x[9],h=x[10],X=x[11],B=x[12],k=x[13],m=x[14],G=x[15],K=V[0],l=V[1],S=V[2],r=V[3];return L[0]=K*Z+l*M+S*O+r*B,L[1]=K*R+l*D+S*b+r*k,L[2]=K*U+l*c+S*h+r*m,L[3]=K*f+l*o+S*X+r*G,K=V[4],l=V[5],S=V[6],r=V[7],L[4]=K*Z+l*M+S*O+r*B,L[5]=K*R+l*D+S*b+r*k,L[6]=K*U+l*c+S*h+r*m,L[7]=K*f+l*o+S*X+r*G,K=V[8],l=V[9],S=V[10],r=V[11],L[8]=K*Z+l*M+S*O+r*B,L[9]=K*R+l*D+S*b+r*k,L[10]=K*U+l*c+S*h+r*m,L[11]=K*f+l*o+S*X+r*G,K=V[12],l=V[13],S=V[14],r=V[15],L[12]=K*Z+l*M+S*O+r*B,L[13]=K*R+l*D+S*b+r*k,L[14]=K*U+l*c+S*h+r*m,L[15]=K*f+l*o+S*X+r*G,L},Ah=function(J,D,$,L){var s,x,v,R,y,P,i,Q,o,S,z=D[0],E=D[1],T=D[2],c=L[0],Y=L[1],U=L[2],q=$[0],t=$[1],H=$[2];return w(z-q)<Wg&&w(E-t)<Wg&&w(T-H)<Wg?yn(J):(i=z-q,Q=E-t,o=T-H,S=1/e(i*i+Q*Q+o*o),i*=S,Q*=S,o*=S,s=Y*o-U*Q,x=U*i-c*o,v=c*Q-Y*i,S=e(s*s+x*x+v*v),S?(S=1/S,s*=S,x*=S,v*=S):(s=0,x=0,v=0),R=Q*v-o*x,y=o*s-i*v,P=i*x-Q*s,S=e(R*R+y*y+P*P),S?(S=1/S,R*=S,y*=S,P*=S):(R=0,y=0,P=0),J[0]=s,J[1]=R,J[2]=i,J[3]=0,J[4]=x,J[5]=y,J[6]=Q,J[7]=0,J[8]=v,J[9]=P,J[10]=o,J[11]=0,J[12]=-(s*z+x*E+v*T),J[13]=-(R*z+y*E+P*T),J[14]=-(i*z+Q*E+o*T),J[15]=1,J)},Wk=function($,o,m,c,d){var M=1/D(o/2),f=1/(c-d);return $[0]=M/m,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=M,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=(d+c)*f,$[11]=-1,$[12]=0,$[13]=0,$[14]=2*d*c*f,$[15]=0,$},Mr=function(H,Q,o,R,I,V,L){var U=1/(Q-o),X=1/(R-I),i=1/(V-L);return H[0]=-2*U,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=-2*X,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=2*i,H[11]=0,H[12]=(Q+o)*U,H[13]=(I+R)*X,H[14]=(L+V)*i,H[15]=1,H},Mn=function(Z,x){var t=x[0],S=x[1],w=x[2],p=x[3],d=t*t+S*S+w*w+p*p,q=d?1/d:0;return Z[0]=-t*q,Z[1]=-S*q,Z[2]=-w*q,Z[3]=p*q,Z},Cq=function(C,A){var c=A[0]+A[5]+A[10],e=0;return c>0?(e=2*Math.sqrt(c+1),C[3]=.25*e,C[0]=(A[6]-A[9])/e,C[1]=(A[8]-A[2])/e,C[2]=(A[1]-A[4])/e):A[0]>A[5]&A[0]>A[10]?(e=2*Math.sqrt(1+A[0]-A[5]-A[10]),C[3]=(A[6]-A[9])/e,C[0]=.25*e,C[1]=(A[1]+A[4])/e,C[2]=(A[8]+A[2])/e):A[5]>A[10]?(e=2*Math.sqrt(1+A[5]-A[0]-A[10]),C[3]=(A[8]-A[2])/e,C[0]=(A[1]+A[4])/e,C[1]=.25*e,C[2]=(A[6]+A[9])/e):(e=2*Math.sqrt(1+A[10]-A[0]-A[5]),C[3]=(A[1]-A[4])/e,C[0]=(A[8]+A[2])/e,C[1]=(A[6]+A[9])/e,C[2]=.25*e),C},ag=function(Y,u,r){var j=u[0],z=u[1],$=u[2],H=u[3],m=j+j,V=z+z,b=$+$,P=j*m,f=j*V,O=j*b,t=z*V,s=z*b,B=$*b,L=H*m,N=H*V,y=H*b;return Y[0]=1-(t+B),Y[1]=f+y,Y[2]=O-N,Y[3]=0,Y[4]=f-y,Y[5]=1-(P+B),Y[6]=s+L,Y[7]=0,Y[8]=O+N,Y[9]=s-L,Y[10]=1-(P+t),Y[11]=0,Y[12]=r[0],Y[13]=r[1],Y[14]=r[2],Y[15]=1,Y},wc=function(V,f){if(V.vr.enable){var O=V.vr.getViewMatrix(f);if(O)return O}return Ah(f?f:Zk(),V._eye,V._center,V._up)},sg=function(z,l){if(z.vr.enable){var F=z.vr.getProjectMatrix();if(F)return F}if(!l&&z._computedProjectMatrix)return ii(z._computedProjectMatrix);var m=z.getAspect(),o=z._near,n=z._far,S=Zk();if(z._ortho){var _=z._orthoWidth/2,b=_/m;Mr(S,-_,_,-b,b,o,n)}else Wk(S,z._fovy,m,o,n);return S},Cg=function(C,D){if(!C)return O;var m=0,U=1,W=2,L=[],h=0,_=C.length,x=_/3;if(D){for(;_>h;h++)L[h]=0;for(h=0;h<D.length;h+=3){var S=[],v=[],j=[];S[m]=C[3*D[h+1]+m]-C[3*D[h]+m],S[U]=C[3*D[h+1]+U]-C[3*D[h]+U],S[W]=C[3*D[h+1]+W]-C[3*D[h]+W],v[m]=C[3*D[h+2]+m]-C[3*D[h+1]+m],v[U]=C[3*D[h+2]+U]-C[3*D[h+1]+U],v[W]=C[3*D[h+2]+W]-C[3*D[h+1]+W],j[m]=S[U]*v[W]-S[W]*v[U],j[U]=S[W]*v[m]-S[m]*v[W],j[W]=S[m]*v[U]-S[U]*v[m];for(var g=0;3>g;g++)L[3*D[h+g]+m]+=j[m],L[3*D[h+g]+U]+=j[U],L[3*D[h+g]+W]+=j[W]}}else for(h=0;x>h;h+=3){var S=[],v=[],j=[];S[m]=C[3*(h+1)+m]-C[3*h+m],S[U]=C[3*(h+1)+U]-C[3*h+U],S[W]=C[3*(h+1)+W]-C[3*h+W],v[m]=C[3*(h+2)+m]-C[3*(h+1)+m],v[U]=C[3*(h+2)+U]-C[3*(h+1)+U],v[W]=C[3*(h+2)+W]-C[3*(h+1)+W],j[m]=S[U]*v[W]-S[W]*v[U],j[U]=S[W]*v[m]-S[m]*v[W],j[W]=S[m]*v[U]-S[U]*v[m];for(var g=0;3>g;g++)L[3*(h+g)+m]=j[m],L[3*(h+g)+U]=j[U],L[3*(h+g)+W]=j[W]}for(h=0;_>h;h+=3){var X=[];X[m]=L[h+m],X[U]=L[h+U],X[W]=L[h+W];var t=e(X[m]*X[m]+X[U]*X[U]+X[W]*X[W]);0===t&&(t=Wg),X[m]=X[m]/t,X[U]=X[U]/t,X[W]=X[W]/t,L[h+m]=X[m],L[h+U]=X[U],L[h+W]=X[W]}return new Ln(L)},hf=function(L,V,d,N){if(d||(d=L.createTexture()),V){var o=L.TEXTURE_2D,b=L.REPEAT,y=L.CLAMP_TO_EDGE,k=L.TEXTURE_MIN_FILTER;N=N||Ac;var Q=N.minFilter||N.filter||L.LINEAR,S=N.magFilter||N.filter||L.LINEAR;Qr(L,d),L.texImage2D(o,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,V),oo(L,L.TEXTURE_MAG_FILTER,S);var Z=V.naturalWidth||V.width,X=V.naturalHeight||V.height;Jm.isPOT(Z)&&Jm.isPOT(X)&&!V.clampToEdge?(oo(L,L.TEXTURE_WRAP_S,b),oo(L,L.TEXTURE_WRAP_T,b),oo(L,k,Q===L.NEAREST?L.NEAREST_MIPMAP_NEAREST:L.LINEAR_MIPMAP_LINEAR),N.mipmapMaxLevel!==n&&oo(L,L.TEXTURE_MAX_LEVEL,N.mipmapMaxLevel),L.generateMipmap(o)):(oo(L,L.TEXTURE_WRAP_S,y),oo(L,L.TEXTURE_WRAP_T,y),oo(L,k,Q)),Qr(L,O)}return d},ce=function(x,N){var v=new Uint8Array(4);return N=N||x.createTexture(),Qr(x,N),oo(x,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,v),N},xc=function(E){E._26I&&E._prg&&(E._26I.deleteProgram(E._prg),E._prg=O)},Nm=function(K,U,G,a){var J=K.createShader(G);return K.shaderSource(J,a),K.compileShader(J),K.attachShader(U,J),J},Al=function(x){return x.createBuffer()},Qr=function(B,W){B.bindTexture(B.TEXTURE_2D,W)},oo=function(G,d,n){G.texParameteri(G.TEXTURE_2D,d,n)},zd=function(S,o){S.enable(S.POLYGON_OFFSET_FILL),S.polygonOffset(o[0],o[1])},ak=function(C){C.disable(C.POLYGON_OFFSET_FILL)},Rg=function(R,B){if(B){var B=Yr(B);R.clearColor(B[0],B[1],B[2],B[3])}},Rb=function(V,p){gl(V,p.uFix,!0),Oq(V,p.aNormal)},ne=function(O,K){gl(O,K.uFix,!1),ws(O,K.aNormal)},Wh=function(w,L,G,M,C,u,t,E){w._picking||(G?(gl(w,L.uBlend,!0),gl(w,L.uBlendColor,G)):gl(w,L.uBlend,!1),gl(w,L.uLight,M==O?!0:M),Sd(C)&&1!==C&&gl(w,L.uPartOpacity,C),gl(w,L.uReverseFlip,u==O?!1:u),gl(w,L.uFixPickReverseColor,t||bb)),E?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE)},Un=function(V,A){V._picking||gl(V,A.uPartOpacity,1)},Gc=function(){var p=[0,0,1,1];return function(Z,o,S,V,m,U,P,z,n){return S?(gl(Z,o.uTexture,!0),gl(Z,o.uDiscardSelectable,Hi(V)?V:!0),ws(Z,o.aUv),hs(Z,m,U,o.aUv,2),n?(gl(Z,o.uBlendTexture,!0),Z.activeTexture(Z.TEXTURE1),Qr(Z,n),Z.uniform1i(o.uBlendSampler,1)):(gl(Z,o.uBlendTexture,!1),Z.activeTexture(Z.TEXTURE1),Qr(Z,Z._emptyBlendTexture)),Z.activeTexture(Z.TEXTURE0),Qr(Z,S),Z.uniform1i(o.uSampler,0),P?(p[0]=P[0],p[1]=P[1]):(p[0]=0,p[1]=0),z?(p[2]=z[0],p[3]=z[1]):(p[2]=1,p[3]=1),gl(Z,o.uOffsetScale,p),void 0):(Z.activeTexture(Z.TEXTURE0),Qr(Z,Z._emptyTexture),Z.activeTexture(Z.TEXTURE1),Qr(Z,Z._emptyBlendTexture),void 0)}}(),to=function(y,F,r){y.activeTexture(y.TEXTURE0),Qr(y,O),y.activeTexture(y.TEXTURE1),Qr(y,O),r&&(Oq(y,F.aUv),gl(y,F.uTexture,!1),gl(y,F.uBlendTexture,!1))},tb=function(y,x,N,C,J,E){!N||kr||Xo||y.lineWidth(N),C&&!y._picking&&gl(y,x.uFixPickReverseColor,C),J&&hs(y,J,E,x.aPosition)},cc=function(c,H,y,B){Dg&&(B=c[Dg]),c.drawArrays(B==O?c.TRIANGLES:B,H,y);var A=c._renderInfo;A&&(A.calls++,A.vertices+=y,(B==O||B===c.TRIANGLES)&&(A.faces+=y/3),B===c.LINES&&(A.lines+=y/2))},cs=function(h,y,d,W){Dg&&(W=h[Dg]),h.drawElements(W==O?h.TRIANGLES:W,d,h.UNSIGNED_SHORT,y==O?0:2*y);var D=h._renderInfo;D&&(D.calls++,D.vertices+=d,(W==O||W===h.TRIANGLES)&&(D.faces+=d/3),W===h.LINES&&(D.lines+=d/2))},Ec=function(k,x,t,E,S){var g=k.ARRAY_BUFFER;k.bindBuffer(g,x),t&&k.bufferData(g,t,k.STATIC_DRAW),E!=O&&k.vertexAttribPointer(E,S?S:3,k.FLOAT,!1,0,0)},hs=function(y,e,L,F,c){return L?(sr(y,y.ARRAY_BUFFER,e,L),F!=O&&y.vertexAttribPointer(F,c?c:3,y.FLOAT,!1,0,0),void 0):Ec(y,e,L,F,c)},wl=function(l,d,L){var G=l.ELEMENT_ARRAY_BUFFER;l.bindBuffer(G,d),L&&l.bufferData(G,L,l.STATIC_DRAW)},wf=function(K,z,g){sr(K,K.ELEMENT_ARRAY_BUFFER,z,g)},sr=function(l,P,r,V){var W=V._bufId;W||(W=V._bufId=Y.Math.generateIncreasingID());var r,D=l._bufPool;(r=D[W])&&r._buf?l.bindBuffer(P,r._buf):(r=D[W]={_buf:Al(l)},l.bindBuffer(P,r._buf),l.bufferData(P,V,l.STATIC_DRAW)),r._fid=l._renderInfo.frame},gl=function(w,g,u){if(u!=O&&g!=O){u=Yr(u);var R=u.length;3===R?w.uniform3fv(g,u):4===R?w.uniform4fv(g,u):16===R?w.uniformMatrix4fv(g,!1,u):Hi(u)?w.uniform1i(g,u?1:0):2===R?w.uniform2fv(g,u):w.uniform1f(g,u)}},ws=function(W,Q){Q!=O&&Q>=0&&W.enableVertexAttribArray(Q)},Oq=function(E,f){f!=O&&f>=0&&E.disableVertexAttribArray(f)},Ih=function(F,R){var j=F.getGL(),A=F._prg;F._7O=F._8O.pop(),R&&(gl(j,A.uMVMatrix,F._7O),F._6O=R,gl(j,A.uNMatrix,R))},Vo=function(n,K){return K||(K=Zk()),Do(K,n),os(K),Zf(K),K},ok=function(A,Z){var K=A.getGL(),k=A._prg,x=A._7O;Z?(A._8O.push(ii(x)),gl(K,k.uMMatrix,Z),cd(x,x,Z),A._7O=x):gl(K,k.uMMatrix,Yc),gl(K,k.uMVMatrix,x),gl(K,k.uNMatrix,Vo(x,A._6O))},Up=function(H,n,A,f,d,t){if(A){if(f){var e=A.value++,I=2147483648|e,k=[(255&I>>16)/255,(255&I>>8)/255,(255&I)/255,(255&I>>24)/255];A[e]={data:d,part:t}}else k=Mq;return gl(H,n.uFixPickReverseColor,k),k}},pk=function(D,m,W){"target"!==W&&(W="source");var v="target"===W?m.getTargetAgent():m.getSourceAgent(),x="edge."+W+".";if(De(v)){var X=m.s(x+"anchor.x"),L=m.s(x+"anchor.elevation"),l=m.s(x+"anchor.y"),M=mk(v,D.getMat(v)),s=v.getAnchor3d();return $i([(X===n?.5:X)-s.x,(L===n?.5:L)-s.y,(l===n?.5:l)-s.z],M)}var u=m.s(x+"index"),J=D.getData3dUI(v);if(!J.info||!J.info.list)return!1;if(u>=0){var A,b,F,Y,E,y=J.info._lastPointsSegments,t=y.points,N=y.segments,O=-1,i=-1;for(F=0,Y=N?N.length:t.length;Y>F;F++){if(b=N?N.get(F):1,3===b)E=2;else if(4===b)E=3;else{if(5===b)continue;E=1}if(O+=E,i++,i===u){A=t.get(O);break}}return A||(A=t.get(t.length-1)),[A.x,A.e||0,A.y]}var H=m.s(x+"percent")||.5;if(H=Math.max(0,Math.min(H,1)),!J||!J.getCache)return!1;var z=J.getCache(),Y=z[z.length-1].length,y=D.getLineOffset(v,H*Y),_=y.point;return[_.x,_.y,_.z]},ef=function(){var C={center:function(z,i,V,n,K){var e=-i[1]/2,U={x:-i[0]/2,y:e,width:i[0],height:i[1]},d=Ke(z,U,V);return[d.x+n,-d.y-K,pg()]},front:function(i,T,V,U,g){var N=-T[1]/2,p={x:-T[0]/2,y:N,width:T[0],height:T[1]},K=Ke(i,p,V);return[K.x+U,-K.y-g,T[2]/2+pg()]},back:function(z,r,M,O,s){var b=-r[0]/2,i=-r[1]/2,v={x:b,y:i,width:r[0],height:r[1]},y=Ke(z,v,M);return[-y.x-O,-y.y-s,-r[2]/2-pg()]},left:function(I,L,v,_,G){var i=-L[1]/2,P={x:-L[2]/2,y:i,width:L[2],height:L[1]},E=Ke(I,P,v);return[-L[0]/2-pg(),-E.y-G,E.x+_]},right:function(q,i,L,n,F){var D=-i[2]/2,x=-i[1]/2,E={x:D,y:x,width:i[2],height:i[1]},Z=Ke(q,E,L);return[i[0]/2+pg(),-Z.y-F,-Z.x-n]},top:function(Z,l,r,d,b){var T={x:-l[0]/2,y:-l[2]/2,width:l[0],height:l[2]},D=Ke(Z,T,r);return[D.x+d,l[1]/2+pg(),D.y+b]},bottom:function(V,M,W,B,H){var L=-M[2]/2,P={x:-M[0]/2,y:L,width:M[0],height:M[2]},y=Ke(V,P,W);return[y.x+B,-M[1]/2-pg(),-y.y-H]}};return function(H,o,E,v,u,M){return C[v](H,o,E,u||0,M||0)}}(),jp=function(j,z,v,p,W,f,X,U,P,c){if(W&&(z[0]+=W[0],z[1]+=W[1],z[2]+=W[2]),Bs(j,v),U){var J=Zk();if(gb(J,P,c),$i(z,J),Bs(j,z),j.auto=U,j.pos=$i([0,0,0],j),f){var k=j.mat2=Zk();gb(k,f,X)}}else gb(j,P,c),Bs(j,z),p===dj?Lq(j,-M):p===xq?Lq(j,M):p===nh?Tf(j,-M):p===$c?Tf(j,M):p===qp&&Lq(j,t),gb(j,f,X);return j},le=function(g,r){var X=r.auto,k=r.mat2,O=g.gv;if(X){var E,u=Zk(),B=[0,0,0,0];E="string"==typeof X?[X.indexOf("x")<0?O._eye[0]:O._center[0],X.indexOf("y")<0?O._eye[1]:O._center[1],X.indexOf("z")<0?O._eye[2]:O._center[2]]:O._eye,Cq(B,Ah(Zk(),E,O._center,O._up)),ag(u,Mn(B,B),r.pos),k&&cd(u,u,k),ok(O,u)}else ok(O,r)},Iq=function(u,v,G,y,K){var c=u.s,D=u.gv,V=D.getGL(),J=D._prg,N=D._buffer,O=D._1O;hf(V,Ie,O),le(u,G),Wh(V,J,c(v+".blend"),c(v+".light"),c(v+".opacity"),c(v+".reverse.flip"),c(v+".reverse.color"),c(v+".reverse.cull")),Gc(V,J,O,K,N.uv,hg),hs(V,N.vs,y,J.aPosition),hs(V,N.ns,jd,J.aNormal),wf(V,N.is,Jd),cs(V,0,Jd.length),to(V,J,O),Un(V,J),Ih(D)},dk=function(f,U,j){var Q=f.gv,d=f.data,K=f[U]={blend:Q.getBodyColor(d)||Q.getFaceBlend(d,U),light:Q.getFaceLight(d,U),color:Q.getFaceColor(d,U),opacity:Q.getFaceOpacity(d,U),transparent:Q.getFaceTransparent(d,U),reverseFlip:Q.getFaceReverseFlip(d,U),reverseColor:Q.getFaceReverseColor(d,U),reverseCull:Q.getFaceReverseCull(d,U),texture:Q.getFaceImage(d,U),blendTexture:Q.getFaceBlendImage(d,U),discardSelectable:Q.getFaceDiscardSelectable(d,U)};if("csg"!==U){K.uv=Q.getFaceUv(d,U)||j&&j[U+"Uv"],K.uvScale=Q.getFaceUvScale(d,U)||j&&j[U+"UvScale"],K.uvOffset=Q.getFaceUvOffset(d,U)||j&&j[U+"UvOffset"];var T=Q.getFaceMat(d,U);if(T){var o=mk(d,T);d.appendAnchorMatrix3d(o),K.mat=o}}return K},yi=function(Y,t,J,e,s){var d=Y[e];if(d){if(!s(d.transparent))return;var K=Y.data,D=Y.gv,R=D._buffer,w=D.getTexture(d.texture,K,e),C=D.getTexture(d.blendTexture,K);Gc(t,J,w,d.discardSelectable,R.uv,d.tuv,d.uvOffset,d.uvScale,C),Wh(t,J,d.blend,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),d.cs&&!D._batchColorDisabled?(gl(t,J.uBatchColor,!0),ws(t,J.aBatchColor),hs(t,R.batchColor,d.cs,J.aBatchColor,4)):gl(t,J.uDiffuse,d.color||v["color.empty"]),hs(t,R.vs,d.vs,J.aPosition),hs(t,R.ns,d.ns,J.aNormal),cc(t,0,d.vs.length/3),d.cs&&!D._batchColorDisabled&&(gl(t,J.uBatchColor,!1),Oq(t,J.aBatchColor)),Un(t,J),to(t,J,w)}},$d=function(B,n,x,m,g,f){var S,M,H,p,E,$,i,N,u,O,Y,K=[m-n,g-x],W=B?B.length:0;for(H=0;W>H;H++){for(p=2,S=B[H],E=S[0],$=S[1];p+1<S.length;){if(i=S[p],N=S[p+1],M=Cr(n,x,m,g,E,$,i,N,!0)){u=[i-E,N-$],O=rs(u),u[0]/=O,u[1]/=O,O=Lg(K,u),O=O>0?f:-f,Y=[u[0]*O,u[1]*O];break}E=i,$=N,p+=2}if(Y)break}if(Y)for(m=n+Y[0],g=x+Y[1],H=0;W>H;H++)for(p=2,S=B[H],E=S[0],$=S[1];p+1<S.length;){if(i=S[p],N=S[p+1],M=Cr(n,x,m,g,E,$,i,N,!0))return[0,0];E=i,$=N,p+=2}return Y?Y:[m-n,g-x]},fl=Y.graph3d={},or=function(c,X,f){kk(F+".graph3d."+c,X,f)},Yb="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",es="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Dq(j,{setBatchInfo:function(G,M){db[G]=M},getBatchInfo:function(Z){return db[Z]},getBatchInfoMap:function(){return db},setBatchInfoMap:function(B){db=B}},!0);var $q=[1,1,1],Po=[1,0,0,0,0,1,0,1,1,1,1,0],ek=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Lk=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],xk=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],nc=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Gk=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Nc=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],uj=function(O,T){be(O,T,"_batchModelMap","_batchIndexMap"),eq(O,T,"_wireframeModelMap","_wireframeIndexMap"),eq(O,T,"_polylineModelMap","_polylineIndexMap"),eq(O,T,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),eq(O,T,"_polylineModelMapSwap","_polylineIndexMapSwap")},be=function(V,m,h,c){if(!m)return V[h]={},V[c]={},void 0;var S=m._id,$=V[c],L=$[S];if(L){var b=V[h],r=L.batch,G=b[r],J=G.ds,k=L.index;if(G.invalidate=!0,delete $[S],J.splice(k,1),te(J))return delete b[r],void 0;for(var d=L.begin,W=L.size,T=3*d,f=3*W,w=4*d,j=4*W,Q=G.vs,U=G.ps,g=G.uv,z=G.cs,p=G.bs,B=G.rs,s=G.ns,n=G.ls;k<J.length;k++)L=$[J[k]._id],L.index--,L.begin-=W;Q.splice(T,f),U.splice(w,j),g&&g.splice(2*d,2*W),z&&z.splice(w,j),p&&p.splice(T,f),B&&B.splice(d,W),s&&s.splice(T,f),n&&n.splice(d,W)}},eq=be,wm=function(R,A,P,T){if(!T)return O;var x=A[T];if(!x){var c=db[T]||Ac,I=c.image?[]:O;x=A[T]={vs:[],ns:[],uv:I,cs:I?O:c.color?O:[],bs:c.blend?[]:O,ps:[],rs:c.brightness?[]:O,ds:[]}}return x.invalidate=!0,R[P._id]={index:x.ds.length,begin:x.vs.length/3,batch:T},x.ds.push(P),x},Oi=function(R,w){return w!=O&&1!==w?[R[0]*w,R[1]*w,R[2]*w,R[3]]:R
},Xe=function(){var B;return function(H,r,a){var J=H.getData3dUI(r),p=J.shapeModel;if(p||(p=Nb(J)),p||!J.shapeName){var u,e=r.s("wf.combineTriangle");if(a.geometry){if(!p&&(r instanceof Y.Node&&!(r instanceof Y.Shape)?(B||(B={vs:Ue,is:Il,uv:Xg}),p=B):p=[J.left,J.front,J.right,J.back,J.top,J.bottom],!p))return n;if(e?(e=0|Math.min(3,Math.max(1,isNaN(e)?1:e)),u=ge[e-1](p)):u=Og(p),!u||0===u.length)return}else u=a.short?rn:ik;var k=H.getBrightness(r),W=Yr(a.color||"white"),P=W[3]<1,E=Math.ceil(a.width)||1,M=(P?"T":"O")+E,f=H._wireframeIndexMap,I=H._wireframeModelMap,z=I[M];z||(z=I[M]={vs:[],cs:[],ps:[],ds:[],T:P,W:E}),z.invalidate=!0;var C=z.vs,v=z.cs,g=z.ds,Q=f[r._id]={index:g.length,begin:C.length/3,batch:M};g.push(r);var d=J.mat;r instanceof Y.Edge||!(!d||!a.geometry&&r instanceof Y.Shape)||(d=mk(r,a.mat),r.appendAnchorMatrix3d(d)),Uf(C,d,u);var q=Q.size=C.length/3-Q.begin;od(v,Oi(W,k),q)}}}(),zg=function(G,v,E,d,I,J,g,h,z){var A=G.getBrightness(v);A==O&&(A=1);var w=Oi(Yr(d),A),l=w[3]<1;J=Math.ceil(J)||1;var x=(l?"T":"O")+J;if(g){var p=g[0],F=(g[1]||p)+p;x+="-"+p+"-"+F,z&&(x+="-"+Cc(z)+"-"+A,z=Oi(Yr(z),A))}var c=G._polylineIndexMap,r=G._polylineModelMap,R=r[x];R||(R=r[x]={vs:[],cs:[],ps:[],ds:[],ls:g?[]:O,T:l,W:J},g&&(R.D=p,R.G=F,R.A=z)),R.invalidate=!0;var W,H=R.vs,_=R.cs,b=R.ds,e=R.ls,m=c[v._id]={index:b.length,begin:H.length/3,batch:x};b.push(v),zr(H,E);var S,Q=m.size=H.length/3-m.begin,M=E.length,n=0,K=[];if(g||I)for(W=0;M>W;W+=6)S=rs([E[W],E[W+1],E[W+2]],[E[W+3],E[W+4],E[W+5]]),K.push(S),n+=S;if(n&&I){var o,P=Oi(Yr(I),A),$=[P[0]-w[0],P[1]-w[1],P[2]-w[2],P[3]-w[3]],T=0;for(W=0;M>W;W+=6)o=T/n,od(_,[w[0]+$[0]*o,w[1]+$[1]*o,w[2]+$[2]*o,w[3]+$[3]*o],1),T+=K[W/6],o=T/n,od(_,[w[0]+$[0]*o,w[1]+$[1]*o,w[2]+$[2]*o,w[3]+$[3]*o],1)}else od(_,w,Q);if(g)for(T=h||0,W=0;M>W;W+=6)e.push(T),T+=K[W/6],e.push(T)},If=function(f,y,P){if(y)for(var o=4*y.begin,Z=P[y.batch].ps,W=0;W<y.size;W++)Z[o++]=f[0],Z[o++]=f[1],Z[o++]=f[2],Z[o++]=f[3]},Yh=function(j,u){var s=u+["32"],U=j[u],o=j[s];U?o&&o.length===U.length?(o.set(U),o._bufId=null):j[s]=new Ln(U):delete j[s]},cf=function(V,H,f,n,q,T,R,S,X){if(Hr(f))f.forEach(function(O){cf(V,H,O,n,q,T,R,S,X)});else if(xh(f))cf(V,H,Nb(n,f),n,q,T,R,S,X);else if(Xj(f)){var o,v=lc(f.mat,H,V),G=lc(f.s3,H,V),k=lc(f.t3,H,V),C=lc(f.r3,H,V);if((G||C||k||v)&&(o=Dn(v,G,C,lc(f.rotationMode,H,V),k),T.push(o)),f.shape3d)cf(V,H,f.shape3d,n,q,T,R,S,f);else{var m=n.s;X=X||Ac;var l=T[0],r=T.length,I=m("shape3d.color",f.color,X.color);if(q||(q=m("shape3d.blend",f.blend,X.blend)),r>1){l=ii(l);for(var P=1;r>P;P++)cd(l,l,T[P])}f.vs&&m(zs,f.visible,X.visible)&&Lb(l,R,S,f.vs,f.uv,f.is,q,I),f.top_vs&&m(yf,f.topVisible,X.topVisible)&&Lb(l,R,S,f.top_vs,f.top_uv,f.top_is,q,m("shape3d.top.color",f.topColor,X.topColor)||I),f.bottom_vs&&m(yq,f.bottomVisible,X.bottomVisible)&&Lb(l,R,S,f.bottom_vs,f.bottom_uv,f.bottom_is,q,m("shape3d.bottom.color",f.bottomColor,X.bottomColor)||I),f.from_vs&&m(zn,f.fromVisible,X.fromVisible)&&Lb(l,R,S,f.from_vs,f.from_uv,f.from_is,q,m("shape3d.from.color",f.fromColor,X.fromColor)||I),f.to_vs&&m(Jc,f.toVisible,X.toVisible)&&Lb(l,R,S,f.to_vs,f.to_uv,f.to_is,q,m("shape3d.to.color",f.toColor,X.toColor)||I)}o&&T.pop()}},Lb=function(F,s,N,g,i,u,c,z){var e,m=s.cs,D=s.uv,l=s.bs;if(u){e=u.length;for(var $=0;e>$;$++){var J=u[$];Uf(N,F,[g[3*J],g[3*J+1],g[3*J+2]]),D&&zr(D,[i[2*J],i[2*J+1]])}}else e=g.length/3,Uf(N,F,g),D&&zr(D,i);m&&od(m,z,e),l&&(c?Ob(l,c,e):zr(l,$q,e))},nf=function(A,U,p,k){var z=[];k?cf(A.gv,A.data,k,A,A.getBodyColor(),[U],p,z):(aj(A,dj,U,p,z),aj(A,xq,U,p,z),aj(A,pj,U,p,z),aj(A,qp,U,p,z),aj(A,nh,U,p,z),aj(A,$c,U,p,z),aj(A,"csg",U,p,z)),z.length&&(zr(p.vs,z),zr(p.ns,Cg(z)))},aj=function(b,B,R,W,d){var L=b[B];if(L){var t=L.tuv;if(t){var Q,X,D,$,h=L.uvScale,y=L.uvOffset;if(h)for(Q=t.length,X=h[0],D=h[1],$=0;Q>$;$+=2)t[$]*=X,t[$+1]*=D;if(y)for(Q=t.length,X=y[0],D=y[1],$=0;Q>$;$+=2)t[$]+=X,t[$+1]+=D}Lb(R,W,d,L.vs,t,O,L.blend,L.color)}},Ci=function(i,B,t,$,S,J,R,T){var n,k=t.cs,P=t.uv,r=t.bs;if(i.getFaceVisible(B,J)){var E=i.getFaceMat(B,J);if(E&&(S=mk(B,E)),Uf(R,S,T),k&&od(k,i.getFaceColor(B,J),6),P){var o=i.getFaceUv(B,J)||$[J+"Uv"],f=i.getFaceUvScale(B,J)||$[J+"UvScale"],b=i.getFaceUvOffset(B,J)||$[J+"UvOffset"];o=o?[o[6],o[7],o[0],o[1],o[2],o[3],o[2],o[3],o[4],o[5],o[6],o[7]]:Po;var _=o[0],l=o[1],w=o[2],d=o[3],s=o[4],C=o[5],L=o[6],N=o[7],O=o[8],G=o[9],u=o[10],H=o[11];if(f){var U=f[0],p=f[1];_*=U,l*=p,w*=U,d*=p,s*=U,C*=p,L*=U,N*=p,O*=U,G*=p,u*=U,H*=p}if(b){var y=b[0],v=b[1];_+=y,l+=v,w+=y,d+=v,s+=y,C+=v,L+=y,N+=v,O+=y,G+=v,u+=y,H+=v}P.push(_,l,w,d,s,C,L,N,O,G,u,H)}r&&(n=i.getBodyColor(B)||i.getFaceBlend(B,J),n?Ob(r,n,6):zr(r,$q,6))}},Gl=function(c,E,D,n){var t=c.getGL(),m=c._prg,M=c._buffer;if(!c.drawFilter&&!sn(E)){ok(c),Rb(t,m);for(var J in E){var y=E[J];if(!(n&&!y.T||!n&&y.T)){y.invalidate?(y.invalidate=!1,Yh(y,"vs"),Yh(y,"cs"),Yh(y,"ls"),Yh(y,"ps")):D&&Yh(y,"ps");var K=y.vs32,b=D?y.ps32:y.cs32;tb(t,m,y.W,O,M.vs,K);var r=y.D,A=!c._dashDisabled&&r;gl(t,m.uAlphaTest,v.alphaTest),A&&(gl(t,m.uDash,!0),gl(t,m.uDashDistance,r),gl(t,m.uDashGapDistance,y.G),ws(t,m.aLineDistance),hs(t,M.lineDistance,y.ls32,m.aLineDistance,1),gl(t,m.uDiffuse,y.A||v["color.empty"]));var U=!c._batchColorDisabled;U&&(gl(t,m.uBatchColor,!0),ws(t,m.aBatchColor),hs(t,M.batchColor,b,m.aBatchColor,4)),Gc(t),cc(t,0,K.length/3,t.LINES),to(t),U&&(gl(t,m.uBatchColor,!1),Oq(t,m.aBatchColor)),A&&(gl(t,m.uDash,!1),Oq(t,m.aLineDistance))}}ne(t,m)}},wn=function(e,w,z){var D,k,p,H,Y,$,h,F,b,g,I,G=e.getGL(),a=e._prg,C=e._buffer,T=e._batchModelMap;if(!sn(T)&&!e.drawFilter){ok(e);for(D in T)if(k=db[D]||Ac,!(z&&!k.transparent||!z&&k.transparent)&&(p=T[D],w||!k.transparentMask)){var A=z&&k.autoSort!==!1&&(e._33Q||p.invalidate);if(p.invalidate?(p.invalidate=!1,Yh(p,"vs"),Yh(p,"ns"),Yh(p,"cs"),Yh(p,"rs"),Yh(p,"ps"),Yh(p,"bs"),Yh(p,"uv")):w&&Yh(p,"ps"),Y=p.vs32,$=w?p.ps32:p.cs32,b=p.uv32,h=p.bs32,F=p.rs32,I=Y.length/3,A&&(p.is=pq(Y,e.getEye())),I){H=k.light,g=e.getTexture(k.image),Wh(G,a,O,k.light,k.opacity,k.reverseFlip,k.reverseColor,k.reverseCull),$?e._batchColorDisabled||(gl(G,a.uBatchColor,!0),ws(G,a.aBatchColor),hs(G,C.batchColor,$,a.aBatchColor,4)):gl(G,a.uDiffuse,k.color||v["color.empty"]);var M=k.alphaTest;gl(G,a.uAlphaTest,M===n?v.alphaTest:M),k.envmap!==n?(gl(G,a.uUseEnvMap,!0),gl(G,a.uReflectivity,k.envmap)):(gl(G,a.uUseEnvMap,!1),gl(G,a.uReflectivity,0));var X=h&&!e._batchBlendDisabled;X&&(gl(G,a.uBatchBlend,!0),ws(G,a.aBatchBlend),hs(G,C.batchBlend,h,a.aBatchBlend));var s=F&&!e._batchBrightnessDisabled;s&&(gl(G,a.uBatchBrightness,!0),ws(G,a.aBatchBrightness),hs(G,C.batchBrightness,F,a.aBatchBrightness,1)),b?Gc(G,a,g,k.discardSelectable,C.uv,b,k.uvOffset,k.uvScale):Gc(G),hs(G,C.vs,Y,a.aPosition),hs(G,C.ns,p.ns32,a.aNormal),p.is?(wl(G,C.is,p.is),cs(G,0,I)):cc(G,0,I),b?to(G,a,g):to(G),$&&!e._batchColorDisabled&&(gl(G,a.uBatchColor,!1),Oq(G,a.aBatchColor)),X&&(gl(G,a.uBatchBlend,!1),Oq(G,a.aBatchBlend)),s&&(gl(G,a.uBatchBrightness,!1),Oq(G,a.aBatchBrightness)),Un(G,a)}}}},pq=function(i,z){for(var j=i.length/3,Z=new Array(j),L=j/3,q=new Array(L),x=0;L>x;x++)q[x]=x;q.sort(function(_,w){var s=9*_,K=[(i[s]+i[s+3]+2*i[s+6])/4,(i[s+1]+i[s+4]+2*i[s+7])/4,(i[s+2]+i[s+5]+2*i[s+8])/4];s=9*w;var D=[(i[s]+i[s+3]+2*i[s+6])/4,(i[s+1]+i[s+4]+2*i[s+7])/4,(i[s+2]+i[s+5]+2*i[s+8])/4],S=rs(z,K)-rs(z,D);return S>0?-1:0>S?1:0});for(var x=0;L>x;x++){var m=3*x,P=3*q[x];Z[m]=P,Z[m+1]=P+1,Z[m+2]=P+2}return new Qo(Z)},ch={obj:function(b,r){var P={mat:b.mat,s3:b.s3,r3:b.r3,rotationMode:b.rotationMode,t3:b.t3,cube:b.cube==O?!0:b.cube,center:b.center==O?!0:b.center,ignoreMtls:b.ignoreMtls,ignoreTransparent:b.ignoreTransparent,ignoreColor:b.ignoreColor,ignoreImage:b.ignoreImage,ignoreNormal:b.ignoreNormal,prefix:b.prefix,flipY:b.flipY,flipFace:b.flipFace,reverseFlipMtls:b.reverseFlipMtls,finishFunc:function(V,G){if(V){var G=[];for(var H in V){var S=V[H];G.rawS3=S.rawS3,S.center&&(G.center=S.center),G.push(S),b.eachModel&&b.eachModel(H,S)}G.json=b,r(G)}else r()}};j.loadObj(b.obj,b.mtl,P)}};j.getModelTypeHandlers=function(){return ch},j.setModelTypeHandler=function(C,b){ch[C]=b},j.getModelTypeHandler=function(V){return ch[V]},j.handleModelLoaded=function(){},j.handleUnfoundModel=function(){};var Wd=O,lo=O,Yo=function($){Wd&&!$._loadingModelView_&&(lo||(lo={}),lo[$._loadingModelView_=Xn()]=$)},ro=function(y,l){Wd||(Wd={});var x=Wd[y];if(x){if(x.url===l)return;x.request.onload=Bh,x.request.onerror=Bh}var m=new de;if(Wd[y]={request:m,url:l},l=j.beforeLoadURL(l),l.data){var o=j.parse(l.data);lf(y,o,l)}else{m.onload=function(){if(200===this.status||0===this.status){delete Wd[y];var I=j.parse(m.getResponseText());lf(y,I,l)}else Kr(y,j.handleUnfoundModel(y,l)||O)},m.onerror=function(){Kr(y,j.handleUnfoundModel(y,l)||O)};var U={};U.url=encodeURI(l),U.sync=!1,m.send(U)}},lf=function(d,p,_){var U=p.modelType;if(!U)return Kr(d,p),j.handleModelLoaded(d,p),void 0;var y=j.getModelTypeHandler(U);if(y){if(Wd||(Wd={}),Wd[d])return;Wd[d]=!0;var N=function(c){c?(Kr(d,c),j.handleModelLoaded(d,c)):Kr(d,j.handleUnfoundModel(d,_,p)||O)};y(p,N)}else Kr(d,j.handleUnfoundModel(d,_,p)||O)},Kr=function(W,L){if(delete Wd[W],xh(L)&&Gm.test(L))return ro(W,L),void 0;if(pf[W]=L,sn(Wd)&&(Wd=O,lo)){for(var C in lo){var m=lo[C];m.invalidateAll&&m.invalidateAll(n,"modelLoaded",W),m.redraw&&m.redraw(),m.iv(),delete m._loadingModelView_}lo=O}if(L&&lo)for(var C in lo){var m=lo[C];m.invalidateAll&&m.invalidateAll(n,"modelLoading",W),m.redraw&&m.redraw(),m.iv()}},hg=new Ln([0,0,0,1,1,1,1,0]),jd=new Ln([0,0,1,0,0,1,0,0,1,0,0,1]),Jd=new Qo([0,1,2,2,3,0]),Ue=new Ln([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Il=new Qo([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Xg=new Ln([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Pk=Cg(Ue,Il),Sq=(new Ln([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Qo([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[dj,pj,xq,qp,nh,$c]),ik=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],rn=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Bg=function(D,O,H,S,d,E,r){E=E||16,D=D||16,O=O||0,H=H||D;var y,K,u,X,V,m,q,_,I,v=.5,o=[],i=[],C=A/D,F=t/E;for(y=0;E>y;y++)for(m=y+1,X=y*F,I=m*F,K=O;H>K;K++)q=K+1,u=K*C,_=q*C,o.push(v*N(X)*c(u),v*c(X),-v*N(X)*N(u),v*N(I)*c(_),v*c(I),-v*N(I)*N(_),v*N(X)*c(_),v*c(X),-v*N(X)*N(_),v*N(X)*c(u),v*c(X),-v*N(X)*N(u),v*N(I)*c(u),v*c(I),-v*N(I)*N(u),v*N(I)*c(_),v*c(I),-v*N(I)*N(_)),i.push(K/D,y/E,q/D,m/E,q/D,y/E,K/D,y/E,K/D,m/E,q/D,m/E);if(r){var s=[];for(y=0,V=o.length;V>y;y+=3)s.push(2*o[y],2*o[y+1],2*o[y+2])}if(S){var P=[],w=[];for(u=O*C,y=0;E>y;y++)m=y+1,X=y*F,I=m*F,P.push(0,0,0,v*N(I)*c(u),v*c(I),-v*N(I)*N(u),v*N(X)*c(u),v*c(X),-v*N(X)*N(u)),w.push(0,.5,O/D,m/E,O/D,y/E)}if(d){var J=[],x=[];for(u=H*C,y=0;E>y;y++)m=y+1,X=y*F,I=m*F,J.push(0,0,0,v*N(X)*c(u),v*c(X),-v*N(X)*N(u),v*N(I)*c(u),v*c(I),-v*N(I)*N(u)),x.push(1,.5,H/D,y/E,H/D,m/E)}var g={vs:o,uv:i,from_vs:P,from_uv:w,to_vs:J,to_uv:x};return r&&(g.ns=s),g},cp=function(u,M,j){u=u||.17,M=M||12,j=j||18,0>u?u=0:u>.25&&(u=.25);var C,V,W,d,b,w,p,P=.5,O=[],Q=[],$=[],n=A/j,m=A/M,F=P-u;for(V=0;M>=V;V++)for(d=-t+V*m,w=c(d),b=N(d),C=0;j>=C;C++)W=C*n,p=F+u*w,O.push(c(W)*p,b*u,-N(W)*p),Q.push(C/j,1-V/M);for(V=0;M>V;V++){var U=V*(j+1),y=(V+1)*(j+1);for(C=0;j>C;C++)$.push(U+C,y+C+1,y+C,U+C,U+C+1,y+C+1)}return{vs:O,uv:Q,is:$}},qd=function(Y,F,$,q,x,e,b,V){b=b||12,Y=Y||18,F=F||0,$=$||Y,e=e||.17,0>e?e=0:e>.25&&(e=.25);var s,B,P,w,d,a,H,u,g,j,o=.5,R=[],J=[],r=A/Y,v=A/b,y=o-e,C=V?[]:n;for(P=0;b>P;P++)for(w=P+1,H=-t+P*v,u=-t+w*v,s=F;$>s;s++)B=s+1,d=s*r,a=B*r,g=y+e*c(H),j=y+e*c(u),R.push(c(d)*g,N(H)*e,-N(d)*g,c(a)*g,N(H)*e,-N(a)*g,c(a)*j,N(u)*e,-N(a)*j,c(d)*g,N(H)*e,-N(d)*g,c(a)*j,N(u)*e,-N(a)*j,c(d)*j,N(u)*e,-N(d)*j),J.push(s/Y,1-P/b,B/Y,1-P/b,B/Y,1-w/b,s/Y,1-P/b,B/Y,1-w/b,s/Y,1-w/b),V&&C.push(c(d)*c(H),N(H),-N(d)*c(H),c(a)*c(H),N(H),-N(a)*c(H),c(a)*c(u),N(u),-N(a)*c(u),c(d)*c(H),N(H),-N(d)*c(H),c(a)*c(u),N(u),-N(a)*c(u),c(d)*c(u),N(u),-N(d)*c(u));if(q){var E=[],m=[];for(P=0;b>P;P++)w=P+1,H=-t+P*v,u=-t+w*v,d=F*r,g=y+e*c(H),j=y+e*c(u),E.push(c(d)*g,N(H)*e,-N(d)*g,c(d)*j,N(u)*e,-N(d)*j,c(d)*y,0,-N(d)*y),m.push(.5+.5*c(H),.5-.5*N(H),.5+.5*c(u),.5-.5*N(u),.5,.5)}if(x){var O=[],Z=[];for(P=0;b>P;P++)w=P+1,H=-t+P*v,u=-t+w*v,d=$*r,g=y+e*c(H),j=y+e*c(u),O.push(c(d)*g,N(H)*e,-N(d)*g,c(d)*y,0,-N(d)*y,c(d)*j,N(u)*e,-N(d)*j),Z.push(.5-.5*c(H),.5-.5*N(H),.5,.5,.5-.5*c(u),.5-.5*N(u))}var z={vs:R,uv:J,from_vs:E,from_uv:m,to_vs:O,to_uv:Z};return V&&(z.ns=C),z},xe=function(F,d){for(var t,W,Y,M=.5,v=16,L=[],K=[],J=[],e=A/v,R=0;v>=R;R++)t=R*e,W=c(t)*M,Y=N(t)*M,L.push(W,-M,Y,W,M,Y),K.push(1-R/v,1,1-R/v,0);for(R=0;v>R;R++)J.push(2*R,2*R+1,2*R+3,2*R,2*R+3,2*R+2);if(d){var Q=[],T=[],D=[];for(Q.push(0,-M,0),T.push(.5,.5),R=0;v>=R;R++)t=R*e,W=c(t),Y=N(t),Q.push(W*M,-M,-Y*M),T.push(.5+.5*W,.5+.5*Y);for(R=0;v>R;R++)D.push(0,R+2,R+1)}if(F){var S=[],G=[],x=[];for(S.push(0,M,0),G.push(.5,.5),R=0;v>=R;R++)t=R*e,W=c(t),Y=N(t),S.push(W*M,M,-Y*M),G.push(.5+.5*W,.5-.5*Y);for(R=0;v>R;R++)x.push(0,R+1,R+2)}return{vs:L,uv:K,is:J,bottom_vs:Q,bottom_uv:T,bottom_is:D,top_vs:S,top_uv:G,top_is:x}},Hg=function(J,f,x,M,$,H,d,r){J=J||12,f=f||0,x=x||J;for(var P,T,g,e,B,i,R,q,D,L=.5,Z=[],s=[],o=A/J,O=f;x>O;O++)P=O+1,T=O*o,g=P*o,e=c(T)*L,B=N(T)*L,i=c(g)*L,R=N(g)*L,Z.push(e,-L,-B,i,-L,-R,e,L,-B,i,-L,-R,i,L,-R,e,L,-B),s.push(O/J,1,P/J,1,O/J,0,P/J,1,P/J,0,O/J,0);if(r){var _=[];for(O=0,D=Z.length;D>O;O+=3)_.push(2*Z[O],0,2*Z[O+2])}if(d){var C=[],u=[];for(O=f;x>O;O++)T=o*O,g=o*(O+1),e=c(T),B=N(T),i=c(g),R=N(g),C.push(e*L,-L,-B*L,0,-L,0,i*L,-L,-R*L),u.push(.5+.5*e,.5+.5*B,.5,.5,.5+.5*i,.5+.5*R)}if(H){var b=[],U=[];for(O=f;x>O;O++)T=o*O,g=o*(O+1),e=c(T),B=N(T),i=c(g),R=N(g),b.push(e*L,L,-B*L,i*L,L,-R*L,0,L,0),U.push(.5+.5*e,.5-.5*B,.5+.5*i,.5-.5*R,.5,.5)}if(M){var G=[],I=[];T=o*f,e=c(T)*L,B=N(T)*L,q=f/J,G.push(0,L,0,0,-L,0,e,-L,-B,e,-L,-B,e,L,-B,0,L,0),I.push(0,0,0,1,q,1,q,1,q,0,0,0)}if($){var W=[],j=[];T=o*x,e=c(T)*L,B=N(T)*L,q=x/J,W.push(0,-L,0,0,L,0,e,L,-B,e,L,-B,e,-L,-B,0,-L,0),j.push(1,1,1,0,q,0,q,0,q,1,1,1)}var K={vs:Z,uv:s,bottom_vs:C,bottom_uv:u,top_vs:b,top_uv:U,from_vs:G,from_uv:I,to_vs:W,to_uv:j};return r&&(K.ns=_),K},yd=function($,r,y,P,e){r=r||18,y=y||0,P=P==O?A:P,e=e==O?.5:e;for(var G,p,L,u,d,D,Z=[0,.5,.75,.875,.9375],I=[],s=[],m=[],g=P/r,t=0;t<Z.length;t++){var K=0===t%2?0:.5;for(G=0;r>=G;G++)p=(G+K)*g+y,L=1-Z[t],I.push(c(p)*e*L,-e+2*Z[t]*e,-N(p)*e*L),s.push((G+K)/r,L)}for(t=0;t<Z.length-1;t++){var V=t*(r+1),b=(t+1)*(r+1);for(G=0;r>G;G++)m.push(V+G,b+G+1,b+G,V+G,V+G+1,b+G+1)}for(D=I.length/3-(r+1),G=0;r>G;G++)I.push(0,e,0),s.push((G+.5)/r,0);for(G=0;r>G;G++)m.push(D+G,D+G+1,D+(r+1)+G);if($){var x=[],M=[],Q=[];for(x.push(0,-e,0),M.push(.5,.5),G=0;r>=G;G++)p=G*g+y,u=c(p),d=N(p),x.push(u*e,-e,-d*e),M.push(.5+.5*u,.5+.5*d);for(G=0;r>G;G++)Q.push(0,G+2,G+1)}return{vs:I,uv:s,is:m,bottom_vs:x,bottom_uv:M,bottom_is:Q}},$k=function(x,Y,S,R,g,X){x=x||16,Y=Y||0,S=S||x;for(var e=.5,t=[],k=[],T=A/x,F=Y;S>F;F++){var l=F+1,D=T*F,W=T*l;t.push(c(D)*e,-e,-N(D)*e,c(W)*e,-e,-N(W)*e,0,e,0),k.push(F/x,1,l/x,1,(F+l)/2/x,0)}if(X){var B=[],L=[];for(F=Y;S>F;F++){D=T*F,W=T*(F+1);var z=c(D),p=N(D),w=c(W),m=N(W);B.push(z*e,-e,-p*e,0,-e,0,w*e,-e,-m*e),L.push(.5+.5*z,.5+.5*p,.5,.5,.5+.5*w,.5+.5*m)}}if(R){var P=[],j=[];D=T*Y,P.push(0,e,0,0,-e,0,c(D)*e,-e,-N(D)*e),j.push(0,0,0,1,Y/x,1)}if(g){var I=[],$=[];D=T*S,I.push(0,-e,0,0,e,0,c(D)*e,-e,-N(D)*e),$.push(1,1,1,0,S/x,1)}return{vs:t,uv:k,bottom_vs:B,bottom_uv:L,from_vs:P,from_uv:j,to_vs:I,to_uv:$}},Fj=function(L,O,R,B,h,$,j,o){for(var Z=[],t=0;t<L.length-1;t+=2)Z.push({x:L[t],y:L[t+1]});return ae(Z,O,R,B,h,$,j,o,!1)},$p={roundRect:function(Z,F){return Fj([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],Z,F,3)},star:function(T,X){return Fj([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],T,X)},rect:function(t,j){return Fj([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],t,j)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(R,z){return Fj([0,-.5,.5,.5,-.5,.5],[1,2,2,5],R,z)},rightTriangle:function(a,U){return Fj([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],a,U)},parallelogram:function(A,U){return Fj([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],A,U)},trapezoid:function(z,I){return Fj([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],z,I)}},dp={sphere:1,cylinder:1,cone:1,torus:1},Fo={torus:1,sphere:1},$m=Dq(qk($p),{cylinder:1}),Wf=Dq(qk($p),{cylinder:1,cone:1}),rb=function(i,$,f){var K,c=lc(i.anchor3d,f,$),F=lc(i.mat,f,$),r=lc(i.s3,f,$),b=lc(i.t3,f,$),B=lc(i.r3,f,$),d=r||B||b||F;if(c||d){K=ii($._6O);var t=d?Dn(F,r,B,lc(i.rotationMode,f,$),b):Zk();c&&Bs(t,[.5-c[0],.5-c[1],.5-c[2]]),ok($,t)}return K},Hd=function(n,C,o,t,W,v,M){if(Hr(o))o.forEach(function(h){Hd(n,C,h,t,W,v,M)});else if(xh(o))Hd(n,C,Nb(t,o),t,W,v,M);else if(Xj(o))if(o.shape3d){var j=rb(o,n,C);Hd(n,C,o.shape3d,t,W,v,o),j&&Ih(n,j)}else Ig(n,C,o,t.s,W,v,M)},Ig=function(j,J,w,V,D,n,s){if(s=s||Ac,!n||n(V("shape3d.transparent",w.transparent,s.transparent))){var H=rb(w,j,J);Si(w);var d=j._26I,A=j._prg,p=j._buffer,e=V("shape3d.color",w.color,s.color);D||(D=V("shape3d.blend",w.blend,s.blend));var K,Y=w.opacity==O?s.opacity:w.opacity,g=V("shape3d.opacity");K=g!=O&&Y!=O?Y*g:Y!=O?Y:g,Wh(d,A,D,V("shape3d.light",w.light,s.light),K,V("shape3d.reverse.flip",w.reverseFlip,s.reverseFlip),V("shape3d.reverse.color",w.reverseColor,s.reverseColor),V("shape3d.reverse.cull",w.reverseCull,s.reverseCull));var M=V("polygonOffset",w.polygonOffset,s.polygonOffset);w.vs&&V(zs,w.visible,s.visible)&&uq(d,A,p,e,j.getTexture(V("shape3d.image",w.image,s.image),J),V("shape3d.discard.selectable",w.discardSelectable,s.discardSelectable),w.vs,w.uv,w.ns,w.is,V("shape3d.uv.offset",w.uvOffset,s.uvOffset),V("shape3d.uv.scale",w.uvScale,s.uvScale),M),w.top_vs&&V(yf,w.topVisible,s.topVisible)&&uq(d,A,p,V("shape3d.top.color",w.topColor,s.topColor)||e,j.getTexture(V("shape3d.top.image",w.topImage,s.topImage),J,"top"),V("shape3d.top.discard.selectable",w.topDiscardSelectable,s.topDiscardSelectable),w.top_vs,w.top_uv,w.top_ns,w.top_is,V("shape3d.top.uv.offset",w.topUvOffset,s.topUvOffset),V("shape3d.top.uv.scale",w.topUvScale,s.topUvScale),M),w.bottom_vs&&V(yq,w.bottomVisible,s.bottomVisible)&&uq(d,A,p,V("shape3d.bottom.color",w.bottomColor,s.bottomColor)||e,j.getTexture(V("shape3d.bottom.image",w.bottomImage,s.bottomImage),J,"bottom"),V("shape3d.bottom.discard.selectable",w.bottomDiscardSelectable,s.bottomDiscardSelectable),w.bottom_vs,w.bottom_uv,w.bottom_ns,w.bottom_is,V("shape3d.bottom.uv.offset",w.bottomUvOffset,s.bottomUvOffset),V("shape3d.bottom.uv.scale",w.bottomUvScale,s.bottomUvScale),M),w.from_vs&&V(zn,w.fromVisible,s.fromVisible)&&uq(d,A,p,V("shape3d.from.color",w.fromColor,s.fromColor)||e,j.getTexture(V("shape3d.from.image",w.fromImage,s.fromImage),J,"from"),V("shape3d.from.discard.selectable",w.fromDiscardSelectable,s.fromDiscardSelectable),w.from_vs,w.from_uv,w.from_ns,w.from_is,V("shape3d.from.uv.offset",w.fromUvOffset,s.fromUvOffset),V("shape3d.from.uv.scale",w.fromUvScale,s.fromUvScale),M),w.to_vs&&V(Jc,w.toVisible,s.toVisible)&&uq(d,A,p,V("shape3d.to.color",w.toColor,s.toColor)||e,j.getTexture(V("shape3d.to.image",w.toImage,s.toImage),J,"to"),V("shape3d.to.discard.selectable",w.toDiscardSelectable,s.toDiscardSelectable),w.to_vs,w.to_uv,w.to_ns,w.to_is,V("shape3d.to.uv.offset",w.toUvOffset,s.toUvOffset),V("shape3d.to.uv.scale",w.toUvScale,s.toUvScale),M),Un(d,A),H&&Ih(j,H)}},uq=function(P,d,n,u,O,D,U,W,I,j,l,X,Q){U&&(Q&&zd(P,Q),gl(P,d.uDiffuse,u||v["color.empty"]),W?Gc(P,d,O,D,n.uv,W,l,X):Gc(P),hs(P,n.vs,U,d.aPosition),hs(P,n.ns,I,d.aNormal),j?(wf(P,n.is,j),cs(P,0,j.length)):cc(P,0,U.length/3),W?to(P,d,O):to(P),Q&&ak(P))},Nb=function(z,V){var m=z.s;if(V||(V=m(Ij)),!V)return O;var q=Xi(V);if(q)return q;if("text"===V){var u={amount:m("shape3d.text.amount"),size:m("shape3d.text.size"),font:m("shape3d.text.font"),style:m("shape3d.text.style"),weight:m("shape3d.text.weight"),fill:m("shape3d.text.fill"),curveSegments:m("shape3d.text.curveSegments"),spacing:m("shape3d.text.spacing")},l=z.gv.getShape3dText(z.data),C=l;for(var N in u)C+="_"+(u[N]===n?"U":u[N]);return z._cachedTextKey===C?z._cachedTextGeometry:(z._cachedTextKey=C,z._cachedTextGeometry=j.createTextGeometry(l,u))}var N=V;if(dp[V]){var K=m("shape3d.side"),g=m("shape3d.side.from"),y=m("shape3d.side.to"),L=m(zn),B=m(Jc);3>K?(K=0,g=0,y=0,L=!1,B=!1):((g==O||0>g)&&(g=0),(y==O||y>K)&&(y=K),0===g&&y===K&&(L=!1,B=!1));var E="cone"===V?!1:m("shape3d.smooth");N+="-"+K+"-"+g+"-"+y+"-"+L+"-"+B+(E?1:0)}if($m[V]){var P=m(yf);N+="-"+P}if(Wf[V]){var M=m(yq);N+="-"+M}if("torus"===V){var R=m("shape3d.torus.radius");0>R?R=0:R>.25&&(R=.25),N+="-"+R}if(Fo[V]){var i=m(Sh);N+="-"+i}return q=mq[N],q||("box"===V?q=j.createBoxModel():$p[V]?q=$p[V](P,M):"sphere"===V?q=j.createSphereModel(K,g,y,L,B,i,E):V===xr?q=j.createCylinderModel(K,g,y,L,B,P,M,E):"cone"===V?q=j.createConeModel(K,g,y,L,B,M):"torus"===V&&(q=j.createTorusModel(K,g,y,L,B,R,i,E)),mq[N]=q),q},Si=function(){var V=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],i=["is","top_is","bottom_is","from_is","to_is"];return W=$g(Yb.substr(Yb.indexOf("^#")+2)),Wm(j[An(Hk+V[15]+"n"+V[16])]())&&fn()?function(K){K&&!K._complete_&&(K._complete_=!0,K.vs&&te(K.ns)&&(K.ns=Cg(K.vs,K.is)),K.top_vs&&te(K.top_ns)&&(K.top_ns=Cg(K.top_vs,K.top_is)),K.bottom_vs&&te(K.bottom_ns)&&(K.bottom_ns=Cg(K.bottom_vs,K.bottom_is)),K.from_vs&&te(K.from_ns)&&(K.from_ns=Cg(K.from_vs,K.from_is)),K.to_vs&&te(K.to_ns)&&(K.to_ns=Cg(K.to_vs,K.to_is)),V.forEach(function(B){var h=K[B];Hr(h)&&(K[B]=new Ln(h))}),i.forEach(function(g){var C=K[g];Hr(C)&&(K[g]=new Qo(C))}))}:void 0}(),Oh=function(q,K){var j=q[K];Hr(j)&&(q[K]=new Ln(j))};Dq(pc,{_25Q:function(a){a._16O=function(r,U,Z,O,c,W,H,m,o){var M=this.info;if(M){var v,t,G,R,j,V,x=Zk();if(ho[U]?(v=M.p3,t=M.c1,G=M.c2):he[U]?(t=M.s1||M.c1,G=M.s2||M.c2):(t=M.t1||M.c1,G=M.t2||M.c2),v)V=ef(U,Lp,Z,O,m,o);else{var h=hi(G,t),N=rs(t,G);R=[0,-E(h[2],h[0]),S(h[1]/N)],j="zyx",v=[(t[0]+G[0])/2,(t[1]+G[1])/2,(t[2]+G[2])/2],V=ef(U,[N,0,0],Z,O,m,o)}return jp(x,V,v,O,c,W,H,r,R,j)}return Yc},a._80o=function(R,V,n){var J=this,v=J.shapeModel;if(v){var B=J.gv;ok(B),Hd(B,J.data,v,J,J.getBodyColor(),n)}},a.createLineModel=function(E,r,n,M,b){for(var d=this,C=d.s,S=We(E,r,C(Sh)),f=[],s=0;s<S.length;s++){var W=S[s],J=W.length;if(J>1){var y=W[0];f.push(y.x,y.y,y.z);for(var X=1;J-1>X;X++)y=W[X],f.push(y.x,y.y,y.z),f.push(y.x,y.y,y.z);y=W[J-1],f.push(y.x,y.y,y.z)}}var R,I,q,G=C(M+".color"),v=C(b),w=0;return v&&(I=C(b+".color"),R=C(b+".pattern"),w=C(b+".offset"),q=G),zg(d.gv,d.data,f,I||G,q?O:C(M+".gradient.color"),n,R||C(M+".pattern"),w,q),S},a.createTubeModel=function(S,x,N,u){for(var Q=this,_=Q.s,J=_("shape3d.side")||Yg,p=_("shape3d.start.angle"),L=_("shape3d.sweep.angle"),h=_(yf)?_("shape3d.top.cap"):O,z=_(yq)?_("shape3d.bottom.cap"):O,X="flat"===h,B="flat"===z,P=X&&(u?u.uv:_("shape3d.top.image")),D=B&&(u?u.uv:_("shape3d.bottom.image")),$=u?u.uv:_("shape3d.image"),q={vs:[],uv:$?[]:O,top_vs:X?[]:O,top_uv:P?[]:O,bottom_vs:B?[]:O,bottom_uv:D?[]:O},k=We(S,x,_(Sh),N),C=0,c=k.length;c>C;C++)qe(q,k[C],_(an),N,J,p,L,h,z);if(u){var T=[];cf(Q.gv,Q.data,q,Q,Q.getBodyColor(),[],u,T),T.length&&(zr(u.vs,T),zr(u.ns,Cg(T)))}else Q.shapeModel=q;return k},a.getCache=function(){var d=this.info;if(d){var p=d.list;if(p){var c=d.cache;return c||(c=d.cache=fp(p)),c}}return O}}});var Fe=function(x,L){for(var e,w=0,G=x.length,d=0,Y=G-1;Y>=d;)if(w=J(d+(Y-d)/2),e=x[w].length-L,0>e)d=w+1;else{if(!(e>0)){Y=w;break}Y=w-1}w=Y;var b=x[w],y=b.point;return w===G-1||b.length===L||(y=(new vb).subVectors(x[w+1].point,y).normalize().multiplyScalar(L-b.length).add(y)),{point:y,tangent:b.tangent}},fp=function(r){for(var G,f,x=[],q=0,g=0;g<r.length;g++){for(var A=r[g],N=0;N<A.length;N++){G=A[N],f&&(q+=f.distanceTo(G));var W=new vb,t=A[N+1];t?W.subVectors(t,G):f?W.subVectors(G,f):W.x=1,W.normalize(),x.push({point:G,length:q,tangent:W}),f=G}f=null}return x},We=function(g,i,H,r){H=H||ns;for(var L=[],M=0,P=g.size();P>M;M++){var R=g.get(M);L.push(new vb(R.x,R.e||0,R.y))}i&&(re(i)&&(i=i._as),i.length||(i=null));for(var T,N,z,S,p,B=[],I=0,C=0,Q=i?i.length:P;Q>C;C++)if(p=i?i[C]:0===C?1:2,1===p)B.push(z=[]),z.push(L[I++]);else if(2===p||5===p)if(S=2===p?L[I++]:z[0],r){var J=i?i[C+1]:Q>C+1?2:O;if(2===J||5===J){var d=z[z.length-1],v=2===J?L[I]:z[0],l=(new vb).subVectors(d,S),x=(new vb).subVectors(v,S),y=l.length(),j=x.length();if(y&&j)if(r>y/2&&r>j/2)z.push(S);else for(l.multiplyScalar(u(r,y/2)/y).add(S),x.multiplyScalar(u(r,j/2)/j).add(S),T=new ti(l,S,x).getPoints(H),N=0;H>=N;N++)z.push(T[N])}else z.push(S)}else z.push(S);else if(3===p)for(T=new ti(z[z.length-1],L[I++],L[I++]).getPoints(H),N=1;H>=N;N++)z.push(T[N]);else if(4===p)for(T=new fk(z[z.length-1],L[I++],L[I++],L[I++]).getPoints(H),N=1;H>=N;N++)z.push(T[N]);return B},El=function(j){for(var Z,W,E=new vb,L=[],T=[],V=[],e=0,s=j.length;s>e;e++)Z=j[e],W=j[e+1],W?E.subVectors(W,Z):E.subVectors(Z,j[e-1]),L.push(E.normalize().clone());var x,i,b,B,z=new vb,R=new vb,_=new Yj,g=1e-4,Q=Number.MAX_VALUE,p=L[0],y=T[0]=new vb,O=V[0]=new vb;for(i=w(p.x),b=w(p.y),B=w(p.z),Q>=i&&(Q=i,z.set(1,0,0)),Q>=b&&(Q=b,z.set(0,1,0)),Q>=B&&z.set(0,0,1),R.crossVectors(p,z).normalize(),y.crossVectors(p,R),O.crossVectors(p,y),e=1;s>e;e++)T[e]=T[e-1].clone(),V[e]=V[e-1].clone(),R.crossVectors(L[e-1],L[e]),R.length()>g&&(R.normalize(),x=l(am(L[e-1].dot(L[e]),-1,1)),T[e].applyMatrix4(_.makeRotationAxis(R,x))),V[e].crossVectors(L[e],T[e]);return{B:V,T:L,N:T}},qe=function(){var B=function(u){for(var Y=1;Y<arguments.length;Y++){var T=arguments[Y];u.push(T.x,T.y,T.z)}},j=function(V){for(var $=1;$<arguments.length;$++){var O=arguments[$].uv;V.push(O[0],O[1])}},d=function(R,e,n,d,s){var S=-d*c(s),V=d*N(s);return new vb(R.x+S*n.x+V*e.x,R.y+S*n.y+V*e.y,R.z+S*n.z+V*e.z)},C=function(x,g,t,k,b,V,h,v){h=h||A;for(var i=[],I=h/b,P=0;b>=P;P++){var D=d(x,g,t,k,P*I+V);i.push(D),v!=O&&(D.uv=[v,1-P/b])}return i},Q=function(s,O,F,m,V,D,z,M,b){b=b||A;var h=O?s.top_vs:s.bottom_vs;if(h)for(var k=O?s.top_uv:s.bottom_uv,L=b/z,l=0;z>l;l++){var H,U;O?(H=l*L+M,U=(l+1)*L+M):(U=l*L+M,H=(l+1)*L+M),B(h,d(F,m,V,D,H),d(F,m,V,D,U),F),k&&k.push(.5-.5*c(H),.5-.5*N(H),.5-.5*c(U),.5-.5*N(U),.5,.5)}};return function(F,S,K,u,t,D,x,l,r){var w=S.length;if(w>1){var z,s,V,g,v,E,Z,q=El(S),y=q.T,L=q.N,a=q.B;"flat"===l&&Q(F,!0,S[0],a[0],L[0],u,t,D,x),"flat"===r&&Q(F,!1,S[w-1],a[w-1],L[w-1],u,t,D,x);var i,P,I=[],d=$(t/2),c="round"===l,h="round"===r,m=S[0],A=y[0],G=a[0],Y=L[0],R=S[w-1],M=y[w-1],b=a[w-1],T=L[w-1];if(c){for(V=1;d>=V;V++)L.splice(0,0,Y),a.splice(0,0,G),y.splice(0,0,A),P=-V/d*u,S.splice(0,0,A.clone().multiplyScalar(P).add(m)),I[d-V]=e(u*u-P*P);w+=d}if(h){for(V=1;d>=V;V++)L.push(T),a.push(b),y.push(M),P=V/d*u,S.push(M.clone().multiplyScalar(P).add(R)),I[S.length-1]=e(u*u-P*P);w+=d}if(F.uv){var o=0,H=0,W=[];for(K&&(o=K),v=S[0],W[0]=0,V=1;w>V;V++)g=S[V],W[V]=v.distanceTo(g),v=g,K||(o+=W[V]);for(i=[],V=0;w>V;V++)H+=W[V],i[V]=o?H/o:0}for(V=0;w>V;V++){if(g=S[V],E=a[V],Z=L[V],z=C(g,E,Z,I[V]===n?u:I[V],t,D,x,i?i[V]:O),s)for(var U=0;t>U;U++){var k=s[U],J=s[U+1]||s[0],p=z[U],N=z[U+1]||z[0];B(F.vs,J,k,p,p,N,J),F.uv&&j(F.uv,J,k,p,p,N,J)}s=z}}}}();Dq(j,{getLineLength:function(N){return N[N.length-1].length},getLineOffset:function(W,F){return Fe(W,F)},getLineCacheInfo:function(p,W,N,n){return fp(We(p,W,N,n))}});var ld=Y.graph3d.RenderLite={},Qi=new Array(0),Zn=ld.Buffer=function(r,v,H,S){this.gl=r,this.buffer=r.createBuffer(),this.type=v||r.ARRAY_BUFFER,this.drawType=S||r.STATIC_DRAW,this.data=Qi,H&&this.upload(H)};Zn.prototype.upload=function($,v,G){G||this.bind();var F=this.gl;$=$||this.data,v=v||0,this.data.byteLength>=$.byteLength?F.bufferSubData(this.type,v,$):F.bufferData(this.type,$,this.drawType),this.data=$},Zn.prototype.bind=function(){var v=this.gl;v.bindBuffer(this.type,this.buffer)},Zn.createVertexBuffer=function(v,N,c){return new Zn(v,v.ARRAY_BUFFER,N,c)},Zn.createIndexBuffer=function(H,p,Q){return new Zn(H,H.ELEMENT_ARRAY_BUFFER,p,Q)},Zn.create=function(F,L,X,D){return new Zn(F,L,D)},Zn.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Wi=ld.Shader=function(V,E,T){this.gl=V,this.program=Ym(V,E,T),this.attributes=_m(V,this.program);var j=Tb(V,this.program);this.uniforms=xs(V,j)};Wi.prototype.bind=function(){this.gl.useProgram(this.program)},Wi.prototype.destroy=function(){this.gl};var Ym=function(M,X,J){var i=Lm(M,M.VERTEX_SHADER,X),D=Lm(M,M.FRAGMENT_SHADER,J);M.getShaderParameter(D,M.COMPILE_STATUS)||console.error(M.getError());var P=M.createProgram();return M.attachShader(P,i),M.attachShader(P,D),M.linkProgram(P),M.getProgramParameter(P,M.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",M.getProgramParameter(P,M.VALIDATE_STATUS)),console.error("gl.getError()",M.getError()),""!==M.getProgramInfoLog(P)&&console.warn("Warning: gl.getProgramInfoLog()",M.getProgramInfoLog(P)),M.deleteProgram(P),P=null),M.deleteShader(i),M.deleteShader(D),P},Lm=function(b,O,V){var I=b.createShader(O);return b.shaderSource(I,V),b.compileShader(I),b.getShaderParameter(I,b.COMPILE_STATUS)?I:(console.log(b.getShaderInfoLog(I)),null)},Tb=function(Y,v){for(var R={},L=Y.getProgramParameter(v,Y.ACTIVE_UNIFORMS),d=0;L>d;d++){var f=Y.getActiveUniform(v,d),z=f.name.replace(/\[.*?\]/,""),M=qh(Y,f.type);R[z]={type:M,size:f.size,location:Y.getUniformLocation(v,z),value:Fq(M,f.size)}}return R},_m=function(C,i){for(var R={},X=C.getProgramParameter(i,C.ACTIVE_ATTRIBUTES),o=0;X>o;o++){var B=C.getActiveAttrib(i,o),W=qh(C,B.type);R[B.name]={type:W,size:_o(W),gl:C,location:C.getAttribLocation(i,B.name),pointer:sd}}return R},sd=function(x,e,b,h,F){var n=this.gl;n.enableVertexAttribArray(this.location),x instanceof ld.Buffer||(x=ld.Buffer.createVertexBuffer(n,x)),n.bindBuffer(x.type,x.buffer),n.vertexAttribPointer(this.location,this.size,e||n.FLOAT,b||!1,h||0,F||0)},_o=function(E){return ps[E]},ps={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},qh=function(J,D){if(!$f){var v=L.keys(Ei);$f={};for(var V=0;V<v.length;++V){var g=v[V];$f[J[g]]=Ei[g]}}return $f[D]},$f=null,Ei={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Fq=function(w,s){switch(w){case"float":return 0;case"vec2":return new Float32Array(2*s);case"vec3":return new Float32Array(3*s);case"vec4":return new Float32Array(4*s);case"int":case"sampler2D":return 0;
case"ivec2":return new Int32Array(2*s);case"ivec3":return new Int32Array(3*s);case"ivec4":return new Int32Array(4*s);case"bool":return!1;case"bvec2":return Vn(2*s);case"bvec3":return Vn(3*s);case"bvec4":return Vn(4*s);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Vn=function(K){for(var q=new Array(K),x=0;x<q.length;x++)q[x]=!1;return q},xs=function(z,Y){var $={data:{}};$.gl=z;for(var M=L.keys(Y),x=0;x<M.length;x++){var m=M[x],e=m.split("."),E=e[e.length-1],W=ck(e,$),j=Y[m];W.data[E]=j,W.gl=z,L.defineProperty(W,E,{get:wr(E),set:Tc(E,j)})}return $},wr=function(v){var L=ub.replace("%%",v);return new Function(L)},Tc=function(H,O){var $,n=Sr.replace(/%%/g,H);return $=1===O.size?kp[O.type]:lj[O.type],$&&(n+="\nthis.gl."+$+";"),new Function("value",n)},ck=function(E,R){for(var n=R,H=0;H<E.length-1;H++){var q=n[E[H]]||{data:{}};n[E[H]]=q,n=q}return n},ub=["return this.data.%%.value;"].join("\n"),Sr=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),kp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},lj={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ze=Y.Light=function(){Ck(ze,this),this.s(Gn,v[Gn]),this.s(Ij,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};ij("Light",Vj,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(S,e,y){ze.superClass.onStyleChanged.apply(this,arguments),S===Gn&&this.s("shape3d.color",y)}});var bf=fl.Graph3dView=function(m,b){var e=this;e._webGLVersion=1,e._attributes=b||j.graph3dViewAttributes,e._25I={},e._view=Cd(1,e);var H=e._canvas=Uq(e._view);q(H,"webglcontextlost",function(B){B.preventDefault(),xc(e),e._26I&&e._doBufferGC(e._26I,!0),e._26I=O,e._1o.texture=O,e._35O=!0}),q(H,"webglcontextrestored",function(){e._35O=!1,e.iv()}),e._batchIndexMap={},e._batchModelMap={},e._wireframeIndexMap={},e._wireframeModelMap={},e._wireframeIndexMapSwap={},e._wireframeModelMapSwap={},e._polylineIndexMap={},e._polylineIndexMap={},e._polylineIndexMapSwap={},e._polylineIndexMapSwap={},e._8O=[],e._7O=Zk(),e._6O=Zk(),e._1o=new _p(e),e._30O=new Nn(e),e._31O=new Ch(e),e._32O=new Xm(e),e._raycaster=new rq(e),e._highlightHelper=new Ii(e),e._postProcessing=new mr(e),e._cameras=[],e._cameraId=0,e.vr=new Nr(e),e._33Q=!0,e._eye=qk(j.graph3dViewEye),e._center=qk(j.graph3dViewCenter),e._up=qk(j.graph3dViewUp),e._lightChanged=!1,e._59O=[],e._spots=[],e._dirs=[],e._frameId=0,e.overlappingBox=new sb(e),e.dm(m?m:new Dr),e._coreInteractor=new bd(this),e.setInteractors([new Ur(e)]),e._initView()},zc={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Pf=function(R,c,u,S){R.clearColor(0,0,0,0),R.clearDepth(1),R.enable(R.DEPTH_TEST),R.depthFunc(R.LEQUAL),R.disable(R.CULL_FACE),R.enable(R.BLEND),R.blendFuncSeparate(R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA,R.ONE,R.ONE_MINUS_SRC_ALPHA),R.useProgram(u),gl(R,u.uBrightness,1),gl(R,u.uOpacity,1),gl(R,u.uPartOpacity,1),gl(R,u.uPick,S._picking),gl(R,u.uTexture,!1),gl(R,u.uBlendTexture,!1),gl(R,u.uAlphaTest,v.alphaTest),gl(R,u.uTransparent,!1),gl(R,u.uFix,!1),gl(R,u.uBatchColor,!1),gl(R,u.uBatchBlend,!1),gl(R,u.uBatchBrightness,!1),gl(R,u.uReflectivity,S._envmapReflectivity),gl(R,u.uCameraPosition,c.getEye()),gl(R,u.uPMatrix,S._projectMatrix),gl(R,u.uViewMatrix,S._viewMatrix),c.bindEnvMap(R),S._picking||(ei(c,R,u),c._fogDisabled||(gl(R,u.uFogColor,c._fogColor),gl(R,u.uFogNear,c._fogNear),gl(R,u.uFogFar,c._fogFar))),ws(R,u.aPosition),ws(R,u.aNormal),Oq(R,u.aUv),Oq(R,u.aBatchColor),Oq(R,u.aBatchBlend),Oq(R,u.aBatchBrightness),Oq(R,u.aLineDistance),R.depthMask(!0)},Zl=0;or("Graph3dView",L,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Eb,kj,"firstPersonMode",qo,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",vh,vr,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:j.graph3dViewEditHelperDisabled,_blockSelectable:j.graph3dViewBlockSelectable,_devicePixelRatio:n,_boundaries:n,_moveStep:j.graph3dViewMoveStep,_rotateStep:j.graph3dViewRotateStep,_pannable:j.graph3dViewPannable,_rotatable:j.graph3dViewRotatable,_walkable:j.graph3dViewWalkable,_resettable:j.graph3dViewResettable,_zoomable:j.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:j.graph3dViewFirstPersonMode,_mouseRoamable:j.graph3dViewMouseRoamable,_gridVisible:j.graph3dViewGridVisible,_gridSize:j.graph3dViewGridSize,_gridGap:j.graph3dViewGridGap,_gridColor:j.graph3dViewGridColor,_originAxisVisible:j.graph3dViewOriginAxisVisible,_centerAxisVisible:j.graph3dViewCenterAxisVisible,_axisXColor:j.graph3dViewAxisXColor,_axisYColor:j.graph3dViewAxisYColor,_axisZColor:j.graph3dViewAxisZColor,_ortho:j.graph3dViewOrtho,_orthoWidth:j.graph3dViewOrthoWidth,_fovy:j.graph3dViewFovy,_near:j.graph3dViewNear,_far:j.graph3dViewFar,_headlightColor:j.graph3dViewHeadlightColor,_headlightIntensity:j.graph3dViewHeadlightIntensity,_headlightRange:j.graph3dViewHeadlightRange,_headlightAmbientIntensity:j.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:j.graph3dViewHeadlightDisabled,_rectSelectable:j.graph3dViewRectSelectable,_rectSelectBackground:j.graph3dViewRectSelectBackground,_editSizeColor:j.graph3dViewEditSizeColor,_autoMakeVisible:of,_fogDisabled:j.graph3dViewFogDisabled,_fogColor:j.graph3dViewFogColor,_fogNear:j.graph3dViewFogNear,_fogFar:j.graph3dViewFogFar,_pickerResolution:j.graph3dViewPickerResolution,_dashDisabled:j.graph3dViewDashDisabled,_batchColorDisabled:j.graph3dViewBatchColorDisabled,_batchBlendDisabled:j.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:j.graph3dViewBatchBrightnessDisabled,addCamera:function(z){var N=L.freeze({id:this._cameraId++,priority:z.priority||0,ignoreInPick:!!z.ignoreInPick,useDefaultProgram:!!z.useDefaultProgram,render:z.render});this._cameras.push(N),this._cameras.sort(function(u,b){return u.priority!==b.priority?u.priority-b.priority:u.id-b.id})},setEye:function(E,Z,U){1===arguments.length&&(Z=E[1],U=E[2],E=E[0]);var u=this._eye;u[0]=E,u[1]=Z,u[2]=U,this.fp(vh,O,u)},setCenter:function(Y,x,y){1===arguments.length&&(x=Y[1],y=Y[2],Y=Y[0]);var C=this._center;C[0]=Y,C[1]=x,C[2]=y,this.fp(vr,O,C)},setUp:function(y,K,p){1===arguments.length&&(K=y[1],p=y[2],y=y[0]);var z=this._up;z[0]=y,z[1]=K,z[2]=p,this.fp("up",O,z)},getDevicePixelRatio:function(){return this._devicePixelRatio||Vd},isTransparentMask:function(R){return R.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var A=this,L=A._aspect;return L?L:(L=A.getWidth()/A.getHeight(),L||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(J){var I=this,A=I._dataModel,q=I._selectionModel;A!==J&&(A&&(A.ump(I.handleDataModelPropertyChange,I),A.umm(I.handleDataModelChange,I),A.umd(I.handleDataPropertyChange,I),q||A.sm().ums(I.handleSelectionChange,I)),I._dataModel=J,J.mp(I.handleDataModelPropertyChange,I),J.mm(I.handleDataModelChange,I),J.md(I.handleDataPropertyChange,I),q?q._21I(J):J.sm().ms(I.handleSelectionChange,I),I._postProcessing.handleDataModleChange(A,J),I.invalidateAll(!0),I.invalidateLight(),I.fp(Rp,A,J),I._canvas.style.background=J.getBackground()||"")},handleDataModelPropertyChange:function(v){if("background"===v.property){var r=this._canvas.style.background,D=v.newValue||"";this._canvas.style.background=D,this.fp("canvasBackground",r,D)}else"envmap"===v.property&&this.iv()},handleDataPropertyChange:function(k){var N=k.data;this.invalidateData(N),wh(N)&&"s:light.type"===k.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(W){var F=this,R=W.property;F.iv(),F._18Q=O,"eye"===R?F._33Q=!0:"devicePixelRatio"===R?F._42(O,F.getDevicePixelRatio()):zc[R]&&xc(F)},_5O:function(C){var i=C._22Q();return i?new i(this,C):O},getData3dUI:function(c){var J=this._25I[c._id];return J===n&&(J=this._5O(c),this._25I[c._id]=J),J},invalidateAll:function(b){var r=this;if(b){for(var I in r._25I){var U=r._25I[I];U&&U.dispose()}r._25I={},r.iv(),uj(r)}else uj(r),r.dm().each(function(L){r.invalidateData(L)})},invalidateSelection:function(){var E=this;E.sm().each(function(m){E.invalidateData(m)})},invalidateData:function(U){var s=this,n=s.getData3dUI(U);n&&(n.iv(),s.iv()),uj(s,U)},getShape3dText:function(h){return h.getStyle("shape3d.text")||this.getLabel(h)},invalidateBatch:function(h){var Y=this,T=Y._batchModelMap,a=T[h],b=[],_={};if(a){a.ds.forEach(function(O){var n=Y.getData3dUI(O);n&&n.iv(),delete Y._batchIndexMap[O._id],b.push(O._id)}),delete T[h];for(var j,W,A,s,N,$,g,C,H,O=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],p=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],S=0;S<O.length;S++){var o=Y[O[S]],I=Y[p[S]];for(_={},C=0;C<b.length;C++){var M=I[b[C]];if(M){delete I[b[C]],H=M.batch,j=o[H];var F=M.begin,y=M.size,R=3*F,v=3*y,u=4*F,U=4*y;for(W=j.ds,A=j.vs,s=j.cs,N=j.ps,$=j.ls,g=M.index,j.invalidate=!0,W[g]=n,g=R;R+v>g;g++)A[g]=n;for(g=u;u+U>g;g++)s[g]=n;for(g=u;u+U>g;g++)N[g]=n;if($)for(g=R;R+v>g;g++)$[g]=n;_[H]=!0}}for(H in _){j=o[H],W=j.ds,A=j.vs,s=j.cs,N=j.ps,$=j.ls;var K=[];for(g=0;g<W.length;g++)W[g]!==n&&K.push(W[g]);if(0===K.length)delete o[H];else{for(j.ds=K,K=[],g=0;g<A.length;g++)A[g]!==n&&K.push(A[g]);for(j.vs=K,K=[],g=0;g<s.length;g++)s[g]!==n&&K.push(s[g]);for(j.cs=K,K=[],g=0;g<N.length;g++)N[g]!==n&&K.push(N[g]);if(j.ps=K,$){for(K=[],g=0;g<$.length;g++)$[g]!==n&&K.push($[g]);j.ls=K}}}}Y.iv()}},handleDataModelChange:function(r){var x=this,_=r.kind,$=r.data;if("add"===_)x.invalidateData($),_n($)&&$.getEdgeGroup()&&$.getEdgeGroup().eachSiblingEdge(x.invalidateData,x),wh($)&&x.invalidateLight();else if(_===Mp){var I=$._id,A=x._25I[I];A&&(A.dispose(),delete x._25I[I],x.iv()),$===x._currentSubGraph&&x.setCurrentSubGraph(O),uj(x,$),wh($)&&x.invalidateLight()}else _===zq&&(x.invalidateAll(!0),x.setCurrentSubGraph(O),uj(x),x.invalidateLight())},toCanvas:function(B,k,b){var Z=this,g=Z.getGL();if(Z.validate(),B){var z=g.getParameter(g.COLOR_CLEAR_VALUE);Rg(g,B)}Z._42(O,1);var $=Z.getWidth()||1,o=Z.getHeight()||1,A=new Uint8Array(4*$*o),F=Uq(),E=F.getContext("2d");g.readPixels(0,0,$,o,g.RGBA,g.UNSIGNED_BYTE,A),Xr(F,$,o,1);for(var C=E.getImageData(0,0,$,o),W=C.data,D=0;D<W.length;D+=4){var s=D/4,V=J(s/$),h=s-V*$;s=4*((o-1-V)*$+h),W[s]=A[D],W[s+1]=A[D+1],W[s+2]=A[D+2],W[s+3]=A[D+3]}if(E.putImageData(C,0,0),B&&Rg(g,z),Z._42(O,Z.getDevicePixelRatio()),k&&b){var p=Uq(),_=p.getContext("2d");return k=k,b=b,Xr(p,k,b,1),j.drawImage(_,F,0,0,k,b),p}return F},toDataURL:function(S,h){var k=this,g=k.getGL();if(k.validate(),S){var M=g.getParameter(g.COLOR_CLEAR_VALUE);Rg(g,S)}k._42(O,1);var l=k._canvas.toDataURL(h||"image/png",1);return S&&Rg(g,M),k._42(O,k.getDevicePixelRatio()),l},getGL:function(){var t=this._26I;if(t)return this.acquireProgram(),t;var i=this,h=i._canvas,j=i._attributes;try{t=h.getContext("webgl2",j)||h.getContext("experimental-webgl2",j),t&&(i._webGLVersion=2,i._26I=t)}catch(B){}if(!t)try{t=h.getContext("webgl",j)||h.getContext("experimental-webgl",j)}catch(B){throw new Error("WebGL not supported")}if(!t)throw new Error("WebGL not supported");i._26I=t,i._glExtensions=new y(t),i._glCapabilities=new Q(t,i._glExtensions),i._2O={},t._compiledShader={},t._emptyTexture=ce(t),t._emptyBlendTexture=ce(t),t._bufPool={},t._id=++Zl,i._buffer={vs:Al(t),ns:Al(t),is:Al(t),uv:Al(t),batchColor:Al(t),batchBlend:Al(t),batchBrightness:Al(t),lineDistance:Al(t)},i._1O=hf(t);var T=i._cube={vs:Al(t),ns:Al(t),is:Al(t),uv:Al(t)};return Ec(t,T.vs,Ue),Ec(t,T.ns,Pk),Ec(t,T.uv,Xg),wl(t,T.is,Il),i.acquireProgram(),t},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var B=this,u=B._26I;if(u){var r=j.getImage(B.getEnvmap()),P=r&&r.tagName?!0:!1,g=B._prg&&B._prg.envMapFlag?!0:!1;if(!B._prg||P!==g){var w=B._prg=u.createProgram();if(!w)return O;w.envMapFlag=P;var n=B._dirs.length,k=B._spots.length,p=B._59O.length,y=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];n&&y.push("uDirColor","uDirDirection"),k&&y.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),p&&y.push("uPointColor","uPointRange","uPointPosition"),Rg(u,[0,0,0,0]),u.clearDepth(1),u.enable(u.DEPTH_TEST),u.depthFunc(u.LEQUAL),u.enable(u.BLEND),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA),Ni||(Yb=$g(Yb.substring(0,Yb.indexOf("^#"))),es=$g(es),Ni=!0);var f=["#define MAX_DIR "+n,"#define MAX_SPOT "+k,"#define MAX_POINT "+p,B._fogDisabled?"":"#define FOG",B._dashDisabled?"":"#define DASH",P?"#define USE_ENVMAP":"",B.isOrtho()?"#define ORTHOGRAPHIC":"",B._batchColorDisabled?"":"#define BATCHCOLOR",B._batchBlendDisabled?"":"#define BATCHBLEND",B._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),v=Nm(u,w,u.VERTEX_SHADER,Yb.replace("PREFIX",f));u.getShaderParameter(v,u.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",u.getShaderInfoLog(v));var D=Nm(u,w,u.FRAGMENT_SHADER,es.replace("PREFIX",f));u.getShaderParameter(D,u.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",u.getShaderInfoLog(D)),kr?y.push("aPosition"):(w.aPosition=0,u.bindAttribLocation(w,0,"aPosition")),u.linkProgram(w),y.forEach(function(V){w[V]=/^u/.test(V)?u.getUniformLocation(w,V):u.getAttribLocation(w,V)}),u.useProgram(w),u.deleteShader(v),u.deleteShader(D)}}},getBrightness:function(b){var z=b.s("brightness"),n=this.isSelected(b)?b.s("select.brightness"):O;return z==O?n:n==O?z:z*n},setHighlightMode:function(p){var P;P="selection"===p||"selected"===p?Ii.Mode.Selection:"mouseover"===p||"hover"===p?Ii.Mode.MouseOver:"style"===p?Ii.Mode.Style:Ii.Mode.Disable;var C=this._highlightHelper.mode;this._highlightHelper.mode=P,this.firePropertyChange("highlightMode",C,P)},getHighlightMode:function(){var l=this._highlightHelper.mode;return l===Ii.Mode.Selection?"selected":l===Ii.Mode.MouseOver?"hover":l===Ii.Mode.Style?"style":"disabled"},getDataHighlightMode:function(c){return c.s("highlight.mode")},getHighlightColor:function(){return this._highlightHelper.color||v["highlight.color"]},setHighlightColor:function(O){var X=this._highlightHelper.color;this._highlightHelper.color=O,this.firePropertyChange("highlightColor",X,O)},getHighlightWidth:function(){return this._highlightHelper.width||v["highlight.width"]},setHighlightWidth:function(v){var Q=this._highlightHelper.width;this._highlightHelper.width=v,this.firePropertyChange("highlightWidth",Q,v)},bindEnvMap:function(J){var n=this,M=n._prg,W=5,k=n.getEnvmap(),t=j.getImage(k);if(t&&t.tagName){if(k!==n._lastEnvMap){t=j.resizeImagePOT(t,!0),n._envMapTexture&&J.deleteTexture(n._envMapTexture);var e=n._envMapTexture=J.createTexture();J.activeTexture(J.TEXTURE0),J.bindTexture(J.TEXTURE_CUBE_MAP,e),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,t),J.bindTexture(J.TEXTURE_CUBE_MAP,null),n._lastEnvMap=k}J.activeTexture(J.TEXTURE0+W),J.bindTexture(J.TEXTURE_CUBE_MAP,n._envMapTexture),J.uniform1i(M.uEnvMap,W)}},getWireframe:function(X){var I=X.s("wf.visible"),B=X.s("wf.width");return I===!0||B>0&&"selected"===I&&this.isSelected(X)?{color:X.s("wf.color"),width:B,"short":X.s("wf.short"),mat:X.s("wf.mat")}:void 0},_transformPointToViewSpace:function(J){var K=[J[0],J[1],J[2]];return $i(K,this._viewMatrix),K},_transformDirectionToViewSpace:function(K,o){var y=[K[0],K[1],K[2]];$i(y,this._viewMatrix);var j=o?[o[0],o[1],o[2]]:[0,0,0];$i(j,this._viewMatrix);var b=j[0]-y[0],V=j[1]-y[1],m=j[2]-y[2],C=Math.sqrt(b*b+V*V+m*m);return C?[b/C,V/C,m/C]:[b,V,m]},getWireframeGeometry:function(Q){return Q.s("wf.geometry")?{color:Q.s("wf.color"),width:Q.s("wf.width"),mat:Q.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(I){return I.s("body.color")},getMat:function(X){return X.getMat?X.getMat():X.s("mat")},getFaceMat:function(h,y){return h.getFaceMat?h.getFaceMat(y):h.s(y+".mat")},getFaceBlend:function(N,t){return N.s(t+".blend")||N.s("all.blend")},getFaceColor:function(M,T){return M.s(T+".color")||M.s("all.color")},getFaceImage:function(v,g){return v.s(g+".image")||v.s("all.image")},getFaceBlendImage:function(s,q){return s.s(q+".blend.image")||s.s("all.blend.image")},getFaceDiscardSelectable:function(E,i){var B=E.s(i+".discard.selectable");return B==O?E.s("all.discard.selectable"):B},getFaceUv:function(x,u){return x.s(u+".uv")||x.s("all.uv")},getFaceUvOffset:function(S,C){return S.s(C+".uv.offset")||S.s("all.uv.offset")},getFaceUvScale:function(X,h){return X.s(h+".uv.scale")||X.s("all.uv.scale")},getFaceLight:function(j,w){var T=j.s(w+".light");return T==O?j.s("all.light"):T},getFaceVisible:function(h,Q){var K=h.s(Q+".visible");return K==O?h.s("all.visible"):K},getFaceOpacity:function(Q,b){var r=Q.s(b+".opacity");return r==O?Q.s("all.opacity"):r},getFaceTransparent:function(n,T){var F=n.s(T+".transparent");return F==O?n.s("all.transparent"):F},getFaceReverseColor:function(F,L){return F.s(L+".reverse.color")||F.s("all.reverse.color")},getFaceReverseFlip:function(F,y){var m=F.s(y+".reverse.flip");return m==O?F.s("all.reverse.flip"):m},getFaceReverseCull:function(S,f){var U=S.s(f+".reverse.cull");return U==O?S.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function(z){var m=this,v=m._2O[z];v&&(delete m._2O[z],m.getGL().deleteTexture(v))},invalidateCachedTexture:function(d){var q=this.getData3dUI(d);q.invalidateCachedTexture(this.getGL()),this.invalidateData(d)},invalidateShape3dCachedImage:function(E){this.invalidateCachedTexture(E)},invalidateCachedGeometry:function(b){var d=this.getData3dUI(b);d.invalidateCachedGeometry(),this.invalidateData(b)},isInteractive:function(h){return h.s("interactive")},getTexture:function($,y,f){if(!$)return O;var c=this,b=c.getGL(),t=c._2O[$];if(!t){var X=co($),p={mipmapMaxLevel:y?y.s("texture.mipmap.max"):n};if(!X)return b._emptyTexture;if(X.uuid||(X.uuid=Y.Math.generateUUID()),X.tagName){if(X.dynamic)return hf(b,X,c._1O,p);t=c._2O[$]=hf(b,X,n,p)}else{var I,g=y&&(y.s("texture.cache")||y.s("shape3d.image.cache")||X.textureCache),S=c.vr.isPresenting();if(S&&(y._textureUpdateFrame===b._renderInfo.frame?g=!0:y._textureUpdateFrame=b._renderInfo.frame),g&&(I=c.getData3dUI(y),t=I.getCachedTexture(f),t&&I.interactiveInfo&&t.interactiveInfo&&(I.interactiveInfo[t.interactiveInfo.key]=t.interactiveInfo.info)),!t){var e=b._renderInfo.textureCache;if(g){if(e.time>j.graph3dMaxVectorCacheTime)return c.redraw(),b._emptyTexture;if(!Ak(X,y))return b._emptyTexture}var z;y&&(1!==y.s("texture.scale")?z=y.s("texture.scale"):1!==y.s("shape3d.texture.scale")&&(z=y.s("shape3d.texture.scale"))),z||(z=1);var L=y&&(y.s("fixSizeOnScreen")||y.s("shape3d.fixSizeOnScreen")),s=L?b.NEAREST:b.LINEAR;L?"number"==typeof L&&(z*=0>L?1:L):y&&(y.s("vector.dynamic")||y.s("shape3d.vector.dynamic"))&&(I||(I=c.getData3dUI(y)),L=I.getVectorDynamicSize());var J,A,B,K=y&&y.s("shape3d");"billboard"===K?B=y.getTall()/y.getWidth():"plane"===K&&(B=y.getHeight()/y.getWidth());var i=Ne(X,y);if(L){var H=c.getDevicePixelRatio();J=L[0]>0?L[0]*H:z*i*H,A=L[1]>0?L[1]*H:z*(B?Jf(X,y,c,Math.min(4096,i*B)):Jf(X,y))*H}else J=z*i,A=z*(B?Jf(X,y,c,Math.min(4096,i*B)):Jf(X,y));if(J>=1&&A>=1){var C=0;(g||S)&&(C=Date.now());var w=$h(J,A);if(!I&&y&&(I=c.getData3dUI(y)),I&&I.interactiveInfo){var T=$;"object"==typeof T&&(T=T.uuid||(T.uuid=Y.Math.generateUUID()));var r=I.interactiveInfo[T]={};w.interactiveInfo=r.bodyInfo={compInfos:[],matrix:new Hm,rect:{x:0,y:0,width:J,height:A}}}vf(w,X,0,0,J,A,y,c),w.interactiveInfo&&(w.interactiveInfo=null),w.restore(),e.count++,e.pixels+=J*A,y?(p.minFilter=y.s("texture.filter.min")||y.s("texture.filter")||s,p.magFilter=y.s("texture.filter.mag")||y.s("texture.filter")||s):p.minFilter=p.magFilter=s,g||S?(t=hf(b,Ie,null,p),I.setCachedTexture(t,f),e.time+=Date.now()-C,r&&(t.interactiveInfo={key:T,info:r}),Ie=null):t=hf(b,Ie,c._1O,p)}}}}return t},redraw:function(){this.iv()},validateImpl:function(){var P=this;if(P._lightChanged){P._lightChanged=!1;var r=[],B=[],X=[];P.dm().each(function(Z){if(wh(Z)){var m=Z.s("light.type");m===_c?r.push(Z):m===Sj?B.push(Z):m===ql&&X.push(Z)}}),(r.length!==P._59O.length||B.length!==P._spots.length||X.length!==P._dirs.length)&&xc(P),P._59O=r,P._spots=B,P._dirs=X}P._42(),P._1o.iv()},getRenderInfo:function(){var j=this.getGL();return j?j._renderInfo:void 0},getDebugTip:function(){var b=this,H=b.getRenderInfo();if(H){var K=b.getGL()._validBufCount||0,u="Draw Calls: "+H.calls+"<br/>"+"Vertices: "+H.vertices+"<br/>"+"Faces: "+H.faces+"<br/>"+"Lines: "+H.lines+"<br/>"+"Buffers: "+K+"<br/>"+"Cache Models: "+L.keys(mq).length+"<br/>"+"Shape3d Models: "+L.keys(pf).length;b.vr.isPresenting()&&(u+="<br/>VR fps: "+b.vr.getFps());var l=H.textureCache.count;if(u+="<br/>2D Dynamic Textures: "+H.textureCache.count,l>0){var D,y=H.textureCache.pixels;D=y>1e6?Math.round(y/1e6)+"M":y>1e3?Math.round(y/1e3)+"K":Math.round(y),u+="<br/>2D Dynamic pixels: "+D}return u}},_42:function(r,B){var Z=this;if(!Z._35O&&(!Rr||_g(Rr))){var h,D;r&&(r instanceof Vj?D=r:h=r);var o=Z._canvas,F=Z.getGL(),E=Z._prg;if(F){var g=Z.getWidth(),V=Z.getHeight();if(g&&V){B?r||Xr(o,g,V,B):(B=Z.getDevicePixelRatio(),r||g===o.clientWidth&&V===o.clientHeight||(Xr(o,g,V,B),g&&Math.abs(F.drawingBufferWidth-g*B)>1&&(Z.setDevicePixelRatio(B=F.drawingBufferWidth/g),Xr(o,g,V,B)))),F.clear(F.COLOR_BUFFER_BIT),Z.drawFilter||(F._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:r?Z._frameId:++Z._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var x,e=this._cameras,J=0,m=e.length,c=!1,U=Y.Default.cameraPriority.skybox,S=Y.Default.cameraPriority.main,u=Y.Default.cameraPriority.top,N=g*B,t=V*B,G=function(){Z.overlappingBox.clear(),Z._81O=O,F.clear(F.DEPTH_BUFFER_BIT),F._picking=!!r;var H={_picking:!!r,_envmapReflectivity:Z._envmapReflectivity||.5,_projectMatrix:Z._projectMatrix=sg(Z),_viewMatrix:wc(Z,Z._7O)};if(Z._viewMatrix=ii(Z._7O),D){Pf(F,Z,E,H);var M=F.getParameter(F.COLOR_CLEAR_VALUE);F.clearColor(0,0,0,0),F.disable(F.BLEND),Oq(F,E.aNormal),Ec(F,Z._cube.vs,O,E.aPosition),wl(F,Z._cube.is),tj(D,Z,dj,0),tj(D,Z,pj,6),tj(D,Z,xq,12),tj(D,Z,qp,18),tj(D,Z,nh,24),tj(D,Z,$c,30),ws(F,E.aNormal),Rg(F,M)}else if(h){for(h.value=2;m>J;J++)if(x=e[J],!x.ignoreInPick){if(x.priority>=S)break;x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z,h)}Pf(F,Z,E,H);var M=F.getParameter(F.COLOR_CLEAR_VALUE);for(F.clearColor(0,0,0,0),F.disable(F.BLEND),F.textureBatch&&!_g[(ONE_FRAME_TIME-6)/2]||Z._95I(F,E,h),wn(Z,h),Gl(Z,Z._polylineModelMap,h),Gl(Z,Z._wireframeModelMap,h),gl(F,E.uTransparent,!0),Z._95I(F,E,h,!0),wn(Z,h,!0),Gl(Z,Z._polylineModelMap,h,!0),Gl(Z,Z._wireframeModelMap,h,!0),gl(F,E.uTransparent,!1);m>J;J++)if(x=e[J],!x.ignoreInPick){if(x.priority>=u)break;x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z,h),c=!0}for(c&&(Pf(F,Z,E,H),c=!1),F.clear(F.DEPTH_BUFFER_BIT),Z._swapLineMap(),Z._95I(F,E,h,!1,!0),Gl(Z,Z._polylineModelMap,h),Gl(Z,Z._wireframeModelMap,h),Z._swapLineMap(),Z._swapLineMap(),Z._95I(F,E,h,!1,!0),Gl(Z,Z._polylineModelMap,h),Gl(Z,Z._wireframeModelMap,h),gl(F,E.uTransparent,!0),Z._95I(F,E,h,!0,!0),Gl(Z,Z._polylineModelMap,h,!0),Gl(Z,Z._wireframeModelMap,h,!0),gl(F,E.uTransparent,!1),Z._swapLineMap(),F.disable(F.DEPTH_TEST),Z.drawFilter||Z._30O._42(F,E,h),F.enable(F.DEPTH_TEST);m>J;J++)x=e[J],x.ignoreInPick||(x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z,h));Rg(F,M)}else{for(;m>J&&(x=e[J],!(x.priority>=U));J++)x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z);for(Pf(F,Z,E,H),F.disable(F.BLEND),Z.drawSky(F,E),Z.drawReflectors(F,N,t,G,r)&&(H._projectMatrix=Z._projectMatrix=sg(Z),H._viewMatrix=wc(Z,Z._7O),Z._viewMatrix=ii(Z._7O),Pf(F,Z,E,H));m>J&&(x=e[J],!(x.priority>=S));J++)x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z),c=!0;for(c&&(Pf(F,Z,E,H),c=!1),Z._31O._42(F,E),Z._95I(F,E),wn(Z),Gl(Z,Z._polylineModelMap),Gl(Z,Z._wireframeModelMap),F.enable(F.BLEND),F.depthMask(!1),gl(F,E.uTransparent,!0),Z._95I(F,E,O,!0),wn(Z,O,!0),Gl(Z,Z._polylineModelMap,O,!0),Gl(Z,Z._wireframeModelMap,O,!0),F.depthMask(!0),gl(F,E.uTransparent,!1);m>J&&(x=e[J],!(x.priority>=u));J++)x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z),c=!0;for(c&&(Pf(F,Z,E,H),c=!1),F.clear(F.DEPTH_BUFFER_BIT),Z._swapLineMap(),F.disable(F.BLEND),Z._95I(F,E,O,!1,!0),Gl(Z,Z._polylineModelMap),Gl(Z,Z._wireframeModelMap),F.enable(F.BLEND),gl(F,E.uTransparent,!0),F.depthMask(!1),Z._95I(F,E,O,!0,!0),Gl(Z,Z._polylineModelMap,O,!0),Gl(Z,Z._wireframeModelMap,O,!0),F.depthMask(!0),gl(F,E.uTransparent,!1),Z._swapLineMap(),F.disable(F.DEPTH_TEST),F.disable(F.BLEND),Z._32O._42(F,E),Z._30O._42(F,E),Z._highlightHelper._42(F,E),F.enable(F.DEPTH_TEST);m>J;J++)x=e[J],x.useDefaultProgram&&Pf(F,Z,E,H),x.render(F,Z)}Ec(F,O),wl(F,O)},n=!1,I=Z.vr;I.enable&&I._42(F,N,t,G)&&(n=!0);var M=Z.envRenderer;M&&M.enable&&M._42(F,N,t,G)&&(n=!0);var X=Z._postProcessing;X._42(F,N,t,G,r)&&(n=!0),n||(Z.setViewport(F,0,0,g*B,V*B),G()),Z._33Q=!1,Z.drawFilter||Z.countFrame(),Z._doBufferGC(F)}}}},drawReflectors:function(h,E,o,b,d){h._renderInfo.reflectDepth++;var v,f,m,V=this,P=V._dataModel.getReflectors(),B=!1;for(v in P)f=P[v],V.isVisible(f)&&(m=V.getData3dUI(f),m&&m.drawReflector(h,E,o,b,d)&&(B=!0));return h._renderInfo.reflectDepth--,B},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(x,J){return this._postProcessing.enableModule(x,J)},getPostProcessingModule:function(g){return this._postProcessing.getModule(g)},getPostProcessingValue:function(U,v){var A=this._postProcessing.getModule(U);return A?A[v]:n},setPostProcessingValue:function(d,J,b){var Q=this.getPostProcessingValue(d,J),q=this._postProcessing.getModule(d);q&&Q!==b&&("enable"===J?this.enablePostProcessing(d,b):q[J]=b,this.firePropertyChange("postProcessing."+d+"."+J,Q,b))},setViewport:function(Z,p,d,V,M){this._viewport=[p,d,V,M],Z.viewport(p,d,V,M)},getViewport:function(){return this._viewport},setBufferGCInterval:function(C){this._bufferGCInterval=C},_doBufferGC:function(F,i){var H,K,d=F._bufPool,O=0,b=0,r=F._renderInfo.frame,v=this._bufferGCInterval||10;for(H in d)O++,K=d[H],K&&(i||r-K._fid>v?(F.deleteBuffer(K._buf),K._buf=null,d[H]=null):b++);if(O/2>b&&O>128){var $={};for(H in d)d[H]&&($[H]=d[H]);F._bufPool=$}F._validBufCount=b},_swapLineMap:function(){var k=this;Vh=k._polylineModelMap,k._polylineModelMap=k._polylineModelMapSwap,k._polylineModelMapSwap=Vh,Vh=k._wireframeModelMap,k._wireframeModelMap=k._wireframeModelMapSwap,k._wireframeModelMapSwap=Vh,Vh=k._polylineIndexMap,k._polylineIndexMap=k._polylineIndexMapSwap,k._polylineIndexMapSwap=Vh,Vh=k._wireframeIndexMap,k._wireframeIndexMap=k._wireframeIndexMapSwap,k._wireframeIndexMapSwap=Vh},_updateSkyBox:function(F){if(this._skyBox&&F){var y=F.property,i=!1,x=this._skyBox;if("eye"===y||"forceUpdate"===y){var L=this._eye;x.p3(L[0],L[1],L[2]),i=!0}if("near"===y||"far"===y||"forceUpdate"===y){var w=this._near,X=this._far,I=x.getFinalScale3d();if(I[0]/=2,I[1]/=2,I[2]/=2,I[0]<=w||I[0]>=X||I[1]<=w||I[1]>=X||I[2]<=w||I[2]>=X){var z=2*w*X/(w+X),M=Math.min(I[0],I[1],I[2]),b=z/M,$=x.getScale3d();x.setScale3d($[0]*b,$[1]*b,$[2]*b),i=!0}}i&&this.invalidateData(x)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(x){var A=this._skyBox;A&&(this._skyBoxStyleMap&&A.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&A.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&A.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=x,this.ump(this._updateSkyBox,this),x&&(x.dm()&&x.dm().remove(x),this._skyBoxStyleMap=Y.Default.clone(x.getStyleMap()),this._skyBoxAnchor3d=x.getAnchor3d(),x.setAnchor3d(.5,.5,.5),this._skyBoxP3=x.p3().slice(0),x.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",A,x)},drawSky:function(d,f,R){var w=this,J=w._skyBox;if(J){var W=w._headlightIntensity,S=Yr(w._headlightColor),f=w._prg;1!==W&&(S=[S[0]*W,S[1]*W,S[2]*W]),gl(d,f.uHeadlightColor,[S[0],S[1],S[2],1]);var D=w.getData3dUI(J);if(D){var $,F=w.isOrtho(),x=F||this._computedProjectMatrix;x&&($=w._projectMatrix,F&&(w._ortho=!1),gl(d,f.uPMatrix,w._projectMatrix=sg(w,!0)));var e=J.p3(),B=this._eye;(e[0]!==B[0]||e[1]!==B[1]||e[2]!==B[2])&&(J._position.x=B[0],J._54O=B[1],J._position.y=B[2]),D._42(d,f,R,function(){return!0}),x&&(F&&(w._ortho=!0),gl(d,f.uPMatrix,w._projectMatrix=$))}d.clear(d.DEPTH_BUFFER_BIT),gl(d,f.uHeadlightColor,[S[0],S[1],S[2],w._headlightDisabled?1:0])}},_95I:function(l,j,m,T,i){function q(e){if(!(!e.s("alwaysOnTop")&&!e.s("shape3d.alwaysOnTop"))==!!i&&I.isVisible(e)&&(!a||x)){if(!m&&I.isTransparentMask(e))return;
var Z=I.getData3dUI(e);Z&&Z._42(l,j,m,b)}}var I=this,b=function(W){return T?W:!W};I.sky&&l.clear(l.DEPTH_BUFFER_BIT);var z=I.drawFilter;z?I.dm().each(function(h){z(h)||q(h)}):I.dm().each(function(l){q(l)})},getLogicalPoint:function(t){return jn(t,this._canvas)},isRectOverlapping:function(q){var Y=this.getData3dUI(q);return Y._rectOverlapping},getHitFaceInfo:function(C){C.target&&(C=this.lp(C));var M=this.getDataInfoAt(C);if(M){var x=this._1o.face(M.data,Vp(C.x,C.y));if(x)return{data:M.data,face:x}}return O},unproject:function(c,X){var j=this,r=j.getWidth(),B=j.getHeight(),k=c.target?j.lp(c):c,L=k.x-r/2,y=k.y-B/2,Q=2*(L/r),S=2*(-1*y/B);X=X||0;var e=Zk(),p=sg(j),l=wc(j);cd(e,p,l),os(e);var f=ci([Q,S,X,1],e);return[f[0]/f[3],f[1]/f[3],f[2]/f[3]]},getDataAt:function(K){var w=this.getDataInfoAt(K);return w?w.data:O},getDataInfoAt:function(Y,m){return Y.target&&(Y=this.lp(Y)),this._1o.get(Vp(Y.x,Y.y,m),!0)},getDatasInRect:function(j){return this._1o.get(j)},setEditable:function(e){var P=this,d=P._editable;P._editable=e,this.fp(tm,d,e)},isEditable:function(u){var U=this;return u?U._editable?De(u)?u.s("3d.editable")?U._editableFunc?U._editableFunc(u):!0:!1:!1:!1:U._editable},isSelectable:function(B){return B.s("3d.selectable")&&this.sm().isSelectable(B)},isMovable:function(A){var z=this;return _n(A)&&A.getStyle(Jq)!==Nj?!1:A.s("3d.movable")?z._movableFunc?z._movableFunc(A):!0:!1},isSizeEditable:function(d){return De(d)?this._sizeEditableFunc?this._sizeEditableFunc(d):!0:!1},isRotationEditable:function(X){return De(X)&&X.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(X):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(d){this.setZoom(Ze,d)},zoomOut:function(b){this.setZoom(1/Ze,b)},setZoom:function(){var W=new sh,d=new sh,I=new sh,n=new sh;return function(e,u){if(1!==e){var K=this;K._14o&&K._14o.stop(!0);var r,z=1/e;W.copy(K.getCenter()),d.copy(K.getEye());var R=K._ortho;if(R){if(r=K._orthoWidth,r<K._moveStep&&e>1)return}else if(W.distanceTo(d)<K._moveStep&&1>z)return;var a=!1;return K._zoomToCenter===!1&&K._lastZoomLP&&(I.copy(d).sub(W).normalize(),K._81O=null,n.copy(K.getHitPosition(K._lastZoomLP,W.toArray(),I.toArray())),a=!0,K._lastZoomHit=n),(u=vo(u))?(u.action=function(H){K.fi({kind:K._zooming?"betweenZoom":"beginZoom"}),K._zooming=1;var L=(z-1)*H+1;R&&K.setOrthoWidth(r*L),a?(K.setEye(I.lerpVectors(n,d,L).toArray()),K.setCenter(I.lerpVectors(n,W,L).toArray())):R||K.setEye(I.lerpVectors(W,d,L).toArray())},u._37o=function(){delete K._14o,delete K._zooming,K.fi({kind:"endZoom"}),K.onZoomEnded()},K._14o=Zc(u)):(R&&K.setOrthoWidth(r*z),a?(K.setEye(I.lerpVectors(n,d,z).toArray()),K.setCenter(I.lerpVectors(n,W,z).toArray())):R||K.setEye(I.lerpVectors(W,d,z).toArray()),void 0)}}}(),setOrthoZoom:function(d,b){return this.setZoom(d,b)},getPositionInfo:function(Y){var O=this,b=O._eye,a=O._center,y=O.getAspect(),l=Y?Lg(hi(a,b,!0),hi(Y,b)):rs(b,a);if(O._ortho){var W=O._orthoWidth;return{length:l,height:W/y,width:W}}var $=2*D(O._fovy/2)*l;return{length:l,height:$,width:$*y}},getCenterInfo:function(){var H=this;return H._81O||(H._81O=H.getPositionInfo()),qk(H._81O)},rotate:function(f,v,W,z){var F=this;if(f||v){z==O&&(z=F._firstPersonMode),F._88O&&F._88O.stop(!0);var m=F._center,K=F._eye,A=F.getCenterInfo().length,h=z?m:K,p=z?K:m,u=hi(h,p),C=E(u[0],u[2]),l=E(e(u[0]*u[0]+u[2]*u[2]),u[1]),I=z?vr:vh;return z&&(v=-v),(W=vo(W))?(W.action=function(B){F.fi({kind:F._rotating?"betweenRotate":"beginRotate"}),F._rotating=1;var s=C+f*B,j=l+v*B;j=z?t-He(t-j):He(j),u[0]=A*N(j)*N(s),u[1]=A*c(j),u[2]=A*N(j)*c(s),h[0]=p[0]+u[0],h[1]=p[1]+u[1],h[2]=p[2]+u[2],F.fp(I,O,h)},W._37o=function(){delete F._88O,delete F._rotating,F.fi({kind:"endRotate"}),F.onRotateEnded()},F._88O=Zc(W)):(C+=f,l+=v,l=z?t-He(t-l):He(l),u[0]=A*N(l)*N(C),u[1]=A*c(l),u[2]=A*N(l)*c(C),h[0]=p[0]+u[0],h[1]=p[1]+u[1],h[2]=p[2]+u[2],F.fp(I,O,h),void 0)}},pan:function($,U,Z,I){if($||U){var W=this;I==O&&(I=W._firstPersonMode),W._89O&&W._89O.stop(!0);var v=wc(W),R=[v[0]*$,v[4]*$,v[8]*$],h=[v[1]*U,v[5]*U,v[9]*U],d=R[0]+h[0],i=R[1]+h[1],V=R[2]+h[2],X=W._center,f=W._eye;if(I){var _=$d(W.getBoundaries(),f[0],f[2],f[0]+d,f[2]+V,e(d*d+V*V));d=_[0],V=_[1]}if(Z=vo(Z)){var s=qk(f),p=qk(X);return Z.action=function($){W.fi({kind:W._panning?"betweenPan":"beginPan"}),W._panning=1,X[0]=p[0]+d*$,X[1]=p[1]+i*$,X[2]=p[2]+V*$,f[0]=s[0]+d*$,f[1]=s[1]+i*$,f[2]=s[2]+V*$,W.fp(vh,O,f),W.fp(vr,O,X)},Z._37o=function(){delete W._89O,delete W._panning,W.fi({kind:"endPan"}),W.onPanEnded()},W._89O=Zc(Z)}X[0]+=d,X[1]+=i,X[2]+=V,f[0]+=d,f[1]+=i,f[2]+=V,W.fp(vh,O,f),W.fp(vr,O,X)}},walk:function(h,y,T){if(h){var e=this;T==O&&(T=e._firstPersonMode),e._90O&&e._90O.stop(!0);var c=e._center,Z=e._eye,A=hi(c,Z,!0);if(T){var Q=$d(e.getBoundaries(),Z[0],Z[2],Z[0]+A[0]*h,Z[2]+A[2]*h,w(h));if(h=rs(Q),!h)return;A=[Q[0]/h,0,Q[1]/h]}if(y=vo(y)){var s=qk(Z),t=qk(c);return y.action=function(z){e.fi({kind:e._walking?"betweenWalk":"beginWalk"}),e._walking=1;var L=h*z;Z[0]=s[0]+A[0]*L,Z[1]=s[1]+A[1]*L,Z[2]=s[2]+A[2]*L,c[0]=t[0]+A[0]*L,c[1]=t[1]+A[1]*L,c[2]=t[2]+A[2]*L,e.fp(vh,O,Z),e.fp(vr,O,c)},y._37o=function(){delete e._90O,delete e._walking,e.fi({kind:"endWalk"}),e.onWalkEnded()},e._90O=Zc(y)}Z[0]+=A[0]*h,Z[1]+=A[1]*h,Z[2]+=A[2]*h,c[0]+=A[0]*h,c[1]+=A[1]*h,c[2]+=A[2]*h,e.fp(vh,O,Z),e.fp(vr,O,c)}},handleScroll:function(R,e){R.preventDefault();var b=this,D=b._moveStep,C=b.getDataInfoAt(R);if(C){var S=C.data;if(S&&b.isInteractive(S)){var J=b.intersectObject(R,S);if(J){var w=J.part,O=co(S.s(w+".image")||S.s("shape3d."+w+".image")||S.s("all.image")||S.s("shape3d.image"));if(O&&lc(O.scrollable,S,b))return}}}return b.isFirstPersonMode()?(b.isPannable()&&b.pan(0,e>0?D:-D),void 0):(b.isZoomable()&&(b._lastZoomLP=b.lp(R),b.setZoom(0>e?1/Sn:Sn),b._lastZoomLP=b._lastZoomHit=null),void 0)},handlePinch:function(d,U){if(this.isZoomable()){if(Math.abs(d-U)<j.pinchZoomThreshold)return;this.setZoom(U>d?1/qm:qm)}},reset:function(){this.setCenter(j.graph3dViewCenter),this.setEye(j.graph3dViewEye),this.setUp(j.graph3dViewUp)},moveSelection:function(L,M,v){var I=this;I.dm().beginTransaction(),qq(this.sm().toSelection(this.isMovable,this),L,M,v),I.dm().endTransaction()},getMoveMode:function(M,W){var c=W.s("3d.move.mode");if(c)return c;var E="88",f="89",V="90";return Hc(M)||Ej[E]&&Ej[f]&&Ej[V]?"xyz":Ej[E]&&Ej[f]?"xy":Ej[E]&&Ej[V]?"xz":Ej[f]&&Ej[V]?"yz":Ej[E]?"x":Ej[f]?"y":Ej[V]?"z":"xz"},handleTick:function(){var y=this,v=!1,J=y._moveStep,f=J,x=!1,$=!0,b=y._rotateStep*($?-1:1);if(y.isWalkable()||(f=0),y.isPannable()||(J=0),y.isRotatable()||(b=0),y._32Q){var O=(Af()-y._32Q)/50;f*=O,J*=O,b*=O}y._31Q&&(nl(y._31Q),delete y._31Q,delete y._32Q),Zg()&&(v=!0,y.pan(-J,0,x,$)),Ap()&&(v=!0,y.pan(J,0,x,$)),Cm()&&(v=!0,Hc()?y.pan(0,J,x,$):y.walk(f,x,$)),af()&&(v=!0,Hc()?y.pan(0,-J,x,$):y.walk(-f,x,$)),Fk()&&(v=!0,y.rotate(-b,0,x,$)),tc()&&(v=!0,y.rotate(b,0,x,$)),fb()&&(v=!0,y.rotate(0,-b/2,x,$)),dc()&&(v=!0,y.rotate(0,b/2,x,$)),v&&(y._32Q=Af(),y._31Q=Bj(y.handleTick,y))},handleKeyDown:function(Z){var F=this;!_e(Z)&&fj[Z.keyCode]?F.handleTick():hl(Z)?F.selectAll():Zr(Z)?F.handleDelete(Z):ym(Z)&&this.isResettable()&&F.reset()},checkDoubleClickOnNote:function(g,T,k){var V=this;if(k===Fb){if(T.s("note.toggleable"))return T.s(Pd,!T.s(Pd)),V.fi({kind:"toggleNote",event:g,data:T,part:k}),!0}else if(k===mb&&T.s("note2.toggleable"))return T.s(Zi,!T.s(Zi)),V.fi({kind:"toggleNote2",event:g,data:T,part:k}),!0;return!1},checkDoubleClickOnRotation:function(F,h,u){return u===dd?(h.setRotationX(0),!0):u===lq?(h.setRotationY(0),!0):u===Ag?(h.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(V){var h=this;if(h.isOrtho())return h.getWidth()/h.getOrthoWidth();var j=h.getCenter(),n=h.getHeight(),y=h.getEye(),q=[j[0]-y[0],j[1]-y[1],j[2]-y[2]],v=[V[0]-y[0],V[1]-y[1],V[2]-y[2]],$=Math.sqrt(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]),B=1/Math.tan(h.getFovy()/2);return n*$*B/(v[0]*q[0]+v[1]*q[1]+v[2]*q[2])},inViewSpace:function(o){var s,E=this,m=E._transformPointToViewSpace(o),T=E.getAspect(),M=E.getNear(),V=E.getFar();return-m[2]<M||-m[2]>V?!1:E.isOrtho()?(s=E.getOrthoWidth()/2,Math.abs(m[0])<=s&&Math.abs(m[1]*T)<=s):(s=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])*Math.tan(E.getFovy()/2),Math.abs(m[1]<=s)&&Math.abs(m[0])<=s*T)},getPVMatrix:function(){var x=this,B=x.getWidth()/2,N=x.getHeight()/2,q=x._18Q;return q&&q._wh===B/N||(q=sg(x),x._18Q=cd(q,q,wc(x)),x._18Q._wh=B/N),q},getFrustum:function(){var R=new Hf,n=new ed,x=new Array(16);return function(){for(var L=this.getPVMatrix(),O=!1,s=0;16>s;s++)L[s]!==x[s]&&(O=!0,x[s]=L[s]);return O&&n.setFromMatrix(R.fromArray(L)),n}}(),toViewPosition:function(S){var X=this,I=X.getWidth()/2,y=X.getHeight()/2,L=X.getPVMatrix();return S=ci([S[0],S[1],S[2],1],L),{x:I+I*S[0]/S[3],y:y-y*S[1]/S[3],z:S[2]/S[3]}},getHitPosition:function(C,U,V){var O=this,J=O.getWidth(),A=O.getHeight(),Q=C.target?O.lp(C):C,c=Q.x-J/2,H=Q.y-A/2,v=O.getCenterInfo(),x=wc(O);U=U?U:[0,0,0],V=V?V:[0,1,0],c=c/J*v.width,H=-1*H/A*v.height;var m=[x[0]*c,x[4]*c,x[8]*c],R=[x[1]*H,x[5]*H,x[9]*H],y=[m[0]+R[0],m[1]+R[1],m[2]+R[2]],L=O.getCenter(),Y=zp(O,U,V,[y[0]+L[0],y[1]+L[1],y[2]+L[2]]);return Y?Y:[0,0,0]},intersectObject:function(n,x){return this._raycaster.intersectObject(n,x)},intersectObjects:function(A,d,z){return this._raycaster.intersectObjects(A,d,z)},getLineLength:function(h){this.validate();var w=this.getData3dUI(h);if(w&&w.getCache){var X=w.getCache();if(X)return X[X.length-1].length}return 0},getLineOffset:function(h,x){var y=this.getData3dUI(h);if(y&&y.getCache){var Q=y.getCache();if(Q){var D=Fe(Q,x);if(!h.r3)return D;var l=h.r3();if(0===l[0]&&0===l[1]&&0===l[2])return D;var T=new sh(h.p3()),N=new sh(D.point).sub(T),e=new sh(D.tangent).add(N),S=(new Rf).setFromEuler(new Gj(l,h.getRotationMode(),!0));return N.applyQuaternion(S),e.applyQuaternion(S),{point:N.add(T),tangent:e.sub(N).normalize()}}}return O},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(K,C,P){var y=this,D=y.getEye();D=[D[0],D[1],D[2]];var e=y.getCenter();if(e=[e[0],e[1],e[2]],K||(K=D),C||(C=e),y._flyAnim&&y._flyAnim.stop(!0),P=vo(P),!P)return y.setEye(K[0],K[1],K[2]),y.setCenter(C[0],C[1],C[2]),delete y._flyAnim,!0;var w=[K[0]-D[0],K[1]-D[1],K[2]-D[2]],q=[C[0]-e[0],C[1]-e[1],C[2]-e[2]];return P.action=function(F){y.setCenter(e[0]+q[0]*F,e[1]+q[1]*F,e[2]+q[2]*F),y.setEye(D[0]+w[0]*F,D[1]+w[1]*F,D[2]+w[2]*F)},P._37o=function(){delete y._flyAnim},y._flyAnim=Zc(P)},flyTo:function(){function $(c,p,O){if(O instanceof Y.Node){r.fromArray(mk(O,p.getMat(O)));var S=O.getAnchor3d();c.push((new sh).set(0-S.x,0-S.y,0-S.z).applyMatrix4(r)),c.push((new sh).set(0-S.x,0-S.y,1-S.z).applyMatrix4(r)),c.push((new sh).set(0-S.x,1-S.y,0-S.z).applyMatrix4(r)),c.push((new sh).set(0-S.x,1-S.y,1-S.z).applyMatrix4(r)),c.push((new sh).set(1-S.x,0-S.y,0-S.z).applyMatrix4(r)),c.push((new sh).set(1-S.x,0-S.y,1-S.z).applyMatrix4(r)),c.push((new sh).set(1-S.x,1-S.y,0-S.z).applyMatrix4(r)),c.push((new sh).set(1-S.x,1-S.y,1-S.z).applyMatrix4(r))}}var j=new sh,N=new sh,P=new sh,t=new sh,r=new Hf,k=new Y.Math.Quaternion,I=new Gj;return function(q,A,C){var V=this;if(C!==n)A={animation:A,ratio:C};else{var W=typeof A;("boolean"===W||"object"===W&&A.duration)&&(A={animation:A})}A=A||{},j.fromArray(V.getEye()),N.fromArray(V.getCenter());var z,g,d=[],F=A.center,f=A.distance===n;if(F&&P.fromArray(F),q instanceof Y.Node)F||P.fromArray(q.p3()),f&&($(d,V,q),z=d.length);else{if(q||(q=V.dm().getDatas()),!q.length)return;if((f||!F)&&(d=[],q.forEach(function(u){$(d,V,u)}),z=d.length,!z))return;if(!F){for(P.set(0,0,0),g=0;z>g;g++)P.add(d[g]);P.multiplyScalar(1/z)}}if(V.setCenter(P.x,P.y,P.z),t.subVectors(j,N),A.direction||A.worldDirection){!A.worldDirection&&q instanceof Y.Node?k.setFromEuler(I.set(q.r3(),q.getRotationMode(),!0)):k.set(0,0,0,1);var K=t.length();t.fromArray(A.worldDirection||A.direction).applyQuaternion(k).setLength(K)}var E=0;if(f){var J,x,X,C=A.ratio||.8,e=A.xRatio||C,r=A.yRatio||C;if(V.isOrtho()){var G=-1/0;for(V._eye[0]=t.x+P.x,V._eye[1]=t.y+P.y,V._eye[2]=t.z+P.z,J=sg(V),cd(J,J,wc(V)),g=0;z>g;g++)X=d[g],x=ci([X.x,X.y,X.z,1],J),G=Math.max(G,Math.max(Math.abs(x[0])/e,Math.abs(x[1])/r));E=V.getOrthoWidth()*G,t.add(P)}else{for(var v,S,D=V.getNear(),O=10;O--;){for(V._eye[0]=t.x+P.x,V._eye[1]=t.y+P.y,V._eye[2]=t.z+P.z,J=sg(V),cd(J,J,wc(V)),v=!0,S=-1/0,g=0;z>g;g++){if(X=d[g],x=ci([X.x,X.y,X.z,1],J),x[3]<D&&O){t.multiplyScalar(2),v=!1;break}S=Math.max(S,Math.max(Math.abs(x[0])/e,Math.abs(x[1])/r)-x[3])}if(v)break}t.setLength(S+t.length()).add(P)}}else t.setLength(A.distance).add(P);V._flyAnim&&V._flyAnim.stop(!0);var u=vo(A.animation);if(u){V.setEye(j.x,j.y,j.z),V.setCenter(N.x,N.y,N.z);var H=(new sh).subVectors(t,j),B=(new sh).subVectors(P,N);if(E)var y=V.getOrthoWidth();var Q=new sh,_=new sh,a=u.action,U=u._37o,i=j.clone(),R=N.clone();return u.action=function(e,G){Q.copy(i).addScaledVector(H,e),_.copy(R).addScaledVector(B,e),V.setCenter(_.x,_.y,_.z),V.setEye(Q.x,Q.y,Q.z),E&&V.setOrthoWidth((E-y)*e+y),a&&a(e,G)},u._37o=function(){delete V._flyAnim,U&&U()},{lastEye:j,lastCenter:N,eye:t,center:P,orthoWidth:E,animation:V._flyAnim=Zc(u)}}return V.setEye(t.x,t.y,t.z),E&&V.setOrthoWidth(E),delete V._flyAnim,{lastEye:j,lastCenter:N,eye:t,center:P,orthoWidth:E}}}(),getBoundingBox:function(){function Z(R,C,z){V.fromArray(mk(z,C.getMat(z)));var j=z.getAnchor3d();R.push((new sh).set(0-j.x,0-j.y,0-j.z).applyMatrix4(V)),R.push((new sh).set(0-j.x,0-j.y,1-j.z).applyMatrix4(V)),R.push((new sh).set(0-j.x,1-j.y,0-j.z).applyMatrix4(V)),R.push((new sh).set(0-j.x,1-j.y,1-j.z).applyMatrix4(V)),R.push((new sh).set(1-j.x,0-j.y,0-j.z).applyMatrix4(V)),R.push((new sh).set(1-j.x,0-j.y,1-j.z).applyMatrix4(V)),R.push((new sh).set(1-j.x,1-j.y,0-j.z).applyMatrix4(V)),R.push((new sh).set(1-j.x,1-j.y,1-j.z).applyMatrix4(V))}var V=new Hf;return function(n){if(n=n||this.sm().getSelection(),n instanceof Y.Node&&(n=[n]),0===n.length)return O;var g=[];n.forEach(function(G){Z(g,this,G)},this);var i=[1/0,1/0,1/0],y=[-1/0,-1/0,-1/0];return g.forEach(function(t){i[0]=Math.min(t.x,i[0]),i[1]=Math.min(t.y,i[1]),i[2]=Math.min(t.z,i[2]),y[0]=Math.max(t.x,y[0]),y[1]=Math.max(t.y,y[1]),y[2]=Math.max(t.z,y[2])}),{min:i,max:y}}}()}),fl.RenderEnv=function(N){this.gv=N,this.enable=!1},L.defineProperties(fl.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(p){this._debugOn=p,this.capture&&this.capture()}}}),L.assign(fl.RenderEnv.prototype,{renderEnvToCube:function(J,v,i,a){var A=this,G=A.gv;if(!J||!v||!i)return A.enable=!1,A._42=null,void 0;A.enable=!0;var Q=Math.floor(a/J*v),I=G.getGL(),s=A._renderTargets;s?s.length<i&&(s=A._renderTargets=s.concat(new Array(i-s.length))):s=A._renderTargets=new Array(i);for(var D=0;i>D;D++)s[D]?s[D].setSize(I,a,Q):s[D]=new fl.RenderTarget(G,I,a,Q);var T=!1;A.capture=function(){T=!0,G._42(),T=!1};var V=new sh,c=new sh,q=new sh,d=new sh,B=(new sh).setY(0),t=2*Math.PI/i,m=J/2/Math.tan(Math.PI/i),o=2*Math.atan2(v/2,m),n=J/v;A._42=function(z,O,u,w){var D=A._debugOn;if(!T&&!D)return!1;V.copy(G.getEye()),d.copy(G.getCenter()).sub(V);var F=Math.atan2(d.z,d.x),f=G.getNear(),L=G.getFovy(),r=G.getAspect();c.copy(G.getCenter());for(var Z,y=0;i>y;y++)if(Z=s[y],B.setZ(Math.cos(F)).setX(Math.sin(F)).multiplyScalar(m),F-=t,q.addVectors(V,B),G.setNear(m),G.setCenter([q.x,q.y,q.z]),G.setFovy(o),G.setAspect(n),D){var x=Math.round(O/i);z.viewport(x*y,0,x,u),w()}else gm(z,Z.frame),z.viewport(0,0,Z.width,Z.height),z.clear(z.COLOR_BUFFER_BIT),w(),Se(z),Z.assureTexture();return G.setNear(f),G.setCenter([c.x,c.y,c.z]),G.setFovy(L),G.setAspect(r),!0},A.capture()},getTextureInfo:function(P){var B=this._renderTargets;if(!B)return null;var S=this._renderTargets[P];return S?{index:P,texture:S.texture,textureName:S.uuid}:null}}),L.assign(fl.Graph3dView.prototype,{renderEnvToCube:function(I,L,M,V){var R=this;R.envRenderer||(R.envRenderer=new fl.RenderEnv(R)),R.envRenderer.renderEnvToCube(I,L,M,V)}}),fl.RenderTarget=function(r,d,H,J,t){var m=this;t=t||{},t.samples=Math.min(r._glCapabilities.maxSamples,t.samples&&t.samples>1&&2===r._webGLVersion?t.samples:0),m.options=t,m.uuid=Y.Math.generateUUID(),m.gv=r,m.init(r,d,t),t.samples&&!r._glCapabilities._maxSamplesChecked?m.setSize(d,H||1,J||1):m.setSize(d,H,J)},L.assign(fl.RenderTarget.prototype,{bind:function(V){gm(V,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(h){Se(h),this.options.samples&&(h.bindFramebuffer(h.READ_FRAMEBUFFER,this._MSAAFbo),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,this.frame),h.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,h.COLOR_BUFFER_BIT,h.NEAREST),h.bindFramebuffer(h.READ_FRAMEBUFFER,null),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,null))},init:function(M,a,z){var _=this,V=_.texture=a.createTexture();a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,V);var L=z.samples,f=L?a.NEAREST:a.LINEAR;a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,z.minFilter||f),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,z.magFilter||f),a.bindTexture(a.TEXTURE_2D,null),_.render=a.createRenderbuffer(),_.frame=a.createFramebuffer(),M._2O[_.uuid]=V},assureTexture:function(){var q=this,b=q.uuid,X=q.gv._2O;X[b]||(X[b]=q.texture)},setSize:function(V,q,h){var D=this;if(q&&h&&(D.width!==q||D.height!==h)){var b=V.RGBA,u=V.TEXTURE_2D,w=V.RENDERBUFFER,U=V.FRAMEBUFFER,H=D.options.samples;if(Qr(V,D.texture),V.texImage2D(u,0,b,q,h,0,b,V.UNSIGNED_BYTE,O),Jm.isPOT(q)&&Jm.isPOT(h)&&!D.options.clampToEdge?(V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.REPEAT),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.REPEAT)):(V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE)),V.bindRenderbuffer(w,D.render),H){var X=D.gv._glCapabilities;if(X._maxSamplesChecked)V.renderbufferStorageMultisample(w,H,V.DEPTH_COMPONENT16,q,h);else{for(V.getError();H>1&&(V.renderbufferStorageMultisample(w,H,V.DEPTH_COMPONENT16,q,h),V.getError());)H=Math.floor(H>>1);1>=H&&(H=0,V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,D.options.minFilter||V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,D.options.magFilter||V.LINEAR),V.renderbufferStorage(w,V.DEPTH_COMPONENT16,q,h)),X._maxSamplesChecked=!0,X.maxSamples=D.options.samples=H}}else V.renderbufferStorage(w,V.DEPTH_COMPONENT16,q,h);H&&!D._MSAAFbo&&(D._MSAAFbo=V.createFramebuffer(),D._MSAARbO=V.createRenderbuffer()),gm(V,D.frame),V.framebufferTexture2D(U,V.COLOR_ATTACHMENT0,u,D.texture,0),H||V.framebufferRenderbuffer(U,V.DEPTH_ATTACHMENT,w,D.render),Se(V),H&&(V.bindRenderbuffer(V.RENDERBUFFER,D._MSAARbO),V.renderbufferStorageMultisample(V.RENDERBUFFER,H,V.RGBA8,q,h),gm(V,D._MSAAFbo),V.framebufferRenderbuffer(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.RENDERBUFFER,D._MSAARbO),V.framebufferRenderbuffer(U,V.DEPTH_ATTACHMENT,w,D.render),Se(V)),Qr(V,O),V.bindRenderbuffer(w,O),D.width=q,D.height=h}},toCanvas:function(){var z=this,W=z.gv.getGL();gm(W,z.frame);var T=z.width,m=z.height,x=new Uint8Array(4*T*m);W.readPixels(0,0,T,m,W.RGBA,W.UNSIGNED_BYTE,x),Se(W);var j=d.createElement("canvas");j.width=T,j.height=m;var w=j.getContext("2d"),t=w.createImageData(T,m);return t.data.set(x),w.putImageData(t,0,0),j}});var gh=fl.Interactor=function(j){this.gv=this.g3d=j};or("Interactor",L,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Ur=fl.DefaultInteractor=function(g){Ck(Ur,this,[g])};or("DefaultInteractor",gh,{getDataInfoAt:function(c,G){var u=this.gv,E=u.getDataInfoAt(c);if(!u.isBlockSelectable()||!E||!E.data)return E;if(!G&&u.isSelected(E.data))return E;for(var L=E.data;(L=L.getParent())&&L instanceof Y.Block&&u.isSelectable(L);){var w=u.isSelected(L);if(w&&G)break;if(E={data:L,part:E},w&&!G)break}return E},handle_contextmenu:function(t){zh(t)},handle_mousewheel:function(k){this.gv.handleScroll(k,k.wheelDelta/40)},handle_DOMMouseScroll:function(l){2===l.axis&&this.gv.handleScroll(l,-l.detail)},handle_keydown:function(n){this.gv.handleKeyDown(n)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(Y){zh(Y);var D=this,q=D.gv,B=mg(Y),l=D.getDataInfoAt(Y),Q=l?l.data:O,R=l?l.part:O,n=q.sm(),u=yj(Y),z=Am(Y);q.setFocus(Y)&&(D._62O=O,D._57I=O,D.pendingClickThrough=O,D.__lastClientPoint__=up(Y),Q?_e(Y)?n.co(Q)?n.rs(Q):n.as(Q):n.co(Q)?Q instanceof nk&&Q.isClickThroughEnabled()&&mg(Y)&&(D.pendingClickThrough=up(Y)):n.ss(Q):B&&(_e(Y)?q.isRectSelectable()&&(D._62O=$r):D._57I=up(Y)),D._31Q&&(nl(D._31Q),delete D._31Q,delete D._32Q),D._62O||(q.isFirstPersonMode()&&(Hc(Y)||Bq(Y)||z>2?D._62O="pan":q.isMouseRoamable()||Hh(Y)?(D._62O="roaming",D.foward=u&&mg(Y),D._32Q=Af(),D._31Q=Bj(D.tick,D)):B||(D._62O="roaming")),D._62O||(B&&u&&tf[R]?(D._62O=R,D.p3=Q.p3()):B&&u&&De(Q)&&q.isSelected(Q)?q.isMovable(Q)?(D._62O="move",D.p3=Q.p3(),D.movedata=Q):q._39Q(Q)&&(D._62O="none"):Hh(Y)&&(z>2?D._62O="pan":2===z&&(D.dist=Im(Y),D._62O="pinch")))),D.point=q.lp(Y),Bi(D,Y),vl(Y)?q.handleDoubleClick(Y,Q,R):q.handleClick(Y,Q,R))},tick:function(){var g=this,_=g.gv,s=_._moveStep;g.point&&_.isWalkable()&&(g._32Q&&(s*=(Af()-g._32Q)/50),_.walk(g.foward?s:-s),g._32Q=Af(),g._31Q=Bj(g.tick,g))},handle_mouseup:function(s){this.handle_touchend(s)},handle_touchend:function(m){var q=this._57I;if(q&&(rs(q,up(m))<=1&&this.gv.sm().cs(),this._57I=O),q=this.pendingClickThrough){if(rs(q,up(m))<=1){var z=this.getDataInfoAt(m);z&&z.data instanceof nk&&z.data.isClickThroughEnabled()&&(z=this.getDataInfoAt(m,!0),z&&(m.clickThrough=!0,this.gv.sm().ss(z.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(P){var B,C,z=this,t=z.gv,K=z._62O,c=z.point,G=t.dm(),$=t.lp(P),q=$.x-c.x,k=$.y-c.y,W=t.getWidth(),O=t.getHeight();if(W&&O){var J=up(P),N=xf(t,J,z.__lastClientPoint__),Y=rs({x:0,y:0},N),H=-A*q/W,m=-A*k/O;if("roaming"===K)z.rotate(P,H/2,m/2);else if(K===dd||K===lq||K===Ag)t._86O||G.beginTransaction(),t.fi({kind:t._86O?"betweenEditRotation":"beginEditRotation",event:P}),t._86O=1,t.sm().each(function($){if(De($)&&t.isRotationEditable($)){var p=w(H)>w(m)?H:m;K===dd?$.setRotationX($.getRotationX()+p):K===lq?$.setRotationY($.getRotationY()+p):K===Ag&&$.setRotationZ($.getRotationZ()+p)}});else if("move"===K||tf[K]){if(K===To||K===el||K===ee)t._87O||G.beginTransaction(),t.fi({kind:t._87O?"betweenEditScale":"beginEditScale",event:P}),t._87O=1;else{if(!t._moving){if(Y<j.touchMoveThreshold)return;G.beginTransaction()}t.fi({kind:t._moving?"betweenMove":"beginMove",event:P}),t._moving=1}var Z,r=z.p3,R=t.getPositionInfo(r),I=wc(t);Z=K===Np?"x":K===Rd?"y":K===Cf?"z":K===To?"sx":K===el?"sy":K===ee?"sz":t.getMoveMode(P,z.movedata),q=q/W*R.width,k=-1*k/O*R.height;var L,x,n=[I[0]*q,I[4]*q,I[8]*q],g=[I[1]*k,I[5]*k,I[9]*k],X=n[0]+g[0],d=n[1]+g[1],h=n[2]+g[2],Q=[r[0]+X,r[1]+d,r[2]+h],p=hi(t.getEye(),Q,!0);if("xyz"===Z?(L=Q,t.moveSelection(X,d,h)):"xz"===Z?(L=zp(t,r,[0,1,0],Q),L&&t.moveSelection(L[0]-r[0],0,L[2]-r[2])):"xy"===Z?(L=zp(t,r,[0,0,1],Q),L&&t.moveSelection(L[0]-r[0],L[1]-r[1],0)):"yz"===Z?(L=zp(t,r,[1,0,0],Q),L&&t.moveSelection(0,L[1]-r[1],L[2]-r[2])):"x"===Z||"sx"===Z?(p[0]=0,L=zp(t,r,p,Q),L&&(x=L[0]-r[0],"x"===Z?t.moveSelection(x,0,0):t.sm().each(function(m){De(m)&&t.isSizeEditable(m)&&(B=m.getScaleX()+x/100,C=B/m.getScaleX(),m.setScaleX(B),Hc(P)&&(m.setScaleY(m.getScaleY()*C),m.setScaleTall(m.getScaleTall()*C)))}))):"y"===Z||"sy"===Z?(p[1]=0,L=zp(t,r,p,Q),L&&(x=L[1]-r[1],"y"===Z?t.moveSelection(0,x,0):t.sm().each(function(S){De(S)&&t.isSizeEditable(S)&&(B=S.getScaleTall()+x/100,C=B/S.getScaleTall(),S.setScaleTall(B),Hc(P)&&(S.setScaleY(S.getScaleY()*C),S.setScaleX(S.getScaleX()*C)))}))):("z"===Z||"sz"===Z)&&(p[2]=0,L=zp(t,r,p,Q),L&&(x=L[2]-r[2],"z"===Z?t.moveSelection(0,0,x):t.sm().each(function(i){De(i)&&t.isSizeEditable(i)&&(B=i.getScaleY()+x/100,C=B/i.getScaleY(),i.setScaleY(B),Hc(P)&&(i.setScaleX(i.getScaleX()*C),i.setScaleTall(i.getScaleTall()*C)))}))),!L)return;z.p3=L}else if(K===$r){var F=z.div;F||(F=z.div=Tj(),cr(z.getView(),F),F.op=c,F.style.background=t.getRectSelectBackground()),t.fi({kind:t._rectSelecting?"betweenRectSelect":"beginRectSelect",event:P}),t._rectSelecting=1,F.rect=pr(F.op,$),dg(F,F.rect)}else if("pinch"===K&&2===Am(P)){t.fi({kind:t._pinching?"betweenPinch":"beginPinch",event:P}),t._pinching=1;var x=Im(P);t._lastZoomLP||(t._lastZoomLP=li(P)),t.handlePinch(x,z.dist),z.dist=x}else"pan"===K||Hc(P)||Bq(P)?z.pan(P,q,k):"none"===K||t.isFirstPersonMode()||z.rotate(P,H,m);z.point=$}},pan:function(p,Y,l){var e=this.gv;if(e.isPannable()){var v=e.getWidth(),y=e.getHeight();if(!v||!y)return;var N=e.getCenterInfo(),Z=Y/v*N.width,O=-1*l/y*N.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:p}),e._panning=1,e.pan(-Z,-O)}},rotate:function(S,u,n){var J=this.gv;J.isRotatable()&&(J.fi({kind:J._rotating?"betweenRotate":"beginRotate",event:S}),J._rotating=1,J.rotate(u,n))},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(A){var g=this,F=g.gv,E=F.dm(),i=g.div;if(i){var w=F.getDatasInRect(i.rect);if(!w.isEmpty()){var p=F.sm(),N=p.toSelection();w.each(function(u){p.co(u)?N.remove(u):N.add(u)}),p.ss(N)}go(i)}F._moving&&(delete F._moving,F.fi({kind:"endMove",event:A}),F.onMoveEnded(),E.endTransaction()),F._panning&&(delete F._panning,F.fi({kind:"endPan",event:A}),F.onPanEnded()),F._rotating&&(delete F._rotating,F.fi({kind:"endRotate",event:A}),F.onRotateEnded()),F._86O&&(delete F._86O,F.fi({kind:"endEditRotation",event:A}),E.endTransaction()),F._87O&&(delete F._87O,F.fi({kind:"endEditScale",event:A}),E.endTransaction()),F._pinching&&(delete F._pinching,F.fi({kind:"endPinch",event:A}),F.onPinchEnded()),F._rectSelecting&&(delete F._rectSelecting,F.fi({kind:"endRectSelect",event:A}),F.onRectSelectEnded()),F._walking&&(delete F._walking,F.fi({kind:"endWalk",event:A}),F.onWalkEnded()),F._lastZoomLP=F._lastZoomHit=null,g.dist=g.point=g._62O=g.p3=g.movedata=g.div=g._57I=g.pendingClickThrough=g._32Q=g._31Q=g.foward=O,g.__lastClientPoint__=O}});var np=fl.MapInteractor=function(A){Ck(np,this,[A]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};or("MapInteractor",gh,{handle_contextmenu:function(P){zh(P)},handle_mousewheel:function(z){this.gv.handleScroll(z,z.wheelDelta/40)},handle_DOMMouseScroll:function(U){2===U.axis&&this.gv.handleScroll(U,-U.detail)},handle_keydown:function(X){this.gv.handleKeyDown(X)},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(D){zh(D);var j=this,v=j.gv;if(v.setFocus(D)){var G=v.getDataInfoAt(D),y=G?G.data:O,Z=G?G.part:O,T=j.editing={point:v.lp(D)};Hh(D)?T.touch=!0:(T.touch=!1,T.clickLeft=mg(D),T.pan=Bq(D)?!0:"left"===this.panButton===T.clickLeft),y&&v._39Q(y)&&(T.preventDefault=!0),Bi(j,D),vl(D)?v.handleDoubleClick(D,y,Z):v.handleClick(D,y,Z)}},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(){},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(C){var v=this,u=v.gv,x=v.editing;if(x){var P=u.lp(C),g=x.point,l=P.x-g.x,m=P.y-g.y;if(!x.moved){if(Math.abs(l)<v.threshold&&Math.abs(m)<v.threshold&&!(C.touches&&C.touches.length>1))return;x.moved=!0}if(!x.preventDefault)if(x.point=P,x.touch){var E=C.touches.length;if(2!==E)v.pan(C,l,m);else{if(1>=E)return;var o=C.touches,G={x:o[0].clientX,y:o[0].clientY},Q={x:o[1].clientX,y:o[1].clientY},p={x:Q.x-G.x,y:Q.y-G.y},L=x.lastCenter,_=Math.atan2(p.y,p.x),D=x.theta,B=0;D==O?D=x.theta=_:(B=_-D,x.thetaStarted||Math.abs(B)>v.touchRotateThreshold?(x.thetaStarted=!0,x.theta=_):B=0);var y=t*(G.y+Q.y)/2/u.getHeight(),r=x.phi,V=0;r==O?r=x.phi=y:(V=y-r,x.phiStarted||Math.abs(V)>v.touchRotateThreshold?(x.phiStarted=!0,x.phi=y):V=0);var n,c=Math.sqrt(p.x*p.x+p.y*p.y),H=x.vlen;if(H){var b=G.x-L.x,Z=G.y-L.y,d=Q.x-L.x,M=Q.y-L.y,h=Math.sqrt(b*b+Z*Z),a=Math.sqrt(d*d+M*M),z=H/2,W=v._sign2(h-z),$=v._sign2(a-z);0>W*$||0===W&&0===$?(n=1,x.vlen=c):(n||(n=c/H),x.scaleStarted||Math.abs(n-1)>v.touchScaleThreshold?(x.vlen=c,x.scaleStarted=!0):n=1)}else H=x.vlen=c,n=1;1!==n&&u.setZoom(n),(V||B)&&v.rotate(C,B,-V),x.lastCenter={x:(Q.x+G.x)/2,y:(Q.y+G.y)/2}}}else if(x.pan)v.pan(C,l,m);else{var K=u.getWidth(),S=u.getHeight();if(!K||!S)return;var i=-A*l/K,Y=-A*m/S;v.rotate(C,i,Y)}}},_sign2:function(I){return Math.abs(I)<this._touchScaleCheckAccuracy?0:I>0?1:-1},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(k){var s=this,J=s.editing;if(s.editing=null,J){var S=s.gv;if(J.moved||!J.clickLeft&&!J.touch)S._panning=null,S._rotating=null,S.fi({kind:J.pan?"endPan":"endRotate",event:k});else{var P=S.getDataAt(k);P?S.sm().setSelection([P]):S.sm().clearSelection()}}},pan:function(e,o,M){var A=this,q=A.gv;if(q.isPannable()){var d=q.getWidth(),D=q.getHeight();if(d&&D){var V=q.getCenterInfo(),Y=-o/d*V.width,y=1*M/D*V.height;q.fi({kind:q._panning?"betweenPan":"beginPan",event:e}),q._panning=1;var U=A.keepHorizon,u=A.editing.touch;if((u&&e.touches&&e.touches.length>1||!u&&Hc(e))&&(U=!U),!U)return q.pan(Y,y);if(Y||y){var Q=wc(q),b=[Q[0]*Y,Q[4]*Y,Q[8]*Y],X=[Q[1],0,Q[9]],z=Math.sqrt(X[0]*X[0]+X[2]*X[2]);z&&(X=[X[0]/z*y,0,X[2]/z*y]);var G=b[0]+X[0],j=b[1]+X[1],S=b[2]+X[2],i=q._center,R=q._eye;i[0]+=G,i[1]+=j,i[2]+=S,R[0]+=G,R[1]+=j,R[2]+=S,q.fp(vh,O,R),q.fp(vr,O,i)}}}},rotate:function(Z,T,C){var d=this,i=d.gv;if(i.isRotatable()){var n=i._center,M=i._eye,S=hi(M,n),q=E(e(S[0]*S[0]+S[2]*S[2]),S[1]),s=He(q+C);C=s-q,i.fi({kind:i._rotating?"betweenRotate":"beginRotate",event:Z}),i._rotating=1,i.rotate(T,C)}}}),L.defineProperties(np.prototype,{panButton:{get:function(){return this._panButton},set:function(z){this._panButton=z}},minPhi:{get:function(){return j.graph3dViewMinPhi},set:function(o){j.graph3dViewMinPhi=o}},maxPhi:{get:function(){return j.graph3dViewMaxPhi},set:function(M){j.graph3dViewMaxPhi=M}},keepHorizon:{get:function(){return this._keepHorizon},set:function(N){this._keepHorizon=N}},threshold:{get:function(){return this._threshold},set:function(r){this._threshold=r}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(U){this._touchScaleThreshold=U}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(S){this._touchRotateThreshold=S}}});var ao,Vr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",rp=32,we=fl.GlobeInteractor=function(w,M){Ck(we,this,[w]);
var j,P=M.radius||6378137,o=this,g=null;ao||(ao=Tj(),ao.style.border="",ao.style.backgroundImage="url("+Vr+")");var _=new Rf,a=new sh,G=new sh,B=new sh,m=new Ub,n="number"==typeof P?{x:P,y:P,z:P}:P,h={center:new sh(0,0,0),radius:n},k=function(Z){w._81O=null;var q=w.getHitPosition(Z,w.getCenter(),a.copy(w.getEye()).sub(G.copy(w.getCenter())).toArray());return m.origin.copy(w.getEye()),m.direction.copy(q).sub(m.origin).normalize(),m.intersectEllipsoid(h)},u=function(E,r){w._81O=null,m.origin.copy(w.getEye());for(var P,F,W=w.getCenter(),U=a.copy(w.getEye()).sub(G.copy(w.getCenter())).toArray(),D=1,V=16,S=0,z=1,i={x:0,y:0};V--;){if(i.x=r.x+(E.x-r.x)*D,i.y=r.y+(E.y-r.y)*D,P=w.getHitPosition(i,W,U),m.direction.copy(P).sub(m.origin).normalize(),F=m.intersectEllipsoid(h),F&&1===D)return{hit:F};F?S=D:z=D,D=(S+z)/2}return{hit:F,out:1>D}},z=function(H,R){if(g){var I=Date.now();g.deltaTime=g.lastTime?I-g.lastTime:1e3,g.lastTime=I,g.lastAxis=H,g.lastAngle=R}R&&(_.setFromAxisAngle(H,R),w.setEye(a.copy(w.getEye()).applyQuaternion(_).toArray()),w.setCenter(a.copy(w.getCenter()).applyQuaternion(_).toArray()),w.setUp(a.copy(w.getUp()).applyQuaternion(_).toArray()))};o._showCrossIcon=function(T){cr(o.getView(),ao),dg(ao,{x:T.clientX-rp/2,y:T.clientY-rp/2,width:rp,height:rp})},o._hideCrossIcon=function(){go(ao)},o._scrollImpl=function(l,F){g={point:w.lp(l),screen:up(l),hit:k(l),type:"right"},g.hitNormalize=g.hit?g.hit.clone().normalize():new sh;var s={clientX:g.screen.x,clientY:g.screen.y+10*F};o._handleMoveImpl(s),o._endMoveImpl(s)},o._startMoveImpl=function(C){j&&(j.stop(!0),j=null),g={point:w.lp(C),screen:up(C),hit:k(C)},g.hitNormalize=g.hit?g.hit.clone().normalize():new sh,Hh(C)?1===C.touches.length?g.hit&&(g.type="left"):2===C.touches.length&&(g.type="touch2"):(mg(C)?g.hit&&(g.type="left"):ue(C)?g.type="right":Bq(C)&&g.hit&&(g.type="middle"),!g.hit||"right"!==g.type&&"middle"!==g.type||o._showCrossIcon(C)),g.type&&Bi(o,C)},o._handleMoveImpl=function(p){if(g)switch(g.type){case"left":return o._handleLeft(p);case"right":return o._handleRight(p);case"middle":return o._handleMiddle(p);case"touch2":return o._handleTouch2(p)}},o._endMoveImpl=function(){if(g){if(this._hideCrossIcon(),"left"===g.type||"middle"===g.type){var A=1e3*(g.lastAngle/(g.deltaTime||30)),w=g.lastAxis,P=g.lastTime,B=function(){var M=Date.now(),n=(M-P)/1e3;return P=M,A*=Math.pow(Math.abs(o.decelerationRate),3*n),Math.abs(A)<.01?(A=0,j&&j.stop(),void 0):(z(w,A*n),void 0)};j=Zc({action:function(){B(arguments)},duration:5e3})}g=null}},o._handleLeft=function(T){if(!g.finished){var s=up(T),q=u(s,g.lastScreen||g.screen);if(g.lastScreen=s,!q.hit)return g.finished=!0,o._endMoveImpl(T),void 0;var Z=q.hit;Z.normalize();var n=g.hitNormalize,M=Math.acos(Z.dot(n)),A=Z.cross(n).normalize();z(A,M),q.out&&(g.finished=!0,o._endMoveImpl(T))}},o._handleRight=function($){var K=g.lastScreen||g.screen,d=K.y;K=g.lastScreen=up($);var u=K.y,I=u-d;if(I){var W=Math.min(.5,I*o.scaleSpeed);a.copy(w.getEye());var j=g.hit;j||(j=a.clone().divide(n).normalize().multiply(n)),G.copy(a).lerp(j,W),w.setEye(G.toArray()),a.copy(w.getUp()),G.normalize();var Q=a.clone().cross(G).normalize();if(B.copy(w.getCenter()),B.sub(Q.multiplyScalar(B.dot(Q))),w.setCenter(B.toArray()),g.hit){var E=k(g.screen),p=g.hitNormalize;if(E){E.normalize();var f=Math.acos(E.dot(p)),Y=E.cross(p).normalize();f&&z(Y,f)}}}};var c=function(i){return Math.abs(i)<.01?0:i>0?1:-1};o._handleTouch2=function(M){var Z=M.touches.length;if(2===Z){var C=M.touches,Y={x:C[0].clientX,y:C[0].clientY},n={x:C[1].clientX,y:C[1].clientY},V={x:n.x-Y.x,y:n.y-Y.y},R=g.lastCenter,r=Math.atan2(V.y,V.x),B=g.theta,F=0;B==O?B=g.theta=r:(F=r-B,g.thetaStarted||Math.abs(F)>.03?(g.thetaStarted=!0,g.theta=r):F=0);var i,f=Math.sqrt(V.x*V.x+V.y*V.y),v=g.vlen;if(v){var D=Y.x-R.x,H=Y.y-R.y,m=n.x-R.x,l=n.y-R.y,d=Math.sqrt(D*D+H*H),I=Math.sqrt(m*m+l*l),U=v/2,x=c(d-U),s=c(I-U);0>x*s||0===x&&0===s?(i=1,g.vlen=f):(i||(i=f/v),g.scaleStarted||Math.abs(i-1)>.05?(g.vlen=f,g.scaleStarted=!0):i=1)}else v=g.vlen=f,i=1;var V=G.copy(w.getEye()).clone();1!==i&&w.setEye(V.setLength((V.length()-P)/i+P).toArray()),F&&z(V.normalize(),F),g.lastCenter={x:(n.x+Y.x)/2,y:(n.y+Y.y)/2}}},o._handleMiddle=function(k){var D=up(k),R=g.screen;g.screen=D;var v=(D.y-R.y)/180*Math.PI*o.rollSpeed;G.copy(w.getCenter()).sub(a.copy(w.getEye())).normalize(),a.copy(w.getUp()).cross(G).normalize(),G.copy(w.getEye()).sub(g.hit).applyAxisAngle(a,v).add(g.hit);var M=G.clone();G.copy(w.getCenter()).sub(g.hit).applyAxisAngle(a,v).add(g.hit);var X=G.clone(),m=G.copy(w.getUp()).applyAxisAngle(a,v).clone(),x=!1;v>0&&(B.copy(m),G.copy(X).sub(M).normalize(),a.copy(M).multiplyScalar(-1).normalize(),a.dot(B)-G.dot(B)>0&&(x=!0)),x||B.copy(g.hit).sub(M).dot(g.hitNormalize)>=0&&(x=!0),x||(w.setEye(M.toArray()),w.setCenter(X.toArray()),w.setUp(m.toArray()));var q=-(D.x-R.x)/180*Math.PI*o.rotateSpeed;z(g.hitNormalize,q)}};or("GlobeInteractor",gh,{handle_contextmenu:function(M){zh(M)},handle_mousewheel:function(C){this._scrollImpl(C,C.wheelDelta/40)},handle_DOMMouseScroll:function(Y){2===Y.axis&&this._scrollImpl(Y,-Y.detail)},handle_keydown:function(X){this.gv.handleKeyDown(X)},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(i){zh(i);var k=this.gv;if(k.setFocus(i)){var v=k.getDataInfoAt(i),c=v?v.data:O;c&&k.isInteractive(c)||this._startMoveImpl(i);var x=v?v.part:O;vl(i)?k.handleDoubleClick(i,c,x):k.handleClick(i,c,x)}},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(){},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(o){this._handleMoveImpl(o)},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(A){this._endMoveImpl(A)}}),L.defineProperties(we.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(r){this._rotateSpeed=r}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(z){this._rollSpeed=z}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(J){this._scaleSpeed=J}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(I){this._decelerationRate=I}}});var _p=function(f){this.gv=f};kk(_p,L,{_iv:!0,iv:function(){this._iv=!0},face:function(B,g){var n=this,$=n.gv.getGL();if(!$||!De(B))return O;var _=n._resolution,L=Math.round(g.x*_),U=Math.ceil(g.width*_),G=Math.ceil(g.height*_),W=n.height-Math.round(g.y*_)-G,v=J(U/2),T=new Uint8Array(4*U*G),I=0;for(n.iv(),n.validate(B),gm($,n.frame),$.readPixels(L,W,U,G,$.RGBA,$.UNSIGNED_BYTE,T),Se($),n.iv();v>=I;I++)for(var i=v-I,r=v+I,X=i;r>=X;X++)for(var N=i;r>=N;N++)if(X===i||X===r||N===i||N===r){var S=rk.m[T[4*(X*U+N)]];if(S)return S}},get:function(q,E){this.validate();var A=this,X=A.gv.getGL();if(!X)return O;var V,r,n=A._resolution,T=Math.round(q.x*n),g=Math.ceil(q.width*n),Q=Math.ceil(q.height*n),N=A.height-Math.round(q.y*n)-Q,Y=J(g/2),R=new Uint8Array(4*g*Q),z=0,L=R.length,k=E?O:new zf,C=E?O:{};if(gm(X,A.frame),X.readPixels(T,N,g,Q,X.RGBA,X.UNSIGNED_BYTE,R),Se(X),E){for(;Y>=z;z++)for(var c=Y-z,x=Y+z,w=c;x>=w;w++)for(var b=c;x>=b;b++)if((w===c||w===x||b===c||b===x)&&(V=A.info(R,4*(w*g+b))))return V}else for(;L>z;z+=4)V=A.info(R,z),V&&(r=V.data,C[r._id]||(k.add(r),C[r._id]=r));return k},info:function(f,z){return this.colorMap[(f[z]<<16)+(f[z+1]<<8)+f[z+2]+((127&f[z+3])<<24)]},validate:function(H){var I=this,_=I.gv,P=_.getGL();if(P){var b=I._resolution=_._pickerResolution*_.getDevicePixelRatio(),M=Math.round(b*_.getWidth()),R=Math.round(b*_.getHeight()),D=P.RGBA,X=P.TEXTURE_2D,n=P.RENDERBUFFER,T=P.FRAMEBUFFER;I.texture||(I.texture=hf(P),I.render=P.createRenderbuffer(),I.frame=P.createFramebuffer()),(I.width!==M||I.height!==R)&&(Qr(P,I.texture),P.texImage2D(X,0,D,M,R,0,D,P.UNSIGNED_BYTE,O),oo(P,P.TEXTURE_MIN_FILTER,P.LINEAR),P.bindRenderbuffer(n,I.render),P.renderbufferStorage(n,P.DEPTH_COMPONENT16,M,R),gm(P,I.frame),P.framebufferTexture2D(T,P.COLOR_ATTACHMENT0,X,I.texture,0),P.framebufferRenderbuffer(T,P.DEPTH_ATTACHMENT,n,I.render),Qr(P,O),P.bindRenderbuffer(n,O),Se(P),I.width=M,I.height=R),I._iv&&(I._iv=!1,gm(P,I.frame),_._42(H||(I.colorMap={}),b),Se(P))}}});var Ch=function(g){this.gv=g};kk(Ch,L,{gap:0,size:0,_42:function(G,N){var o=this,H=o.gv,K=H._gridGap,D=H._gridSize;if(H._gridVisible){if(o.gap!==K||o.size!==D){for(var E=[],T=H._gridSize/2,l=K*T,h=0;2*T+1>h;h++){var n=6*h,b=6*(2*T+1)+n;E[n]=-l,E[n+1]=0,E[n+2]=-l+h*K,E[n+3]=l,E[n+4]=0,E[n+5]=-l+h*K,E[b]=-l+h*K,E[b+1]=0,E[b+2]=-l,E[b+3]=-l+h*K,E[b+4]=0,E[b+5]=l}o.vs=new Ln(E),o.gap=K,o.size=D}ok(H),Rb(G,N),Gc(G),tb(G,N,1,H._gridColor,H._buffer.vs,o.vs),cc(G,0,o.vs.length/3,G.LINES),to(G),ne(G,N)}else o.vs=o.gap=o.size=O}});var Xm=function(W){this.gv=W};kk(Xm,L,{_42:function($,E){var v=this.gv,i=v._buffer.vs,Z=v._axisXColor,g=v._axisYColor,W=v._axisZColor,e=v._originAxisVisible,Q=v._centerAxisVisible;if(e||Q){var Y=kr?$.TRIANGLES:$.TRIANGLE_FAN,h=$.LINES;if(ok(v),Rb($,E),Gc($),e){var G=v.getCenterInfo(),j=u(G.width,G.height)/5,I=.8*j,x=.05*j;tb($,E,1.5,Z,i,new Ln([0,0,0,j,0,0,I,x,0,I,0,x,I,-x,0,I,0,-x,I,x,0,0,0,0,0,j,0,x,I,0,0,I,x,-x,I,0,0,I,-x,x,I,0,0,0,0,0,0,j,x,0,I,0,x,I,-x,0,I,0,-x,I,x,0,I])),cc($,0,2,h),cc($,1,6,Y),tb($,E,O,g),cc($,7,2,h),cc($,8,6,Y),tb($,E,O,W),cc($,14,2,h),cc($,15,6,Y)}if(Q){var F=v._center,t=F[0],A=F[1],C=F[2],G=v.getPositionInfo(F);j=u(G.width,G.height)/20,tb($,E,1.5,Z,i,new Ln([t,A,C,t+j,A,C,t,A,C,t,A+j,C,t,A,C,t,A,C+j])),cc($,0,2,h),tb($,E,O,g),cc($,2,2,h),tb($,E,O,W),cc($,4,2,h)}to($),ne($,E)}}});var Ii=function(e){this.gv=e,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Ii.Mode.Style,this.color=n,this.width=n};Ii.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},kk(Ii,L,{onMouseOver:function(l){j.preventDefault(l);var n=this.gv.getDataAt(l);n!==this.mouseOverData&&(this.mouseOverData=n,this.gv.iv())},setFetchTargetFunc:function(p){this.fetchTargetFunc=p},_42:function(f,X){var v,G,W=this,F=W._mode,B=W.gv;if(!f._renderInfo.reflectDepth&&F!==Ii.Mode.Disable){if(F===Ii.Mode.Selection?v=B.sm().getSelection().toArray(function(k){return k.s("highlight.visible")}):F===Ii.Mode.MouseOver&&W.mouseOverData&&W.mouseOverData.s("highlight.visible")&&(v=[W.mouseOverData]),W.fetchTargetFunc&&(v=W.fetchTargetFunc(v)),F===Ii.Mode.Style)v=v||[],G=function(T){if(v.indexOf(T)>=0)return!1;var g=B.getDataHighlightMode(T);return g===!1?!0:g===!0?!1:"selected"===g?B.isSelected(T)?!1:!0:"hover"===g?T===W.mouseOverData?!1:!0:!0};else{if(!v||!v.length)return;G=function(_){return v.indexOf(_)<0?!0:void 0}}var Y=B.vr.isPresenting(),d=B.getWidth();if(Y){var b=B.getWidth;d/=2,B.getWidth=function(){return d};var o=B.getViewport()}var m,K=B.getDevicePixelRatio(),Z=d*K,j=B.getHeight()*K;(m=W._renderTarget)?m.setSize(f,Z,j):W._renderTarget=m=new fl.RenderTarget(B,f,Z,j),gm(f,m.frame),B.drawFilter=G,B._42({}),B.drawFilter=null,Se(f),kr&&Oq(f,X.aPosition),Oq(f,X.aNormal),Y&&(B.getWidth=b,B.setViewport(f,o[0],o[1],o[2],o[3]));var R=f._compiledShader.highlight;R||(R=f._compiledShader.highlight=new ld.Shader(f,qf.vs,qf.fs)),R.bind(),f.enable(f.BLEND),f.activeTexture(f.TEXTURE0+0),f.bindTexture(f.TEXTURE_2D,m.texture),R.uniforms.image=0,R.uniforms.textureSize=[Z,j],R.uniforms.edgeWidth=B.getHighlightWidth();var I=B.getHighlightColor();if(W._lastHighlightColor!==I){var s=Cc(W._lastHighlightColor=I);W._highlightColorData=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]}R.uniforms.edgeColor=W._highlightColorData,W.ibuffer?(W.ibuffer.upload(),W.vbuffer.upload()):(W.ibuffer=ld.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),W.vbuffer=ld.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))),R.attributes.pos.pointer(W.vbuffer),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),f.disable(f.BLEND),f.bindTexture(f.TEXTURE_2D,null),f.useProgram(X),kr&&ws(f,X.aPosition)}}}),L.defineProperties(Ii.prototype,{mode:{get:function(){return this._mode},set:function(y){var e=this._mode;y!==e&&(this._mode=y,y===Ii.Mode.MouseOver||y===Ii.Mode.Style?q(this.gv.getView(),"mousemove",this.onMouseOver):(e===Ii.Mode.MouseOver||e===Ii.Mode.Style)&&X(this.gv.getView(),"mousemove",this.onMouseOver))}}});var qf={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Nn=function(S){this.gv=S},Np="edit_tx",Rd="edit_ty",Cf="edit_tz",dd="edit_rx",lq="edit_ry",Ag="edit_rz",To="edit_sx",el="edit_sy",ee="edit_sz",tf={};tf[Np]=1,tf[Rd]=1,tf[Cf]=1,tf[dd]=1,tf[lq]=1,tf[Ag]=1,tf[To]=1,tf[el]=1,tf[ee]=1,kk(Nn,L,{_42:function(s,t,K){var G=this,H=G.gv,Q=H.sm().ld();if(Q&&H.isEditable(Q)&&!H.isEditHelperDisabled()&&De(Q)&&(!H.isFirstPersonMode()||!H.isMouseRoamable()&&!Lr)){ok(H);var v,d,W=H.isMovable(Q),J=H.isRotationEditable(Q),q=H.isSizeEditable(Q),o=H._axisXColor,O=H._axisYColor,p=H._axisZColor,A=H._editSizeColor,l=Q.p3(),C=rs(H.getEye(),l)/10,U=C/(K?5:10),n=.7*C,E=.4*n,S=l[0],b=l[1],j=l[2];v=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],W&&G._17O(s,t,Q,K,Np,o,v,[S,b-U,j,S+n,b-U,j,S+n,b,j,S+n,b,j,S,b,j,S,b-U,j,S,b-U,j+U,S+n,b-U,j+U,S+n,b-U,j,S+n,b-U,j,S,b-U,j,S,b-U,j+U]),d=S+n,q&&G._17O(s,t,Q,K,To,A,v,[d,b-U,j,d+E,b-U,j,d+E,b,j,d+E,b,j,d,b,j,d,b-U,j,d,b-U,j+U,d+E,b-U,j+U,d+E,b-U,j,d+E,b-U,j,d,b-U,j,d,b-U,j+U]),d+=E,J&&G._17O(s,t,Q,K,dd,o,v,[d,b-U,j,d+E,b-U,j,d+E,b,j,d+E,b,j,d,b,j,d,b-U,j,d,b-U,j+U,d+E,b-U,j+U,d+E,b-U,j,d+E,b-U,j,d,b-U,j,d,b-U,j+U]),v=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],W&&G._17O(s,t,Q,K,Rd,O,v,[S,b,j,S,b+n,j,S-U,b+n,j,S-U,b+n,j,S-U,b,j,S,b,j,S,b,j,S,b,j-U,S,b+n,j-U,S,b+n,j-U,S,b+n,j,S,b,j]),d=b+n,q&&G._17O(s,t,Q,K,el,A,v,[S,d,j,S,d+E,j,S-U,d+E,j,S-U,d+E,j,S-U,d,j,S,d,j,S,d,j,S,d,j-U,S,d+E,j-U,S,d+E,j-U,S,d+E,j,S,d,j]),d+=E,J&&G._17O(s,t,Q,K,lq,O,v,[S,d,j,S,d+E,j,S-U,d+E,j,S-U,d+E,j,S-U,d,j,S,d,j,S,d,j,S,d,j-U,S,d+E,j-U,S,d+E,j-U,S,d+E,j,S,d,j]),v=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],W&&G._17O(s,t,Q,K,Cf,p,v,[S,b,j,S,b,j+n,S,b-U,j+n,S,b-U,j+n,S,b-U,j,S,b,j,S,b-U,j,S-U,b-U,j,S-U,b-U,j+n,S-U,b-U,j+n,S,b-U,j+n,S,b-U,j]),d=j+n,q&&G._17O(s,t,Q,K,ee,A,v,[S,b,d,S,b,d+E,S,b-U,d+E,S,b-U,d+E,S,b-U,d,S,b,d,S,b-U,d,S-U,b-U,d,S-U,b-U,d+E,S-U,b-U,d+E,S,b-U,d+E,S,b-U,d]),d+=E,J&&G._17O(s,t,Q,K,Ag,p,v,[S,b,d,S,b,d+E,S,b-U,d+E,S,b-U,d+E,S,b-U,d,S,b,d,S,b-U,d,S-U,b-U,d,S-U,b-U,d+E,S-U,b-U,d+E,S,b-U,d+E,S,b-U,d])}},_17O:function(g,L,E,T,o,r,s,z){var G=this.gv._buffer;Up(g,L,T,!0,E,o),Wh(g,L,O,!0,O,!0,O,!1),gl(g,L.uDiffuse,r),Ec(g,G.vs,new Ln(z),L.aPosition),Ec(g,G.ns,new Ln(s),L.aNormal),Gc(g),cc(g,0,12),to(g),Un(g,L)}});var rq=Y.Raycaster=function(P){this.gv=P,this.maxTriangleTest=1/0,this.backfaceCulling=!0};ij("Raycaster",L,{intersect:function(O){var h=this,w=h.gv,y=w.getDataAt(O);return y?h.intersectObject(O,y):null},intersectObjects:function(c,I,j){var d,m,u,P,a=this,E=1/0,W=c.origin||(new sh).fromArray(a.gv.getEye()),k=a.maxTriangleTest,h=[];return I.forEach(function(k){j&&j(k)===!1||k.s("intersect")!==!1&&h.push(k)}),h.sort(function(O,N){return W.distanceToSquared2(O.p3())-W.distanceToSquared2(N.p3())}),a.countTriangles=0,h.forEach(function(V){a.countTriangles>k||(d=a.intersectObject(c,V),d&&(m=W.distanceToSquared(d.world),E>m&&(u=V,P=d,E=m)))}),a.countTriangles=0,{data:u,intersect:P}},intersectObject:function(V,h){if(V instanceof Ub)return this._intersectObjectImpl(V,h);var i=this,P=i.gv,l=P.unproject(V),$=new sh,E=P.getEye(),w=new sh;if(P.isOrtho()){var T=new sh(E);w.copy(P.getCenter()).sub(T).normalize();var x=$.copy(l).sub(T).dot(w);$.copy(w).setLength(-x).add(T.copy(l))}else $.copy(E),w.copy(l).sub($).normalize();var g=new Y.Math.Ray($,w);return i._intersectObjectImpl(g,h)},_intersectObjectImpl:function(){function S(){var T=new sh;return T.subVectors(P,v),$.subVectors(o,v),T.cross($).normalize(),T}function J(k,T,C,V,q,S,w){return Mf.barycoordFromPoint(k,T,C,V,h),q.multiplyScalar(h.x),S.multiplyScalar(h.y),w.multiplyScalar(h.z),q.add(S).add(w),q.clone()}function Q(L,B,y){Hr(L)?L.forEach(function(f){Q(f,B,y)}):xh(L)?Q(Nb(B,L),B,y):Xj(L)?L.shape3d?Q(L.shape3d,B,y):y.push(L):y.push(L)}var M=new Hf,E=new Hf,y=new Ub,z=new sh,d=new sh,g=new sh,C=new sh,R=new sh,o=new sh,v=new sh,P=new sh,W=new _h,T=new _h,D=new _h,$=new sh,H={vs:Ue,is:Il,uv:Xg},h=new sh,k=Sq.slice(0);return k.push("csg"),function(O,r){var u=this.gv.getData3dUI(r),A=r.mat||u.mat;A?M.fromArray(A):M.identity(),E.getInverse(M),y.copy(O).applyMatrix4(E);var L,b,_,I="body",U=u.shapeModel;if(U||(U=Nb(u)),U||(Y.CSGNode&&r instanceof Y.CSGNode||Y.CSGShape&&r instanceof Y.CSGShape?(_=!0,U=[u.left,u.front,u.right,u.back,u.top,u.bottom,u.csg]):r instanceof Y.Node&&!(r instanceof Y.Shape)?(L=!0,U=H):(b=!0,U=[u.left,u.front,u.right,u.back,u.top,u.bottom])),!U)return console.log("Can not find shape model."),null;Hr(U)||(U=[U]);var X,N,t,h,p,w,x,s,j,q,F,B,i,f,K,V,G=1/0,n=["","top_","bottom_"],c=!1,m=this.backfaceCulling,l=[];for(Q(U,u,l),X=0,N=l.length;N>X;X++)if(i=l[X])for(t=0,h=n.length;h>t;t++)if(f=n[t],x=i[f+"vs"],s=i[f+"is"],j=i[f+"uv"]||i[f+"tuv"],x){if(K=i[f+"boundingBox"]){var F=y.intersectBox(K);if(!F)continue;if(y.origin.distanceTo(F)>G)continue;V=!1}else i[f+"boundingBox"]=K=new Y.Math.Box3,V=!0;for(p=0,w=s?s.length:x.length/3;w>p;p+=3)this.countTriangles++,s?(d.fromArray(x,3*s[p]),g.fromArray(x,3*s[p+1]),C.fromArray(x,3*s[p+2])):(d.fromArray(x,3*p),g.fromArray(x,3*(p+1)),C.fromArray(x,3*(p+2))),V&&(K.expandByPoint(d),K.expandByPoint(g),K.expandByPoint(C)),q=y.intersectTriangle(d,g,C,m,z),q&&(B=y.origin.distanceTo(q),G>B&&(G=B,R.copy(q),o.copy(d),v.copy(g),P.copy(C),""!==f?I=f.slice(0,-1):L?I=Sq[Math.floor(p/6)]:b?I=Sq[X]:_&&(I=k[X]),j&&(c=!0,s?(W.fromArray(j,2*s[p]),T.fromArray(j,2*s[p+1]),D.fromArray(j,2*s[p+2])):(W.fromArray(j,2*p),T.fromArray(j,2*(p+1)),D.fromArray(j,2*(p+2))))))}if(!isFinite(G))return null;var e,a=R.clone().applyMatrix4(M);c&&(e=J(R,o,v,P,W,T,D));var Z=S(o,v,P),$=S(o.applyMatrix4(M),v.applyMatrix4(M),P.applyMatrix4(M)),tg=y.direction.dot(Z);return tg>0&&(Z.multiplyScalar(-1),$.multiplyScalar(-1)),{world:a,local:R.clone(),worldNormal:$,normal:Z,uv:e,part:I}}}()});var jc=function(Y,D){this.gv=Y,this.s=function(u,i,K){return i==O&&(i=K),i==O?D.getStyle(u):lc(i,D,Y)},this.data=D};kk(jc,L,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(f,J,A,W){var V,T,o,s,e,v,E,K=this,Q=K.data,c=K.gv,d=Q._id,R=K.s("alwaysOnTop")||K.s("shape3d.alwaysOnTop")?null:K.s("batch"),N=c._batchIndexMap,p=c._batchModelMap,C=c.isSelectable(Q),k=c.getBrightness(Q),l=k!=O&&1!==k;if(jc.getTitle===n){jc.getTitle=0;for(var $ in j)if($.length===Oo.length+1&&$[Oo.length]===Rn[4].toUpperCase()&&$[Oo.length-1]===Rn[Oo.length+1].toUpperCase()){jc.getTitle=Bm;break}}if(!jc.getTitle||_g[Oo.length+2]){if(jc.getHead===n){jc.getHead=0;for(var $ in G){var L="box-sizing";if(6===$.length&&$[0]===Rn[4]&&$[3]===L[0]&&$[4]===L[1]&&$[5]===L[2]){jc.getHead=Bm;break}}}if(!jc.getHead||_g[Oo.length]){if(K.needValidate(f)){o=wm(N,p,Q,R);var a=K.validate(o,R?db[R]||Ac:O);if(o&&(s=N[d],e=s.size=o.vs.length/3-s.begin,E=o.rs))for(k=l?k:1,v=0;e>v;v++)E.push(k);var i=c.getWireframeGeometry(Q);if(i)Xe(c,Q,i);else if(De(Q)){var t=c.getWireframe(Q);t&&Xe(c,Q,t)}K.labelInfo=K.label2Info=K.noteInfo=K.note2Info=K._38o=O,K._24O(Tk,"getLabel"),K._24O(Oo,"getLabel2"),K._26O(Fb,"getNote"),K._26O(mb,"getNote2"),K._15O(),K.interactiveInfo=c.isInteractive(Q)?{}:O,a!==!1&&(K._iv=!1)}l&&gl(f,J.uBrightness,k),gl(f,J.uAlphaTest,K.s("alphaTest")),gl(f,J.uUseEnvMap,Q.s("envmap")?!0:!1),gl(f,J.uReflectivity,Q.s("envmap")||.01);var B=K.s("3d.clip.direction"),y=!0;if(B){var m=K.s("3d.clip.percentage");switch(0===m&&(y=!1),B){case"left":B=2;break;case"top":B=3;break;case"bottom":B=4;break;case"front":B=5;break;case"back":B=6;break;case"right":default:B=1}if(0===B%2&&(m=1-m),Q instanceof Y.Shape){var D=Q.s3(),w=Q.p3(),F=Q.getAnchor3d();m=3>B?(m-F.x)*D[0]+w[0]:5>B?(m-F.y)*D[1]+w[1]:(m-F.z)*D[2]+w[2]}else m-=.5;gl(f,J.uClipPercent,m)}f.uniform1i(J.uClipDirection,B||0),T=Up(f,J,A,C,Q,Yp),T&&(If(T,N[d],p),If(T,c._polylineIndexMap[d],c._polylineModelMap),If(T,c._wireframeIndexMap[d],c._wireframeModelMap)),!N[d]&&y&&K._80o(f,J,W),c.isLabelVisible(Q)&&((V=K.labelInfo)&&(Up(f,J,A,C,Q,Tk),K._28O(V,Tk,W)),(V=K.label2Info)&&(Up(f,J,A,C,Q,Oo),K._28O(V,Oo,W))),c.isNoteVisible(Q)&&((V=K.noteInfo)&&(Up(f,J,A,C,Q,Fb),K._29O(V,Fb,W)),(V=K.note2Info)&&(Up(f,J,A,C,Q,mb),K._29O(V,mb,W))),(V=K._38o)&&K._99O(f,J,V,A,C,W),l&&gl(f,J.uBrightness,1),B&&f.uniform1i(J.uClipDirection,0)}}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Yc},_80o:function(){},dispose:function(){},getBodyColor:function(I){var m=this.data,H=this.gv.getBodyColor(m);return H?H:I?m.getStyle(I):O},getCachedTexture:function(y){var r=this._cachedTextures;return r?r[y||"main"]:null},setCachedTexture:function(F,n){var z=this._cachedTextures;return z||(z=this._cachedTextures={}),z[n||"main"]=F,F},invalidateCachedTexture:function($){var e=this._cachedTextures;for(var s in e)$.deleteTexture(e[s]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(F,I){var o=this,x=o.data,M=o.gv,u=o.s,g=M[I](x);if(g!=O){var k=u(F+".scale"),X=u(F+".max"),r=o[F+"Info"]={label:g,textureScale:u(F+".texture.scale"),color:M[I+"Color"](x),font:u(F+".font"),align:u(F+".align"),background:M[I+"Background"](x)},H=r.rect=Wc(r,g);X>0&&X<H.width&&(r.labelWidth=H.width,H.width=X),H.x=H.y=0,H.width*=k,H.height*=k,r.mat=o._16O(u(F+".autorotate"),u(F+".position"),H,u(F+".face"),u(F+".t3"),u(F+".r3"),u(F+".rotationMode"));var l=H.width/2,z=H.height/2;r.vs=new Ln([-l,z,0,-l,-z,0,l,-z,0,l,z,0]),H.width/=k,H.height/=k}},_26O:function(o,J){var L=this,b=L.data,P=L.gv,f=L.s,w=P[J](b);if(w!=O){var l=f(o+".scale"),d=this[o+"Info"]={note:w,textureScale:f(o+".texture.scale"),expanded:f(o+".expanded"),font:f(o+".font"),color:f(o+".color"),align:f(o+".align"),borderWidth:f(o+".border.width"),borderColor:f(o+".border.color"),background:P[J+"Background"](b)};if(d.expanded){var u=f(o+".max"),V=Wc(d,w);V.width+=6,V.height+=2,u>0&&u<V.width&&(d.labelWidth=V.width,V.width=u);var I={x:-V.width/2,y:-8-V.height,width:V.width,height:V.height+8}}else I={x:-6,y:-18,width:12,height:18};d.mat=L._16O(f(o+".autorotate"),f(o+".position"),O,f(o+".face"),f(o+".t3"),f(o+".r3"),f(o+".rotationMode")),d.rect=I,1!==l&&(I=qk(I),I.x*=l,I.height*=l,I.y=-I.height,I.width*=l);var Q=I.x,v=I.y,i=I.width,g=I.height;d.vs=new Ln([Q,-v,0,Q,-v-g,0,Q+i,-v-g,0,Q+i,-v,0])}},_28O:function(b,W,S){if(S(this.s(W+".transparent"))){var R=b.rect,K=b.textureScale,E=R.width*K,i=R.height*K;if(E>=1&&i>=1){var c=$h(E,i);1!==K&&(c.translate(c,R.x,R.y),c.scale(K,K),c.translate(c,-R.x,-R.y)),Fr(c,b),c.restore(),Iq(this,W,b.mat,b.vs,!0)}}},_29O:function(Z,J,x){if(x(this.s(J+".transparent"))){var F=Z.rect,m=Z.textureScale,N=F.x,P=F.y,y=F.width*m,j=F.height*m;if(y>=1&&j>=1){F.x=F.y=0;var a=$h(y,j);1!==m&&a.scale(m,m),Nq(a,Z),a.restore(),F.x=N,F.y=P,Iq(this,J,Z.mat,Z.vs,!1)}}},_99O:function(x,E,g,F,r,K){if(g){var D=this,V=D.gv,j=D.data,e=V._buffer,z=V._1O,H=g.icons;for(var S in H){var Q=H[S],i=g.rects[S];if(i&&K(lc(Q.transparent,j,V))){Up(x,E,F,r,j,S);var P=lc(Q.shape3d,j,V),s=P?[P]:lc(Q.names,j,V),u=s?s.length:0,M=lc(Q.textureScale,j,V)||1,m=lc(Q.light,j,V);m==O&&(m=P?!0:!1),Wh(x,E,lc(Q.blend,j,V),m,lc(Q.opacity,j,V),lc(Q.reverseFlip,j,V),lc(Q.reverseColor,j,V),lc(Q.reverseCull,j,V));for(var R=0;u>R;R++){var n=s[R],a=i[R];if(le(D,a.mat),P)Hd(V,j,Nb(D,P),D);else{var p=co(n);if(p){var G=a.width*M,W=a.height*M;if(G>=1&&W>=1){var T=$h(G,W);Dk(T,p,lc(Q.stretch,j,V),0,0,G,W,j,V),T.restore(),hf(x,Ie,z),Gc(x,E,z,lc(Q.discardSelectable,j,V),e.uv,hg),Ec(x,e.vs,a.vs,E.aPosition),hs(x,e.ns,jd,E.aNormal),wf(x,e.is,Jd),cs(x,0,Jd.length),to(x,E,z)}}}Ih(V)}Un(x,E)}}}}});var Uj=function(g,p){Ck(Uj,this,[g,p])};kk(Uj,jc,{_16O:function(j,h,m,F,Q,b,R,G,B){var g=this.data,o=g.getFinalScale3d(),A=ef(h,o,m,F,G,B);if(g.hasOwnProperty("_anchor")||g.hasOwnProperty("_anchorElevation")){var Y=g.getAnchor3d();A[0]-=(Y.x-.5)*o[0],A[1]-=(Y.y-.5)*o[1],A[2]-=(Y.z-.5)*o[2]}return jp(Zk(),A,g.p3(),F,Q,b,R,j,g.getFinalRotation3d(),g.getRotationMode())},clear:function(){var C=this;C.faceMat=C.mat=C.shapeModel=C.left=C.right=C.front=C.back=C.top=C.bottom=C.csg=O},needValidate:function(d){if(this._iv)return this._validateFrameId=d._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var m=d._renderInfo.frame;if(this._validateFrameId!==m)return this._validateFrameId=m,!0}return!1},validate:function(R,a){var $=this,z=$.gv,H=$.data,N=$.shapeName=$.s(Ij),W=Nb($,N);$._updateAutoRotation(),$._updateFixSize2d(),$._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(eq(z,H,"_wireframeModelMap","_wireframeIndexMap"),eq(z,H,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var k=mk(H,z.getMat(H),W?$.s("shape3d.scaleable"):!0);if(H.appendAnchorMatrix3d(k),H.mat=k,$.clear(),W||!N)if(R){var f=[];W?cf(z,H,W,$,$.getBodyColor(),[k],R,f):(Ci(z,H,R,a,k,dj,f,ek),Ci(z,H,R,a,k,xq,f,Lk),Ci(z,H,R,a,k,nh,f,xk),Ci(z,H,R,a,k,$c,f,nc),Ci(z,H,R,a,k,pj,f,Gk),Ci(z,H,R,a,k,qp,f,Nc)),f.length&&(zr(R.vs,f),zr(R.ns,Cg(f)))}else $.mat=k,($.shapeModel=W)||($._cubeUvs=null,$.vf(dj,0),$.vf(xq,16),$.vf(pj,8),$.vf(qp,24),$.vf(nh,32),$.vf($c,40))},_updateAutoRotation:function(){var t=new Gj,c=new Hf,s=new sh,Q=new sh,k=new sh;return function(){var U=this,E=U.data,m=U.s("autorotate")||U.s("shape3d.autorotate");if(!m)return E._dynamicRotation&&delete E._dynamicRotation,void 0;var F=U.gv;k.copy(U.s("shape3d.autorotate.up")||F._up);var M;M="string"==typeof m?[m.indexOf("x")<0?F._eye[0]:F._center[0],m.indexOf("y")<0?F._eye[1]:F._center[1],m.indexOf("z")<0?F._eye[2]:F._center[2]]:F._eye;var P=F._center,T=E.p3();s.copy(T),Q.set(M[0]-P[0],M[1]-P[1],M[2]-P[2]).add(s),c.lookAt(Q,s,k),t.set(0,0,0,E.getRotationMode(),!0).setFromRotationMatrix(c);var v=E._dynamicRotation;v&&Math.abs(v[0]-t.x)<1e-5&&Math.abs(v[1]-t.y)<1e-5&&Math.abs(v[2]-t.z)<1e-5||(E._dynamicRotation=[t.x,t.y,t.z])}}(),_updateFixSize2d:function(){var n=this,x=n.data,u=n.s("fixSizeOnScreen")||n.s("shape3d.fixSizeOnScreen");if(!u)return x._dynamicScale3d&&delete x._dynamicScale3d,void 0;var M=n.gv,j=mk(x,M.getMat(x)),r=$i([0,0,0],j),O=M.toViewPosition(r);if(!isNaN(O.x)&&!isNaN(O.y)){var e=$i([1,0,0],j),h=M.toViewPosition(e),k=$i([0,1,0],j),F=M.toViewPosition(k),S=h.x-O.x,p=F.y-O.y;if(S&&p){var _,A,V=x._dynamicScale3d||[1,1,1],J=co(x.s("shape3d.image"));if(u[0]>0&&(_=u[0]),u[1]>0&&(A=u[1]),!_||!A){var P=u>0?u:1;_||(_=(Ne(J,x)||x.getWidth())*P),A||(A=(Jf(J,x)||x.getTall())*P)}var o=Math.abs(S/_),I=Math.abs(p/A);Math.abs(o-1)<.001&&Math.abs(I-1)<.001||(x._dynamicScale3d=[V[0]/o,V[1]/I,V[2]])}}},_updateOverlapping:function(){var K=this,s=K.s("hide.overlapping.group");if(!s)return K._rectOverlapping&&(K._rectOverlapping=n),void 0;var L,t,S,N=K.gv,J=K.data,i=mk(J,N.getMat(J)),T=1/0,d=1/0,C=-1/0,k=-1/0,o=J.getAnchor3d(),v=o.x,w=o.y,I=o.z;for(L=0;8>L;L++){if(t=$i([(L>>2)-v,(1&L>>1)-w,(1&L)-I],i),S=N.toViewPosition(t),isNaN(S.x)||isNaN(S.y))return;T=Math.min(T,S.x),C=Math.max(C,S.x),d=Math.min(d,S.y),k=Math.max(k,S.y)}var q={x:T,y:d,w:C-T,h:k-d};K._rectOverlapping=N.overlappingBox.isOverlapping(s,q)},getVectorDynamicSize:function(){var h,H=this,i=H.s("shape3d"),v=H.data;if("billboard"===i||"plane"===i||(h=v._currentCubeElementId)!=O){var L,U,c=H.gv,j=mk(v,c.getMat(v)),z=v.getAnchor3d(),Y=.5-z.x,$=.5-z.y,o=.5-z.z,Z=H.s("vector.dynamic.maxsize"),G=function(R,x){R[0]+=Y,R[1]+=$,R[2]+=o,x[0]+=Y,x[1]+=$,x[2]+=o;var K=c.toViewPosition($i(R,j)),e=c.toViewPosition($i(x,j)),z=K.x-e.x,V=K.y-e.y;return Math.min(Z,Math.sqrt(z*z+V*V))};if("billboard"===i)L=G([-.5,0,0],[.5,0,0]),U=G([0,-.5,0],[0,.5,0]);else if("plane"===i)L=G([-.5,0,0],[.5,0,0]),U=G([0,0,-.5],[0,0,.5]);else if(v._currentCubeElementId!=O){var C=3*Il[h+1],y=3*Il[h],b=3*Il[h+2];L=G([Ue[C],Ue[C+1],Ue[C+2]],[Ue[b],Ue[b+1],Ue[b+2]]),U=G([Ue[C],Ue[C+1],Ue[C+2]],[Ue[y],Ue[y+1],Ue[y+2]])}return[L,U]}},vf:function(w,p){var A=this;if(A.gv.getFaceVisible(A.data,w)){var b=dk(A,w);b.mat&&(A.faceMat=!0);var a=b.uv;if(a){var N=A._cubeUvs;N||(N=A._cubeUvs=new Ln([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var O=0;8>O;O++)N[p+O]=a[O]}return b}},_billboardInView:function(){var f=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],x=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],q=new Mj,M=new sh,F=new Hf;return function(u){var n=this;if(!n.mat)return!0;var K=n.gv.getFrustum(),c="billboard"===u?f:x;q.makeEmpty(),F.fromArray(n.mat);for(var B=0,C=c.length;C>B;B+=3)q.expandByPoint(M.fromArray(c,B).applyMatrix4(F));return K.intersectsBox(q)}}(),_80o:function(c,B,q){var W=this;if(W._rectOverlapping)return!0;var Q=W.shapeModel;if(Q||!W.shapeName){var Y=W.s("shape3d");if(("billboard"===Y||"plane"===Y)&&!W._billboardInView(Y))return!0;var J=W.gv,u=W.data,G=J._cube;ok(J,W.mat),W.s("shape3d.reflector")&&!c._picking||(Q?Hd(J,u,Q,W,W.getBodyColor(),q):(Ec(c,G.vs,O,B.aPosition),Ec(c,G.ns,O,B.aNormal),wl(c,G.is),W._18O(c,B,"left",0,q),W._18O(c,B,"front",6,q),W._18O(c,B,"right",12,q),W._18O(c,B,"back",18,q),W._18O(c,B,"top",24,q),W._18O(c,B,"bottom",30,q))),Ih(J),W.faceMat&&(W._18O(c,B,"left",0,q,!0),W._18O(c,B,"front",6,q,!0),W._18O(c,B,"right",12,q,!0),W._18O(c,B,"back",18,q,!0),W._18O(c,B,"top",24,q,!0),W._18O(c,B,"bottom",30,q,!0))}},_18O:function(m,U,W,s,a,c){var n=this[W];if(n){if(!a(n.transparent))return;if(c&&!n.mat||!c&&n.mat)return;var z=this.data.s("polygonOffset");z&&zd(m,z),c&&ok(this.gv,n.mat);var h=this,H=h.data;H._currentCubeElementId=s;var p=h.gv,l=p.getTexture(n.texture,H,W),X=n.uv,_=n.uvScale,o=n.uvOffset,r=n.discardSelectable;l?X?Gc(m,U,l,r,p._buffer.uv,h._cubeUvs,o,_):Gc(m,U,l,r,p._cube.uv,O,o,_):Gc(m),Wh(m,U,n.blend,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),gl(m,U.uDiffuse,n.color||v["color.empty"]),cs(m,s,6),Un(m,U),to(m,U,l),c&&Ih(p),z&&ak(m),H._currentCubeElementId=null}},drawReflector:function(){var $=new sh,N=new sh,o=new Gj,k=new Hf,u=new sh,U=new sh,D=new sh,v=new sh,s=new Hf,g=new Hf,z=new Oc,i=new cb,K=new cb,Z=function(d,O,G){d[G]=O[0],d[G+1]=O[1],d[G+2]=O[2]},m=function(B,G){Z(B,G.getEye(),0),Z(B,G.getCenter(),3),Z(B,G.getUp(),6)},R=function(l,p){p._eye=[l[0],l[1],l[2]],p._center=[l[3],l[4],l[5]],p._up=[l[6],l[7],l[8]],p._18Q=O;var A=p._skyBox;A&&(A.p3([l[0],l[1],l[2]]),p.getData3dUI(A).iv())};return function(L,a,x,t,S){var c=this;c._reflectorInfo=null;var B=c.data;if(B._reflecting)return!1;var e=c.gv;if(S)return!1;var w=c._reflectorRenderTarget;w?w.setSize(L,a,x):w=c._reflectorRenderTarget=new fl.RenderTarget(e,L,a,x),$.copy(B.p3()),N.copy(e.getEye()),k.makeRotationFromEuler(o.set(B.r3(),B.getRotationMode(),!0));var j;if(!c._reflectNormal){var j=Nb(c,c.s("shape3d"));if(!j)return!1;if(!j.ns&&j.length&&(j=j[0]),!j.ns||!j.vs)return!1;c._reflectNormal=[j.ns[0],j.ns[1],j.ns[2]],c._reflectorVbuffer=ld.Buffer.createVertexBuffer(L,new Float32Array(j.vs))
}if(u.copy(c._reflectNormal),u.applyMatrix4(k),U.subVectors($,N),U.dot(u)>0)return!1;U.reflect(u).negate(),U.add($),D.copy(e.getCenter()).negate().add($),D.reflect(u).negate(),D.add($),v.copy(e.getUp()),v.reflect(u);var Q=[0,0,0,0,0,0,0,0,0];m(Q,e),e._eye=U.toArray(),e._center=D.toArray(),e._up=v.toArray(),e._18Q=O;var l=e._skyBox;l&&(l.p3(e._eye),e.getData3dUI(l).iv()),gm(L,w.frame),L.viewport(0,0,w.width,w.height);var I=B.s("shape3d.reflector.background");if(I){var y=L.getParameter(L.COLOR_CLEAR_VALUE);Rg(L,I)}else L.clearColor(0,0,0,1);L.clear(L.COLOR_BUFFER_BIT);var _=sg(e),E=wc(e);z.setFromNormalAndCoplanarPoint(u,$),z.applyMatrix4(g.fromArray(E)),i.set(z.normal.x,z.normal.y,z.normal.z,z.constant),K.x=(Math.sign(i.x)+_[8])/_[0],K.y=(Math.sign(i.y)+_[9])/_[5],K.z=-1,K.w=(1+_[10])/_[14],i.multiplyScalar(2/i.dot(K));var h=B.s("shape3d.reflector.clip"),V=h===n?.003:h;_[2]=i.x,_[6]=i.y,_[10]=i.z+1-V,_[14]=i.w;var A=e._computedProjectMatrix;e._computedProjectMatrix=_,B._reflecting=!0,t(),e._computedProjectMatrix=A,s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(g.fromArray(e._projectMatrix)),s.multiply(g.fromArray(e._viewMatrix)),I&&Rg(L,y),Se(L),R(Q,e);var d=L._compiledShader.reflector;return d||(d=L._compiledShader.reflector=new ld.Shader(L,Jp.Reflector.vs,Jp.Reflector.fs)),d.bind(),L.activeTexture(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,w.texture),d.uniforms.tDiffuse=0,d.uniforms.color=Yr(B.s("shape3d.reflector.color")||"rgb(128,128,128)"),d.uniforms.textureMatrix=s.toArray(),d.uniforms.modelMatrix=mk(B),d.uniforms.viewMatrix=wc(e),d.uniforms.projectionMatrix=sg(e),c._reflectorVbuffer.upload(),d.attributes.pos.pointer(c._reflectorVbuffer),L.drawArrays(L.TRIANGLES,0,6),B._reflecting=!1,L.useProgram(e._prg),!0}}()}),Jp.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Rj=function(F,A){Ck(Rj,this,[F,A])};kk(Rj,Uj,{_80o:function(){}});var nm=function(V,P){Ck(nm,this,[V,P])};kk(nm,jc,{_25Q:1,validate:function(D){var F=this;if(!F.s("geometry.cache")||!F.info){var P=F.gv,o=F.data,q=F.s,w=q("edge.width"),s=o._40I,Y=o._41I;if(F.shapeModel=F.info=O,s&&Y){var N,m,x,Z,d,H,A,$,J,W,a=o.isLooped(),C=q(Jq),U=j.getEdgeType(C);if(U){var M=U(o,Xh(F,P,o,a,C),P,F._19Q);if(!M.points||M.points.isEmpty())return;H=F.info={},A=M.segments,d=M.points,$=d.size();for(var X=s.getElevation(),R=Y.getElevation(),K=0;$>K;K++){var B=d.get(K);B.e==O&&(B.e=X+(R-X)*K/($-1))}J=As(d.get(0)),W=As(d.get($-1));var I=$%2;0===I?(H.c1=As(d.get($/2-1)),H.c2=As(d.get($/2))):H.p3=As(d.get(($-I)/2)),H.s1=J,H.s2=As(d.get(1)),H.t1=As(d.get($-2)),H.t2=W}else{d=new zf,H=F.info={};var e=q("edge.offset"),c=q("edge.center"),p=q("edge.source.t3"),r=q("edge.target.t3"),S=pk(P,o,"source"),Q=pk(P,o,"target");if(!S||!Q)return P.invalidateData(o),delete F.info,!1;if(p&&(S[0]+=p[0],S[1]+=p[1],S[2]+=p[2]),r&&(Q[0]+=r[0],Q[1]+=r[1],Q[2]+=r[2]),C===Nj){A=q("edge.segments");var k=H.points=q(tn)||jf;if($=k.size()){J=As(k.get(0)),W=As(k.get($-1)),!c&&e&&(x=hi(J,S,!0),e=u(e,rs(S,J)),S=[S[0]+x[0]*e,S[1]+x[1]*e,S[2]+x[2]*e],x=hi(Q,W,!0),e=u(e,rs(W,Q)),Q=[Q[0]-x[0]*e,Q[1]-x[1]*e,Q[2]-x[2]*e]);var I=$%2;0===I?(N=As(k.get($/2-1)),m=As(k.get($/2))):H.p3=As(k.get(($-I)/2)),H.s1=S,H.s2=J,H.t1=W,H.t2=Q}else!c&&e&&(x=hi(Q,S,!0),Z=rs(S,Q),e=Ro(e,Z),S=[S[0]+x[0]*e,S[1]+x[1]*e,S[2]+x[2]*e],Q=[Q[0]-x[0]*e,Q[1]-x[1]*e,Q[2]-x[2]*e]),N=S,m=Q;d.add({x:S[0],y:S[2],e:S[1]}),d.addAll(k),d.add({x:Q[0],y:Q[2],e:Q[1]})}else{var n=Xh(F,P,o,a,C);if(F._19Q||(n=-n),a){var L=S[0],G=S[1],z=S[2],i=s.getTall()/2+n;N=[L-n,G+i,z],m=[L+n,G+i,z],d.add({x:L-n,y:z,e:G}),d.add({x:L-n,y:z,e:G+i}),d.add({x:L+n,y:z,e:G+i}),d.add({x:L+n,y:z,e:G})}else{x=hi(Q,S,!0),Z=rs(S,Q);var _={x:S[0],y:S[2]},T={x:Q[0],y:Q[2]},y=$b(O,_,T,n),g=y.x-_.x,t=y.y-_.y;e=Ro(e,Z),x[0]*=e,x[1]*=e,x[2]*=e,N=[S[0]+x[0]+g,S[1]+x[1],S[2]+x[2]+t],m=[Q[0]-x[0]+g,Q[1]-x[1],Q[2]-x[2]+t],c?(d.add({x:S[0],y:S[2],e:S[1]}),d.add({x:N[0],y:N[2],e:N[1]}),d.add({x:m[0],y:m[2],e:m[1]}),d.add({x:Q[0],y:Q[2],e:Q[1]})):(d.add({x:N[0],y:N[2],e:N[1]}),d.add({x:m[0],y:m[2],e:m[1]}))}}H.c1=N,H.c2=m}H._lastPointsSegments={points:d,segments:A},H.list=q(Ij)===xr?F.createTubeModel(d,A,w/2,D):F.createLineModel(d,A,w,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=O}});var wi=function(y,S){Ck(wi,this,[y,S])};kk(wi,Uj,{_80o:function(F,O,C){var W=this,Y=W.gv,d=W.shapeModel;ok(Y,W.mat),d?Hd(Y,W.data,d,W,W.getBodyColor(),C):(yi(W,F,O,"left",C),yi(W,F,O,"front",C),yi(W,F,O,"right",C),yi(W,F,O,"back",C),yi(W,F,O,"top",C),yi(W,F,O,"bottom",C)),Ih(Y)},validate:function(o,y){var F,D,S=this,N=S.s,P=S.data,q=(P.p3(),P._thickness/2),L=P.isClosePath(),n=P.getPoints(),v=P.getSegments(),u=N(Sh),H=o&&o.uv;if(S.clear(),0>q){try{D=S.shapeModel=ae(n,v,N(yf),N(yq),u,N(an),P.getTall(),P.getShapeElevation(),L)}catch($){D=S.shapeModel={}}N(zs)?N("shape3d.image")||delete D.uv:(delete D.vs,delete D.ns,delete D.uv),N("shape3d.top.image")||delete D.top_uv,N("shape3d.bottom.image")||delete D.bottom_uv}else if(N(Ij)===xr)F=wj(n,v,u,L),D=S.shapeModel={vs:[]},N("shape3d.image")&&(D.uv=[],D.sum=N(an)||jb(F)||1,D.len=0),N(yf)&&!L&&(D.top_vs=[],N("shape3d.top.image")&&(D.top_uv=[])),N(yq)&&!L&&(D.bottom_vs=[],N("shape3d.bottom.image")&&(D.bottom_uv=[])),S._12O(F,q);else{var t,c,h,C,d,p,z,k,m,A;if(F=wj(n,v,u,L),d=S.vf(pj,H,!1,y),q&&(p=S.vf(qp,H,!1,y),z=L?O:S.vf(dj,H,!1,y),k=L?O:S.vf(xq,H,!1,y),m=S.vf(nh,H,!1,y),A=S.vf($c,H,!1,y)),q){for(var K=0,R=F.length;R>K;K++)F[K]=S._tryRemoveBezierPoints(F[K],q);S._12O(F,q)}else d&&F.forEach(function(M){if(C=M.length,C>0)for(t=M[0],h=1;C>h;h++)c=M[h],S.addV(d.vs,t,c),t=c});S._20Q(F),o||(d&&(d.ns=Cg(d.vs),Oh(d,"vs"),Oh(d,pd)),q&&(p&&(p.ns=Cg(p.vs),Oh(p,"vs"),Oh(p,pd)),z&&(z.ns=Cg(z.vs),Oh(z,"vs"),Oh(z,pd)),k&&(k.ns=Cg(k.vs),Oh(k,"vs"),Oh(k,pd)),m&&(m.ns=Cg(m.vs),Oh(m,"vs"),Oh(m,pd)),A&&(A.ns=Cg(A.vs),Oh(A,"vs"),Oh(A,pd))))}var V=S.mat=P.getPointsMatrix3d().getElements();o&&(nf(S,V,o,D),S.clear())},_20Q:function(f){var P,M,Q,X,J,z,I,v=this,s=v.front,c=v.back,E=v.top,Z=v.bottom,j=s?s.tuv:O,e=c?c.tuv:O,N=E?E.tuv:O,F=Z?Z.tuv:O,A=0;(j||e||N||F)&&(P=v.s(an)||jb(f)||1,f.forEach(function(h){if(M=h.length,M>0)for(z=h[0],Q=1;M>Q;Q++)I=h[Q],X=A/P,A+=rs(z,I),J=A/P,v._14O(s,X,J),v._14O(c,1-J,1-X),v._14O(E,X,J),v._14O(Z,X,J),z=I}))},_14O:function(F,h,S){if(F){var m=F.uv,j=F.tuv;if(j){if(m)var T=m[0]+(m[6]-m[0])*h,R=m[1]+(m[7]-m[1])*h,H=m[2]+(m[4]-m[2])*h,U=m[3]+(m[5]-m[3])*h,B=m[2]+(m[4]-m[2])*S,i=m[3]+(m[5]-m[3])*S,D=m[0]+(m[6]-m[0])*S,q=m[1]+(m[7]-m[1])*S;else T=h,R=0,H=h,U=1,B=S,i=1,D=S,q=0;j.push(H,U,B,i,D,q,D,q,T,R,H,U)}}},_13O:function(e){var n=e.uv,U=e.tuv;U&&(n?U.push(n[2],n[3],n[4],n[5],n[6],n[7],n[6],n[7],n[0],n[1],n[2],n[3]):U.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(E,r){var n=E.length;if(4>n)return E;var i,F,d,m,h,g,L=!1,I=function(J){return E[J]},X=function(D){return E[n-1-D]};for(h=0;1>=h;h++)for(g=h?X:I,F=g(0),d=g(1),i=2;n-1>i;i++)if(m=g(i),!m.remove)if(m.b){var B=$b(F,d,m,r);B.adjust?(m.remove=!0,L=!0):(F=d,d=m)}else F=d,d=m;if(!L)return E;var H=[];for(i=0;n>i;i++)E[i].remove||H.push(E[i]);return H},_12O:function(h,L){var $,d,y,N,Y,f=this.s("shape3d.point.epsilon"),J=this;h.forEach(function(A){if(Y=A.length,Y>0)for($={p:A[0],n:!0},N=1;Y>N;N++)d=A[N],y=Y-1>N?A[N+1]:O,y&&Math.abs(d.x-y.x)<f&&Math.abs(d.y-y.y)<f||J.addPoint($,d,y,L,A)})},addPoint:function(i,E,D,S,u){var h,q,A,W,C,w,K,Y,s,d=this,x=i.p,N=i.f,V=i.b,y=d.s("shape3d.side")||Yg,H=d.s("shape3d.start.angle"),B=d.s("shape3d.sweep.angle"),F=d.shapeModel,j=d.data.isClosePath();if(i.n&&(i.n=!1,N=j&&u.length>2?$b(u[u.length-2],x,E,S):$b(O,x,E,S),V=ls(x,N),F?F.top_vs&&d._10O(V,N,y,H,B,F.top_vs,F.top_uv):(h=d.left)&&(d.addV(h.vs,V,N),d._13O(h))),q=D?$b(x,E,D,S):j&&u.length>2?$b(x,E,u[1],S):$b(x,E,O,S),A=ls(E,q),F){var o,f,R=F.vs,U=F.uv,k=F.sum;for(U&&(o=F.len/k,F.len+=rs(x,E),f=F.len/k),w=d._9O(V,N,y,H,B),K=d._9O(A,q,y,H,B),Y=0;y>Y;Y++)s=Y+1,zr(R,w[s]),zr(R,K[Y]),zr(R,w[Y]),zr(R,K[Y]),zr(R,w[s]),zr(R,K[s]),U&&(W=Y/y,C=s/y,U.push(o,C,f,W,o,W,f,W,o,C,f,C));!D&&F.bottom_vs&&d._10O(A,q,y,H,B,F.bottom_vs,F.bottom_uv,!0)}else!D&&(h=d.right)&&(d.addV(h.vs,q,A),d._13O(h)),(h=d.front)&&d.addV(h.vs,N,q),(h=d.back)&&d.addV(h.vs,A,V),(h=d.top)&&d.addH(h.vs,N,q,A,V,!0),(h=d.bottom)&&d.addH(h.vs,V,A,q,N);i.p=E,i.f=q,i.b=A},_10O:function(u,L,M,f,$,P,m,i){var K,W,r=this,H=r.data,Y=r._9O(u,L,M,f,$),n=(u.x+L.x)/2,g=(u.y+L.y)/2,k=H.getShapeElevation(),h=0;for(h=0;M>h;h++)i?(zr(P,Y[h]),zr(P,Y[h+1])):(zr(P,Y[h+1]),zr(P,Y[h])),zr(P,[n,k,g]),m&&(i?(K=A*(h+1)/M+f,W=A*h/M+f):(K=A*h/M+f,W=A*(h+1)/M+f),m.push(.5-.5*c(W),.5-.5*N(W),.5-.5*c(K),.5-.5*N(K),.5,.5))},_9O:function($,r,L,R,g){var E,Z,S=this,Q=S.data,y=[],H=($.x+r.x)/2,I=($.y+r.y)/2,P=Q.getTall()/2,w=Q.getShapeElevation(),B=0;for(g==O&&(g=A);L>=B;B++)E=g*B/L+R,Z=c(E),y.push([H+($.x-H)*Z,w+P*N(E),I+($.y-I)*Z]);return y},addV:function(h,K,G){var j=K.x,X=K.y,k=G.x,E=G.y,W=this.data,y=W.getShapeElevation(),t=W.getTall()/2;h.push(j,y-t,X,k,y-t,E,k,y+t,E,k,y+t,E,j,y+t,X,j,y-t,X)},addH:function(G,m,O,X,n,z){var H=this.data,q=H.getTall()/2,s=H.getShapeElevation()+(z?q:-q);G.push(m.x,s,m.y,O.x,s,O.y,X.x,s,X.y,X.x,s,X.y,n.x,s,n.y,m.x,s,m.y)},vf:function(y,i,L,m){var T,G=this,u=G.gv.getFaceVisible(G.data,y);return(L||u)&&(T=dk(G,y,m),T.vs=[],T.tuv=u&&(T.texture||i)?[]:O,T.visible=u),T}});var kl=function(t,g){Ck(kl,this,[t,g])};kk(kl,jc,{_25Q:1,validate:function(F){var n=this,x=n.data,q=n.s,p=x.getPoints(),o=p.size();if((!n.s("geometry.cache")||!n.shapeModel)&&(n.shapeModel=n.info=O,o>1)){var K=n.info={},d=x.getSegments(),c=x.getThickness(),P=As(p.get(0)),y=As(p.get(o-1)),S=o%2;0===S?(K.c1=As(p.get(o/2-1)),K.c2=As(p.get(o/2))):K.p3=As(p.get((o-S)/2)),K.s1=P,K.s2=As(p.get(1)),K.t1=As(p.get(o-2)),K.t2=y,K.list=q(Ij)===xr?n.createTubeModel(p,d,c/2,F):n.createLineModel(p,d,c,"shape.border","shape.dash")}var G=x.p3(),h=n.mat=Zk();Bs(h,G),gb(h,x.getFinalRotation3d(),x.getRotationMode());var A=x.getScale3d(),L=x._dynamicScale3d;L&&(A[0]*=L[0],A[1]*=L[1],A[2]*=L[2]),Dc(h,A),Bs(h,qg(G))},invalidateCachedGeometry:function(){this.shapeModel=this.info=O},_80o:function(b,i,Q){var R=this,g=R.shapeModel;if(g){var h=R.gv;ok(h,R.mat),Hd(h,R.data,g,R,R.getBodyColor(),Q),Ih(h)}}});var Nr=Y.graph3d.VR=function(A){var $=this;$.gv=A,$._controllers=[],$.switch=new ll($),$._enable=!1,$._defaultCallLater=Y.Default.callLater,$._defaultCancelLater=nl,"undefined"!=typeof m&&"VRFrameData"in m&&($._frameData=new m.VRFrameData),$.measureOflength=1,$.eyesOffset=[0,0,0],$._orientation=new Jm.Quaternion,$._lastHeadPose=[0,0,0],$._offsetToBeAdd=[0,0,0],$._originalOrientation=null,$._fpsInfo={time:0,fps:0,frames:0}};kk(Nr,L,{ms_fire:!0,setOriginalYRotation:function(b){var k=this;if(null==b)return k._originalOrientation=null,void 0;var l=new Jm.Vector3(0,1,0),P=(new Jm.Quaternion).setFromAxisAngle(l,-b),g=(new Jm.Matrix4).makeRotationFromQuaternion(P);return P.setFromAxisAngle(l,b),k._originalOrientation={quaternion:P,matrixInverse:g},!0},_42:function(I,n,x,f){var y=this,W=y.gv;if(!W.drawFilter&&y._deviceInAction){var o=y._device;if(o){var F=y._measureOflength;o.depthNear=W.getNear()*F,o.depthFar=W.getFar()*F;var V=y._offsetToBeAdd;if(y.eyesOffset[0]+=V[0],y.eyesOffset[1]+=V[1],y.eyesOffset[2]+=V[2],V[0]=0,V[1]=0,V[2]=0,o.isPresenting===!1)return y._controllers.forEach(function(w){w&&w.update()}),W.iv(),!1;var P=y._frameData;o.getFrameData(P);var Q=P.pose.position;if(Q){var S=y.toViewPosition(Q);W.setEye(S),y._orientation.fromArray(P.pose.orientation),y._originalOrientation&&y._orientation.premultiply(y._originalOrientation.quaternion);var K=new Jm.Vector3(0,0,-10*y._scaleFactor);K.applyQuaternion(y._orientation),W.setCenter([S[0]+K.x,S[1]+K.y,S[2]+K.z])}y._controllers.forEach(function(m){m&&m.update()}),W.setViewport(I,0,0,n/2,x),y._viewMatrix=y._copyViewMatrix(P.leftViewMatrix),y._projectMatrix=y._copyProjectMatrix(P.leftProjectionMatrix),f(),W.setViewport(I,n/2,0,n/2,x),y._viewMatrix=y._copyViewMatrix(P.rightViewMatrix),y._projectMatrix=y._copyProjectMatrix(P.rightProjectionMatrix),f(),y._lastViewMatrix=y._viewMatrix,y._lastProjectMatrix=y._projectMatrix,y._viewMatrix=null,y._projectMatrix=null,y.submitFrame();var M=Date.now(),g=y._fpsInfo;return M-g.time>1e3?(g.fps=Math.round(1e3*(g.frames+1)/(M-g.time)),g.time=M,g.frames=0):g.frames++,!0}}},onVRDisplayPresentChange:function(){var y=this.isPresenting();this._injectGraphView(y),this.fp("present",!y,y)},getOrientation:function(){return this._orientation},addController:function(m){m=m||0;var R=this,n=R.getController(m);return n?n:(n=new Kq(R,m),R._controllers.push(n),n)},getController:function(h){h=h||0;for(var X=this._controllers,B=0,Z=X.length;Z>B;B++)if(X[B]&&X[B].id===h)return X[B];return null},removeController:function(f){f=f||0;for(var k=this._controllers,X=0,E=k.length;E>X;X++)if(k[X]&&k[X].id===f)return k.splice(X,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(z,m){var g=this,w=g._scaleFactor,B=g._eyesOffset,G=g._lastHeadPose;if(g._originalOrientation){var l=g._originalOrientation.quaternion,R=new Jm.Vector3(z);R.applyQuaternion(l).multiplyScalar(w).toArray(G)}else G[0]=z[0]*w,G[1]=z[1]*w,G[2]=z[2]*w;return m?(m[0]=G[0]+B[0],m[1]=G[1]+B[1],m[2]=G[2]+B[2],m):[G[0]+B[0],G[1]+B[1],G[2]+B[2]]},addEyesOffset:function(W,H,h){var I=this._offsetToBeAdd;I[0]+=W,I[1]+=H,I[2]+=h},_copyViewMatrix:function(o){var t=this,E=t.dup(o);if(t._originalOrientation){var J=(new Jm.Matrix4).fromArray(E);J.multiply(t._originalOrientation.matrixInverse).toArray(E)}var T=t._scaleFactor;E[12]*=T,E[13]*=T,E[14]*=T;var w=t._eyesOffset;if(w&&(w[0]||w[1]||w[2])){var X=w[0],k=w[1],Z=w[2];E[12]-=E[0]*X+E[4]*k+E[8]*Z,E[13]-=E[1]*X+E[5]*k+E[9]*Z,E[14]-=E[2]*X+E[6]*k+E[10]*Z}return E},shutdown:function(){var N=this._device;N&&N.isPresenting&&N.exitPresent()},isPresenting:function(){var b=this._device;return b&&b.isPresenting},_copyProjectMatrix:function(x){var N=this.dup(x),L=this._scaleFactor;return N[14]*=L,N},dup:function(C,J){for(var r=C.length,v=J||new Array(r);r--;)v[r]=C[r];return v},getViewMatrix:function(W){var u=this._viewMatrix;return u?this.dup(u,W):void 0},getProjectMatrix:function(){var I=this._projectMatrix;return I?this.dup(I):void 0},submitFrame:function(){var y=this;if(y._enable&&y._deviceInAction){var n=y._device;n&&n.isPresenting&&(n.submitFrame(),y.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function($){var r=this.gv;return r.intersectObjects($,r.dm().getDatas())},setDevice:function(i){var V=this;V._device=i},_injectGraphView:function(){var f,A,d;return function(Z){var C=this.gv;if(!Z)return f&&(C.getWidth=f,C.getHeight=A,C.getDevicePixelRatio=d),void 0;var r=this._device,V=r.getEyeParameters("left"),t=V.renderWidth,K=V.renderHeight;f=C.getWidth,A=C.getHeight,d=C.getDevicePixelRatio,C.getWidth=function(){return 2*t},C.getHeight=function(){return K},C.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(I){var E=this;if(!I)return Bj=Y.Default.callLater=E._defaultCallLater,nl=Y.Default.cancelLater=E._defaultCancelLater,void 0;var E=this;Bj=Y.Default.callLater=function(l,i,I,H){var t=E._device;return t&&t.isPresenting?H?T(function(){Bj(l,i,I)},H):t.requestAnimationFrame(function(){E._deviceInAction=!0,l.apply(i,I),E._deviceInAction=!1}):E._defaultCallLater(l,i,I,H)},nl=Y.Default.cancelLater=function(D,R){var W=E._device;return W&&W.isPresenting?R?r(D):W.cancelAnimationFrame(D):E._defaultCancelLater(D,R)}}}),L.defineProperties(Nr.prototype,{enable:{get:function(){return this._enable},set:function(i){var K=this;K._enable!==i&&(K._enable=i,i?(K.switch.showButton(),K._injectCallLaterFunc(!0)):(K.shutdown(),K.switch.hideButton(),K._injectCallLaterFunc(!1)),K.fp("enable",!i,i))}},measureOflength:{get:function(){return this._measureOflength},set:function(m){this._measureOflength=m;var K=this._scaleFactor=1/m;this._controllers.forEach(function(x){x&&x._setScaleFactor(K)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(o){this._eyesOffset=o}},controllerModel:{get:function(){return this._controllerModel},set:function(g){var s;"object"==typeof g?(s=g.mtl,g=g.obj):(s=g+".mtl",g+=".obj");var e=this,p=e._controllerModel;p&&p.obj===g&&p.mtl===s||(p=e._controllerModel={obj:g,mtl:s},j.loadObj(g,s,{finishFunc:function(X,G){e._controllerModel===p&&j.setShape3dModel("vrControllerModel",G)}}))}},interactive:{get:function(){return!!this._interactive},set:function(b){!!b!=!!this._interactive&&(this._interactive=b,b&&this.addController(0),this.gv.getCoreInteractor().enableVR(b))}}});var Kq=function(k,a){function N(B){var v=navigator.getGamepads&&navigator.getGamepads();if(v)for(var p=0,O=0,I=v.length;I>p;p++){var H=v[p];if(H){var b=H.id;if("OpenVR Gamepad"===b||0===b.indexOf("Oculus Touch")||b.indexOf("Controller")>=0){if(O===B)return H;O++}}}}function D(F,K,T){return Math.abs(F[0]-K[0])<T&&Math.abs(F[1]-K[1])<T&&Math.abs(F[2]-K[2])<T?!0:!1}var b=this;b.vr=k,b.id=a;var _,i,f=[0,0],Z=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],V=new Vj;V.s("shape3d","vrControllerModel"),V.isController=!0,V.s("intersect",!1),b.getGamepad=function(){return i},b.isButtonPressed=function(d){for(var V,C=0,Y=Z.length;Y>C;C++)if(V=Z[C],V.id===d)return V.pressed;return!1},b.getNode=function(){return V};var F=.003;b.setRotationEpsilon=function(o){F=o};var G=5e-4,$=G;b.setPositionEpsilon=function(S){G=S,$=S*b.vr._scaleFactor},b._setScaleFactor=function(Y){V.s3(Y,Y,Y),$=G*Y},b._setScaleFactor(b.vr._scaleFactor);var A,v=new Rf,w=new Hf,q=[0,0,0],e=[0,0,0],K=new Gj,x=new sh,B=new Ub;b.getRay=function(){return A?(B.origin.fromArray(q),B.direction.copy(x),A=!1,B):B},b.update=function(){if(_=i,i=N(a),!i||i.pose===n)return i=null,V.s("3d.visible",!1),void 0;if(j.getShape3dModel("vrControllerModel")){V.dm()||k.gv.dm().add(V),V.s("3d.visible",!0);var O=i.pose;if(null!==O){if(O.position&&(b.vr.toViewPosition(O.position,q),D(V.p3(),q,$)||(A=!0,V.p3(q))),O.orientation){v.fromArray(O.orientation);var R=b.vr._originalOrientation;R&&v.premultiply(R.quaternion),x.set(0,0,-1).applyQuaternion(v).normalize(),w.makeRotationFromQuaternion(v),K.set(0,0,0,V.getRotationMode(),!0).setFromRotationMatrix(w),e[0]=K.x,e[1]=K.y,e[2]=K.z,D(V.r3(),e,F)||(A=!0,V.r3(e))}A&&k.fp("gamepad.pose",null,{position:q,rotation:e,id:a});var o=i.axes;(f[0]!==o[0]||f[1]!==o[1])&&(f=[o[0],o[1]],k.fp("gamepad.axes",null,{id:a,axes:f}));var u,z,J,T,m=i.buttons;for(u=0,z=m.length;z>u;u++)if(J=m[u],J&&(T=J.pressed,Z[u]||(Z[u]={id:"button"+u,pressed:!1}),T!==Z[u].pressed)){Z[u].pressed=T;var s={id:a},Q="state";s[Q]=s._62O=T?"down":"up",k.fp("gamepad.button."+Z[u].id,null,s)}}}}},ll=function(G){this.vr=G,this._button=null};kk(ll,L,{showButton:function(){var o=this.assureButton();if(!o.parentNode){var b=this.vr.gv,W=b.getView();b._79O?W.insertBefore(o,b._79O):W.appendChild(o)}},hideButton:function(){var P=this._button;P&&P.parentNode&&P.parentNode.removeChild(P)},assureButton:function(){var x=this._button;return x?x:this._button=this.createButton(this.vr.gv)},createButton:function(V){function M(l,n){l.textContent=n&&n.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function R(D){j.style.display="",j.style.cursor="pointer",j.style.left="calc(50% - 50px)",j.style.width="100px",M(j,D),j.onmouseenter=function(){j.style.opacity="1.0"},j.onmouseleave=function(){j.style.opacity="0.5"},j.onclick=function(){D.isPresenting?D.exitPresent():D.requestPresent([{source:V.getCanvas()}])},V.vr.setDevice(D)}function P(){j.style.display="",j.style.cursor="auto",j.style.left="calc(50% - 75px)",j.style.width="150px",M(j,null),j.onmouseenter=null,j.onmouseleave=null,j.onclick=null,V.vr.setDevice(null)}function u(O){O.style.position="absolute",O.style.bottom="20px",O.style.padding="12px 6px",O.style.border="1px solid #fff",O.style.borderRadius="4px",O.style.color="#000",O.style.font="normal 13px sans-serif",O.style.textAlign="center",O.style.opacity="0.5",O.style.outline="none",O.style.zIndex="999"}if("getVRDisplays"in navigator){var j=this._button=d.createElement("button");return j.style.display="none",u(j),q(m,"vrdisplayconnect",function(O){R(O.display)}),q(m,"vrdisplaydisconnect",function(){P()}),q(m,"vrdisplaypresentchange",function(y){M(j,y.display),V.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(E){E.length>0?R(E[0]):P()}),j}var B=d.createElement("a");return B.href="https://webvr.info",B.innerHTML="当前不支持 webvr",B.style.left="calc(50% - 90px)",B.style.width="180px",B.style.textDecoration="none",u(B),B}}),L.defineProperties(ll.prototype,{});var mr=Y.graph3d.PostProcessing=function(O){function q(){if(!D){var H=O.getGL();D=new fl.RenderTarget(O,H,null,null,{samples:v.renderTextureSamples||1}),Y=new ld.Shader(H,g.vs,g.fs),p=ld.Buffer.createIndexBuffer(H,new Uint16Array([0,2,1,1,2,3])),Z=ld.Buffer.createVertexBuffer(H,new Float32Array([0,0,1,0,0,1,1,1]))}}var D,Y,p,Z,_=this,E={},N=!1;!function(){L.keys(mr).forEach(function(J){E[J]=new mr[J](O)})}(),_.getModule=function(V){return V?E[V]:_},_.getModuleList=function(){return L.keys(E)},_._serializable=!0,_.handleDataModleChange=function(H,N){H&&(_._serializable&&H.setPostProcessingData(_.serialize()),H.removeSerializeListener(_.onDataModelSerialize,_)),N&&(N.addSerializeListener(_.onDataModelSerialize,_),_.deserialize(N))},_.onDataModelSerialize=function(l){"serialize"===l.type?_._serializable&&(O.dm()._postProcessingData=_.serialize()):"deserialize"===l.type&&_.deserialize(O.dm())},_.isDeserializeDisabled=function(P){return!_._serializable||P.a("sceneBloom")!==n},_.isSerializable=function(){return _._serializable},_.setSerializable=function(k){_._serializable=k,k||O.dm().setPostProcessingData(n)},_.serialize=function(){var r,X,D,C,k={};for(X in E)if(D=E[X],C=D.serializeProperties){r={},D.enable&&(r.enable=!0);for(var c in C){var q=D[c];q!=C[c]&&(r[c]=q)}L.keys(r).length&&(k[X.toLowerCase()]=r)}return k},_.deserialize=function(r){var y,C,g,K,P,I={},L={};for(y in E){g=E[y],K=g.serializeProperties;var N={},S="scene"+y,B=r.a(S);B!==n&&(N.enable=B);for(var P in K)B=r.a(S+P[0].toUpperCase()+P.slice(1)),B!==n&&B!==K[P]&&(N[P]=B);sn(N)||(L[y.toLowerCase()]=N)}if(sn(L)&&(L=r.getPostProcessingData()),L)for(C in L)if(C&&(y=C[0].toUpperCase()+C.slice(1),g=E[y])){I[y]=!0,K=L[C];var t=!!K.enable;_.enableModule(y,t),y="scene"+y,r.a(y,t),g.resetProperties&&g.resetProperties();for(P in K)if("enable"!==P){var B=K[P];g[P]=B,r.a(y+P[0].toUpperCase()+P.slice(1),B)}}for(y in E)I[y]||(g=E[y],g.enable=!1,g.resetProperties&&g.resetProperties())},_.decodeShader=function($){var V,e,z,I="",h="";for(z=0;z<$.length;z++)V=$[z],"%"===V?V="'":"a"===V?V='"':"]"===V&&(V="\\"),e=String.fromCharCode(V.charCodeAt(0)-1),z%2?h+=e:I=e+I;return h+I},_.createShader=function(t,Q,T){var Z=Q.indexOf("^#"),X=_.decodeShader(Q.substr(0,Z)),e=_.decodeShader(Q.substr(Z+2));if(T){var h=T(X,e);h&&h.vs&&(X=h.vs),h&&h.fs&&(e=h.fs)}return new ld.Shader(t,X,e)},_.enableModule=function(e,J){var _,H,L,W=e.split(",");for(_=0,H=W.length;H>_;_++)L=W[_].trim(),E[L]&&(E[L].enable=J);N=!1;for(L in E)if(E[L].enable){N=!0;break}N&&q()};var g={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};_._42=function(L,B,j,n,R){if(N&&!R){D.setSize(L,B,j),D.bind(L);var a=L.getParameter(L.COLOR_CLEAR_VALUE);a&&0===a[0]&&0===a[1]&&0===a[2]&&0===a[3]?a=null:Rg(L,[0,0,0,0]),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),O.setViewport(L,0,0,B,j),n(),D.unbind(L);for(var k=0,P=O._glCapabilities.maxAttributes;P>k;k++)L.disableVertexAttribArray(k);var r,t=D;for(r in E)t=E[r]._42(L,t)||t;return O.setViewport(L,0,0,B,j),a&&Rg(L,a),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),Y.bind(),L.activeTexture(L.TEXTURE0+0),L.bindTexture(L.TEXTURE_2D,t.texture),Y.uniforms.image=0,p.upload(),Z.upload(),Y.attributes.pos.pointer(Z),L.drawElements(L.TRIANGLES,6,L.UNSIGNED_SHORT,0),L.bindTexture(L.TEXTURE_2D,null),L.useProgram(O._prg),!0}}},Gq=Y.graph3d.PostProcessing.Bloom=function(H){function a(){var E=H.getGL();if(E)for(var g=H._postProcessing,y=0;_>y;y++)K[y]=g.createShader(E,Gq._35Q,function(C,r){return{fs:r.replace(/DEFINE_VALUE/g,v[y]).replace("%OVERRIDE_ALPHA_DEFINE%",l?"#define OVERRIDE_ALPHA":"")}})}function S(){var P=H.getWidth(),Q=H.getHeight();if(P&&Q){i=[P,Q],o=!0;var n,Y=H.getGL(),$=Math.round(i[0]/2),v=Math.round(i[1]/2);for(U=new fl.RenderTarget(H,Y,$,v),n=0;_>n;n++)N.push(new fl.RenderTarget(H,Y,$,v)),g.push(new fl.RenderTarget(H,Y,$,v)),$=Math.round($/2),v=Math.round(v/2);var W=H._postProcessing;k=W.createShader(Y,Gq._34Q),a(),c=W.createShader(Y,Gq._36Q,function(N,O){return{fs:O.replace(/NUM_MIPS/g,_)}}),Z=W.createShader(Y,Gq.finalShader),F=ld.Buffer.createIndexBuffer(Y,new Uint16Array([0,2,1,1,2,3])),p=ld.Buffer.createVertexBuffer(Y,new Float32Array([0,0,1,0,0,1,1,1]))}}var y,t,d,l,F,p,J=this,r=!1,o=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var L=this.serializeProperties;for(var k in L)this[k]=L[k]},L.defineProperties(J,{enable:{get:function(){return r},set:function(k){!!r!=!!k&&(r=k,k&&!o&&S(),H.iv())}},strength:{get:function(){return y},set:function(Y){y!==Y&&(y=Y,H.iv())}},threshold:{get:function(){return t},set:function(y){t!==y&&(t=y,H.iv())}},radius:{get:function(){return d},set:function(E){d!==E&&(d=E,H.iv())}},overrideAlpha:{get:function(){return l},set:function(K){!!l!=!!K&&(l=K,o&&a(),H.iv())}}}),this.resetProperties();var U,k,c,Z,i=[256,256],N=[],g=[],_=5,v=[3,5,7,9,11],K=[];J._42=function(u,l){function T(x,E,B,O){gm(u,E.frame),H.setViewport(u,0,0,E.width,E.height),O?O(u):u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),e!==x&&x.bind();var C=0;for(var A in B){var q=B[A];q instanceof WebGLTexture&&(u.activeTexture(u.TEXTURE0+C),u.bindTexture(u.TEXTURE_2D,q),q=C,C++),x.uniforms[A]=q}for(e!==x&&(F.upload(),p.upload(),x.attributes.pos.pointer(p),e=x),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0);C--;)u.activeTexture(u.TEXTURE0+C),u.bindTexture(u.TEXTURE_2D,null);Se(u)}if(r&&(o||(S(),o))){var e;T(k,U,{smoothWidth:.01,luminosityThreshold:t,tDiffuse:l.texture});var J,O=U,j=Math.round(i[0]/2),s=Math.round(i[1]/2);for(J=0;_>J;J++)T(K[J],N[J],{colorTexture:O.texture,direction:[1,0],texSize:[j,s]}),T(K[J],g[J],{colorTexture:N[J].texture,direction:[0,1],texSize:[j,s]}),j=Math.round(j/2),s=Math.round(s/2),O=g[J];return T(c,N[0],{blurTexture1:g[0].texture,blurTexture2:g[1].texture,blurTexture3:g[2].texture,blurTexture4:g[3].texture,blurTexture5:g[4].texture,bloomStrength:y,bloomRadius:d,bloomTintColor:[1,1,1]}),T(Z,l,{image:N[0].texture},function($){$.enable($.BLEND),$.blendEquation($.FUNC_ADD),$.blendFunc($.SRC_ALPHA,$.ONE)}),u.blendEquationSeparate(u.FUNC_ADD,u.FUNC_ADD),u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA),l}}};Gq._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Gq._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Gq._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Gq.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Aq=Y.graph3d.PostProcessing.Dof=function(W){function V(){U=!0;var I=W.getGL();f=new fl.RenderTarget(W,I),Y=W._postProcessing.createShader(I,Aq._38Q),q=ld.Buffer.createIndexBuffer(I,new Uint16Array([0,2,1,1,2,3])),$=ld.Buffer.createVertexBuffer(I,new Float32Array([0,0,1,0,0,1,1,1]))}var f,Y,q,$,R,y,T,S,H=this,K=!1,U=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var c=this.serializeProperties;for(var h in c)this[h]=c[h]},L.defineProperties(H,{enable:{get:function(){return K},set:function(O){!!K!=!!O&&(K=O,O&&!U&&V(),W.iv())}},image:{get:function(){return y},set:function(S){y!==S&&(y=S,R&&(W.getGL().deleteTexture(R),R=null),W.iv())}},maxblur:{get:function(){return T},set:function(e){T!==e&&(T=e,W.iv())}},aperture:{get:function(){return S},set:function(p){S!==p&&(S=p,W.iv())}}}),this.resetProperties(),H._42=function(i,y){function e(y,O,C,R){gm(i,O.frame),W.setViewport(i,0,0,O.width,O.height),R?R(i):i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),t!==y&&y.bind();
var c=0;for(var T in C){var j=C[T];j instanceof WebGLTexture&&(i.activeTexture(i.TEXTURE0+c),i.bindTexture(i.TEXTURE_2D,j),j=c,c++),y.uniforms[T]=j}for(t!==y&&(q.upload(),$.upload(),y.attributes.pos.pointer($),t=y),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0);c--;)i.activeTexture(i.TEXTURE0+c),i.bindTexture(i.TEXTURE_2D,null);Se(i)}if(K){U||V();var t;if(!R){var F=co(this.image);if(!F||!F.tagName)return y;R=hf(i,F)}var r=y.width,h=y.height;if(r&&h)return f.setSize(i,r,h),e(Y,f,{tColor:y.texture,tDepth:R,aspect:r/h,aperture:this.aperture,maxblur:this.maxblur}),f}}};Aq._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Dq(j,{accordionViewExpandIcon:Xf(Rh),accordionViewCollapseIcon:Xf(Rh,!0),accordionViewLabelColor:$j,accordionViewLabelFont:Go,accordionViewTitleBackground:lg,accordionViewSelectBackground:Tr,accordionViewSelectWidth:3,accordionViewSeparatorColor:n,splitViewDividerSize:1,splitViewDividerBackground:lg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:hk,rect:[2,2,12,12],background:Rh}]},propertyViewLabelColor:zl,propertyViewLabelSelectColor:$j,propertyViewLabelFont:Go,propertyViewExpandIcon:Xf(mm),propertyViewCollapseIcon:Xf(mm,!0),propertyViewBackground:Vl,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ir,propertyViewColumnLineColor:ir,propertyViewSelectBackground:Tr,listViewLabelColor:zl,listViewLabelSelectColor:$j,listViewLabelFont:Go,listViewRowLineVisible:!1,listViewRowLineColor:ir,listViewSelectBackground:Tr,treeViewLabelColor:zl,treeViewLabelSelectColor:$j,treeViewLabelFont:Go,treeViewExpandIcon:Xf(Cj),treeViewCollapseIcon:Xf(Cj,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ir,treeViewSelectBackground:Tr,treeViewDoubleClickToToggle:!0,tableViewLabelColor:zl,tableViewLabelSelectColor:$j,tableViewLabelFont:Go,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ir,tableViewColumnLineColor:ir,tableViewSelectBackground:Tr,treeTableViewLabelColor:zl,treeTableViewLabelSelectColor:$j,treeTableViewLabelFont:Go,treeTableViewExpandIcon:Xf(Cj),treeTableViewCollapseIcon:Xf(Cj,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ir,treeTableViewColumnLineColor:ir,treeTableViewSelectBackground:Tr,tableHeaderLabelColor:zl,tableHeaderLabelFont:Go,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:_b,tableHeaderBackground:Vl,tableHeaderMoveBackground:Fg,tableHeaderInsertColor:Tr,tableHeaderSortDescIcon:Nk(mm,!0),tableHeaderSortAscIcon:Nk(mm),tabViewTabGap:1,tabViewLabelColor:$j,tabViewLabelFont:Go,tabViewTabBackground:lg,tabViewSelectWidth:3,tabViewSelectBackground:Tr,tabViewMoveBackground:Fg,tabViewInsertColor:Tr,toolbarLabelColor:zl,toolbarLabelSelectColor:$j,toolbarLabelFont:Go,toolbarBackground:Vl,toolbarSelectBackground:Tr,toolbarItemGap:8,toolbarSeparatorColor:gq},!0);var oe={translateX:1,sortColumn:1},ar={sortable:1,sortOrder:1,sortFunc:1},xg={focusData:1},Bc={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Jb={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Gd=function(p,$){$.add(p),p.hasChildren()&&p.eachChild(function(k){Gd(k,$)})},Ve=function(F,b,u,x,h,L,y,d,p,V,A){var e,s=u.getValueType(V),U=u.getAlign(V);if(u.getEnumValues(V)){var f=u.toEnumLabel(b,V),D=Pq||0,q=0,Y=L,o=j.getTextSize(x,f).width;return e=co(u.toEnumIcon(b,V)),e&&(q=L+Pq/2,"center"===U?q+=(d-(D+o))/2:"right"===U&&(q=q+d-(D+o)),Qe(F,e,q,y+p/2,V,A),Y=q+Pq/2),f!=O&&(e?om(F,f,x,h,Y,y,d-(Y-L),p):om(F,f,x,h,L,y,d,p,U)),void 0}return b=u.formatValue(b),b!=O?s===ib?(hd(F,L,y,d,p,b),void 0):s===sf||!s&&Hi(b)?(e=co(b?Ol:Sg),Qe(F,e,L+d/2,y+p/2,V,A),void 0):(om(F,b,x,h,L,y,d,p,U),void 0):void 0},fo=function(x,Y){var j=Y.view,J=mp(x),b=Y.column||Y.property;j.getDataModel().beginTransaction(),Y.editor=x,x.info=Y,j.setCurrentEditor(x),j.getView().insertBefore(J,j._79O),dg(x,Y.editorRect),x.setFocus?x.setFocus():eh(x),x.commitValue=function(t,E){x._17Q&&(x=x._17Q),E||j.setValue(Y.data,b,x.getValue?x.getValue():x.value),x.close&&x.close(),go(J)},b.onEditorCreated&&b.onEditorCreated(Y)},me=function(A,D,m,I,X){var n=$l(A,m),S=D.value,E=D.view,Y=X.getValueType(D.data);return n.onblur=n.onchange=function(){E.endEditing()},"input"===A?(S=X.formatValue(S),S!=O&&(n.value=S),n.onkeydown=function(c){Vm(c)?E.endEditing():Le(c)&&E.endEditing(!0)},(Y===Hk||Y===fc)&&q(n,Ud,j.numberListener)):A===$r&&I.forEach(function(j){var B=d.createElement("option");B.innerHTML=X.toEnumLabel(j),B.value=j,X.isEnumEqual(S,j)&&(B.selected=!0),cr(n,B)}),fo(n,D),n},Ao=Y.widget={},xp=function(c,Z,m){kk(F+".widget."+c,Z,m)};Dq(pc,{ms_value:function(o){o.getValue=function(_){var n=this.getItemById(_),p=n.element;return xh(p)?p:p?p.getValue?p.getValue():p.value:n.selected},o.setValue=function(t,u){var R=this.getItemById(t);if(R){var C=R.element;C&&!xh(C)?C.setValue?C.setValue(u):C.value=u:Hi(u)?(R.selected=u,this.iv()):(R.element=u,this.iv())}},o.v=function(k,t){var f=this;if(2===arguments.length)f.setValue(k,t);else{if(!Xj(k))return f.getValue(k);for(var m in k)f.setValue(m,k[m])}return f}},_46o:function(o){o._icon=O,o._accessType=O,o._valueType=O,o._editable=!1,o._batchEditable=!0,o._align=dj,o._nullable=!0,o._emptiable=!1,o.setParent=yp,o.formatValue=function(I){var b=this,t=b._valueType;return b.getEnumValues()?b.toEnumLabel(I):t===sf?!!I:I!=O&&t===Hk?i(I):I},o.setEnum=function(e,d,S,H,l,Q,C){var D=this;e&&!Hr(e)&&e.values&&(H=e.editable,S=e.icons,d=e.labels,l=e.strict,Q=e.maxHeight,C=e.dropDownWidth,e=e.values),re(e)&&(e=e._as),re(d)&&(d=d._as),re(S)&&(S=S._as),D._enumValues=e,D._enumLabels=d,D._enumIcons=S,D._enumEditable=H,D._enumStrict=l==O?!0:l,D._enumMaxHeight=Q,D._enumDropDownWidth=C,e&&e.length&&Sd(e[0])&&(D._valueType=fc),D.fp("enum",!1,!0)},o.getEnumDropDownWidth=function(){return this._enumDropDownWidth},o.getEnumMaxHeight=function(){return this._enumMaxHeight},o.isEnumEditable=function(){return this._enumEditable},o.getEnumValues=function(){return this._enumValues},o.getEnumLabels=function(){return this._enumLabels},o.getEnumIcons=function(){return this._enumIcons},o.isEnumStrict=function(){return this._enumStrict},o.isEnumEqual=function(M,K){return this._enumStrict?M===K:M==K},o.toEnumLabel=function(B,S){var n=this,K=n.getEnumValues(S),r=n.getEnumLabels(S);if(K&&r)for(var q=0;q<K.length;q++)if(n.isEnumEqual(B,K[q]))return r[q];return B},o.toEnumIcon=function(e,w){var y=this,P=y.getEnumValues(w),d=y.getEnumIcons(w);if(P&&d)for(var Q=0;Q<P.length;Q++)if(y.isEnumEqual(e,P[Q]))return d[Q];return n}},_45o:function(B){B._87o=function(e,x,R,h,B,j){if(e){var Z=this,y=Z._90I,A=Tj(1);Z._columnLineVisible&&(B-=1),Z._rowLineVisible&&(j-=1),0>=B||0>=j||(Z._90I||(y=Z._90I={}),y[x]||(y[x]=new zf),dg(A,Z.tx()+R,Z.ty()+h,B,j),cr(A,e),Z._view.insertBefore(A,Z._79O),e.onParentAdded&&e.onParentAdded(A),y[x].add(A))}},B._76o=function(){var Y=this,P=Y._90I;if(P){for(var W in P)P[W].each(function(w){go(w)});delete Y._90I}},B._77o=function(e){var W=this;if(W._90I){var L=W._90I[e];L&&(L.each(function(F){go(F)}),delete W._90I[e])}}},_47o:function(x){x.getValue=function(l,z){return z.getValue?z.getValue(l,z,this):Bm(l,z.getAccessType(),z.getName())},x.setValue=function(e,i,J){if(i.isEmptiable(e)||""!==J||(J=n),i.isNullable(e)||J!=O){var A=this,N=i.getName(e),s=i.getAccessType(e),H=i.getValueType(e);H===Hk&&xh(J)?J=I(J):H===fc&&xh(J)?J=parseFloat(J):H===sf&&xh(J)&&(J="true"===J),A._batchEditable&&i._batchEditable&&A.isSelected(e)?A.sm().each(function(u){i.setValue?i.setValue(u,i,J,A):fr(u,s,N,J)}):i.setValue?i.setValue(e,i,J,A):fr(e,s,N,J)}},x.setCurrentEditor=function(m){this.endEditing(),this._currentEditor=m,this.redraw()},x.isEditing=function(M,W){var p=this,a=p._currentEditor;if(!a)return!1;if(W){var m=a.info;return m?(m.column||m.property)===W&&m.data===M:!1}return!0},x.endEditing=function(Q){var W=this,b=W._currentEditor;b&&(delete W._currentEditor,b.commitValue&&b.commitValue(b.info,Q),W.redraw(),W.getDataModel().endTransaction())},x.beginEditing=function(c){this.endEditing();var I=this,$=c.column||c.property;if($.beginEditing)$.beginEditing(c);else{var j=c.data,J=c.value,R=I.getSelectBackground(j),L=$.getEnumValues(j),x=$.getSlider(j),q=$.getColorPicker(j);if(x){var A=cq(Ao.Slider,x);return A.setValue(J),A.getView().onblur=function(){I.endEditing()},A.isInstant()&&(A.onValueChanged=function(){I.setValue(j,$,A.getValue())}),fo(A,c),void 0}if(q||$.getValueType(j)===ib){var h=cq(Ao.ColorPicker,q);return h.setValue(J),h.onClosed=function(){I.endEditing()},h.isInstant()&&(h.onValueChanged=function(m,H){I.setValue(j,$,H)}),fo(h,c),h.open(),void 0}if(L){if(Ao.ComboBox){var V=new Ao.ComboBox;V.setValue(J),V.setValues(L),V.setLabels($.getEnumLabels(j)),V.setIcons($.getEnumIcons(j)),V.setEditable($.isEnumEditable(j)),V.setStrict($.isEnumStrict(j)),V.setMaxHeight($.getEnumMaxHeight(j)),V.setDropDownWidth($.getEnumDropDownWidth(j)),V.onClosed=function(){I.endEditing()},fo(V,c),V.open()}else me($r,c,R,L,$);return}var b=$.getValueType(j);if(b===sf||Hi(J))return I.setValue(j,$,!J),void 0;if($.getItemEditor(j)){var m=qi($.getItemEditor(j)),E=new m(j,$,I,c),C=E.getView();return C._17Q=E,E.setValue(J),Fc(C),fo(C,c),E.editBeginning&&E.editBeginning(),void 0}me("input",c,R,O,$)}}},_44o:function(M){M.init=function(q){var J=this,t=J.th=new kg(q),g=J._view=Cd(1,J);J.tv=J._tableView=q,cr(g,t.getView()),cr(g,q.getView()),t.mp(function(K){K.property===rj&&J.iv()}),J.iv()},M.getTableView=function(){return this.tv},M.getTableHeader=function(){return this.th},M.getDataModel=function(){return this.tv.dm()},M.getColumnModel=function(){return this.tv.getColumnModel()},M.setColumns=function(o){this.tv.setColumns(o)},M.addColumns=function(n){this.tv.addColumns(n)},M.endEditing=function(){this.tv.endEditing()},M.validateImpl=function(){var W=this,h=W.th,V=Tn(h),T={x:0,y:0,width:W.getWidth(),height:V};dg(h,T),T.y=V,T.height=P(0,W.getHeight()-V),dg(W.tv,T)}},ms_vs:function(x){x._41o=function(){return this._29I.height<this._59I},x._43o=function(){var v=this;v._41o()&&(v._58I||(T(function(){v._94O()},Mk),v.iv()),v._58I=new Date)},x._94O=function(){var e=this;if(e._58I){var X=new Date;X.getTime()-e._58I.getTime()>=Mk?(delete e._58I,e.iv()):T(function(){e._94O()},Mk)}},x._93I=function(){var r=this,t=r._27I;if(r._58I||!r._autoHideScrollBar){t||cr(r._79O,t=r._27I=Tj());var s=r._29I,L=s.height,n=r._59I,d=r.getScrollBarSize(),l=s.width-d-2,F=L*(-r.ty()/n),Y=L*(L/n),Q=t.style;n>L?(Vb>Y&&(F=F+Y/2-Vb/2,0>F&&(F=0),F+Vb>L&&(F=L-Vb),Y=Vb),Q.visibility=Hn,Q.background=r.getScrollBarColor(),Q.borderRadius=d/2+Qj,dg(t,l,F,d,Y)):Q.visibility=Uk}else t&&(t.style.visibility=Uk)}},ms_hs:function(Z){Z._40o=function(){return this._29I.width<this._91I},Z._42o=function(){var I=this;I._40o()&&(I._95O||(T(function(){I._94I()},Mk),I.iv()),I._95O=new Date)},Z._94I=function(){var L=this;if(L._95O){var N=new Date;N.getTime()-L._95O.getTime()>=Mk?(delete L._95O,L.iv()):T(function(){L._94I()},Mk)}},Z._92I=function(){var $=this,u=$._28I;if($._95O||!$._autoHideScrollBar){u||cr($._79O,u=$._28I=Tj());var _=$._29I,W=_.width,q=$._91I,T=$.getScrollBarSize(),b=_.height-T-2,k=W*(-$.tx()/q),l=W*(W/q),m=u.style;q>W?(Vb>l&&(k=k+l/2-Vb/2,0>k&&(k=0),k+Vb>W&&(k=W-Vb),l=Vb),m.visibility=Hn,m.background=$.getScrollBarColor(),m.borderRadius=T/2+Qj,dg(u,k,b,l,T)):m.visibility=Uk}else u&&(u.style.visibility=Uk)}}}),hm(Ol,Gg(16,16,[{type:Dl,rect:[1,1,14,14],background:Tr},{type:hc,rect:[1,1,14,14],width:1,color:cj},{type:ml,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),hm(Sg,Gg(16,16,{type:hc,rect:[1,1,14,14],width:1,color:cj})),hm(In,Gg(16,16,[{type:Oj,rect:[2,2,12,12],borderWidth:1,borderColor:cj,background:"#FFF"},{type:Oj,rect:[4,4,8,8],background:Tr}])),hm(qn,Gg(16,16,{type:Oj,rect:[2,2,12,12],borderWidth:1,borderColor:cj})),pc._15Q=function(d){d._29I=yk,d._59I=0,d._91I=0,d._5o=function(G){var k=this;k._30I=new zf,k._rows=new zf,k._rowMap={},k._31I=0,k._14I=0,k._view=Cd(1,k),k._canvas=Uq(k._view),cr(k._view,k._79O=Tj()),k.dm(G?G:new Dr)},d.getCheckIcon=function(l){var W=this.sm(),V=W.co(l);return W.sg()?co(V?In:qn):co(V?Ol:Sg)},d.checkData=function(q){var I=this.sm(),$=I.co(q);I.sg()&&$||(this._32o=1,$?I.rs(q):I.as(q),delete this._32o)},d.getDataAt=function(Q){Q.target&&(Q=this.lp(Q));var E=J(Q.y/this._rowHeight),j=this._rows;return 0>E||E>=j.size()?O:j.get(E)},d.onDataDoubleClicked=function(){},d.onDataClicked=function(){},d.adjustTranslateX=function(){return 0},d.adjustTranslateY=function(M){var g=this.getHeight()-this._59I;return g>M&&(M=g),M>0?0:i(M)},d.onPropertyChanged=function(P){var l=this,q=P.property;Bc[q]?l.ivm():xg[q]||l.redraw(),q===jq?l._42o():q===Ko&&l._43o()},d.getLabel=function(T){return T.toLabel()},d.getLabelFont=function(){return this._labelFont},d.getLabelColor=function(g){var $=this;if($.isCheckMode()){if($._focusData===g)return $._labelSelectColor}else if($.isSelected(g))return $._labelSelectColor;return $._labelColor},d.getStartRowIndex=function(){return this._31I},d.getEndRowIndex=function(){return this._14I},d.getRowDatas=function(){return this._rows},d.getRowIndex=function(p){return this._rowMap[p._id]},d.getRowSize=function(){return this._rows.size()},d.getViewRect=function(){return qk(this._29I)},d.isVisible=function(r){return this._visibleFunc?this._visibleFunc(r):!0},d.getCurrentSortFunc=function(){return this._sortFunc},d.setDataModel=function(K){var $=this,C=$._dataModel,J=$._selectionModel;C!==K&&(C&&(C.umm($.handleDataModelChange,$),C.umd($.handleDataPropertyChange,$),C.umh($.handleHierarchyChange,$),J||C.sm().ums($.handleSelectionChange,$)),$._dataModel=K,K.mm($.handleDataModelChange,$),K.md($.handleDataPropertyChange,$),K.mh($.handleHierarchyChange,$),J?J._21I(K):K.sm().ms($.handleSelectionChange,$),$.fp("dataModel",C,K))},d.validateModel=function(){var q=this;q._rows.clear(),q._rowMap={},q.buildChildren(q._dataModel._roots);var o=q._rows=q._rows.toList(q.isVisible,q),j=0,K=q.getCurrentSortFunc(),M=o.size();for(K&&o.sort(K);M>j;j++)q._rowMap[o.get(j)._id]=j},d.buildChildren=function(v){var N=this;v.each(function(a){N._rows.add(a),N.buildChildren(a._children)})},d.handleDataModelChange=function(){this.ivm()},d.handleDataPropertyChange=function(C){"parent"===C.property?this.ivm():this.invalidateData(C.data)},d.handleHierarchyChange=function(){this.ivm()},d.handleSelectionChange=function(b){b.datas.each(this.invalidateData,this),this.onSelectionChanged(b)},d.onSelectionChanged=function(H){var K=this,X=K.sm();!K.isAutoMakeVisible()||1!==X.size()||"set"!==H.kind&&"append"!==H.kind||K._32o||K.makeVisible(X.ld())},d.handleBackgroundClick=function(L){mg(L)&&!this.isCheckMode()&&this.sm().cs()},d.makeVisible=function(I){I&&(this._23I=I,this.iv())},d.scrollToIndex=function(a){var n=this,$=n._29I,f=$.height,F=n._rowHeight,K=F*a;a>=0&&a<n._rows.size()&&f>0&&(K+F>$.y+f?n.ty(-K+f-F):K<$.y&&n.ty(-K))},d.autoScroll=function(D,T){var O=this,n=O._rowHeight,o=n,j=n/4,v=O._29I,N=O.lp(D),H={x:O.tx(),y:O.ty()};return n>0&&v&&(N.x-v.x<o?O.translate(j,0):v.x+v.width-N.x<o&&O.translate(-j,0),N.y-v.y<o?O.translate(0,j):v.y+v.height-N.y<o&&O.translate(0,-j)),H.x=O.tx()-H.x,H.y=O.ty()-H.y,T&&(T.x+=H.x,T.y+=H.y),H},d.getTopRowOrderSelection=function(){var M=this.sm().getTopSelection(),z={},K=new zf;return M.each(function(K){z[K._id]=K}),this._rows.each(function(x){z[x._id]&&K.add(x)}),K},d.getRowOrderSelection=function(){var l=new zf;return this._rows.each(function(r){this.isSelected(r)&&l.add(r)},this),l},d.ivm=function(){this.invalidateModel()},d.invalidateModel=function(){var y=this;y._96I||(y._96I=1,y._32I=1,delete y._24I),y.iv()},d.redraw=function(){var W=this;W._32I||(W._32I=1,delete W._24I,W.iv())},d.invalidateData=function(F){var y=this;Xp?y.redraw():y._32I||(y._24I||(y._24I={}),y._24I[F._id]=F,y.iv())},d.getFocusData=function(){return this._focusData},d.setFocusDataById=function($){this.setFocusData(this.dm().getDataById($))},d.setFocusData=function(m){var x=this,w=x._focusData;w!==m&&(x._focusData=m,x.fp("focusData",w,m),w&&x.invalidateData(w),m&&(x.invalidateData(m),x.isAutoMakeVisible()&&x.makeVisible(m)))},d.drawRowBackground=function(Y,M,L,k,u,h,I){var n=this,g=n.isCheckMode();(M===n._focusData&&g||L&&!g)&&hd(Y,k,u,h,I,n.getSelectBackground(M))},d.drawData=function(y,l,s){var J=this,G=J._rowHeight,C=G*s,k=J._29I,o=k.x,m=k.width;y.save(),y.beginPath(),y.rect(o,C,m,G),y.clip(),J._87o(J.drawRow(y,l,J.isSelected(l),o,C,m,G),s,o,C,m,G),y.restore(),J._rowLineVisible&&hd(y,o,C+G-1,m,1,J._rowLineColor)},d._12I=function(O){var l=this,A=l._31I,Y=l._29I,q=Y.x,v=Y.y,R=Y.width,$=Y.height;for(O.beginPath(),O.rect(q,v,R,$),O.clip(),O.clearRect(q,v,R,$),l._76o(),l._93db(O);A<l._14I;A++)l.drawData(O,l._rows.get(A),A);l._92db(O)},d._13I=function(v){for(var V,P=this,l=P._rowHeight,T=P._29I,J=T.x,I=T.width,e=P._31I,R=P._30I;e<P._14I;e++)V=P._rows.get(e),P._24I[V._id]&&R.add({data:V,index:e});R.isEmpty()||(v.beginPath(),R.each(function(H){v.rect(J,H.index*l,I,l)}),v.clip(),R.each(function(C){v.clearRect(J,C.index*l,I,l)}),R.each(function(L){P._77o(L.index)}),P._93db(v),R.each(function(y){P.drawData(v,y.data,y.index)}),P._92db(v),R.clear())},d.preValidateModel=function(){this.endEditing&&this.endEditing()},d.validateImpl=function(){var Q=this,u=Q._canvas,G=Q.getWidth(),H=Q.getHeight(),f=Q._rowHeight,h=Q._32I;(G!==u.clientWidth||H!==u.clientHeight)&&(Xr(u,G,H),h=1);var X=a&&!x;Q._96I&&!X&&(Q.preValidateModel(),Q.validateModel());var p=Q._29I,T={x:-Q.tx(),y:-Q.ty(),width:G,height:H},j=Q._rows.size(),t=Kn(u),A=Q._23I;h||Xd(T,p)||(h=1),Q._29I=T,Q._59I=j*f+Q.getScrollBarSize(),Q._31I=J(T.y/f),Q._14I=$((T.y+T.height)/f),Q._31I<0&&(Q._31I=0),Q._14I>j&&(Q._14I=j),Q._99I&&h&&Q._99I(),Qh(t,Q.tx(),Q.ty(),1),h?Q._12I(t):Q._24I&&Q._13I(t),Q._93I(),Q._92I(),t.restore(),Q._32I=Q._24I=Q._96I=O,A&&(Q.scrollToIndex(Q.getRowIndex(A)),delete Q._23I),Q.tx(Q.tx()),Q.ty(Q.ty())}},pc._48o=function(w){w._rootVisible=!0,w._rootData=O,w._35o=function(){this._expandMap={},this._levelMap={}},w.validateModel=function(){var V=this,W=V._rootData;V._rows.clear(),V._levelMap={},V._rowMap={},V._currentLevel=0,W?V._rootVisible?V.isVisible(W)&&V.buildData(W):V.buildChildren(W):V.buildChildren(),delete V._currentLevel},w.buildData=function(k){var x=this,a=k._id,Z=x._rows;x._rowMap[a]=Z.size(),Z.add(k),x._levelMap[a]=x._currentLevel,x.isExpanded(k)&&(x._currentLevel++,x.buildChildren(k),x._currentLevel--)},w.buildChildren=function(j){var d=this,l=j?j._children:d._dataModel._roots,r=d.getCurrentSortFunc();r&&d.isChildrenSortable(j)?l.toList(d.isVisible,d).sort(r).each(d.buildData,d):l.each(function(Q){d.isVisible(Q)&&d.buildData(Q)})},w.getLevel=function(e){return this._levelMap[e._id]},w.getToggleIcon=function(W){var K=this,k=K._loader,u=K._collapseIcon;return k&&!k.isLoaded(W)?u:W.hasChildren()?K.isExpanded(W)?K._expandIcon:u:O},w.isCheckMode=function(){return this._checkMode!=O},w.isChildrenSortable=function(){return!0},w.handleDataModelChange=function(i){var v=this;i.kind===Mp?delete v._expandMap[i.data._id]:i.kind===zq&&(v._expandMap={}),v.ivm()},w.toggle=function(C){var E=this;E.isExpanded(C)?E.collapse(C):E.expand(C)},w.isExpanded=function(Q){return 1===this._expandMap[Q._id]},w.expand=function(A){var x=this,V=x._loader;x.isExpanded(A)||(V&&!V.isLoaded(A)&&V.load(A),x._expandMap[A._id]=1,x.ivm(),x.onExpanded(A))},w.onExpanded=function(){},w.collapse=function(v){var w=this;w.isExpanded(v)&&(delete w._expandMap[v._id],w.ivm(),w.onCollapsed(v))},w.onCollapsed=function(){},w.expandAll=function(e){if(e)this.expand(e),e.eachChild(function(K){this.expandAll(K)},this);else{var Y=this;Y._dataModel.each(function(Q){Q.hasChildren()&&(Y._expandMap[Q._id]=1)}),Y.ivm()}},w.collapseAll=function(){this._expandMap={},this.ivm()},w.makeVisible=function($){if($){var d=this;if(!d._rootData||$.isDescendantOf(d._rootData)){for(var i=$._parent;i;)d.expand(i),i=i._parent;d._23I=$,d.iv()}}},w.checkData=function($){var B,z=this,i=z._checkMode,r=z.sm(),Z=r.co($);if(!r.sg()||!Z){if(z._32o=1,i===ol)Z?r.rs($):r.as($);else if(i===pn)B=new zf($),B.addAll($._children);else if("descendant"===i)B=new zf,Gd($,B);else if("all"===i&&(B=new zf,Gd($,B),!Z))for(var w=$._parent;w;)B.add(w),w=w._parent;B&&(Z?r.rs(B):r.as(B)),delete z._32o}},w.drawTree=function(n,A,l,J,L,Z,K){var i=this,e=i._indent,f=i._levelMap[A._id],T=i.getIconWidth(A),h=co(i.getToggleIcon(A));h?(J+=e*f,Qe(n,h,J+e/2,L+K/2,A,i),J+=e):J+=e*(f+1),i._checkMode&&(Qe(n,i.getCheckIcon(A),J+e/2,L+K/2,A,i),J+=e),i.drawIcon(n,A,J,L,T,K),i.drawLabel(n,A,J+T,L,K)}},pc._14Q=function(e){e.getIcon=function(v){return v.getIcon()},e.getIconWidth=function(o){return this.getIcon(o)?this._indent:0},e.drawIcon=function(U,V,e,x,E,$){if(E){var F=this,T=F.getBodyColor(V),_=co(F.getIcon(V),T);_&&($-=F.isRowLineVisible()?1:0,Dk(U,_,Wr,e,x,E,$,V,F,T),Vi(U,F.getBorderColor(V),e,x,E,$))}},e.drawLabel=function(v,u,t,L,G){var O=this;om(v,O.getLabel(u),O.getLabelFont(u),O.getLabelColor(u),t,L,0,G)}},pc._50o=function(t){t._98I=function(){var t=this,I=t._39o=new Dr;t._60I=new zf,I.mm(t._17o,t),I.md(t._18o,t),I.mh(t._19o,t)},t.setColumns=function(v){this._39o.clear(),this.addColumns(v)},t.addColumns=function(Q){var W=this._39o;Q.forEach(function(X){if(!(X instanceof xi)){var j=qi(X.className);X=cq(j?j:xi,X)}W.add(X)})},t.onColumnClicked=function(){},t.onCheckColumnClicked=function(){},t._3Q=function(y){for(var w,W=0,J=this._60I,P=J.size();P>W;W++)if(w=J.get(W),w.column===y)return w;return O},t.getColumnAt=function(E){var b=this._4Q(E);return b?b.column:O},t._4Q=function(t){for(var A=this,j=t.target?A.lp(t).x:t.x,b=A._60I,s=0;s<b.size();s++){var w=b.get(s),F=w.startX;if(j>=F&&j<F+w.column.getWidth())return w}return O},t.getToolTip=function(B){var i=this,b=i.getDataAt(B),r=i.getColumnAt(B);return b&&r?r.getToolTip(b,i):O},t.adjustTranslateX=function(E){var $=this.getWidth()-this._91I;return $>E&&(E=$),E>0?0:i(E)},t._99I=function(){var u=this,A=u._29I,k=u._60I;k.clear(),u._91I=0,u._39o._roots.each(function(x){if(x.isVisible()){var c=u._91I+x.getWidth();u._91I<=A.x+A.width&&c>=A.x&&k.add({column:x,startX:u._91I}),u._91I=c}}),u._91I+=u.getScrollBarSize()},t.drawData=function(i,v,K){var e=this,O=e._rowHeight,r=O*K,p=e.isSelected(v),Y=e._29I,m=Y.x,y=Y.width;e.drawRowBackground(i,v,p,m,r,y,O),e._60I.each(function(P){var j=P.column,h=P.startX,b=j.getWidth();b>0&&!e.isEditing(v,j)&&(i.save(),i.beginPath(),i.rect(h,r,b,O),i.clip(),e._87o(e.drawCell(i,v,p,j,h,r,b,O),K,h,r,b,O),e._columnLineVisible&&hd(i,h+b-1,r,1,O,e._columnLineColor),i.restore())}),e._rowLineVisible&&hd(i,m,r+O-1,y,1,e._rowLineColor)},t.drawCell=function(m,U,X,s,i,H,r,Y){var c=this;if(s.drawCell)return s.drawCell(m,U,X,s,i,H,r,Y,c);var O=c.getValue(U,s);Ve(m,O,s,c.getLabelFont(U,s,O),c.getLabelColor(U,s,O),i,H,r,Y,U,c)},t.getColumnModel=function(){return this._39o},t._17o=function(){this.redraw()},t._18o=function(g){var Q=this;g.data===Q._sortColumn&&ar[g.property]?Q.ivm():(Q._42o(),Q.redraw())},t._19o=function(){this.redraw()},t.getCurrentSortFunc=function(){var N=this,I=N._sortColumn;if(I&&I.isSortable()){var k=I.getSortFunc(),t=Yk===I.getSortOrder()?1:-1;return k||(k=fq),function(W,j){return k.call(N,N.getValue(W,I),N.getValue(j,I),W,j)*t}}return N._sortFunc},t.isCellEditable=function(L,Y,A){return Y.isEditable()&&this.isEditable()?Y.isCellEditable?Y.isCellEditable(L,Y,A,this):!0:!1},t._37O=function(m,R){if(mg(R))for(var C=this,x=C.lp(R),o=C._60I,I=C._rowHeight,F=C._29I,H=F.x,K=F.y,u=F.width,w=F.height,X=0;X<o.size();X++){var L=o.get(X),a=L.startX,O=L.column,d=O.getWidth();if(O!==C._31o&&O!==C._4o&&x.x>=a&&x.x<a+d&&C.isCellEditable(m,O,R)){var l={x:a,y:C.getRowIndex(m)*I,width:d,height:I},S={x:l.x+C.tx(),y:l.y+C.ty(),width:l.width,height:l.height},G=0,e=0;return l.x<H?G=l.x-H:l.x+l.width>H+u&&(G=l.x+l.width-H-u),G&&(C.tx(C.tx()-G),S.x-=G),l.y<K?e=l.y-K:l.y+I>K+w&&(e=l.y+I-K-w),e&&(C.ty(C.ty()-e),S.y-=e),C.beginEditing({data:m,column:O,value:C.getValue(m,O),event:R,rect:l,editorRect:S,view:C}),void 0}}}},Ao.BaseItemEditor=function(v,p,C,Y){this._data=v,this._column=p,this._master=C,this._editInfo=Y},xp("BaseItemEditor",L,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var jr=Y.Tab=function(){Ck(jr,this)};ij("Tab",Jh,{ms_ac:["view","closable","disabled","visible"],_icon:O,_closable:!1,_disabled:!1,_visible:!0,setParent:yp});var xi=Y.Column=function(){Ck(xi,this)};ij("Column",Jh,{_46o:1,ms_ac:["accessType","valueType",Hn,tm,gj,Ml,"align",ib,"sortOrder",bl,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Yk,_sortFunc:O,_sortable:!0,_clickable:!0,setWidth:function(E){16>E&&(E=16);var U=this._width;this._width=E,this.fp(Ml,U,E)},getToolTip:function(s,S){return this.formatValue(S.getValue(s,this))}});var Pp=Y.Property=function(){Ck(Pp,this)};ij("Property",Jh,{_46o:1,ms_ac:["accessType","valueType",tm,gj,"categoryName",ib,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:O,getToolTip:function(D,t,o){var m=this;return t?m.formatValue(o.getValue(D,m)):o.getPropertyName(m)}}),Ao.AccordionView=function(){var U=this;U._20o={},U._21o=new zf,U._10o=O,U._9o=O,U._11o=O,U._view=Cd(0,U),U.iv()},xp("AccordionView",L,{ms_v:1,ms_fire:1,ms_ac:[Kj,Kf,"titleHeight",Br,Vk,"titleBackground","selectWidth",jl,"orientation","separatorColor"],_expandIcon:j.accordionViewExpandIcon,_collapseIcon:j.accordionViewCollapseIcon,_titleHeight:Xl,_labelColor:j.accordionViewLabelColor,_labelFont:j.accordionViewLabelFont,_titleBackground:j.accordionViewTitleBackground,_selectBackground:j.accordionViewSelectBackground,_selectWidth:j.accordionViewSelectWidth,_orientation:"v",_separatorColor:j.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(F,O,z,b){var N=this,Z=Tj(),$={content:O,div:Z,canvas:Uq(Z),icon:b};if(N._20o[F])throw F+" already exists";var y=$.downEventFunc=function(i){zh(i)},P=$.upEventFunc=function(I){zh(I),mg(I)&&(N._10o===F?N.collapse():N.expand(F))};[Kd,fm].forEach(function(z){q(Z,z,y)}),[hj,Dh].forEach(function(x){q(Z,x,P)}),Z.style.cursor=bi,cr(N._view,Z),N._20o[F]=$,N._21o.add(F),z&&N.expand(F),N.iv()},remove:function(b){var K=this,f=K._20o[b];if(f){var R=f.div;go(R),[Kd,fm].forEach(function(v){X(R,v,f.downEventFunc)}),[hj,Dh].forEach(function(t){X(R,t,f.upEventFunc)}),delete K._20o[b],K._21o.remove(b),K.iv()}},clear:function(){var H=this;H._21o.toArray().forEach(H.remove,H),H._20o={},H._21o.clear(),H.iv()},isExpanded:function(r){return this._10o===r},expand:function(S){var m=this;m._20o[S]&&m._10o!==S&&(m._10o=S,m.onExpanded(S),m.iv())},onExpanded:function(){},collapse:function(){var n=this;n._10o&&(n.onCollapsed(n._10o),delete n._10o,n.iv())},onCollapsed:function(){},initCanvas:function(q,z,Y){Xr(q,z,Y);
var O=Kn(q);return Qh(O,0,0,1),O.clearRect(0,0,z,Y),O},drawTitle:function(H,y,Y,L,q){var e=this,c=co(q.icon),C=e.isExpanded(y),V=e._titleHeight,r=e._titleBackground,l=e._selectWidth,E=e._separatorColor,j=co(C?e._expandIcon:e._collapseIcon),R=l+4;hd(H,0,0,Y,L,r),C&&l&&hd(H,0,0,l,L,e._selectBackground),(C||e._21o.get(e._21o.size()-1)!==y)&&hd(H,0,L-1,Y,1,E?E:Io(r)),c&&(Qe(H,c,R+Ne(c)/2,V/2),R+=Ne(c)+2),om(H,y,e.getLabelFont(y),e.getLabelColor(y),R,0,0,V),j&&Qe(H,j,Y-Ne(j)/2-4,V/2)},validateImpl:function(){var l=this,m=l._view,X=0,y=0,j=l.getWidth(),i=l.getHeight(),S=l._titleHeight,Z=l._21o.size()*S,w=l._11o,L=l._9o;delete l._11o,delete l._9o,l._21o.each(function(o){var w,V,W=l._20o[o],b=W.content,K=l._10o===o;Qc(l)?(dg(W.div,X,0,S,i),w=l.initCanvas(W.canvas,S,i),cl(w,0,i),gc(w,-M),l.drawTitle(w,o,i,S,W),w.restore(),K?(V=P(0,j-Z),b&&(l._11o=b,l._9o=mp(b),dg(b,X+S,0,V,i)),X+=S+V):X+=S):(dg(W.div,0,y,j,S),w=l.initCanvas(W.canvas,j,S),l.drawTitle(w,o,j,S,W),w.restore(),K?(V=P(0,i-Z),b&&(l._11o=b,l._9o=mp(b),dg(b,0,y+S,j,V)),y+=S+V):y+=S)});var d=l._9o;w&&w!==l._11o&&w.endEditing&&w.endEditing(),d&&d!==L&&cr(m,d),L&&L!==d&&go(L)}}),Ao.SplitView=function(L,k,Q,l){var K=this,b=K._dividerDiv=Tj(),a=K._60O=Uq(),$=K._61O=Uq(),V=a.style,A=$.style;K._view=Cd(1,K),cr(K._view,b),V.msTouchAction=Bn,V.pointerEvents=Bn,V.cursor=bi,A.msTouchAction=Bn,A.pointerEvents=Bn,A.cursor=bi,L&&K.setLeftView(L),k&&K.setRightView(k),Q&&K.setOrientation(Q),l!=O&&K.setPosition(l),K.setStatus(xm),new eo(K)},xp("SplitView",L,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:j.splitViewDividerSize,_dividerBackground:j.splitViewDividerBackground,_dragOpacity:j.splitViewDragOpacity,_toggleIcon:j.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(b,C){var z=this,y=z._position;isNaN(b)||(C||(z._82O=0>b?-1:b>1?1:0),z._position=b,z.fp(mj,y,b))},getLeftView:function(){return this._leftView},setLeftView:function(q){var v=this,L=v._leftView,o=v._view;if(v._leftView!==q){if(L&&L!==v._rightView){var X=mp(L);X.parentNode===o&&go(X)}if(v._leftView=q,q){var D=mp(q);D.parentNode!==o&&o.insertBefore(D,v._dividerDiv)}v.fp("leftView",L,q)}},getRightView:function(){return this._rightView},setRightView:function(c){var q=this,k=q._rightView,z=q._view;if(q._rightView!==c){if(k&&k!==q._leftView){var U=mp(k);U.parentNode===z&&go(U)}if(q._rightView=c,c){var u=mp(c);u.parentNode!==z&&z.insertBefore(u,q._dividerDiv)}q.fp("rightView",k,c)}},validateImpl:function(){var T=this,B=T._draggable,Y=T._position,w=T.getWidth(),Z=T.getHeight(),G=T._dividerSize,S=T._dividerBackground,q=Lr?18:8,j=T._dividerDiv,b=T._82O,Q=T._60O,z=T._61O,A=T._toggleIcon,C=T._status,e=j.style,n=null,k=Lr?20:4,$=A.comps[0];G>=q||0===G?T._coverDiv&&(go(T._coverDiv),delete T._coverDiv):T._coverDiv||(T._coverDiv=Tj(),kr&&(T._coverDiv.style.background=lb),cr(j,T._coverDiv)),T._togglable?Q.parentNode||(cr(j,Q),cr(j,z)):(go(Q),go(z));var o=T._coverDiv,c=T._leftView,U=T._rightView;if(Qc(T)){if(G>w&&(G=w),C===xm)if(1===b)var R=u(Y,w),m=P(0,w-G-R);else-1===b?(m=u(-Y,w),R=P(0,w-G-m)):(R=i((w-G)*Y),m=P(0,w-G-R));else"cl"===C?(R=0,m=P(0,w-G)):"cr"===C&&(m=0,R=P(0,w-G));c&&dg(c,0,0,R,Z),U&&dg(U,R+G,0,m,Z),dg(j,R,0,G,Z),T._22o=R,o&&(dg(o,G/2-q/2,0,q,Z),o.style.cursor=B?gp:""),j.style.cursor=B?gp:"";var a=j.clientHeight/2,L=j.clientWidth;Xr(Q,L,L),dg(Q,0,a-L-k,L,L),n=Kn(Q),Qh(n,0,0,1),$.rotation=-M,vf(n,A,0,0,L,L),n.restore(),Xr(z,L,L),dg(z,0,a+k,L,L),n=Kn(z),Qh(n,0,0,1),$.rotation=M,vf(n,A,0,0,L,L),n.restore()}else{if(G>Z&&(G=Z),C===xm)if(1===b)var _=u(Y,Z),I=P(0,Z-G-_);else-1===b?(I=u(-Y,Z),_=P(0,Z-G-I)):(_=i((Z-G)*Y),I=P(0,Z-G-_));else"cl"===C?(_=0,I=P(0,Z-G)):"cr"===C&&(I=0,_=P(0,Z-G));c&&dg(c,0,0,w,_),U&&dg(U,0,_+G,w,I),dg(j,0,_,w,G),T._22o=_,o&&(dg(o,0,G/2-q/2,w,q),o.style.cursor=B?Md:""),e.cursor=B?Md:"";var d=j.clientWidth/2,L=j.clientHeight;Xr(Q,L,L),dg(Q,d-L-k,0,L,L),n=Kn(Q),Qh(n,0,0,1),$.rotation=0,vf(n,A,0,0,L,L),n.restore(),Xr(z,L,L),dg(z,d+k,0,L,L),n=Kn(z),Qh(n,0,0,1),$.rotation=t,vf(n,A,0,0,L,L),n.restore()}e.background=S}});var eo=function(l){this.sv=l,this.addListeners()};kk(eo,L,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(M){var I=this,J=I.sv,K=J._dividerDiv,m=J._60O,V=J._61O,a=J._status,U=M.target;if(U===m)a===xm?J.setStatus("cl"):"cr"===a&&J.setStatus(xm);else if(U===V)a===xm?J.setStatus("cr"):"cl"===a&&J.setStatus(xm);else if(yj(M)&&(U===K||U===J._coverDiv)&&(zh(M),J.isDraggable())){J.getLeftView(),J.getRightView();var W=I.maskDiv=Tj();if(W.style.left=0,W.style.top=0,W.style.width=J.getWidth()+"px",W.style.height=J.getHeight()+"px",J.getView().appendChild(W),!J.isContinuousLayout()){var h=I.resizeDiv=Tj();h.style.left=K.style.left,h.style.top=K.style.top,h.style.width=K.style.width,h.style.height=K.style.height,h.style.opacity=J.getDragOpacity(),h.style.background=J.getDividerBackground(),cr(I.getView(),h)}I._lastAbsPosition=J._22o,I._86o=Qc(J)?up(M).x:up(M).y,Bi(I,M)}},handleWindowTouchMove:function(Q){yj(Q)&&this.update(Q,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(F){var o=this;o.update(F,!0),o.sv.setStatus(xm),o.maskDiv&&go(o.maskDiv),o.resizeDiv&&go(o.resizeDiv),o.maskDiv=o.resizeDiv=O},handle_mousedown:function(F){mg(F)&&this.handle_touchstart(F)},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},update:function(T,O){var R=this,x=R.sv,m=Qc(x)?x.getWidth():x.getHeight(),y=x._dividerSize,N=R._lastAbsPosition-R._86o;Qc(x)?(N+=up(T).x,N>m-y&&(N=m-y),0>N&&(N=0),R.resizeDiv&&(R.resizeDiv.style.left=N+Qj)):(N+=up(T).y,N>m-y&&(N=m-y),0>N&&(N=0),R.resizeDiv&&(R.resizeDiv.style.top=N+Qj)),O&&m!==y&&(1===x._82O?x.setPosition(N,1):-1===x._82O?x.setPosition(N-m+y,1):x.setPosition(N/(m-y),1))}}),Ao.TabView=function(){var b=this,W=b._view=Cd(1,b),M=b._91O=Tj(1),K=b._tabModel=new Dr,o=K.sm(),u=b.invalidate;b._7o=new zf,b._canvas=Uq(M),cr(W,M),cr(W,b._92O=Tj(1)),o.setSelectionMode(Li),o.ms(b.handleSelectionChange,b),K.mm(u,b),K.mh(u,b),K.md(u,b),b._interactor=new yg(b),b.iv()},xp("TabView",L,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Br,Vk,"tabHPadding","tabBackground","selectWidth",jl,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:nh,_tabHeight:Xl,_tabGap:j.tabViewTabGap,_labelColor:j.tabViewLabelColor,_labelFont:j.tabViewLabelFont,_tabBackground:j.tabViewTabBackground,_selectWidth:j.tabViewSelectWidth,_selectBackground:j.tabViewSelectBackground,_moveBackground:j.tabViewMoveBackground,_insertColor:j.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(q,Z,v){var A,C=this._tabModel;return q instanceof jr?(A=q,Z&&A.setView(Z)):(A=new jr,A.setName(q),A.setView(Z)),C.add(A),v&&C.sm().ss(A),A},getLabel:function(B){return B.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(p){this._23o=p,this.iv()},get:function(p){var g=this,z=g._tabModel;if(Sd(p))return z._roots.get(p);if(xh(p)){var l;return z.each(function(r){p===g.getLabel(r)&&(l=r)}),l}return p instanceof jr?p:O},select:function(w){this._tabModel.sm().ss(this.get(w))},remove:function(D){var C=this;if(D=C.get(D)){var c=C._tabModel,n=c._roots.indexOf(D);C._tabModel.remove(D),C.selectByIndex(--n)}},getCurrentTab:function(){return this._8o},hideTabView:function(t,j){j.parentNode===this._92O&&(ks(j)?(j.style.display=Jj,j._tab_=t):go(j),Km())},showTabView:function(k,T){ks(T)&&(T.style.display="block",T._tab_=k),T.parentNode!==this._92O&&(cr(this._92O,T),Km())},_24o:function(){var U,S=this,H=S._8o,D=S._9o,v=S._tabModel.sm().ld();v&&(U=mp(v.getView())),U!==D&&(D&&(H.getView()&&H.getView().endEditing&&H.getView().endEditing(),S.hideTabView(H,D)),U&&S.showTabView(v,U)),S._8o=v,S._9o=U,H!==v&&S.onTabChanged(H,v)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function($,E){this.selectByIndex(--E)},selectByIndex:function(z){var l=this,f=l._tabModel,F=f.size();if(F&&!f.sm().ld()){z==O&&(z=0),z>=F&&(z=F-1),0>z&&(z=0);for(var I=z;I>=0;I--){var C=l.get(I);if(!C.isDisabled())return l.select(C),C}for(I=z+1;F>I;I++)if(C=l.get(I),!C.isDisabled())return l.select(C),C}},getTabWidth:function(e){var G=this.getTabHPadding(),y=4+2*G,Y=co(e.getIcon());Y&&(y+=Ne(Y,e)+4);var r=this.getLabel(e);return r&&(y+=Pi(this.getLabelFont(e),r).width+4),e.isClosable()&&(y+=10),y},drawTab:function($,A,P,V,Q,h,y){var l,_=this,U=_._tabPosition,p=this.getTabHPadding(),j=P+4+p,w=_._selectWidth,D=co(A.getIcon()),a=A.isDisabled(),f=_.getLabelColor(A),G=_.getLabelFont(A),F=_.getLabel(A),d=_._selectBackground,H=U===dj+"-vertical",S=U===xq+"-vertical";(H||S)&&(j=V+4+p),a&&($.globalAlpha=xd),hd($,P,V,Q,h,y),A===_._8o&&w&&(U===nh?hd($,P,V+h-w,Q,w,d):U===dj?hd($,P+Q-w,V,w,h,d):U===xq?hd($,P,V,w,h,d):H?hd($,P+Q-w,V,w,h,d):S?hd($,P,V,w,h,d):hd($,P,V,Q,w,d));var q=Q/2;if(H&&(cl($,q,V+h/2),gc($,t),cl($,-q,-V-h/2)),D){var Y=Jf(D,A),X=Ne(D,A);if(H||S){var T=P+Q/2,z=j+Y/2;cl($,T,z),gc($,M),cl($,-T,-z),Qe($,D,P+Q/2,j+Y/2,A,_),cl($,T,z),gc($,-M),cl($,-T,-z),j+=Y+4}else Qe($,D,j+X/2,V+h/2,A,_),j+=X+4}return H||S?(cl($,Q/2,j+Q/2),gc($,M),cl($,-Q/2,-j-Q/2),om($,F,G,f,P,j,h,Q),cl($,Q/2,j+Q/2),gc($,-M),cl($,-Q/2,-j-Q/2)):om($,F,G,f,j,V,Q,h),H&&(cl($,q,V+h/2),gc($,-t),cl($,-q,-V-h/2)),A.isClosable()&&(l=S?{x:P+Q-12,y:V+h-12,width:12,height:12}:{x:P+Q-12,y:V+2,width:12,height:12},this.drawCloseIcon(A,$,f,l)),a&&($.globalAlpha=1),l},drawCloseIcon:function(Y,k,F,G){var i=G.x,j=G.y;k.strokeStyle=F,k.lineWidth=1,k.beginPath(),k.moveTo(i+2,j+8),k.lineTo(i+8,j+2),k.moveTo(i+8,j+8),k.lineTo(i+2,j+2),k.stroke()},getTabAt:function(U){var O=this._interactor._8Q(U);return O?O.tab:null},validateImpl:function(){var o=this;o._24o();var p,s=o._canvas,R=o._tabPosition,t=o._91O,N=o._92O,_=o._tabModel,M=o.getWidth(),Y=o.getHeight(),a=o._tabHeight,V=o._7o,m=o._tabGap,F=R===nh,H=R===dj,l=R===xq,i=R===dj+"-vertical",$=R===xq+"-vertical",h=o._23o,W=0;if((H||l)&&_._roots.each(function(b){W=P(o.getTabWidth(b),W)}),F?(dg(t,0,0,M,a),p={x:0,y:a,width:M,height:P(0,Y-a)}):H?(dg(t,0,0,W,Y),p={x:W,y:0,width:P(0,M-W),height:Y}):l?(dg(t,M-W,0,W,Y),p={x:0,y:0,width:P(0,M-W),height:Y}):i?(dg(t,0,0,a,Y),p={x:a,y:0,width:P(0,M-a),height:Y}):$?(dg(t,M-a,0,a,Y),p={x:0,y:0,width:P(0,M-a),height:Y}):(dg(t,0,Y-a,M,a),p={x:0,y:0,width:M,height:P(0,Y-a)}),dg(N,p),i||$){o._9o&&(p.x=0,dg(o._8o.getView(),p)),Xr(s,a,Y);var r=Kn(s),T=0;if(Qh(r,0,o.ty(),1),r.clearRect(0,0,a,Y),V.clear(),_._roots.each(function(z){if(z.isVisible()){var X,x=o.getTabWidth(z);h&&h.tab===z||(X=o.drawTab(r,z,0,T,a,x,o._tabBackground)),V.add({_75o:X,tab:z,startY:T,endY:T+x,height:x}),T+=x+m}}),o._23Q=P(0,T-m),h){var K=h.position;o.drawTab(r,h.tab,0,h.startY,a,h.height,o._moveBackground),hd(r,0,K,a,1,o._insertColor)}if(r.restore(),o._selectionChanged){o._selectionChanged=!1;for(var J=o.ty(),d=0;d<V.size();d++){var E=V.get(d);if(E.tab===o._8o){if(E.endY+J<0){o.ty(-E.startY);break}if(E.startY+J>Y){o.ty(Y-E.endY);break}}}}o.ty(o.ty())}else if(H||l){o._9o&&(p.x=0,dg(o._8o.getView(),p)),Xr(s,W,Y);var r=Kn(s),T=0;if(Qh(r,0,o.ty(),1),r.clearRect(0,0,W,Y),V.clear(),_._roots.each(function(Q){if(Q.isVisible()){var P;h&&h.tab===Q||(P=o.drawTab(r,Q,0,T,W,a,o._tabBackground)),V.add({_75o:P,tab:Q,startY:T,endY:T+a,height:a}),T+=a+m}}),o._23Q=P(0,T-m),h){var K=h.position;o.drawTab(r,h.tab,0,h.startY,W,h.height,o._moveBackground),hd(r,0,K,W,1,o._insertColor)}if(r.restore(),o._selectionChanged){o._selectionChanged=!1;for(var J=o.ty(),d=0;d<V.size();d++){var E=V.get(d);if(E.tab===o._8o){if(E.endY+J<0){o.ty(-E.startY);break}if(E.startY+J>Y){o.ty(Y-E.endY);break}}}}o.ty(o.ty())}else{o._9o&&(p.y=0,dg(o._8o.getView(),p)),Xr(s,M,a);var r=Kn(s),k=0;if(Qh(r,o.tx(),0,1),r.clearRect(0,0,M,a),V.clear(),_._roots.each(function(p){if(p.isVisible()){var e,q=o.getTabWidth(p);h&&h.tab===p||(e=o.drawTab(r,p,k,0,q,a,o._tabBackground)),V.add({_75o:e,tab:p,startX:k,endX:k+q,width:q}),k+=q+m}}),o._64I=P(0,k-m),h){var K=h.position;o.drawTab(r,h.tab,h.startX,0,h.width,a,o._moveBackground),dq(r,o._insertColor,K,0,a)}if(r.restore(),o._selectionChanged){o._selectionChanged=!1;for(var U=o.tx(),d=0;d<V.size();d++){var E=V.get(d);if(E.tab===o._8o){if(E.endX+U<0){o.tx(-E.startX);break}if(E.startX+U>M){o.tx(M-E.endX);break}}}}o.tx(o.tx())}for(var I=[],n=N.children,d=0;d<n.length;d++){var B=n[d],y=B._tab_;y&&!_.contains(y)&&I.push(B)}I.forEach(function(m){N.removeChild(m)})}});var yg=function(z){this.tv=z,this.addListeners()};kk(yg,L,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(w){this.handleScroll(w,10*-w.detail)},handleScroll:function(y,A){zh(y);var S=this.tv,X=S._tabPosition;!S._40o()||X!==nh&&X!==$c||S.tx(this.tv.tx()+A),!S._41o()||X!==dj&&X!==xq&&X!==dj+"-vertical"&&X!==xq+"-vertical"||S.ty(this.tv.ty()+A)},_8Q:function(n){var I,b,N=this.tv,r=N._tabPosition,z=N._7o;if(r===nh||r===$c){var V=N.lp(n).x;for(I=0;I<z.size();I++)if(b=z.get(I),b.startX<=V&&V<=b.endX)return b}else if(r===dj||r===xq||r===dj+"-vertical"||r===xq+"-vertical"){var i=N.lp(n).y;for(I=0;I<z.size();I++)if(b=z.get(I),b.startY<=i&&i<=b.endY)return b}return O},isClickable:function(_){var b=this.tv,F=b._tabPosition,N=this._73o=this._8Q(_);return!b._40o()||F!==nh&&F!==$c?!b._41o()||F!==dj&&F!==xq&&F!==dj+"-vertical"&&F!==xq+"-vertical"?N&&(!N.tab.isDisabled()||b.isMovable()):!0:!0},handle_mousemove:function(h){var K=this;_q?K._74o=K._8Q(h):K.getView().style.cursor=K.isClickable(h)?bi:""},handle_mousedown:function(q){this.handle_mousemove(q),this.handle_touchstart(q)},handle_touchstart:function(o){var p=this,D=p.tv,N=D._tabPosition;zh(o),mg(o)&&p.isClickable(o)&&(N===nh||N===$c?(p.x=up(o).x,p.lp=D.lp(o),p.tx=D.tx()):(p.y=up(o).y,p.lp=D.lp(o),p.ty=D.ty()),Bi(p,o))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(n){var F,U=this,Q=U.tv,k=Q._tabPosition,g=U._73o;if(k===nh||k===$c){if(F=up(n).x-U.x,!U._25o&&!U.moving&&w(F)>2&&(Q._40o()&&!_e(n)?U._25o=1:g&&Q.isMovable()&&(U.moving=1)),U._25o)Q.tx(U.tx+F);else if(U.moving){var d=U.lp.x+F,C=Q._tabGap/2;Q._7o.each(function(Z){var M=Z.endX,c=d-Z.startX<M-d;d>=Z.startX&&M>=d&&Q._7Q({tab:g.tab,startX:g.startX+F,width:g.width,front:c,insertTab:Z.tab,position:c?P(0,Z.startX-C):u(Q._64I,M+C)})})}}else if(F=up(n).y-U.y,!U._25o&&!U.moving&&w(F)>2&&(Q._41o()&&!_e(n)?U._25o=1:g&&Q.isMovable()&&(U.moving=1)),U._25o)Q.ty(U.ty+F);else if(U.moving){var r=U.lp.y+F,C=Q._tabGap/2;Q._7o.each(function(k){var a=k.endY,t=r-k.startY<a-r;r>=k.startY&&a>=r&&Q._7Q({tab:g.tab,startY:g.startY+F,height:g.height,front:t,insertTab:k.tab,position:t?P(0,k.startY-C):u(Q._23Q,a+C)})})}},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(){var c=this,q=c.tv,L=q._tabPosition,r=q.getTabModel(),D=r._roots,Y=c._73o;if(c.moving){var i=q._23o;if(i&&i.insertTab!==i.tab){var n=i.tab,C=D.remove(n),U=D.indexOf(i.insertTab);U>=0&&(i.front||U++,U<=D.size()&&(D.add(n,U),r._38I(n,C,U)))}q._7Q(O),delete c.moving}else if(!c._25o&&Y){n=Y.tab;var s=c._74o;if(!s||s.tab===n)if(!n.isDisabled()&&Mg(Y._75o,c.lp)){var X=function(){var C=D.indexOf(n);r.remove(n),q.onTabClosed(n,C)};q.onTabClosing(n,X)&&X()}else n.isDisabled()||q._8o===n||r.sm().ss(n)}c._25o=c._73o=c._74o=L===nh||L===$c?c.x=c.lp=c.tx=O:c.y=c.lp=c.ty=O}}),Ao.PropertyView=function(w){var J=this;J._view=Cd(1,J),J._canvas=Uq(J._view),cr(J._view,J._79O=Tj()),J._rows=new zf,J._28o=new zf,J._26o={},J._26Q={};var Y=J._propertyModel=new Dr,g=J.ivm;Y.mm(g,J),Y.md(g,J),Y.mh(g,J),J.dm(w?w:new Dr),new Qd(J)},xp("PropertyView",L,{ms_ac:[Br,vd,Vk,tm,gj,"categorizable",Kb,bl,qo,Kj,Kf,_l,Fh,oc,"selectRowIndex",jl,"background",Pm,ni,$o,cm,Rn],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:yk,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Pq,_background:j.propertyViewBackground,_expandIcon:j.propertyViewExpandIcon,_collapseIcon:j.propertyViewCollapseIcon,_scrollBarColor:Td,_scrollBarSize:qs,_autoHideScrollBar:Hp,_selectBackground:j.propertyViewSelectBackground,_rowHeight:Fi,_rowLineVisible:j.propertyViewRowLineVisible,_rowLineColor:j.propertyViewRowLineColor,_10I:.5,_columnLineVisible:j.propertyViewColumnLineVisible,_columnLineColor:j.propertyViewColumnLineColor,_labelColor:j.propertyViewLabelColor,_labelSelectColor:j.propertyViewLabelSelectColor,_labelFont:j.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(x){0>x&&(x=0),x>1&&(x=1);var u=this,r=u._10I;u._10I=x,u.fp("columnPosition",r,x)},getPropertyName:function(Z){return Z.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(b,C,N){return N===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(S,C){return C===this._selectRowIndex?this._labelSelectColor:S.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(c){var E=this.getHeight()-this._59I;return E>c&&(c=E),c>0?0:i(c)},isExpanded:function(z){if(!z)return!0;var q=this._26o[z];return q?q.isExpanded:!(this._26Q[z]===!1)},toggle:function(f){var _=this;_.isExpanded(f)?_.collapse(f):_.expand(f)},expandAll:function(){this.validate();for(var n in this._26o)this.expand(n)},expand:function(c){if(c&&c!==Jj){var e=this,Q=e._26o[c];Q&&!Q.isExpanded&&(Q.isExpanded=!0,e.onExpanded(c),e.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var M in this._26o)this.collapse(M)},collapse:function(I){if(I&&I!==Jj){var O=this,G=O._26o[I];G&&G.isExpanded&&(G.isExpanded=!1,O.onCollapsed(I),O.ivm())}},onCollapsed:function(){},getCategoryName:function(z){if(!this.isCategorizable())return Jj;var g=z.getCategoryName();return g?g:Jj},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(c){var C=this,A=C._dataModel;A!==c&&(A&&(A.umd(C.handlePropertyChange,C),C._selectionModel||A.sm().ums(C.handleSelectionChange,C)),C._dataModel=c,c.md(C.handlePropertyChange,C),C._selectionModel?C._selectionModel._21I(c):c.sm().ms(C.handleSelectionChange,C),C.fp(Rp,A,c))},isVisible:function(T){return this._visibleFunc?this._visibleFunc(T):!0},onPropertyChanged:function(M){var b=this,j=M.property;Jb[j]?b.ivm():b.iv(),j===Ko&&b._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:jf},handlePropertyChange:function(B){this._27o===B.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var I=this;I._96I||(I.setSelectRowIndex(-1),I._96I=1,I.iv())},redraw:function(){this.iv()},validateModel:function(){var l=this,e=l._rows,q=l._28o,p={},_=new zf,h=l._27o;l.updateCurrentData(),h!==l._27o&&l.endEditing(),e.clear(),q.clear(),l.getRawProperties().each(function(C){if(l.isVisible(C)){_.add(C);var m=l.getCategoryName(C);p[m]||(q.add(m,m===Jj?0:n),p[m]={isExpanded:l.isExpanded(m),properties:new zf})}}),l._sortFunc&&_.sort(l._sortFunc);for(var r in l._26o)l._26Q[r]=l.isExpanded(r);l._26o=p,q.each(function(h){h!==Jj&&e.add(h);var O=p[h];O.isExpanded&&_.each(function(F){l.getCategoryName(F)===h&&(O.properties.add(F),e.add({property:F,data:l._27o}))},l)})},validateImpl:function(){var M=this;M._76o(),M._96I&&(M.validateModel(),delete M._96I);var y=M._canvas,F=M.getWidth(),p=M.getHeight(),z=-M.ty(),R=M._rowHeight,D=M._indent,n=F-D,o=M._rows,m=o.size(),K=M._9I=D+n*M._10I,r=M._59I=m*R;Xr(y,F,p),M._29I={x:0,y:z,width:F,height:p},M._31I=J(z/R),M._14I=$((z+p)/R),M._31I<0&&(M._31I=0),M._14I>m&&(M._14I=m);var g,u=Kn(y),x=M._background;Qh(u,0,-z,1),u.beginPath(),u.rect(0,z,F,p),u.clip(),u.clearRect(0,z,F,p),M._93db(u),x&&hd(u,0,0,D,r,x);for(var i=M._31I;i<M._14I;i++){var B=o.get(i),z=R*i;if(xh(B))x&&hd(u,D,z,n,R,x),g=co(M.isExpanded(B)?M._expandIcon:M._collapseIcon),g&&Dk(u,g,Wr,0,z,D,R),u.save(),u.beginPath(),u.rect(D,z,n,R),u.clip(),M.drawCategoryName(u,B,i,D,z,n,R),u.restore();else{var V=B.property,I=B.data,g=co(V.getIcon()),e=M._selectRowIndex===i?M.getSelectBackground():O;if(g&&Dk(u,g,Wr,0,z,D,R),e&&hd(u,D,z,n,R,e),u.save(),u.beginPath(),u.rect(D,z,K-D,R),u.clip(),M.drawPropertyName(u,V,i,D,z,K-D,R),u.restore(),!M.isEditing(I,V)){var c=K+1,w=F-K-1;u.save(),u.beginPath(),u.rect(c,z,w,R),u.clip(),M._87o(M.drawPropertyValue(u,V,M.getValue(I,V),i,c,z,w,R,I),i,c,z,w,R),u.restore()}}M._rowLineVisible&&hd(u,D,z+R-1,n,1,M._rowLineColor)}M._columnLineVisible&&(hd(u,K,0,1,r,M._columnLineColor),hd(u,F-1,0,1,r)),M._92db(u),M._93I(),u.restore(),M.ty(M.ty())},drawCategoryName:function(k,B,l,Z,Q,v,G){om(k,B,this.getCategoryFont(B),this.getCategoryColor(B),Z,Q,v,G)},drawPropertyName:function(L,n,P,f,p,t,d){return n.drawPropertyName?(n.drawPropertyName(L,n,P,f,p,t,d,this),void 0):(om(L,this.getPropertyName(n),this.getPropertyFont(n,P),this.getPropertyColor(n,P),f,p,t,d),void 0)},drawPropertyValue:function(F,Q,q,Y,i,N,r,t,x){return Q.drawPropertyValue?Q.drawPropertyValue(F,Q,q,Y,i,N,r,t,x,this):(Ve(F,q,Q,this.getLabelFont(Q,q,Y),this.getLabelColor(Q,q,Y),i,N,r,t,x,this),void 0)},isPropertyEditable:function(Z){return Z.isEditable()&&this.isEditable()},setProperties:function(u){this._propertyModel.clear(),this.addProperties(u)},addProperties:function(W){if(W){var S=this._propertyModel;W.forEach(function(e){if(!(e instanceof Pp)){var u=qi(e.className);e=cq(u?u:Pp,e)}S.add(e)})}},getRowIndexAt:function(j){var q=this,t=J(q.lp(j).y/q._rowHeight);return t>=0&&t<q._rows.size()?t:-1},getPropertyAt:function(Y){var t=this,Z=t.getRowIndexAt(Y);return Z>=0?t._rows.get(Z).property:O},getToolTip:function(D){var $=this,h=$.getPropertyAt(D),p=$._27o;return h&&p?h.getToolTip(p,$._9I<$.lp(D).x,$):O}});var Qd=function(X){this.pv=X,this.addListeners()};kk(Qd,L,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(f){this.getView().style.cursor=f},clear:function(){var T=this;T._62O=T.cp=T.ty=T.p=O,T.setCursor(ol)},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(k){var S=this,I=S.pv;zh(k),I.setFocus(k)&&(mg(k)?(S.cp=up(k),S.ty=I.ty(),S.p=I.getColumnPosition(),S.handle_touchmove(k)):I.setSelectRowIndex(I.getRowIndexAt(k)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(Q){var F=this;if(F.cp&&!F._62O){var B=F.pv,S=B.lp(Q),p=S.x,O=S.y,Z=B._indent,c=B.getRowIndexAt(Q),K=B._9I;if(c>=0){var A=B._rowHeight,u=A*c,N=B._rows.get(c),U=N.property;if(xh(N))co(B.isExpanded(N)?B._expandIcon:B._collapseIcon)&&p>=0&&Z>=p&&O>=u&&u+A>=O?B.toggle(N):vl(Q)&&B.toggle(N);else if(p>K&&B.isPropertyEditable(U,Q)){var H={x:K+1,y:u,width:B.getWidth()-K-1,height:A},w={x:H.x+B.tx(),y:H.y+B.ty(),width:H.width,height:H.height},E=0,R=B._29I;H.y<R.y?E=H.y-R.y:H.y+A>R.y+R.height&&(E=H.y+A-R.y-R.height),E&&(B.ty(B.ty()-E),w.y-=E),B.beginEditing({data:N.data,property:U,value:B.getValue(N.data,U),event:Q,rect:H,editorRect:w,view:B})}}B.setSelectRowIndex(c)}F.clear()},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(J){var x=this,E=x.pv,w=x.ty,M=x.cp,Q=up(J),X=x._62O;if("p"===X)E.setTranslateY(w+Q.y-M.y);else if("c"===X){var V=E.getWidth()-E._indent;if(V>16){var u=x.p-(M.x-Q.x)/V,P=16/V;P>u&&(u=P),u>1-P&&(u=1-P),E.setColumnPosition(u)}}else"s"===X&&E.setTranslateY(w+(M.y-Q.y)*E._59I/E._29I.height)},handle_mousemove:function(c){this.handle_touchmove(c)},handle_touchmove:function(e){if(!_q&&mg(e)){var n=this,h=n.pv,u=w(h.lp(e).x-h._9I)<=(Lr?8:3);n.cp?n._62O||(u?(n._62O="c",Bi(n,e)):w(up(e).y-n.cp.y)>=2&&(n._62O=n.isV(e)?"s":"p",Bi(n,e))):(u?n.setCursor(gp):n.setCursor(ol),n.isV(e)&&h._43o())}},isV:function(Y){var G=this.pv,F=G._29I;return G._41o()&&F.x+F.width-G.lp(Y).x<ah},handle_mousewheel:function(z){this.handleScroll(z,z.wheelDelta/40)},handle_DOMMouseScroll:function(A){2===A.axis&&this.handleScroll(A,-A.detail)},handleScroll:function(Z,p){var I=this.pv;zh(Z),I.endEditing(),I.translate(0,p*I.getRowHeight())},handle_keydown:function(j){var l=this.pv,r=l._rows.size(),T=l._selectRowIndex+(fb(j)?-1:1);(fb(j)||dc(j))&&(0>T&&(T=0),T>=r&&(T=r-1),l.setSelectRowIndex(T))}}),Ao.ListView=function(j){this._5o(j),new mc(this)},xp("ListView",L,{ms_ac:[Br,vd,Vk,Pm,Kb,ni,$o,bl,qo,_l,Fh,oc,kj,jl],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Pq,_rowHeight:Fi,_rowLineVisible:j.listViewRowLineVisible,_rowLineColor:j.listViewRowLineColor,_scrollBarColor:Td,_scrollBarSize:qs,_autoMakeVisible:of,_autoHideScrollBar:Hp,_selectBackground:j.listViewSelectBackground,_labelColor:j.listViewLabelColor,_labelSelectColor:j.listViewLabelSelectColor,_labelFont:j.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(s){var f=this,R=f._checkMode;f._checkMode=s,f.fp(bm,R,s)},drawRow:function(I,O,D,A,q,X,Z){var M=this,z=0,y=M._indent,W=M.getIconWidth(O);M.drawRowBackground(I,O,D,A,q,X,Z),M._checkMode&&(Qe(I,co(M.getCheckIcon(O)),z+y/2,q+Z/2,O,M),z+=y),M.drawIcon(I,O,z,q,W,Z),M.drawLabel(I,O,z+W,q,Z)}});var mc=function(Q){this.list=Q,this._lastSelectDataTime=Af(),this.addListeners()};kk(mc,L,{ms_listener:1,getView:function(){return this.list._view},clear:function(Z){var x=this,c=x.list;Z&&"d"===x._62O&&!x.dragCancel&&c.handleDragAndDrop(Z,"end"),c.draggingData&&(c.draggingData=null,c.redraw()),x.dragCancel=x._62O=x._isV=x._isH=x.cp=x.tx=x.ty=O},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(X){var P=this,B=P.list;if(zh(X),B.setFocus(X)){var M=B.getDataAt(X);P.cp=up(X),P.tx=B.tx(),P.ty=B.ty(),mg(X)?M&&B.handleDragAndDrop&&!P.isV(X)&&!P.isH(X)&&(B.draggingData=M,B.redraw(),B.handleDragAndDrop(X,"prepare")):(M&&P._33o(X,M),P.clear(X))}},handleWindowMouseUp:function(H){this.clear(H)},handleWindowTouchEnd:function(o){this.clear(o)},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(i){var N=this,j=N.list;if(!N._isV&&!N._isH&&N.cp&&!N._62O){var e=j.getDataAt(i);e?(j.isCheckMode()?N._34o(i,e):N._33o(i,e),vl(i)?j.onDataDoubleClicked(e,i):j.onDataClicked(e,i)):j.handleBackgroundClick(i)}N.clear(i)},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function($){var d=this,A=d.list,P=d._62O,V=d.tx,t=d.ty,c=d.cp,w=up($),R=A._29I;"p"===P?A.setTranslate(V+w.x-c.x,t+w.y-c.y):"v"===P?A.ty(t+(c.y-w.y)*A._59I/R.height):"h"===P?A.tx(V+(c.x-w.x)*A._91I/R.width):"d"===P&&(d.dragCancel||A.handleDragAndDrop($,"between"))},handle_mousemove:function(H){this.handle_touchmove(H)},handle_touchmove:function(Q){if(!_q&&mg(Q)){var t=this,A=t.list;if(t._isV=t.isV(Q),t._isH=t.isH(Q),t.cp){if(!t._62O){if(rs(up(Q),t.cp)<2)return;t._isV?t._62O="v":t._isH?t._62O="h":A.draggingData&&!this.dragCancel?(t._62O="d",A.handleDragAndDrop(Q,"begin")):t._62O="p",t._62O&&"d"!==t._62O&&A.draggingData&&(A.draggingData=null,A.redraw()),Bi(t,Q)}}else t._isV&&A._43o(),t._isH&&A._42o()}},isV:function(M){var I=this.list,D=I._29I;return I._41o()&&D.x+D.width-I.lp(M).x<ah},isH:function(S){var v=this.list,h=v._29I;return v._40o()&&h.y+h.height-v.lp(S).y<ah},handle_mousewheel:function(u){this.handleScroll(u,u.wheelDelta/40,u.wheelDelta!==u.wheelDeltaX)},handle_DOMMouseScroll:function(o){this.handleScroll(o,-o.detail,1)},handleScroll:function(K,B,_){var Z=this.list;zh(K),Z.endEditing&&Z.endEditing(),_&&Z._41o()?Z.translate(0,B*Z.getRowHeight()):Z._40o()&&Z.translate(10*B,0)},handle_keydown:function(L){if(!j.isInput(L.target)){var s,O=this.list,y=O.sm(),J=O._rows,$=J.size();if(hl(L))O.selectAll();else if(Zr(L))O.handleDelete&&O.handleDelete(L);else if(Le(L))"d"!==this._62O||this.dragCancel||(O.handleDragAndDrop(L,"cancel"),this.dragCancel=!0);else if(ym(L))O.isCheckMode()&&(s=O.getFocusData(),s&&O.checkData(s));else if(fb(L)||dc(L)){var Q=O.isCheckMode();if(s=Q?O.getFocusData():y.ld()){var t=O.getRowIndex(s);t>=0&&(fb(L)?0!==t&&(s=J.get(t-1),Q?O.setFocusData(s):y.ss(s)):t!==$-1&&(s=J.get(t+1),Q?O.setFocusData(s):y.ss(s)))}else $>0&&(s=J.get(0),Q?O.setFocusData(s):y.ss(s))}}},_34o:function(H,w){var L=this.list,x=L.lp(H).x;return x>=0&&x<=L._indent?(L.checkData(w),void 0):(L.setFocusData(w),void 0)},_33o:function(G,l){var T=this.list,O=T.sm(),p=O.ld();if(_e(G))T.isSelected(l)?O.rs(l):O.as(l);else if(Hc(G))if(p)for(var a=T.getRowIndex(p),R=T.getRowIndex(l);a!==R;)a+=R>a?1:-1,O.as(T._rows.get(a));else O.ss(l);else if(mg(G)){var D=Af();if(O.contains(l)){var L=D-this._lastSelectDataTime;T.handleDataDoubleSelect&&L>500&&1500>L&&T.handleDataDoubleSelect(G,l)}O.ss(l),this._lastSelectDataTime=D}else O.contains(l)||O.ss(l)}}),Ao.TreeView=function(q){var x=this;x._35o(),x._5o(q),new Jl(x)},xp("TreeView",L,{ms_ac:[Br,vd,Vk,"rootVisible",bm,"rootData",bl,qo,_l,Fh,oc,Kb,Pm,ni,$o,Kj,Kf,kj,jl,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:O,_indent:Pq,_rowHeight:Fi,_rowLineVisible:j.treeViewRowLineVisible,_rowLineColor:j.treeViewRowLineColor,_scrollBarColor:Td,_scrollBarSize:qs,_autoHideScrollBar:Hp,_expandIcon:j.treeViewExpandIcon,_collapseIcon:j.treeViewCollapseIcon,_autoMakeVisible:of,_selectBackground:j.treeViewSelectBackground,_labelColor:j.treeViewLabelColor,_labelSelectColor:j.treeViewLabelSelectColor,_labelFont:j.treeViewLabelFont,_doubleClickToToggle:j.treeViewDoubleClickToToggle,drawRow:function(y,W,x,n,d,Y,F){var e=this;e.drawRowBackground(y,W,x,n,d,Y,F),e.drawTree(y,W,x,0,d,Y,F)},isOnToggleIcon:function(Z){var h=this.getDataAt(Z);if(h){var b=this.getIndent(),p=this.lp(Z).x;if(co(this.getToggleIcon(h))){var G=b*this.getLevel(h);if(p>=G&&G+b>=p)return!0}}return!1}});var Jl=function(H){Ck(Jl,this,[H])};kk(Jl,mc,{toggle:function(s,k,T,d){var I=this.list,m=I.lp(s).x;if(co(I.getToggleIcon(k))){var h=T*d;if(m>=h&&h+T>=m)return I.toggle(k),!0}return I.isDoubleClickToToggle()&&vl(s)?(I.toggle(k),!0):!1},_34o:function(j,h){var x=this.list,f=x.lp(j).x,Y=x._levelMap[h._id],T=x._indent,R=T*(Y+1);return f>=R&&R+T>=f?(x.checkData(h),void 0):(this.toggle(j,h,T,Y)||x.setFocusData(h),void 0)},_33o:function(K,v){var Q=this,t=Q.list;if(!Q.toggle(K,v,t._indent,t.getLevel(v)))if(Hc(K)){var o=t.sm();if(o.size()>0){for(var e=t._rows,L=null,I=0,c=e.size();c>I;I++)if(t.isSelected(e.get(I))){L=I;break}for(var g=null,I=e.size()-1;I>=0;I--)if(t.isSelected(e.get(I))){g=I;break}var E,k,u=t.getRowIndex(v);for(L>u?(E=u-1,k=L):u>g?(E=g,k=u):(E=L,k=g);E!==k;)E++,o.as(t._rows.get(E))}else o.ss(v)}else Jl.superClass._33o.call(Q,K,v)},handle_keydown:function(d){if(Fk(d)||tc(d)){var f=this.list,s=f._rows,p=f.isCheckMode(),N=f.sm(),U=p?f.getFocusData():N.ld();U?U.hasChildren()&&(Fk(d)?f.collapse(U):f.expand(U)):s.size()>0&&(U=s.get(0),p?f.setFocusData(U):N.ss(U))}else Jl.superClass.handle_keydown.call(this,d)}});var Ar=Ao.TableView=function(o){this._98I(),this._5o(o),new Sb(this)};xp("TableView",L,{ms_ac:[Br,vd,Vk,"sortMode",tm,gj,Pm,ni,$o,cm,Rn,"sortColumn",bl,qo,_l,Fh,oc,kj,jl],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:nj,_editable:!0,_batchEditable:!1,_rowHeight:Fi,_rowLineVisible:j.tableViewRowLineVisible,_rowLineColor:j.tableViewRowLineColor,_columnLineVisible:j.tableViewColumnLineVisible,_columnLineColor:j.tableViewColumnLineColor,_scrollBarColor:Td,_scrollBarSize:qs,_autoHideScrollBar:Hp,_autoMakeVisible:of,_selectBackground:j.tableViewSelectBackground,_labelColor:j.tableViewLabelColor,_labelSelectColor:j.tableViewLabelSelectColor,_labelFont:j.tableViewLabelFont,getCheckColumn:function(){var Z=this;
if(!Z._31o){var R=Z._31o=new xi;R.setEditable(!0),R.setWidth(40),R.getValue=Z.getCheckColumValue,R.drawCell=Z.drawCheckColumnCell}return Z._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(d){var X=this,z=X._39o,v=X.getCheckColumn();d!==X.isCheckMode()&&(d?z.add(v,0):z.remove(v),X.fp(bm,!d,d))},getCheckColumValue:function(U,S,z){return z.isSelected(U)},drawCheckColumnCell:function(F,U,t,S,b,B,n,k,o){Qe(F,o.getCheckIcon(U),b+n/2,B+k/2,U,o)}});var Sb=function(z){Ck(Sb,this,[z])};kk(Sb,mc,{_34o:function(a,d){var T=this.list,n=T._31o;if(T.isCellEditable(d,n,a)){var M=T._3Q(n),F=T.lp(a).x;if(M&&F>=M.startX&&F<M.startX+n.getWidth())return T.checkData(d),void 0}T._37O(d,a),T.setFocusData(d)},_33o:function(m,u){this.list._37O(u,m),Sb.superClass._33o.apply(this,arguments)}});var Pl=Ao.TreeTableView=function(V){var W=this,A=W._4o=new xi;W._35o(),W._98I(),W._5o(V),A.setDisplayName("Name"),A.setEditable(!0),A.setWidth(180),A.drawCell=Zq,A.getValue=kf,W._39o.add(A),new wd(W)},Zq=function(K,Q,G,J,u,s,S,B,x){x.drawTree(K,Q,G,u,s,S,B)},kf=function(M,e,_){return _.getLabel(M)};xp("TreeTableView",L,{ms_ac:[Br,vd,Vk,"sortMode",tm,gj,Kb,bm,"rootData","rootVisible",bl,qo,"sortColumn",Kj,Kf,_l,Fh,oc,kj,$o,Pm,ni,cm,Rn,jl,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:nj,_checkMode:O,_editable:!0,_batchEditable:!1,_indent:Pq,_rowHeight:Fi,_rowLineVisible:j.treeTableViewRowLineVisible,_rowLineColor:j.treeTableViewRowLineColor,_columnLineVisible:j.treeTableViewColumnLineVisible,_columnLineColor:j.treeTableViewColumnLineColor,_expandIcon:j.treeTableViewExpandIcon,_collapseIcon:j.treeTableViewCollapseIcon,_scrollBarColor:Td,_scrollBarSize:qs,_autoHideScrollBar:Hp,_autoMakeVisible:of,_selectBackground:j.treeTableViewSelectBackground,_labelColor:j.treeTableViewLabelColor,_labelSelectColor:j.treeTableViewLabelSelectColor,_labelFont:j.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var wd=function(h){Ck(wd,this,[h])};kk(wd,mc,{_34o:function(e,o){var V=this.list,Q=V._4o,q=V._3Q(Q),I=V.lp(e).x;if(q){var w=V._indent,B=q.startX+w*V.getLevel(o);if(co(V.getToggleIcon(o))&&I>=B&&B+w>=I)return V.toggle(o),void 0;if(V.isCellEditable(o,Q)&&(B+=w,I>=B&&B+w>=I))return V.checkData(o),void 0}V._37O(o,e),V.setFocusData(o)},_33o:function(v,u){var x=this.list,R=x.lp(v).x;if(co(x.getToggleIcon(u))){var Q=x._3Q(x._4o);if(Q){var i=x._indent,z=Q.startX+i*x.getLevel(u);if(R>=z&&z+i>=R)return x.toggle(u),void 0}}x._37O(u,v),wd.superClass._33o.apply(this,arguments)}});var kg=Ao.TableHeader=function(i){var N=this,u=N._view=Cd(1,N),f=N._39o=i.getColumnModel(),O=N.iv;N.tv=N._tableView=i,N._60I=new zf,N._canvas=Uq(u),u.style.background=j.tableHeaderBackground||"",u.style.height=Bd+Qj,f.mm(O,N),f.md(O,N),f.mh(O,N),i.mp(function(z){oe[z.property]&&N.iv()},N),new gk(N),N.iv()};xp("TableHeader",L,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Br,Vk,Kb,"moveBackground","insertColor",cm,Rn,"resizable","movable"],_checkIcon:Sg,_movable:!0,_resizable:!0,_labelColor:j.tableHeaderLabelColor,_labelFont:j.tableHeaderLabelFont,_columnLineColor:j.tableHeaderColumnLineColor,_columnLineVisible:j.tableHeaderColumnLineVisible,_sortDescIcon:j.tableHeaderSortDescIcon,_sortAscIcon:j.tableHeaderSortAscIcon,_moveBackground:j.tableHeaderMoveBackground,_insertColor:j.tableHeaderInsertColor,_indent:Pq,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(K){return K.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(d){return d.getColor()||this._labelColor},getLabelAlign:function(E){return E._align},onPropertyChanged:function(){this.iv()},_5Q:function(U){this._61I=U,this.iv()},getLogicalPoint:function(O){return jn(O,this._canvas,this.tv.tx())},validateImpl:function(){var K=this,k=K._canvas,J=K.getWidth(),l=K.getHeight(),Z=K.tv,A=K._60I,c=K._61I,n=-Z.tx(),R=0;(J!==k.clientWidth||l!==k.clientHeight)&&Xr(k,J,l),A.clear(),K._39o._roots.each(function(v){if(v.isVisible()){var Y=R+v.getWidth();n+J>=R&&Y>=n&&A.add({column:v,startX:R}),R=Y}});var d=Kn(k);if(Qh(d,-n,0,1),d.beginPath(),d.rect(n,0,J,l),d.clip(),d.clearRect(n,0,J,l),A.each(function(E){var n=E.column,T=E.startX,P=n.getWidth();P>0&&(d.save(),d.beginPath(),d.rect(T,0,P,l),d.clip(),c&&c.column===n||K.drawColumn(d,n,T,0,P,l),K._columnLineVisible&&hd(d,T+P-1,0,1,l,K._columnLineColor),d.restore())}),c){var $=c.column,R=c.startX,E=c.position,h=$.getWidth();d.save(),d.beginPath(),d.rect(R,0,h,l),d.clip(),d.fillStyle=K._moveBackground,d.fill(),K.drawColumn(d,$,R,0,h,l),d.restore(),dq(d,K._insertColor,E,0,l)}d.restore()},_6Q:function(s){var h=this.tv;return h._31o===s&&h.sm().getSelectionMode()===ys},drawColumn:function(G,x,X,A,u,P){var b=this,S=b.tv,y=co(x.getIcon()),g=b.getLabelAlign(x);if(b._6Q(x)){var l=co(b._checkIcon);Qe(G,l,X+u/2,A+P/2,x,b)}else{var e=b.getLabel(x),D=b.getLabelFont(x),E=b.getLabelColor(x),U=Pi(D,e).width,Q=y?b._indent:0;g===dj?(y&&Dk(G,y,Wr,X,A,Q,P),om(G,e,D,E,X+Q,A,u,P,dj)):g===xq?(y&&Dk(G,y,Wr,X+u-U-Q,A,Q,P),om(G,e,D,E,X,A,u,P,xq)):(y&&Dk(G,y,Wr,X+(u-U-Q)/2,A,Q,P),om(G,e,D,E,X+(u-U+Q)/2,A,0,P,dj))}if(x.isSortable()&&S.getSortColumn()===x&&(y=co(x.getSortOrder()===Yk?b._sortAscIcon:b._sortDescIcon))){var n=Ne(y,x)/2+2;Qe(G,y,g===xq?X+n:X+u-n,A+P/2,x,S)}}});var gk=function(W){var U=this;U.th=W,U.tv=W._tableView,U.addListeners()};kk(gk,L,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(X){this.getView().style.cursor=X},handle_mousemove:function(j){if(!_q){var i=this;delete i._29o,i.setCursor(ol);for(var p=i.th,y=p._60I,B=p.lp(j).x,Y=y.size()-1;Y>=0;Y--){var n=y.get(Y),m=n.column,s=n.startX+m.getWidth();if(p.isResizable()&&w(s-B)<=(Lr?10:3))return i._29o=n,i.setCursor(gp),void 0;B>n.startX&&s>B&&(i._29o=n),(m.isClickable()||m.isSortable()||p.isMovable()||i.tv.getCheckColumn&&m===i.tv.getCheckColumn())&&B>n.startX&&s>B&&i.setCursor(bi)}}},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(y){var f=this;zh(y),f.tv.endEditing(),f.handle_mousemove(y),f._29o&&(f.x=up(y).x,f.lx=f.th.lp(y).x,f.w=f._29o.column.getWidth(),Bi(f,y))},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(Y){var J=this,C=J.th,v=J.getView().style.cursor,K=J._29o,T=up(Y).x-J.x;if(J.resizing||J.moving||(v===gp?J.resizing=1:C.isMovable()&&v===bi&&w(T)>2&&(J.moving=1)),J.resizing)K.column.setWidth(J.w+T);else if(J.moving){var j=J.lx+T;C._60I.each(function(s){var u=s.startX,Z=u+s.column.getWidth();if(j>=u&&Z>=j){var Q={column:K.column,startX:K.startX+T,front:Z-j>j-u,insertColumn:s.column};Q.position=Q.front?u:Z,C._5Q(Q)}})}},_16Q:function(y,l){var c=this,b=c.tv,$=c.th,x=$._checkIcon;if($._6Q(y)){var T=co(x),i=c.lx,D=y.getWidth(),m=Ne(T,y);if(i>=l+D/2-m&&l+D/2+m>=i){$.setCheckIcon(x===Ol?Sg:Ol);var F=b.sm(),s=b._rows;return x===Ol?F.rs(s):F.ss(s),b.onCheckColumnClicked(y),!0}}return!1},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(h){var E=this,J=E.tv,g=E.th,i=E._29o;if(E.moving){var N=g._61I;if(N&&N.insertColumn!==N.column){var R=N.column,Z=J.getColumnModel()._roots,c=Z.remove(R),$=Z.indexOf(N.insertColumn);$>=0&&(N.front||$++,$<=Z.size()&&(Z.add(R,$),J.getColumnModel()._38I(R,c,$)))}g._5Q(O),delete E.moving}else if(!E.resizing&&i){R=i.column;var _=g.lp(h).x,f=i.startX,Y=!0;if(g.onColumnClicked){var o=g.onColumnClicked(R,h,f);o===!1&&(Y=!1)}if(Y&&_>=f&&_<=f+R.getWidth()&&!E._16Q(R,f)){if(R.isSortable()){var b=J.getSortMode(),e=R.getSortOrder();b===nj?J.getSortColumn()===R?(e===js&&J.setSortColumn(O),R.setSortOrder(e===Yk?js:Yk)):J.setSortColumn(R):"bistate"===b&&(J.getSortColumn()===R?R.setSortOrder(e===Yk?js:Yk):J.setSortColumn(R))}J.onColumnClicked(R,h,f)}}E._29o=E.resizing=E.x=E.lx=E.w=O}}),Ao.TablePane=function(S){this.init(new Ar(S))},xp("TablePane",L,{ms_v:1,_44o:1}),Ao.TreeTablePane=function(B){this.init(new Pl(B))},xp("TreeTablePane",L,{ms_v:1,_44o:1}),Ao.Toolbar=function(W){var r=this,o=r._view=Cd(1,r),t=o.style;t.background=j.toolbarBackground||"",t.height=Xl+Qj,r._canvas=Uq(o),r._30o=new zf,r._90I=new zf,r.setItems(W||[]),o.handleGroupSelectedChanged=function(D){if(D.isSelected()){var Q=D.getGroupId();null!=Q&&r._items.forEach(function(C){var H=C.element;H&&H!==D&&H.setSelected&&H.getGroupId&&H.getGroupId()===Q&&H.setSelected(!1)})}},new Nl(r)},xp("Toolbar",L,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Em,Br,Vk,vd,jl,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:j.toolbarLabelColor,_labelSelectColor:j.toolbarLabelSelectColor,_labelFont:j.toolbarLabelFont,_selectBackground:j.toolbarSelectBackground,_itemGap:j.toolbarItemGap,_separatorColor:j.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(U){var I=this.getItemInfoAt(U);return I?I.item.toolTip:O},getLabelColor:function(Z){return Z&&Z.selected&&Z.type!==Ol&&Z.type!==Ug?this._labelSelectColor:this._labelColor},onPropertyChanged:function(r){this.iv(),r.property===Em&&this._items.forEach(function(V){Hb(V)})},redraw:function(){this.iv()},addItem:function(q,t){var P=this._items;t==O?P.push(q):P.splice(t,0,q),this.fp(Em,O,P)},removeItem:function(l){if(l)for(var w=this._items,f=0;f<w.length;f++)l===w[f]&&(w.splice(f,1),this.fp(Em,O,w))},removeItemById:function(W){if(W!=O)for(var P=this._items,f=0;f<P.length;f++)if(W===P[f].id){var p=P.splice(f,1)[0];return this.fp(Em,O,P),p}},getItemById:function(m){if(m!=O)for(var T=this._items,D=0;D<T.length;D++){var A=T[D];if(m===A.id)return A}},setItemVisible:function(H,A){var G=this.getItemById(H);G&&(G.visible=A)},getItemInfos:function(){return this._30o},getItemInfoAt:function(B){var n=this,o=0,N=n._30o,R=n.lp(B),K=R.x,w=R.y;if(w>=0&&w<=n.getHeight())for(;o<N.size();o++){var c=N.get(o);if(c.startX<=K&&K<=c.endX)return c}return O},drawItem:function(o,J,W,N,U){if(J.visible===!1)return 0;if(er(J.visible)&&!J.visible())return 0;var L=this,p=J.disabled;p&&(o.globalAlpha=xd);var s=L.drawItemImpl(o,J,W,N,U),P=L._itemGap;return p&&(o.globalAlpha=1),this._currentItem!==J||"separator"===J||J.separator===!0||J.unfocusable||Vi(o,L._separatorColor,W-P/2,0,s+P,N),s},drawItemImpl:function(b,I,P,w,f){var B=this,v=B._view,j=B._itemGap,k=w/2,V=I.type,n=I.element,M=I.label;xh(n)&&(M=n,n=O);var o,$=B.getLabelFont(I),Y=B.getLabelColor(I),F=I.selected,H=co(I.icon),R=Ne(H,I),Q=0,q=R+(M?Pi($,M).width:0);if("separator"===I||I.separator===!0)return dq(b,B._separatorColor,P,w/4,k),1;if(n){H&&Qe(b,H,P+R/2,k,I,B),om(b,M,$,Y,P+R,0,0,w);var L=mp(n);f||B._90I.add(L),L.parentNode!==v&&cr(v,L),n.iv&&n.iv(),n.validate&&n.validate();var p=L.getBoundingClientRect(),A=p.width,S=L.style;return Fc(L),S.left=B.tx()+P+q+Qj,S.top=(w-p.height)/2+Qj,q+A}return V===Ug?o=co(F?In:qn):V===Ol&&(o=co(F?Ol:Sg)),o?(Q=Ne(o,I),Qe(b,o,P+Q/2,k,I,B),P+=Q,q+=Q):F&&hd(b,P-j/2,0,q+j,w,B.getSelectBackground(I)),H&&Qe(b,H,P+R/2,k,I,B),om(b,M,$,Y,P+R,0,0,w),q},validateImpl:function(){var y=this,u=y._canvas,x=y.getWidth(),l=y.getHeight(),A=y._30o,E=y._items;Xr(u,x,l);var m=Kn(u),z=y._itemGap,B=z/2;Qh(m,y.tx(),0,1),m.clearRect(0,0,x,l);var w=y._90I;y._90I=new zf,A.clear(),E.forEach(function(N){var j=y.drawItem(m,N,B,l);A.add({item:N,startX:B,endX:B+j,width:j}),j&&(B+=j+z)}),w.each(function(t){y._90I.contains(t)||go(t)});var G=y._64I;y._64I=P(0,B),m.restore(),y._stickToRight?(y._65O=0,m=Kn(u),B=x-y._64I+z,Qh(m,0,0,1),m.clearRect(0,0,x,l),A.clear(),E.forEach(function(j){var G=y.drawItem(m,j,B,l,!0);A.add({item:j,startX:B,endX:B+G,width:G}),G&&(B+=G+z)}),m.restore()):y.tx(y.tx()),G!==y._64I&&y.onSumWidthChanged(G,y._64I)},onSumWidthChanged:function(){},handleClick:function(Q,e){var k=this,z=Q.type,q=Q.action,i=Q.groupId,K=Q.selected;Q.disabled||(i!=O?K||(Q.selected=!0,this._items.forEach(function(N){N.groupId===i&&Q!==N&&(N.selected=!1)}),q&&Q.action(Q,k,e)):z===Ol||"toggle"===z?(Q.selected=!K,q&&Q.action(Q,k,e)):q&&Q.action(Q,k,e)),Km(),k.iv()}});var Nl=function(P){this.tb=P,this.addListeners()};kk(Nl,L,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(e){this.handleScroll(e,10*(e.wheelDelta/40))},handle_DOMMouseScroll:function(j){this.handleScroll(j,10*-j.detail)},handleScroll:function(D,d){zh(D);var a=this.tb;a.isScrollable()&&!a._stickToRight&&(a.tx(a.tx()+d),Qm())},handle_mousemove:function(U){var c=this;_q||c.setItem(U)},handle_mouseout:function(i){var v=this;i.target===v.getView()?v.tb.setCurrentItem(O):v.handle_mousemove(i)},handle_mousedown:function(P){this.handle_mousemove(P),this.handle_touchstart(P)},handle_touchstart:function(S){var l=this,t=l.tb,E=S.target;mg(S)&&(E===l.getView()||E===t._canvas)&&(zh(S),t.setFocus(S)&&(this.setItem(S,!0),(t.isScrollable()||l.info&&!l.info.item.disabled)&&(l.x=up(S).x,l.tx=t.tx(),Bi(l,S))))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(r){var k=this,h=k.tb;if(!h._stickToRight){var R=up(r).x-k.x;!k._25o&&w(R)>2&&h.isScrollable()&&(k._25o=1),k._25o&&h.tx(k.tx+R)}},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(g){var $=this,Q=$.tb,V=$.info,X=$.tb.getItemInfoAt(g);if(!$._25o&&V){var b=V.item;X&&X.item===b&&Q.handleClick(b,g)}$._25o=$.x=$.tx=O,$.setItem()},setItem:function(G,y){var m=this,M=m.tb,Z=m.info=G?M.getItemInfoAt(G):O,z=Z?Z.item:O;M.setCurrentItem(z),y&&z&&er(z.onDown)&&z.onDown(G)}}),Ao.BorderPane=function(){this._view=Cd(1,this),this.iv()},xp("BorderPane",L,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(r,T){this._12o("leftView",r),T!=O&&this.setLeftWidth(T)},getRightView:function(){return this._rightView},setRightView:function(b,e){this._12o("rightView",b),e!=O&&this.setRightWidth(e)},getTopView:function(){return this._topView},setTopView:function(L,j){this._12o("topView",L),j!=O&&this.setTopHeight(j)},getBottomView:function(){return this._bottomView},setBottomView:function(F,h){this._12o("bottomView",F),h!=O&&this.setBottomHeight(h)},getCenterView:function(){return this._centerView},setCenterView:function(R){this._12o("centerView",R)},_12o:function(l,P){var E=this,k="_"+l,I=E._view,Q=E[k];Q!==P&&(Q&&(Q.getView?go(Q.getView()):go(Q)),E[k]=P,P&&(P.getView?cr(I,P.getView(),1):cr(I,P,1)),E.fp(l,Q,P))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var u=this,g=u._topView,K=u._bottomView,e=u._leftView,X=u._rightView,H=u._centerView,B=u.getWidth(),p=u.getHeight(),n=0,Z=0,M=B,m=p,j=0,E=0,G=0,A=0;g&&(j=u._topHeight==O?Tn(g):u._topHeight,Z=j),K&&(E=u._bottomHeight==O?Tn(K):u._bottomHeight,m=p-E),e&&(G=u._leftWidth==O?Kh(e):u._leftWidth,n=G),X&&(A=u._rightWidth==O?Kh(X):u._rightWidth,M=B-A);var _=P(0,M-n),x=P(0,m-Z);g&&dg(g,0,0,B,j),K&&dg(K,0,m,B,E),e&&dg(e,0,Z,G,x),X&&dg(X,M,Z,A,x),H&&dg(H,n,Z,_,x)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);