!function(H){"use strict";var a="ht",h=H[a],O=function(){return document},d=function(){return O().body},D=function(v,h,C){v.style.setProperty(h,C,null)},s=function(n){return O().createElement(n)},X=function(){return s("div")},Q=function(){var w=s("canvas");return w},J=function(x,U){D(x,"-webkit-transform",U),D(x,"-ms-transform",U),D(x,"transform",U)},k=function(F,m){D(F,"-webkit-transform-origin",m),D(F,"-ms-transform-origin",m),D(F,"transform-origin",m)},w=function(E,C){E.appendChild(C)},m=function(z,f){z.removeChild(f)},n=H.parseInt,Y=h.Default,_=Y.getInternal(),F=_.addEventListener,K=(_.removeEventListener,Math.PI),G="white-space",j="visibility",e="left",f="top",B="width",L="height",S="position",x="display",V="z-index",R="px",p="0 0",g="absolute",z="visible",$="hidden",r="none",Z="block",o="nowrap",I="rgba(0, 0, 0, 0.005)";Y.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var i=h.graph.GraphView.prototype,t=i._42;i.adjustHtmlNodeIndex=!0,i._42=function(E,N){if(t.call(this,E,N),this.adjustHtmlNodeIndex)for(var f=this.getDataModel()._datas._as,P=f.length,p=1,M=0;P>M;M++){var X=f[M];if(X instanceof q){var Q=this.getDataUI(X);D(Q.$2f,V,p+""),D(Q.$3f,V,p+1+""),p+=2}}};var b=h.HtmlNodeUI=function(c,N){var M=this;b.superClass.constructor.call(M,c,N);var u=M.$2f=X(),t=M.$3f=Q();D(u,S,g),D(u,j,$),D(u,G,o),t.draggable=!1,D(t,S,g),D(t,x,r),k(t,p),F(u,"change",function(C){var W=C.target,x=W.bind||W.getAttribute("bind"),S=W.type&&"checkbox"===W.type?W.checked:W.value,F=N.getContext();x&&F&&(F[x]=S,M.$4f=JSON.stringify(F))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(U){F(u,U,this.$9f.bind(this))},M)};Y.def(b,_.ui().NodeUI,{_visible:!0,$11f:function(){var N=this,r=N.$3f,G=N._data,E=G.getDraggerImageWidth(),S=G.getDraggerImageHeight(),t=G.getDraggerImage(),h=_.initContext(r);h.beginPath(),_.setCanvas(r,E,S),_.translateAndScale(h,0,0,1),h.clearRect(0,0,E,S),Y.drawImage(h,Y.getImage(t),0,0,E,S),h.restore()},_80o:function(h){b.superClass._80o.call(this,h);var N=this,y=N._data,v=y._padding,Q=2*v,o=N.$2f,a=N.$3f,i=N.gv,C=i.getZoom(),M=i.getTranslateX(),G=i.getTranslateY(),Y=i.getView(),m=N._83o,O=y._width,k=y._height,P=m.position,t=m.rotation,p=(O-Q)/y.$5f*C,s=(k-Q)/y.$6f*C,F=N._html,W=y._html,A=y.getHtmlType();if("html"===A){var E=y.getContext()||{},d=N.$4f,T=y.$10f,U=JSON.stringify(E);F&&d&&F===W&&d===U||(N.$4f=U,N._html=W,o.innerHTML=T?T(E):W)}else if(null!=A){var u=y.getHtml();"ht"===A&&(u=u.getView()),F&&F===u&&o.contains(F)||(N._html=u,o.innerHTML="",w(o,u))}if(!o.parentNode){var H=i.$1f;if(!H){var q=X();D(q,S,g),D(q,V,"0"),H=i.$1f=q;var l=i._canvas.nextSibling;l?Y.insertBefore(q,l):w(Y,q)}w(H,o),w(H,a),y.onContentInitialized&&y.onContentInitialized(o)}if(y._scalable){var c=y.$5f,_=y.$6f;J(o,"rotate("+180*(t/K)+"deg) scale("+p+","+s+")"),D(o,B,""),D(o,L,""),D(o,e,(P.x-c/C/2)*C+M+R),D(o,f,(P.y-_/C/2)*C+G+R)}else{var Zo=n(o.style.width),To=n(o.style.height),ab=n((O-Q)*C),qf=n((k-Q)*C),bd="100%",he=o.children[0];D(he,B,bd),D(he,L,bd),(Zo!==ab||To!==qf)&&(D(o,B,ab+R),D(o,L,qf+R),"ht"===A&&W.invalidate()),J(o,"rotate("+180*(t/K)+"deg)"),D(o,e,(P.x-ab/C/2)*C+M+R),D(o,f,(P.y-qf/C/2)*C+G+R)}var eq=N.dragRect;i.isMovable(y)&&i.isSelected(y)&&eq?(h.save(),h.fillStyle=I,h.fillRect(eq.x,eq.y,eq.width,eq.height),h.restore(),D(a,e,eq.x*C+M+R),D(a,f,eq.y*C+G+R),J(a,"scale("+C+","+C+")"),D(a,x,Z),N.$11f()):D(a,x,r),D(o,j,this._visible?z:$)},dispose:function(){var P=this.gv.$1f;this.$2f.parentNode===P&&P.removeChild(this.$2f),this.$3f.parentNode===P&&P.removeChild(this.$3f)},_84o:function(g){this._visible=g,D(this.$2f,j,g?z:$),D(this.$3f,x,g?Z:r)},_3O:function(){var g=this,J=g.gv,S=g._data;b.superClass._3O.call(g);var N=S.getRect();J.isEditable(S)&&(g.dragRect={x:N.x+N.width+S._padding,y:N.y+10,width:S.getDraggerImageWidth(),height:S.getDraggerImageHeight()},g._68o(g.dragRect))},rectIntersects:function(X){var b=this._79o();return h.Default.intersection(b,X)?!0:void 0},$9f:function(k){var I=this.gv,Z=this._data;I.sm().contains(Z)&&k.stopPropagation()}});var q=h.HtmlNode=function(){q.superClass.constructor.call(this)};h.Default.def(q,h.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:h.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(g){var o=this,t=o._html;o._html=g,"html"===o.getHtmlType()&&"Handlebars"in H&&(o.$10f=Handlebars.compile(g)),o.$13f(),o.fp("html",t,g)},setContext:function(U){var s=this,A=s._context;s._context=U,s.fp("context",A,U),s.$13f()},setScalable:function(P){var Z=this,n=Z._scalable;Z._scalable=P,Z.fp("scalable",n,P),Z.$13f()},getHtmlType:function(){var h=this._html;return h?"string"==typeof h?"html":h.getView?"ht":"dom":null},$13f:function(){var l=this,i=l._html,k=l.$10f;if(i){var J=X(),a=!1,E=l.getHtmlType();if(D(J,S,g),D(J,G,o),D(J,j,$),"html"===E?(J.innerHTML=k?k(l.getContext()||{}):i,a=!0):"ht"===E?(w(J,i.getView()),a=!0):"dom"===E&&(w(J,i),a=!0),a){var q=2*l._padding;w(d(),J),l.$5f=J.scrollWidth,l.$6f=J.scrollHeight,l._width=l.$5f+q,l._height=l.$6f+q,l._originWidth=l._width,l._originHeight=l._height,m(d(),J)}}},getUIClass:function(){return h.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);