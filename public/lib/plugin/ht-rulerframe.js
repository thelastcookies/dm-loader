!function(i,n){"use strict";var K="position",N="absolute",H="relative",S="px",F="left",T="right",f="top",R="bottom",V="display",$="none",B="block",E=ht.Default,G=E.getInternal(),e=Math.floor,P=Math.ceil,o=Math.PI,W=null,M=i.parseInt,j=function(V){return V.getContext("2d")},A=function(){return document},q=function(y){return A().createElement(y)},m=function(){return q("canvas")},r=function(w,$,z){w.style.setProperty($,z,W)},l=function(A,Q,n){E.def(ht.widget[A],Q,n)},h=function(g,J){g.appendChild(J)},p=function(_,F){_.removeChild(F)},G=E.getInternal(),L=G.addEventListener,x=G.removeEventListener;ht.widget.RulerFrame=function(p){var R=this,V=R._view=G.createView(null,R),I=R.$1k=m(),u=R.$2k=m(),L=R.$3k=m(),P=R.$4k=m();R._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},R._topRulerConfig={visible:!0},R._rightRulerConfig={visible:!1},R._bottomRulerConfig={visible:!1},R._leftRulerConfig={visible:!0},h(V,I),h(V,L),h(V,u),h(V,P),r(V,K,H),r(V,"box-sizing","border-box"),r(V,"-moz-box-sizing","border-box"),r(I,K,N),r(u,K,N),r(L,K,N),r(P,K,N),R.$14k=function(){R.$13k=1,R.iv()},R.$15k=function(w){if(R._topRulerConfig.guideVisible||R._rightRulerConfig.guideVisible||R._bottomRulerConfig.guideVisible||R._leftRulerConfig.guideVisible||R._defaultRulerConfig.guideVisible||(R._topRulerConfig.guideTipVisible||R._rightRulerConfig.guideTipVisible||R._bottomRulerConfig.guideTipVisible||R._leftRulerConfig.guideTipVisible||R._defaultRulerConfig.guideTipVisible)&&R._component){var j=V.getBoundingClientRect();R.$16k={x:w.clientX-j.left,y:w.clientY-j.top},R.$5k()}},R.setComponent(p)},l("RulerFrame",n,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(O){var z=this,S=z._component,k=z.getView();if(k){if(z._component=O,z.fp("component",S,O),S){var y=z.getComponentView(S);p(k,y),x(k,"mousemove",z.$15k),z.removeComponentPropertyChangeListener(S,z.$14k)}if(O){var A=z.getComponentView(O);h(k,A),r(A,K,N),L(k,"mousemove",z.$15k),z.addComponentPropertyChangeListener(O,z.$14k)}}},addComponentPropertyChangeListener:function(C,P){C&&C.mp&&C.mp(P)},removeComponentPropertyChangeListener:function(E,V){E&&E.ump&&E.ump(V)},getComponentHZoom:function(Z){return Z&&Z.getZoom?Z.getZoom():1},getComponentVZoom:function(s){return s&&s.getZoom?s.getZoom():1},getComponentViewRect:function(R){return R&&R.getViewRect?R.getViewRect():void 0},getComponentView:function(W){return W&&W.getView?W.getView():W},invalidateComponent:function(h){h&&h.iv&&h.iv()},validateComponent:function(n){n&&n.validate&&n.validate()},$7k:function(X,n,N,P,_,Z,c,p,i,e,F,b){if(n.visible){var z=this._defaultRulerConfig,J="borderStyle",m="borderColor",x="borderWidth",M="background",K=n[J]||z[J],w=n[m]||z[m],o=n[x]||z[x],Y=n.size!=W?n.size:z.size,A=n[M]||z[M],y=Y+o,Q=this.$6k(o,K,w,X,N,_,y,c,p,i,e,F,b);r(X,_,"0px"),Z?G.setCanvas(X,P-Q,Y):G.setCanvas(X,Y,P-Q),r(X,"background",A),r(X,V,B)}else r(X,V,$),r(this.getComponentView(this._component),_,"0px")},$6k:function(_,e,T,C,f,i,Z,P,n,$,A,b,v){var y=0;return r(C,f,_+"px "+e+" "+T),r(this.getComponentView(this._component),i,Z+S),P?(r(C,n,$+S),y+=$):r(C,n,"0px"),A?(r(C,b,v+S),y+=v):r(C,b,"0px"),y},validateImpl:function(){var Y=this,I=Y._component,A=Y.$1k,l=Y.$2k,i=Y.$3k,E=Y.$4k,K=Y._view,N=Y._defaultRulerConfig,X=Y._topRulerConfig,e=Y._rightRulerConfig,s=Y._bottomRulerConfig,V=Y._leftRulerConfig,P=N.size;if(K&&I){var G=X.size!=W?X.size:P,v=e.size!=W?e.size:P,$=s.size!=W?s.size:P,t=V.size!=W?V.size:P;Y.$7k(A,X,"border-bottom",K.offsetWidth,f,!0,V.visible,F,t,e.visible,T,v),Y.$7k(l,e,"border-left",K.offsetHeight,T,!1,X.visible,f,G,s.visible,R,$),Y.$7k(i,s,"border-top",K.offsetWidth,R,!0,V.visible,F,t,e.visible,T,v),Y.$7k(E,V,"border-right",K.offsetHeight,F,!1,X.visible,f,G,s.visible,R,$),Y.$13k?delete Y.$13k:Y.invalidateComponent(I),Y.validateComponent(I),Y.$5k()}},$5k:function(){function s(t,V,G,s,F,Y){if(V.visible){var q=j(t),f=V[I]||X,r=V[J]!=W?V[J]:x,$=V[O]||M,L=V[c]||P,E=V.size!=W?V.size:h,Hp=V[m]||C,Oe=V[v]||n,Qc=V[D]||i,mf=V[d]!=W?V[d]:H,un=V[w]!=W?V[w]:b,ok=V[B]!=W?V[B]:k,id=V[u]!=W?V[u]:Q,Kf=V[K]!=W?V[K]:S,Zo=V[z]!=W?V[z]:U,$d=V[_]||jq,_h=V[a]||Ck;r&&(f=l[Y]=l.$8k(l[Y]||f,V[Z]||g,V[e]||y,s?N:A,Oe)),G.call(l,q,T,R,p,o,E,s?N:A,f,$,L,F,Hp,Qc);var ho=l.$16k;(mf||un)&&ho&&(s?l.$9k(q,ho.x,E,$d,_h,mf,un,ok,id,Kf,Zo):l.$10k(q,ho.y,E,$d,_h,mf,un,ok,id,Kf,Zo,F))}}var l=this,E=l.$1k,f=l.$2k,q=l.$3k,L=l.$4k,t=l._topRulerConfig,$=l._rightRulerConfig,F=l._bottomRulerConfig,V=l._leftRulerConfig,Y=l._defaultRulerConfig,G=l._component,r=l.getComponentViewRect(G),N=l.getComponentHZoom(G),A=l.getComponentVZoom(G),T=r.x*N,p=T+r.width*N,R=r.y*A,o=R+r.height*A,h=l._defaultRulerConfig.size,I="defaultMajorTickSpacing",Z="maxPhysicalMajorTickSpacing",e="minPhysicalMajorTickSpacing",J="tickSpacingAdaptable",O="majorTickTextFont",c="majorTickTextColor",m="majorTickColor",D="minorTickColor",d="guideVisible",w="guideTipVisible",B="guideTipBorderColor",u="guideTipTextColor",K="guideTipTextFont",z="guideTipBackground",_="guideColor",a="guideWidth",v="minMajorTickSpacing",X=Y[I],g=Y[Z],y=Y[e],x=Y[J],M=Y[O],P=Y[c],C=Y[m],n=Y[v],i=Y[D],H=Y[d],b=Y[w],k=Y[B],Q=Y[u],S=Y[K],U=Y[z],jq=Y[_],Ck=Y[a];l._view&&G&&(s(E,t,l.$11k,!0,!1,"_currentTopMajorTickSpacing"),s(f,$,l.$12k,!1,!0,"_currentRightMajorTickSpacing"),s(q,F,l.$11k,!0,!0,"_currentBottomMajorTickSpacing"),s(L,V,l.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(s,T,K,V,r){return K>s*V?s=e(T/V/r)*r:s*V>T&&(s=P(K/V/r)*r),s},getHTipText:function(e){var A=this,B=A._component,j=0,Z=A._view.getBoundingClientRect();return B.lp?j=M(B.lp({x:e.x+Z.left,y:e.y}).x):j-=M(this.getComponentView(B).style.left)||0,j},$9k:function($,_,p,j,z,x,v,d,k,w,r){var F=this,T=F._component;$.save(),G.translateAndScale($,0,0,1);var U=_-(M(this.getComponentView(T).style.left)||0),B=0;if(_=F.getHTipText(F.$16k),x&&($.beginPath(),$.fillStyle=j,$.rect(U,B,z,p),$.fill()),v){$.beginPath(),$.textAlign="center",$.textBaseline="middle",$.font=w;var J=$.measureText(_).width+6;$.fillStyle=r,$.rect(U-J/2,B,J,p),$.fill(),$.strokeStyle=d,$.stroke(),$.beginPath(),$.fillStyle=k,$.fillText(_,U,B+p/2)}$.restore()},getVTipText:function(B){var R=this,W=R._component,K=0,d=R._view.getBoundingClientRect();return W.lp?K=M(W.lp({x:B.x,y:B.y+d.top}).y):K-=M(this.getComponentView(W).style.top)||0,K},formatScaleText:function(S){return Math.round(S)},$10k:function(P,U,A,a,N,S,u,s,i,K,T,d){var p=this,W=p._component;P.save(),G.translateAndScale(P,0,0,1);var F=A/2,C=U-(M(this.getComponentView(W).style.top)||0);if(U=p.getVTipText(p.$16k),S&&(P.beginPath(),P.fillStyle=a,P.rect(F-A/2,C,A,N),P.fill()),u){P.translate(F,C),P.rotate((d?90:-90)*o/180),P.translate(-F,-C),P.beginPath(),P.textAlign="center",P.textBaseline="middle",P.font=K;var h=P.measureText(U).width+6;P.fillStyle=T,P.rect(F-h/2,C-A/2,h,A),P.fill(),P.strokeStyle=s,P.stroke(),P.fillStyle=i,P.fillText(U,F,C)}P.restore()},$11k:function(i,F,A,C,J,b,H,T,Y,n,O,X,U){i.save(),A=0;var o=F,x=C,L=(o+x)/2;F=0,C=x-o,G.translateAndScale(i,0,0,1);var g=0,W=0,r=M(b/2),_=b-r,a=O?0:r,N=T*H,j=N/10;F-=N,C+=N,i.clearRect(F,0,C-F,b),i.beginPath(),i.fillStyle=U;var E=e(L/j)*j-o;for(g=E;C>g;g+=j)i.rect(g,A+a,1,_);for(g=E;g>F;g-=j)i.rect(g,A+a,1,_);for(i.fill(),a=O?0:1,i.beginPath(),i.fillStyle=X,E=e(L/N)*N-o,g=E;C>g;g+=N)i.rect(g,A+a,1,b-1);for(g=E;g>F;g-=N)i.rect(g,A+a,1,b-1);i.fill();var P=M(/\d+px/.exec(Y)[0]),u=(P||10)/2;i.textBaseline="middle",a=O?b-u-2:u+2,i.beginPath(),i.fillStyle=n,i.font=Y;var y=e(L/N)*N/H;for(g=E,W=y;C>g;g+=N,W+=T){var f=this.getHScaleText?this.getHScaleText(g):W;i.fillText(this.formatScaleText(f),g+2,A+a)}for(g=E,W=y;g>F;g-=N,W-=T){var f=this.getHScaleText?this.getHScaleText(g):W;i.fillText(this.formatScaleText(f),g+2,A+a)}i.restore()},$12k:function(N,Z,Y,V,i,H,g,K,n,U,p,a,c){function r(K,W,U,f,H,D){H=z.getVScaleText?z.getVScaleText(U):H,H=z.formatScaleText(H),N.translate(K+W,U),N.rotate(-f),N.translate(-K-W,-U),N.fillText(H,K+W+(D?2:1),U),N.translate(K+W,U),N.rotate(f),N.translate(-K-W,-U)}N.save(),Z=0;var B=Y,f=i,R=(B+f)/2;Y=0,i=f-B,G.translateAndScale(N,0,0,1);var q=0,z=this,j=0,h=M(H/2),m=H-h,F=p?0:h,k=K*g,O=k/10;Y-=k,i+=k,N.clearRect(Z,0,H,i-Y),N.beginPath(),N.fillStyle=c;var W=e(R/O)*O-B;for(q=W;i>q;q+=O)N.rect(Z+F,q,m,1);for(q=W;q>Y;q-=O)N.rect(Z+F,q,m,1);for(N.fill(),F=p?0:1,N.beginPath(),N.fillStyle=a,W=e(R/k)*k-B,q=W;i>q;q+=k)N.rect(Z+F,q,H-1,1);for(q=W;q>Y;q-=k)N.rect(Z+F,q,H-1,1);N.fill();var T=M(/\d+px/.exec(n)[0]),Q=(T||10)/2,v=90*o/180;N.textBaseline="middle",F=p?H-Q:Q+2,v=p?-v:v,N.beginPath(),N.fillStyle=U,N.font=n;var _=e(R/k)*k/g;for(q=W,j=_;i>q;q+=k,j+=K)r(Z,F,q,v,j,p);for(q=W,j=_;q>Y;q-=k,j-=K)r(Z,F,q,v,j,p);N.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var L=this,g=L._component,Q=L._view;g&&L.removeComponentPropertyChangeListener(g,L.$14k),Q&&(x(Q,"mousemove",L.$15k),p(Q.parentNode,Q),L._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);