!function(x,J,j){"use strict";var F="ht",o=x[F],G=o.Default,Z=o.graph,M=G.getInternal(),h=M.ui(),P=h.NodeUI.prototype,u=h.ShapeUI.prototype,S=Z.GraphView,a=S.prototype,C=h.EdgeUI.prototype,e=o.Node,f=o.Shape,p=o.Edge,n=o.Group,B=G.isTouchable,V=G.isTouchEvent,W=G.preventDefault,T=x.setTimeout,m=G.grow,d=G.isDragging,y=G.getDistance,Q=null,K=o.List,g="undefined"!=typeof Float32Array?Float32Array:Array,X=Math,c=X.PI,O="Crossing",b="No Crossing",A=c/2,I=2*c,t=X.atan2,z=X.sqrt,R=X.pow,D=X.sin,i=X.cos,$=X.min,N=X.max,r=X.abs,E=X.ceil,s=X.round,v=G.unionPoint,H=G.unionRect,q=G.containsPoint,U=G.clone,Y="rgb(52, 152, 219)",L="red",w={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},l={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var t=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],N=0;N<t.length;N++){var x=t[N];x=0===N%2?x/400*l.width:x/100*l.height,t[N]=x}return l.width>120&&(t[4]=l.width-26,t[6]=l.width-40,t[10]=l.width-40,t[12]=l.width-26,t[18]=33),t}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},k={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:Y,rotation:.61},{type:"circle",rect:[200,120,70,70],background:Y,rotation:.61},{type:"circle",rect:[200,220,70,70],background:Y,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:Y},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:Y}]},_={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:L,rotation:.61}]},Rl={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:Y},{type:"circle",rect:[0,210,90,90],background:Y},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:Y}]},Zh={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:L},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:L}]},rl={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:Y}]},fs={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:L}]},ys={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ye={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Wb=function(F){var x=F.touches[0];return x?x:F.changedTouches[0]},Xm=function(V,u,o,z){return t(z-u,o-V)},Wr=function(f,a){return{x:f.x*a,y:f.y*a}},ah=function(J,b){J.each(function(V){return J.isSelected(V)?b(V):void 0})},Ip=function(l,t){l.reverseEach(function(g){return l.isSelected(g)?t(g):void 0})},er=function(c,d,D){var k,L,s,I,i,q=this,l=d,G=q.gv;if(c instanceof f){s=c.getSegments();var t=G.getDataUI(c);i=t._55O.$15l,s&&s.size()||(s=tr(i)),c.isClosePath()&&s.indexOf(5)<0&&(s=new K(s._as),s.add(5)),k=vs(c,t,l),L=i[k]}else{var $=G.getDataUI(c);i=Gn($,c.s("edge.points")),s=c.s("edge.segments"),s&&s.size()||(s=tr(i)),i=i._as,k=vs(c,$,l),L=i[k]}if(s&&(I=s.get(l)),2===I||1===I||5===I){var n=i[k+1];5===I&&(n=i[0]);var X=il(L,D,n);return X}return D},jj=function(r,s,v,d){var y=s/2,g=v/2,F=nb(r,-y,-g,d),S=nb(r,y,-g,d),T=nb(r,-y,g,d),Y=nb(r,y,g,d),X=nb(r,0,-g,d),f=nb(r,y,0,d),U=nb(r,0,g,d),C=nb(r,-y,0,d);return[F,S,T,Y,X,f,U,C]},il=function(r,C,H){var F={x:C.x-r.x,y:C.y-r.y},Q={x:H.x-r.x,y:H.y-r.y},Z=z(R(H.x-r.x,2)+R(H.y-r.y,2)),U={x:Q.x/Z,y:Q.y/Z},k=F.x*U.x+F.y*U.y,T={x:U.x*k,y:U.y*k};return{x:r.x+T.x,y:r.y+T.y}},nb=function(p,e,q,v){var Y=i(v)*e-D(v)*q,I=D(v)*e+i(v)*q;return p?{x:p.x+Y,y:p.y+I}:{x:Y,y:I}},Oh=function(B,_){return _>2*B?B:_/2},Og=function(f,x,j,Q){var F=y(f,x);return j=Q?$(j,F):Oh(j,F),F?j/=F:j=0,{x:f.x+(x.x-f.x)*j,y:f.y+(x.y-f.y)*j}},Pb=function(j,v){var f,h,m=j.gv,o=j._data,R=o._40I,H=o._41I,r=o.s("edge.offset"),y=o.s("edge.source.position"),T=o.s("edge.target.position"),E=o.s("edge.source.offset.x"),s=o.s("edge.source.offset.y"),P=o.s("edge.target.offset.x"),_=o.s("edge.target.offset.y"),u=o.s("edge.source.anchor.x"),N=o.s("edge.source.anchor.y"),Y=o.s("edge.target.anchor.x"),X=o.s("edge.target.anchor.y");if(v?(f=M.getEdgeAgentPosition(m,R,y,E,s,u,N),h=M.getEdgeAgentPosition(m,H,T,P,_,Y,X)):(f=M.getEdgeAgentPosition(m,R,y,0,0,u,N),h=M.getEdgeAgentPosition(m,H,T,0,0,Y,X)),"points"===o.s("edge.type")&&r&&!o.s("edge.center")&&f){var S=o.s("edge.points")||new K,$=S.size(),G=Og(f,$?S.get(0):h,r,$),l=Og(h,$?S.get($-1):f,r,$);f=G,h=l}return[f,h]},Gn=function(S,J,g){var o=S._78o,E=S._data,t=E.s("edge.type"),$=[o.sourcePoint,o.targetPoint];return"points"===t?g&&($=Pb(S)):$=o.center?t?g?Pb(S):Pb(S,!0):g?Pb(S):[o.c1,o.c2]:g?Pb(S):Pb(S,!0),J=new K(J?J._as:Q),J.add($[0],0),J.add($[1]),J},Kp=function(e){return e=new K(e._as),e.removeAt(0),e.removeAt(e.size()-1),e},tr=function(q){q._as||(q=new K(q));var x=new K;x.add(1);for(var i=1;i<q.size();i++)x.add(2);return x},Pm=function($,u){return{x:($.x+u.x)/2,y:($.y+u.y)/2}},wl=function(Y,b){return{x:Y.x+1*(b.x-Y.x)/4,y:Y.y+1*(b.y-Y.y)/4}},Xf=function(Y,R){return{x:Y.x+3*(R.x-Y.x)/4,y:Y.y+3*(R.y-Y.y)/4}},Pd=function(L,y,P,e){var R=y.x+y.width/2,S=y.y+y.height/2,p=z(R*R+S*S),T=t(S,R)+P;return{x:e.x+p*i(T),y:e.y+p*D(T)}},hb=a.validateImpl,Xg=a.isRectEditable,mb=a.isPointEditable,Vr=a._42,xr=u._79o,Aj=C._79o,Oe=u._48O,Kc=u._47O,Er=P._48O,Eg=P._80o,eh=u._80o,$l=P.getSelectWidth,bc=P._47O,cc=C._47O,Go=a.isEditable,Le=["northwest","north","northeast","east","southeast","south","southwest","west"],Qg=function(h,m,j,a,w,R,S,J,G,q){var u=h.x,z=h.y,P=h.width,H=h.height,Z={x:u+P/2,y:z+H/2};a=a||0,m=nb(Z,m.x-Z.x,m.y-Z.y,-a),S&&!J&&(m.x+=G,m.y+=q);var U=.01;if("northwest"===j?(m.x+w>u+P-U&&(m.x=u+P-w-U),m.y+w>z+H-U&&(m.y=z+H-w-U),h=v(m,{x:u+P,y:z+H})):"north"===j?(m.y+w>z+H-U&&(m.y=z+H-w-U),h=v({x:u,y:m.y},{x:u+P,y:z+H})):"northeast"===j?(m.x<u+w+U&&(m.x=u+w+U),m.y+w>z+H-U&&(m.y=z+H-w-U),h=v({x:u,y:m.y},{x:m.x,y:z+H})):"west"===j?(m.x+w>u+P-U&&(m.x=u+P-w-U),h=v({x:m.x,y:z},{x:u+P,y:z+H})):"east"===j?(m.x<u+w+U&&(m.x=u+w+U),h=v({x:u,y:z},{x:m.x,y:z+H})):"southwest"===j?(m.x+w>u+P-U&&(m.x=u+P-w-U),m.y<z+w+U&&(m.y=z+w+U),h=v({x:m.x,y:z},{x:u+P,y:m.y})):"south"===j?(m.y<z+w+U&&(m.y=z+w+U),h=v({x:u,y:z},{x:u+P,y:m.y})):"southeast"===j&&(m.x<u+w+U&&(m.x=u+w+U),m.y<z+w+U&&(m.y=z+w+U),h=v({x:u,y:z},m)),"keepRatio"===R&&(!S&&J||S&&!J)&&("northeast"===j||"southeast"===j||"northwest"===j||"southwest"===j)){var g=h.width,o=h.height,W=g/P,i=o/H,A=$(W,i);h.width=P*A,h.height=H*A,"northeast"===j?h.y=z+(H-h.height):"northwest"===j?(h.y=z+(H-h.height),h.x=u+(P-h.width)):"southwest"===j&&(h.x=u+(P-h.width))}h.x-=Z.x,h.y-=Z.y;var l=Pd(Q,h,a,Z);return h.x=l.x-h.width/2,h.y=l.y-h.height/2,h},ki=function(I,q,R,g){var i=I.getRotation(),P=q,Q=P.x,T=P.y,p=P.width,W=P.height,x={x:Q+P.width/2,y:T+P.height/2};g=nb(x,g.x-x.x,g.y-x.y,-i),"northwest"===R?P=v(g,{x:Q+p,y:T+W}):"north"===R?P=v({x:Q,y:g.y},{x:Q+p,y:T+W}):"northeast"===R?P=v({x:Q,y:g.y},{x:g.x,y:T+W}):"west"===R?P=v({x:g.x,y:T},{x:Q+p,y:T+W}):"east"===R?P=v({x:Q,y:T},{x:g.x,y:T+W}):"southwest"===R?P=v({x:g.x,y:T},{x:Q+p,y:g.y}):"south"===R?P=v({x:Q,y:T},{x:Q+p,y:g.y}):"southeast"===R&&(P=v({x:Q,y:T},g)),I.setRect(P),P.x-=x.x,P.y-=x.y;var B=Pd(I,P,i,x);I.p(B.x,B.y)},Ph=function(I,E,J,P,H,N,D,o){var g=Q;N?(g=nb(Q,H.x-E.x,H.y-E.y,-J),g.x-=D.x,g.y-=D.y):g=nb(Q,H.x-E.x,H.y-E.y,0);var u={x:E.x+g.x,y:E.y+g.y};o&&(u=o(u.x,u.y)),u.e=I.getPoints().get(P).e,I.setPoint(P,u);var X=I.getWidth(),i=I.getHeight(),v=I.p().x-X/2,Y=I.p().y-i/2;v-=E.x,Y-=E.y;var B=Pd(I,{x:v,y:Y,width:X,height:i},J,E);I.p(B.x,B.y)},vs=function(d,c,I){var g,R;if(d instanceof f?(g=d.getPoints(),R=d.getSegments()):d instanceof p&&"points"===d.s("edge.type")&&(g=d.s("edge.points"),R=d.s("edge.segments"),g=Gn(c,g)),R&&R.size()||(R=tr(g)),d instanceof f&&d.isClosePath()&&R.indexOf(5)<0&&(R=new K(R._as),R.add(5)),R)for(var l=-1,r=0;r<R.size();r++){if(r===I)return l;var k=R.get(r);1===k?l+=1:2===k?l+=1:3===k?l+=2:4===k&&(l+=3)}},ch=function(N,x,j){var I,b;if(N instanceof f?(I=N.getPoints(),b=N.getSegments()):N instanceof p&&"points"===N.s("edge.type")&&(I=N.s("edge.points"),b=N.s("edge.segments"),I=Gn(x,I)),b&&b.size()||(b=tr(I)),b)for(var D=-1,t=0;t<b.size();t++){var _=b.get(t);if(1===_?D+=1:2===_?D+=1:3===_?D+=2:4===_&&(D+=3),D===j)return t}},qp=function(i,h){var u=[i[0]-h[0],i[1]-h[1],i[2]-h[2]];return u},mm=function(){var T=new g(16);return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T},Lc=function(O,r){var I=O[0],t=O[1],n=O[2];return O[0]=r[0]*I+r[4]*t+r[8]*n+r[12],O[1]=r[1]*I+r[5]*t+r[9]*n+r[13],O[2]=r[2]*I+r[6]*t+r[10]*n+r[14],O},Mc=function(O,I){if(I){var z=D(I),l=i(I),m=O[0],x=O[1],C=O[2],P=O[3],a=O[8],N=O[9],W=O[10],r=O[11];O[0]=m*l-a*z,O[1]=x*l-N*z,O[2]=C*l-W*z,O[3]=P*l-r*z,O[8]=m*z+a*l,O[9]=x*z+N*l,O[10]=C*z+W*l,O[11]=P*z+r*l}},fp=function(m,E){for(var A=m.s("grid.row.count"),D=m.s("grid.column.count"),h=0;A>h;h++)for(var u=0;D>u;u++){var Q=m.getCellRect(h,u);if(q(Q,E))return{rowIndex:h,columnIndex:u,rect:Q,grid:m}}return null},Kh=function(y,F,H,$,I,t){var E={},W=H-y,D=$-F,V=X.sqrt(W*W+D*D),f=W/V,u=D/V,z=(-y+I)*f+(-F+t)*u;return 0>=z?(E.x=y,E.y=F):z>=V?(E.x=H,E.y=$):(E.x=y+z*f,E.y=F+z*u),W=I-E.x,D=t-E.y,E.z=X.sqrt(W*W+D*D),E},Vj=function(g,H){var h,L,B,q,W,m,l,I,u=g.getPoints(),G=g.getSegments(),U=g.p(),R=g.getRotation();if(!G||!(G.indexOf(3)>0||G.indexOf(4)>0)){for(I=0;I<=u.size()-1;I++)if(I===u.size()-1?(W=u.get(0),q=u.get(I)):(q=u.get(I),W=u.get(I+1)),q=nb(U,q.x-U.x,q.y-U.y,R),W=nb(U,W.x-U.x,W.y-U.y,R),m=Kh(q.x,q.y,W.x,W.y,H.x,H.y),l=m.z,l<(g.s("shape.border.width")||10)){L=q,B=W,h=I;break}if(h!=Q){var n=Kh(L.x,L.y,B.x,B.y,H.x,H.y),P=y(L,n);return{attachIndex:h,attachOffset:P}}}},Ro=function(K){for(var O=K._data,B=O.p(),c=O.getRotation(),y=O.getPoints(),u=Q,I=[],a=0;a<y.size();a++)u=y.get(a),I.push(nb(B,u.x-B.x,u.y-B.y,c));K._55O.$15l=I};G.setImage("xeditinteractor_parentIcon",k),G.setImage("xeditinteractor_hostIcon",_),G.setImage("xeditinteractor_edgeIcon",Rl),G.setImage("xeditinteractor_removeIcon",Zh),G.setImage("xeditinteractor_sourceIcon",rl),G.setImage("xeditinteractor_targetIcon",fs),G.setImage("xeditinteractor_elevationIcon",ys),G.setImage("xeditinteractor_tallIcon",ye),a._editPointSize=B?24:9,a._edgeHelpers=["parent","remove","source","target"],a._leftTopHelpers=["parent"],a._rightTopHelpers=["host"],a._leftBottomHelpers=["edge"],a._rightBottomHelpers=["remove"],Le=Le.concat(Le).concat(Le),C._79o=function(){var g=this,J=g.gv,Y=J.getZoom(),G=J._editInteractor,C=Aj.call(g);if(!C)return null;var O=Pb(g,!0),S=O[0],f=O[1],R={x:C.x,y:C.y,width:C.width,height:C.height},V=v(S,f);if(G instanceof Z.XEditInteractor){R=H(R,V);var U=g._55O,L=J.getEditPointSize()/Y+2,D=0;U&&U._43O&&(D+=L/2,m(R,D))}return R},C._47O=function(k){var V=this,R=V.gv,H=R._editInteractor;H instanceof Z.XEditInteractor||cc.call(V,k)},C.rectIntersects=function(m){var Y=this,y=Y._data,j=Y.gv,A=j.getZoom(),l=Y._55O,R=j._editInteractor;if(R instanceof Z.XEditInteractor&&j.isEditable(y)&&l&&l._43O&&"points"===y.s("edge.type")){var b=y.s("edge.points"),M=y.s("edge.segments");b=Gn(Y,b),M&&M.size()||(M=tr(b)),b=b._as;var u=!1,s=B?5:1,n=m.x+s,r=m.y+s,V={x:n,y:r};if(R._edge===y&&R._hoverSegmentIndex>=0){var X=j._editInteractor._hoverSegmentIndex,D=M.get(X),d=vs(y,Y,X),N=Q;if(d!=Q&&d>=0){var K=b[d],I=j.getSegmentHoverWidth()/A;if(2===D||1===D){var h=b[d+1];N=xh(new dp(K.x,K.y),new dp(h.x,h.y),new dp(V.x-I,V.y-I),new dp(V.x+2*I,V.y+2*I)),N.$62l===O&&(u=!0)}else if(3===D){var g=b[d+1],h=b[d+2];N=$r(new dp(K.x,K.y),new dp(g.x,g.y),new dp(h.x,h.y),new dp(V.x-I,V.y-I),new dp(V.x+2*I,V.y+2*I)),N.$62l===O&&(u=!0)}else if(4===D){var C=b[d+1],v=b[d+2];h=b[d+3],N=Gh(new dp(K.x,K.y),new dp(C.x,C.y),new dp(v.x,v.y),new dp(h.x,h.y),new dp(V.x-I,V.y-I),new dp(V.x+2*I,V.y+2*I)),N.$62l===O&&(u=!0)}}}if(u)return!0}return Q},u._47O=function(E){var i=this,K=i.gv,M=K._editInteractor;M instanceof Z.XEditInteractor||Kc.call(i,E)},u.rectIntersects=function(g){var u=this,E=u._data,T=u.gv,p=T.getZoom(),h=u._55O,i=T._editInteractor;if(i instanceof Z.XEditInteractor&&T.isEditable(E)&&h&&h._43O){var U=h.$15l,a=!1,D=B?5:1,r=g.x+D,x=g.y+D,V={x:r,y:x};if(U&&U.length===E.getPoints().size()||(Ro(u),U=h.$15l),i._shape===E&&i._hoverSegmentIndex>=0){var F=E.getSegments();F&&F.size()||(F=tr(U));var t=T._editInteractor._hoverSegmentIndex,K=F.get(t),n=vs(E,u,t),W=Q;if(n!=Q&&n>=0){var b=U[n],Y=T.getSegmentHoverWidth()/p;if(2===K||1===K){var w=U[n+1];W=xh(new dp(b.x,b.y),new dp(w.x,w.y),new dp(V.x-Y,V.y-Y),new dp(V.x+2*Y,V.y+2*Y)),W.$62l===O&&(a=!0)}else if(3===K){var l=U[n+1],w=U[n+2];W=$r(new dp(b.x,b.y),new dp(l.x,l.y),new dp(w.x,w.y),new dp(V.x-Y,V.y-Y),new dp(V.x+2*Y,V.y+2*Y)),W.$62l===O&&(a=!0)}else if(4===K){var X=U[n+1],C=U[n+2];w=U[n+3],W=Gh(new dp(b.x,b.y),new dp(X.x,X.y),new dp(C.x,C.y),new dp(w.x,w.y),new dp(V.x-Y,V.y-Y),new dp(V.x+2*Y,V.y+2*Y)),W.$62l===O&&(a=!0)}}}if(a)return!0}return Q},u._48O=function(){var f=this,m=f.gv,E=m._editInteractor;E instanceof Z.XEditInteractor?(P._48O.call(f),f._55O._43O&&Ro(f)):Oe.call(f)},u._79o=function(){var u=this,P=u.gv,B=P.getZoom(),M=P._editInteractor,z=xr.call(u);if(z){var a={x:z.x,y:z.y,width:z.width,height:z.height};if(M instanceof Z.XEditInteractor){var A=u._55O,H=P.getEditPointSize()/B+2,E=0;A&&A._43O&&(E+=H/2,m(a,E))}return a}},P._47O=function(v){var B=this,l=B.gv,N=l._editInteractor;if(N instanceof Z.XEditInteractor);else{var X=B._55O;X&&X._98o&&bc.call(B,v)}},P.getSelectWidth=function(){var H=this,L=H.gv,w=L._editInteractor,c=H._data;return L.isEditable(c)&&w instanceof Z.XEditInteractor?0:$l.call(H)},P._80o=function(i){var N=this,G=N.gv._editInteractor;if(Eg.call(N,i),G&&G._debug){i.save(),i.beginPath(),i.lineWidth=1,i.strokeStyle="green";var p=N._79o();p&&(i.rect(p.x,p.y,p.width,p.height),i.stroke()),i.restore()}},u._80o=function(W){var z=this,t=z.gv._editInteractor;if(eh.call(z,W),t&&t._debug){W.save(),W.beginPath(),W.lineWidth=1,W.strokeStyle="green";var $=z._79o();W.rect($.x,$.y,$.width,$.height),W.stroke(),W.restore()}},P._48O=function(){var h=this,V=h.gv,a=h._data,Y=V._editInteractor,M=h._55O,b=a.p(),l=a.getRotation();if(Y instanceof Z.XEditInteractor){if(M._42O){var x=jj(b,a.getWidth(),a.getHeight(),l),_=x[0],X=x[1],N=x[2],v=x[3],W=x[4],A=x[5],T=x[6],e=x[7];M.$45l=[_,W,X,A,v,T,N,e]}}else Er.call(h)},a.getResizeMode=function(){return this.$25l||"normal"},a.setResizeMode=function(W){var j=this.$25l;this.$25l=W,this.fp("resizeMode",j,W)},a.getSnapAngle=function(){return this.$26l||Math.PI/36},a.setSnapAngle=function(B){var d=this.$26l;this.$26l=B,this.fp("snapAngle",d,B)},a.getSnapSpacing=function(){return this.$27l},a.setSnapSpacing=function(w){var C=this.$27l;this.$27l=w,this.fp("snapSpacing",C,w)},a.getPointSnapSpacing=function(){return this._pointSnapSpacing},a.setPointSnapSpacing=function(W){var Z=this._pointSnapSpacing;this._pointSnapSpacing=W,this.fp("pointSnapSpacing",Z,W)},a.setHelperEditableFunc=function(x){var o=this._helperEditableFunc;this._helperEditableFunc=x,this.fp("helperEditableFunc",o,x)},a.getHelperEditableFunc=function(){return this._helperEditableFunc},a.setLeftTopHelpers=function(i){var z=this._leftTopHelpers;this._leftTopHelpers=i,this.fp("leftTopHelpers",z,i)},a.getLeftTopHelpers=function(){return this._leftTopHelpers},a.setLeftTopHelpersAlign=function(Q){var f=this._leftTopHelpersAlign;this._leftTopHelpersAlign=Q,this.fp("leftTopHelpersAlign",f,Q)},a.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},a.setRightTopHelpers=function(B){var K=this._rightTopHelpers;this._rightTopHelpers=B,this.fp("rightTopHelpers",K,B)},a.getRightTopHelpers=function(){return this._rightTopHelpers},a.setRightTopHelpersAlign=function(C){var c=this._rightTopHelpersAlign;this._rightTopHelpersAlign=C,this.fp("rightTopHelpersAlign",c,C)},a.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},a.setLeftBottomHelpers=function(t){var J=this._leftBottomHelpers;this._leftBottomHelpers=t,this.fp("leftBottomHelpers",J,t)},a.getLeftBottomHelpers=function(){return this._leftBottomHelpers},a.setLeftBottomHelpersAlign=function(I){var M=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=I,this.fp("leftBottomHelpersAlign",M,I)},a.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},a.setRightBottomHelpers=function(m){var Z=this._rightBottomHelpers;this._rightBottomHelpers=m,this.fp("rightBottomHelpers",Z,m)},a.getRightBottomHelpers=function(){return this._rightBottomHelpers},a.setRightBottomHelpersAlign=function(t){var x=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=t,this.fp("rightBottomHelpersAlign",x,t)},a.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},a.setEdgeHelpers=function(I){var f=this._edgeHelpers;this._edgeHelpers=I,this.fp("edgeHelpers",f,I)},a.getEdgeHelpers=function(){return this._edgeHelpers},a.isHelperEditable=function(E,Z){return E instanceof p&&("host"===Z||"edge"===Z||"elevation"===Z||"tall"===Z)?!1:E instanceof e&&("source"===Z||"target"===Z)?!1:"pointElevation"===Z?this._helperEditableFunc?this._helperEditableFunc(E,Z):!1:this._helperEditableFunc?this._helperEditableFunc(E,Z):!0},a.getEditHelperSize=function(){return this._editHelperSize||(B?28:16)},a.setEditHelperSize=function(X){var h=this._editHelperSize;this._editHelperSize=X,this.fp("editHelperSize",h,X)},a.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},a.setEditRectBorderColor=function(n){var Z=this.$28l;this.$28l=n,this.fp("editRectBorderColor",Z,n)},a.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},a.setNodeBorderColor=function(h){var z=this.$29l;this.$29l=h,this.fp("nodeBorderColor",z,h)},a.getEditRectBorderStyle=function(){return this.$30l||"dashed"},a.setEditRectBorderStyle=function(w){var q=this.$30l;this.$30l=w,this.fp("editRectBorderStyle",q,w)},a.getControlPointBackground=function(){return this.$31l||"#ff0"},a.setControlPointBackground=function(r){var C=this.$31l;this.$31l=r,this.fp("controlPointBackground",C,r)},a.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},a.setControlPointBorderColor=function($){var f=this.$32l;this.$32l=$,this.fp("controlPointBorderColor",f,$)},a.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},a.setJoinPointBackground=function(H){var M=this.$33l;this.$33l=H,this.fp("joinPointBackground",M,H)},a.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},a.setJoinPointBorderColor=function(I){var n=this.$34l;this.$34l=I,this.fp("joinPointBorderColor",n,I)},a.getDirectionLineColor=function(){return this.$35l||"#888"},a.setDirectionLineColor=function(t){var w=this.$35l;this.$35l=t,this.fp("directionLineColor",w,t)},a.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},a.setSegmentHoverColor=function(E){var M=this.$36l;this.$36l=E,this.fp("segmentHoverColor",M,E)},a.getSegmentHoverWidth=function(){return this.$22l||(B?16:8)},a.setSegmentHoverWidth=function(o){var x=this.$22l;this.$22l=o,this.fp("segmentHoverWidth",x,o)},a.getSnapPointBorderColor=function(){return this.$38l||"#f00"},a.setSnapPointBorderColor=function(e){var z=this.$38l;this.$38l=e,this.fp("snapPointBorderColor",z,e)},a.getEditRectPadding=function(){return this.$39l!=Q?this.$39l:6},a.setEditRectPadding=function(s){var v=this.$39l;this.$39l=s,this.fp("editRectPading",v,s)},a.isRectEditable=function(z){var K=this,a=K._editInteractor;return a instanceof Z.XEditInteractor?K._rectEditableFunc?K._rectEditableFunc(z):!0:Xg.call(K,z)},a.isPointEditable=function(N){var E=this,g=E._editInteractor;return g instanceof Z.XEditInteractor?E._pointEditableFunc?E._pointEditableFunc(N):!0:mb.call(E,N)},a.validateImpl=function(){var $=this,x=$.$14l,V=$._editInteractor;if(x){var A=$.getWidth(),Q=$.getHeight();(A!==x.clientWidth||Q!==x.clientHeight)&&(V&&(V._68I=1),M.setCanvas(x,A,Q),$._32I=1)}hb.call(this)},a.isEditable=function(H){var h=Go.call(this,H),R=this._editInteractor;if(R instanceof Z.XEditInteractor&&H instanceof p){if(!H.s("2d.editable"))return!1;var f=this.getEditableFunc();h=f?f(H):!0}return h},a._42=function(K,v){var P=this,V=P._editInteractor;Vr.call(P,K,v),V instanceof Z.XEditInteractor&&V._68I&&V._42()},a.isSnapPoint=function(){return!0};var Qi=function(G){arguments.length>0&&this.$58l(G)},Xc=Qi.prototype;Xc.$58l=function(r){this.$62l=r,this.points=new Array},Xc.$56l=function(s){this.points.push(s)},Xc.$57l=function(q){this.points=this.points.concat(q)};var dp=function(C,K){arguments.length>0&&this.$58l(C,K)},Wp=dp.prototype;Wp.$58l=function(J,L){this.x=J,this.y=L},Wp.add=function(G){return new dp(this.x+G.x,this.y+G.y)},Wp.addEquals=function(E){return this.x+=E.x,this.y+=E.y,this},Wp.$55l=function(Q){return new dp(this.x*Q,this.y*Q)},Wp.eq=function(U){return this.x==U.x&&this.y==U.y},Wp.lt=function(t){return this.x<t.x&&this.y<t.y},Wp.lte=function(R){return this.x<=R.x&&this.y<=R.y},Wp.gt=function(u){return this.x>u.x&&this.y>u.y},Wp.gte=function(A){return this.x>=A.x&&this.y>=A.y},Wp.lerp=function(i,Z){return new dp(this.x+(i.x-this.x)*Z,this.y+(i.y-this.y)*Z)},Wp.distanceFrom=function(V){var F=this.x-V.x,k=this.y-V.y;return z(F*F+k*k)},Wp.min=function(H){return new dp($(this.x,H.x),$(this.y,H.y))},Wp.max=function(R){return new dp(N(this.x,R.x),N(this.y,R.y))},Wp.toString=function(){return this.x+","+this.y};var Pq=function(){this.$58l(arguments)},Nd=Pq.prototype;Pq.TO=1e-6,Pq.AC=6,Nd.$58l=function(T){this.co=new Array;for(var N=T.length-1;N>=0;N--)this.co.push(T[N])},Nd.$55l=function(K){for(var N=new Pq,H=0;H<=this.$50l()+K.$50l();H++)N.co.push(0);for(var H=0;H<=this.$50l();H++)for(var s=0;s<=K.$50l();s++)N.co[H+s]+=this.co[H]*K.co[s];return N},Nd.$59l=function(){for(var X=this.$50l();X>=0&&r(this.co[X])<=Pq.TO;X--)this.co.pop()},Nd.$50l=function(){return this.co.length-1},Nd.$51l=function(){var h;switch(this.$59l(),this.$50l()){case 0:h=new Array;break;case 1:h=this.$52l();break;case 2:h=this.$53l();break;case 3:h=this.$54l();break;case 4:h=this.$63l();break;default:h=new Array}return h},Nd.$52l=function(){var S=new Array,m=this.co[1];return 0!=m&&S.push(-this.co[0]/m),S},Nd.$53l=function(){var B=new Array;if(2==this.$50l()){var Q=this.co[2],A=this.co[1]/Q,D=this.co[0]/Q,c=A*A-4*D;if(c>0){var M=z(c);B.push(.5*(-A+M)),B.push(.5*(-A-M))}else 0==c&&B.push(.5*-A)}return B},Nd.$63l=function(){var p=new Array;if(4==this.$50l()){var d=this.co[4],$=this.co[3]/d,Z=this.co[2]/d,a=this.co[1]/d,I=this.co[0]/d,E=new Pq(1,-Z,$*a-4*I,-$*$*I+4*Z*I-a*a).$54l(),M=E[0],s=$*$/4-Z+M;if(r(s)<=Pq.TO&&(s=0),s>0){var C=z(s),j=3*$*$/4-C*C-2*Z,H=(4*$*Z-8*a-$*$*$)/(4*C),X=j+H,l=j-H;if(r(X)<=Pq.TO&&(X=0),r(l)<=Pq.TO&&(l=0),X>=0){var F=z(X);p.push(-$/4+(C+F)/2),p.push(-$/4+(C-F)/2)}if(l>=0){var F=z(l);p.push(-$/4+(F-C)/2),p.push(-$/4-(F+C)/2)}}else if(0>s);else{var H=M*M-4*I;if(H>=-Pq.TO){if(0>H&&(H=0),H=2*z(H),j=3*$*$/4-2*Z,j+H>=Pq.TO){var _=z(j+H);p.push(-$/4+_/2),p.push(-$/4-_/2)}if(j-H>=Pq.TO){var _=z(j-H);p.push(-$/4+_/2),p.push(-$/4-_/2)}}}}return p},Nd.$54l=function(){var f=new Array;if(3==this.$50l()){var F=this.co[3],E=this.co[2]/F,J=this.co[1]/F,Z=this.co[0]/F,c=(3*J-E*E)/3,h=(2*E*E*E-9*J*E+27*Z)/27,_=E/3,x=h*h/4+c*c*c/27,Y=h/2;if(r(x)<=Pq.TO&&(x=0),x>0){var d,M,P=z(x);d=-Y+P,M=d>=0?R(d,1/3):-R(-d,1/3),d=-Y-P,d>=0?M+=R(d,1/3):M-=R(-d,1/3),f.push(M-_)}else if(0>x){var L=z(-c/3),u=t(z(-x),-Y)/3,B=i(u),G=D(u),w=z(3);f.push(2*L*B-_),f.push(-L*(B+w*G)-_),f.push(-L*(B-w*G)-_)}else{var d;d=Y>=0?-R(Y,1/3):R(-Y,1/3),f.push(2*d-_),f.push(-d-_)}}return f};var $j=function(f,g){arguments.length>0&&this.$58l(f,g)},Jb=$j.prototype;Jb.$58l=function(n,v){this.x=n,this.y=v},Jb.length=function(){return z(this.x*this.x+this.y*this.y)},Jb.$60l=function(C){return this.x*C.x+this.y*C.y};var Ci=function(c,u,X,N){var y,G=(N.x-X.x)*(c.y-X.y)-(N.y-X.y)*(c.x-X.x),m=(u.x-c.x)*(c.y-X.y)-(u.y-c.y)*(c.x-X.x),w=(N.y-X.y)*(u.x-c.x)-(N.x-X.x)*(u.y-c.y);if(0!=w){var d=G/w,r=m/w;d>=0&&1>=d&&r>=0&&1>=r?(y=new Qi(O),y.points.push(new dp(c.x+d*(u.x-c.x),c.y+d*(u.y-c.y)))):y=new Qi(b)}else y=0==G||0==m?new Qi("C"):new Qi("P");return y},to=function(Z,L,j,G,w){var H,y,e,t,M,m,V,U=G.min(w),k=G.max(w),q=new Qi(b);H=L.$55l(-2),e=Z.add(H.add(j)),H=Z.$55l(-2),y=L.$55l(2),t=H.add(y),M=new dp(Z.x,Z.y),V=new $j(G.y-w.y,w.x-G.x),m=G.x*w.y-w.x*G.y;for(var o=new Pq(V.$60l(e),V.$60l(t),V.$60l(M)+m).$51l(),F=0;F<o.length;F++){var c=o[F];if(c>=0&&1>=c){var p=Z.lerp(L,c),C=L.lerp(j,c),B=p.lerp(C,c);G.x==w.x?U.y<=B.y&&B.y<=k.y&&(q.$62l=O,q.$56l(B)):G.y==w.y?U.x<=B.x&&B.x<=k.x&&(q.$62l=O,q.$56l(B)):B.gte(U)&&B.lte(k)&&(q.$62l=O,q.$56l(B))}}return q},$r=function(L,l,Q,R,A){var D=R.min(A),T=R.max(A),w=new dp(T.x,D.y),H=new dp(D.x,T.y),o=to(L,l,Q,D,w),Y=to(L,l,Q,w,T),V=to(L,l,Q,T,H),h=to(L,l,Q,H,D),F=new Qi(b);return F.$57l(o.points),F.$57l(Y.points),F.$57l(V.points),F.$57l(h.points),F.points.length>0&&(F.$62l=O),F},lm=function(Y,o,N,W,A,a){var T,k,R,x,i,u,h,H,q,M,z=A.min(a),p=A.max(a),d=new Qi(b);T=Y.$55l(-1),k=o.$55l(3),R=N.$55l(-3),x=T.add(k.add(R.add(W))),i=new $j(x.x,x.y),T=Y.$55l(3),k=o.$55l(-6),R=N.$55l(3),x=T.add(k.add(R)),u=new $j(x.x,x.y),T=Y.$55l(-3),k=o.$55l(3),R=T.add(k),h=new $j(R.x,R.y),H=new $j(Y.x,Y.y),M=new $j(A.y-a.y,a.x-A.x),q=A.x*a.y-a.x*A.y;for(var E=new Pq(M.$60l(i),M.$60l(u),M.$60l(h),M.$60l(H)+q).$51l(),e=0;e<E.length;e++){var B=E[e];if(B>=0&&1>=B){var y=Y.lerp(o,B),v=o.lerp(N,B),C=N.lerp(W,B),U=y.lerp(v,B),n=v.lerp(C,B),K=U.lerp(n,B);A.x==a.x?z.y<=K.y&&K.y<=p.y&&(d.$62l=O,d.$56l(K)):A.y==a.y?z.x<=K.x&&K.x<=p.x&&(d.$62l=O,d.$56l(K)):K.gte(z)&&K.lte(p)&&(d.$62l=O,d.$56l(K))}}return d},Gh=function(p,n,V,x,M,W){var E=M.min(W),z=M.max(W),u=new dp(z.x,E.y),k=new dp(E.x,z.y),o=lm(p,n,V,x,E,u),G=lm(p,n,V,x,u,z),q=lm(p,n,V,x,z,k),D=lm(p,n,V,x,k,E),P=new Qi(b);return P.$57l(o.points),P.$57l(G.points),P.$57l(q.points),P.$57l(D.points),P.points.length>0&&(P.$62l=O),P},xh=function(I,o,V,x){var H=V.min(x),m=V.max(x),i=new dp(m.x,H.y),B=new dp(H.x,m.y),t=Ci(H,i,I,o),W=Ci(i,m,I,o),s=Ci(m,B,I,o),Y=Ci(B,H,I,o),T=new Qi(b);return T.$57l(t.points),T.$57l(W.points),T.$57l(s.points),T.$57l(Y.points),T.points.length>0&&(T.$62l=O),T},ls=Z.XEditInteractor=function(R){var M=this,P=M._view=document.createElement("canvas");P.className="editCanvas",P.style.position="absolute",ls.superClass.constructor.call(M,R)};G.def(ls,Z.Interactor,{ms_edit:1,setUp:function(){var S=this,E=S.gv,N=E.getView(),G=S._view;ls.superClass.setUp.call(S),E.setEditInteractor(S),E.$14l=G,E._79O?N.insertBefore(G,E._79O):N.appendChild(G);var T=S.$49l=S.$11l.bind(S);E.dm().md(T),E.sm().ms(T),E.mp(T)},tearDown:function(){var F=this,i=F.gv,o=i.getView(),s=F.$49l;ls.superClass.tearDown.call(F),i.setEditInteractor(Q),i.$14l=Q,o.removeChild(F._view),i.dm().umd(s),i.sm().ums(s),i.ump(s)},clear:function(){var g=this,k=g.gv;delete g._hoverSegmentIndex,delete g._edge,delete g._shape,delete k._editing,delete g.$10l,delete g.$13l,delete g.$9l,delete g._removePointIndex,delete g._lp,g.$12l="",delete g.$40l,delete g.$67l,delete g.$72l,delete g.$73l,delete g.$75l,delete g.$1l,delete g.$3l,delete g.$2l,delete g.$92l,delete g.$93l,delete g.$94l,g.clearDragging()},handle_keydown:function(G){this.$48l!==G.shiftKey&&(this.$48l=G.shiftKey,this.handle_mousemove(G,j,!0))},handle_keyup:function(G){this.$48l!==G.shiftKey&&(this.$48l=G.shiftKey,this.handle_mousemove(G,j,!0))},handle_touchstart:function(k){this.handle_mousemove(k),this.handle_mousedown(k)},handle_mousedown:function(z){W(z);var c=this,q=c.$13l,i=c.gv,j=i.dm(),K=i.sm(),C=i.getZoom(),d=i.lp(z),O=G.isDoubleClick(z),t=G.isLeftButton(z),Y=c.$7l,Z=c._shape,E=c._hoverSegmentIndex,o=c._edge,p=c.$87l,n=c.$88l,g=function(){c._68I||p===c.$87l&&n===c.$88l||c.$43l()};if(7!==c.$67l&&(delete c.$87l,delete c.$88l),t&&(Z||o)&&E>=0&&O&&(Z&&K.contains(Z)||o&&K.contains(o))){var N=er.call(c,Z||o,E,d);return c.addShapePoint(Z||o,E,N),T(function(){c.handle_mousemove(z)},40),void 0}if(t&&(Z||o)&&c._removePointIndex>=0&&O)return c.removeShapePoint(),c.$5l=1,T(function(){c.handle_mousemove(z)},40),void 0;if(!t||!i._editing)return g(),void 0;if(Z&&q>=0){var x=Z.getPoints().get(q),F=Z.p(),_=nb(F,x.x-F.x,x.y-F.y,-Y+Z.getRotation());k=nb(F,d.x-F.x,d.y-F.y,-Y),c.$24l={x:k.x-_.x,y:k.y-_.y},c.startDragging(z),j.beginTransaction(),c.fi({kind:"beginEditPoint",event:z,data:Z,index:q}),c.$88l=q,c.$87l=Z}else if(c.$10l){var $=i.sm().getSelection(),P=c.$6l,f=c.$1l={},H=c.$3l={},v=c.$16l[w[c.$10l]],h={x:P.x,y:P.y},V={x:P.x+P.width/2,y:P.y+P.height/2};c.$24l={x:d.x-v.x/C,y:d.y-v.y/C},c.$2l=U(c.$8l),c.$4l=U(P),$.each(function(o){if(o instanceof e){var K=o.p(),F=o.getWidth(),U=o.getHeight(),g=nb(V,K.x-V.x,K.y-V.y,-Y);f[o.getId()]={x:K.x-F/2,y:K.y-U/2,width:F,height:U},H[o.getId()]={x:(g.x-h.x)/P.width,y:(g.y-h.y)/P.height}}}),c.startDragging(z),j.beginTransaction(),c.fi({kind:"beginEditRect",event:z,direction:c.$10l})}else if(o&&q>=0){var l=Gn(i.getDataUI(o),o.s("edge.points")),x=l.get(q);c.$24l={x:d.x-x.x,y:d.y-x.y},c.startDragging(z),j.beginTransaction(),c.fi({kind:"beginEditPoint",event:z,data:o,index:q}),c.$88l=q,c.$87l=o}else if(c.$40l){var P=c.$6l,V={x:P.x+P.width/2,y:P.y+P.height/2},u=U(c.$23l);u.x/=C,u.y/=C;var M=nb(V,u.x-V.x,u.y-V.y,-Y),k=nb(V,d.x-V.x,d.y-V.y,-Y);c.$24l={x:k.x-M.x,y:k.y-M.y},c.startDragging(z),j.beginTransaction(),c.fi({kind:"beginEditRotation",event:z,data:c._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(c.$67l)>=0){var A=c.$67l;(7===A||8===A||9===A)&&j.beginTransaction(),c.startDragging(z)}else if(c.$71l&&O&&c.$79l(c.$71l,d)){var L=K.toSelection();j.beginTransaction(),L.each(function(y){j.remove(y)}),j.endTransaction()}g()},$11l:function(){var U=this,e=U.gv;e._editing&&(U.$13l==Q||U._shape==Q&&U._edge==Q)&&(U.$73l==Q||1!==U.$67l&&5!==U.$67l&&6!==U.$67l)||(U.$5l=1),U._68I=1},$46l:function(_){var L=this,T=L.gv,G=T.lp(_),m=[];return Ip(T,function(V){var z=T.getDataUI(V);if(z){var Y=z._79o();q(Y,G)&&m.push(V)}}),m},$47l:function(j){var C=this,x=C.$13l,o=C.gv.dm();C.$10l?(C.fi({kind:"endEditRect",event:j,direction:C.$10l}),o.endTransaction()):C._shape&&x>=0?(C.fi({kind:"endEditPoint",event:j,data:C._shape,index:x}),o.endTransaction()):C._edge&&x>=0?(C.fi({kind:"endEditPoint",event:j,data:C._edge,index:x}),o.endTransaction()):C.$23l&&C.$40l&&(C.fi({kind:"endEditRotation",event:j}),o.endTransaction())},handleWindowTouchEnd:function(y){this.handleWindowMouseUp(y)},handleWindowMouseUp:function(l){var O=this,n=O.gv,v=n.dm(),L=O._shape,P=O._edge,i=O.$13l,E=O.$40l,R=O.$9l,N=O.$10l,f=O.$67l;if((L||P)&&i>=0&&R>=0){var q,G;if(L){var J=L.p(),r=L.getRotation();q=L.getPoints(),G=q.get(R),Ph(L,J,r,i,G,!1)}else if(q=Gn(n.getDataUI(P),P.s("edge.points"),!0),G=q.get(R),0===i){var T=q.get(0);P.s("edge.source.offset.x",G.x-T.x),P.s("edge.source.offset.y",G.y-T.y)}else if(i===q.size()-1){var $=q.get(q.size()-1);P.s("edge.target.offset.x",G.x-$.x),P.s("edge.target.offset.y",G.y-$.y)}else"points"===P.s("edge.type")&&(q.set(i,G),P.s("edge.points",Kp(q)))}O.$47l(l);var S=O.$73l;1===f?(v.beginTransaction(),S?n.sm().each(function(J){if(J.setHost&&n.isHelperEditable(J,"host")){J.setHost(S);
var z=O.$75l,u=O.$74l;z&&(J.s("attach.row.index",z.rowIndex),J.s("attach.column.index",z.columnIndex)),u&&(J.s("attach.index",u.attachIndex),J.s("attach.offset",u.attachOffset),J.s("attach.offset.relative",!1),J.s("attach.offset.opposite",!1))}}):n.sm().each(function(f){f.setHost&&n.isHelperEditable(f,"host")&&(f.setHost(Q),f.s("attach.row.index",j),f.s("attach.column.index",j),f.s("attach.index",j),f.s("attach.offset",j),f.s("attach.offset.relative",!1),f.s("attach.offset.opposite",!1))}),v.endTransaction()):2===f?(v.beginTransaction(),S?n.sm().each(function(W){W.setParent&&n.isHelperEditable(W,"parent")&&W.setParent(S)}):n.sm().each(function(C){C.setParent&&n.isHelperEditable(C,"parent")&&C.setParent(Q)}),v.endTransaction()):3===f?S&&(v.beginTransaction(),n.sm().each(function(J){if(n.isHelperEditable(J,"edge")&&J instanceof e&&S instanceof e){var C=new o.Edge;v.add(C),C.setSource(J),C.setTarget(S),O.onEdgeCreated&&O.onEdgeCreated(l,C)}}),v.endTransaction()):5===f||6===f?S&&(v.beginTransaction(),n.sm().each(function(m){m instanceof p&&S instanceof e&&(5===f&&n.isHelperEditable(m,"source")?m.setSource(S):6===f&&n.isHelperEditable(m,"source")&&m.setTarget(S))}),v.endTransaction()):(7===f||8===f||9===f)&&v.endTransaction(),(N||E)&&O.$43l(!0),V(l)?(O.clear(),delete O.$64l,O._68I||O.$43l()):(O.handle_mousemove(l,!0),f&&!O._68I&&O.$43l())},handleWindowTouchMove:function(l){this.handleWindowMouseMove(l)},handleWindowMouseMove:function(w){this._78I(w)},handle_mousemove:function(q,o,N){if(!this._pause){if(!N){var $=V(q)?Wb(q):q;this.$61l={clientX:$.clientX,clientY:$.clientY}}if(o===!0||!d()){var X=this,v=X.gv,I=!1,T=Q;X.clear(),v.sm().size()>0&&(T=v.lp(N?X.$61l:q),I=X._79I(q,T)),I&&(v._editing=1),X.$12l!==X.$65l&&(X.$65l=X.$12l,X.setCursor(X.$12l)),X.$40l!==X.$64l&&(X.$64l=X.$40l,X._68I||X.$43l()),X._hoverSegmentIndex!==X.$66l&&(X.$66l=X._hoverSegmentIndex,X._68I||X.$43l())}}},_78I:function(n){this.autoScroll(n);var V=this,B=V.gv,o=B.lp(n),S=B.getZoom(),u=V.$13l;if((V._shape||V._edge)&&u>=0){var l,a,d,x=V._shape,L=V._edge,j=V.$24l,g=B.getPointSnapSpacing(),O=function(N,F){return g==Q||isNaN(g)?{x:N,y:F}:{x:s(N/g)*g,y:s(F/g)*g}};if(x){l=x.getPoints();var h=x.p(),J=x.getRotation(),M=0;a=nb(h,o.x-h.x,o.y-h.y,-J),Ph(x,h,J,u,o,!0,j,O),V.fi({kind:"betweenEditPoint",event:n,data:x,index:u})}else if(L){l=Gn(B.getDataUI(L),L.s("edge.points"),!0),o.x-=j.x,o.y-=j.y,a=o;var C,k,E=L.s("edge.offset"),K=l.size(),R=K>2;if(0===u){var N=l.get(0);E&&(N=Og(N,l.get(1),-E,R),o=Og(o,l.get(1),-E,R)),C=o.x-N.x,k=o.y-N.y,d=O(C,k),L.s("edge.source.offset.x",d.x),L.s("edge.source.offset.y",d.y)}else if(u===K-1){var Z=l.get(K-1);E&&(Z=Og(Z,l.get(K-2),-E,R),o=Og(o,l.get(K-2),-E,R)),C=o.x-Z.x,k=o.y-Z.y,d=O(C,k),L.s("edge.target.offset.x",d.x),L.s("edge.target.offset.y",d.y)}else"points"===L.s("edge.type")&&(d=O(o.x,o.y),d.e=l.get(u).e,l.set(u,d),L.s("edge.points",Kp(l)));V.fi({kind:"betweenEditPoint",event:n,data:L,index:u})}if(delete V.$9l,B.isSnapPoint(x)||B.isSnapPoint(L))for(M=0;M<l.size();M++)if(M!==u){var w=l.get(M);if(y(w,a)<B.getEditPointSize()/S){V.$9l=M;break}}}else if(V.$10l){var j=V.$24l;o.x-=j.x,o.y-=j.y;var X=B.sm().getSelection(),$=V.$1l,v=V.$7l,W=V.$10l,m=V.$4l,H=V.$2l,Y=B.getEditRectPadding()/S,U=2*Y,_=B.getSnapSpacing(),i=_!=Q&&!isNaN(_),F=Qg(H,o,W,v,2*Y,B.getResizeMode(),i,!0),P=V.$6l;if(i){var b=F.width-U,q=F.height-U,D=s(b/_)*_,Co=s(q/_)*_,wp=D-b,Cd=Co-q;("west"===W||"northwest"===W||"southwest"===W)&&(wp=-wp),("north"===W||"northwest"===W||"northeast"===W)&&(Cd=-Cd),F=Qg(H,o,W,v,2*Y,B.getResizeMode(),i,!1,wp,Cd)}V.$8l=F,P.x=F.x+Y,P.y=F.y+Y,P.width=F.width-U,P.height=F.height-U;var Qp=F.x+F.width/2,os=F.y+F.height/2,xj=P.x,sq=P.y,rk=P.width/m.width,us=P.height/m.height;X.each(function(U){if(U instanceof e&&B.isEditable(U)&&B.isRectEditable(U)){var S=$[U.getId()],_=V.$3l[U.getId()],p={x:S.x+S.width/2,y:S.y+S.height/2},s=0,j=0,z=W,y=180*r(v-U.getRotation())/c;"northeast"===W?y>=315||45>y?(s=S.width*rk+S.x,j=S.height*(1-us)+S.y,z="northeast"):y>=45&&135>y?(s=S.width*(1-us)+S.x,j=S.height*(1-rk)+S.y,z="northwest"):y>=135&&225>y?(s=S.width*(1-rk)+S.x,j=S.height*us+S.y,z="southwest"):(s=S.width*us+S.x,j=S.height*rk+S.y,z="southeast"):"north"===W?y>=315||45>y?(j=S.height*(1-us)+S.y,z="north"):y>=45&&135>y?(s=S.width*(1-us)+S.x,z="west"):y>=135&&225>y?(j=S.height*us+S.y,z="south"):(s=S.width*us+S.x,z="east"):"northwest"===W?y>=315||45>y?(s=S.width*(1-rk)+S.x,j=S.height*(1-us)+S.y,z="northwest"):y>=45&&135>y?(s=S.width*(1-us)+S.x,j=S.height*rk+S.y,z="southwest"):y>=135&&225>y?(s=S.width*rk+S.x,j=S.height*us+S.y,z="southeast"):(s=S.width*us+S.x,j=S.height*(1-rk)+S.y,z="northeast"):"west"===W?y>=315||45>y?(s=S.width*(1-rk)+S.x,z="west"):y>=45&&135>y?(j=S.height*rk+S.y,z="south"):y>=135&&225>y?(s=S.width*rk+S.x,z="east"):(j=S.height*(1-rk)+S.y,z="north"):"southwest"===W?y>=315||45>y?(s=S.width*(1-rk)+S.x,j=S.height*us+S.y,z="southwest"):y>=45&&135>y?(s=S.width*us+S.x,j=S.height*rk+S.y,z="southeast"):y>=135&&225>y?(s=S.width*rk+S.x,j=S.height*(1-us)+S.y,z="northeast"):(s=S.width*(1-us)+S.x,j=S.height*(1-rk)+S.y,z="northwest"):"east"===W?y>=315||45>y?(s=S.width*rk+S.x,z="east"):y>=45&&135>y?(j=S.height*(1-rk)+S.y,z="north"):y>=135&&225>y?(s=S.width*(1-rk)+S.x,z="west"):(j=S.height*rk+S.y,z="south"):"south"===W?y>=315||45>y?(j=S.height*us+S.y,z="south"):y>=45&&135>y?(s=S.width*us+S.x,z="east"):y>=135&&225>y?(j=S.height*(1-us)+S.y,z="north"):(s=S.width*(1-us)+S.x,z="west"):"southeast"===W&&(y>=315||45>y?(s=S.width*rk+S.x,j=S.height*us+S.y,z="southeast"):y>=45&&135>y?(s=S.width*us+S.x,j=S.height*(1-rk)+S.y,z="northeast"):y>=135&&225>y?(s=S.width*(1-rk)+S.x,j=S.height*(1-us)+S.y,z="northwest"):(s=S.width*(1-us)+S.x,j=S.height*rk+S.y,z="southwest"));var x=nb(p,s-p.x,j-p.y,U.getRotation());ki(U,S,z,{x:x.x,y:x.y});var o=xj+P.width*_.x,d=sq+P.height*_.y,t={x:o,y:d};t=nb({x:Qp,y:os},t.x-Qp,t.y-os,v),U.p(t.x,t.y)}}),V.fi({kind:"betweenEditRect",event:n,direction:W})}else if(V.$23l&&V.$40l){var Uh=V.$8l,gj=Uh.width,sj=Uh.height,h={x:Uh.x+gj/2,y:Uh.y+sj/2},j=V.$24l,en=V.$23l,ii=en.x/S-h.x,Dp=en.y/S-h.y,Am=z(ii*ii+Dp*Dp),Ah=Math.asin(j.x/Am),dj=B.sm().getSelection(),Uf=A+t(o.y-h.y,o.x-h.x)-Ah,Qm=B.getSnapAngle(),Uf=s(Uf/Qm)*Qm;0>Uf&&(Uf+=I);var ch=Uf-V.$7l,cs=[h.x,0,h.y];dj.each(function(F){if(B.isEditable(F)&&B.isRotationEditable(F)&&B.isVisible(F)){var R=qp(F.p3(),cs),H=mm();Mc(H,-ch),F.setRotation(F.getRotation()+ch),Lc(R,H),F.p3(cs[0]+R[0],cs[1]+R[1],cs[2]+R[2])}}),V.$7l=Uf,V.fi({kind:"betweenEditRotation",event:n})}else if([1,2,3,5,6].indexOf(V.$67l)>=0)V.$72l=n,V.$78l||(V.$78l=1,T(function(){G.isDragging()&&V.$43l(),delete V.$78l},12));else if(7===V.$67l){if(V.$87l instanceof f){var x=V.$87l,Yf=V.$88l,Oo=G.clone(x.getPoints().get(Yf)),Cn=o.y-Oo.y;Oo.e||(Oo.e=0),V.$92l||(V.$92l=Oo.e),Oo.e=V.$92l-Cn,x.setPoint(Yf,Oo)}else if(V.$87l instanceof p){var L=V.$87l,Yf=V.$88l,l=Gn(B.getDataUI(L),L.s("edge.points")),Oo=l.get(Yf),Cn=o.y-Oo.y;Oo.e||(Oo.e=0),V.$92l||(V.$92l=Oo.e),Oo.e=V.$92l-Cn,l.set(Yf,Oo),L.s("edge.points",Kp(l))}}else if(8===V.$67l){var dj=B.sm().getSelection(),xm=V.$93l;xm||(xm=V.$93l={}),dj.each(function(K){if(K.p3){var b=K.p3(),y=xm[K.getId()];y==Q&&(y=xm[K.getId()]=b[1]),K.p3([b[0],y-(o.y-V.$90l.y/S),b[2]])}})}else if(9===V.$67l){var dj=B.sm().getSelection(),Oc=V.$94l;Oc||(Oc=V.$94l={}),dj.each(function(P){if(P.s3){var y=P.s3(),N=Oc[P.getId()];N==Q&&(N=Oc[P.getId()]=y[1]);var v=N-(o.y-V.$91l.y/S);0>v&&(v=.01),P.s3([y[0],v,y[2]])}})}},$79l:function($,j){var M=this,D=M.gv,F=D.getZoom(),S=D.getEditHelperSize(),z=$.x/F,i=$.y/F,R=S/F,p=R/2;return q({x:z-p,y:i-p,width:R,height:R},j)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(I,R){for(var n=this,P=n.gv,k=P.getZoom(),t=P.getEditPointSize(),C=t/k,J=C/2,_=n.$46l(I),m=0;m<_.length;m++){var b,S,W=_[m],o=P.getDataUI(W);if(o&&o._55O){var x=o._55O;if(x._43O&&W instanceof p){if(b=W.s("edge.points"),b=Gn(o,b),S=W.s("edge.segments"),S&&S.size()||(S=tr(b)),n.$42l(W,R,b._as,S,"edge"))return!0;if("points"===W.s("edge.type")&&n.$41l(W,R,b._as,S,"edge"))return}if(x._43O&&W instanceof f&&x.$15l&&x.$15l.length===W.getPoints().size()){if(b=x.$15l,S=W.getSegments(),S&&S.size()||(S=tr(b)),n.$42l(W,R,b,S,"shape"))return!0;if(n.$41l(W,R,b,S,"shape"))return}}}if(n.$16l){var b,w=n.$16l,A=w[3].x-w[7].x,K=w[3].y-w[7].y,y=z(A*A+K*K),V=w[1].x-w[5].x,L=w[1].y-w[5].y,d=z(V*V+L*L),X={x:R.x*k,y:R.y*k};if(n._80I(X,0,w[0],"northwest",y,d)||n._80I(X,1,w[1],"north",y,d)||n._80I(X,2,w[2],"northeast",y,d)||n._80I(X,7,w[7],"west",y,d)||n._80I(X,3,w[3],"east",y,d)||n._80I(X,6,w[6],"southwest",y,d)||n._80I(X,5,w[5],"south",y,d)||n._80I(X,4,w[4],"southeast",y,d))return!0}if(n.$23l){var l=n.$23l,U=l.x/k,i=l.y/k;if(q({x:U-J,y:i-J,width:C,height:C},R))return n.$40l=1,n.$12l=n.getHelperCursor("rotation")||"crosshair",!0}return n.$68l&&n.$79l(n.$68l,R)?(n.$67l=1,n.$12l=n.getHelperCursor("host")||"crosshair",!0):n.$69l&&n.$79l(n.$69l,R)?(n.$67l=2,n.$12l=n.getHelperCursor("parent")||"crosshair",!0):n.$70l&&n.$79l(n.$70l,R)?(n.$67l=3,n.$12l=n.getHelperCursor("edge")||"crosshair",!0):n.$71l&&n.$79l(n.$71l,R)?(n.$67l=4,n.$12l=n.getHelperCursor("remove")||"crosshair",!0):n.$82l&&n.$79l(n.$82l,R)?(n.$67l=5,n.$12l=n.getHelperCursor("source")||"crosshair",!0):n.$83l&&n.$79l(n.$83l,R)?(n.$67l=6,n.$12l=n.getHelperCursor("target")||"crosshair",!0):n._pointElevationHelperPoint&&n.$79l(n._pointElevationHelperPoint,R)?(n.$67l=7,n.$12l=n.getHelperCursor("pointElevation")||"crosshair",!0):n.$90l&&n.$79l(n.$90l,R)?(n.$67l=8,n.$12l=n.getHelperCursor("elevation")||"crosshair",!0):n.$91l&&n.$79l(n.$91l,R)?(n.$67l=9,n.$12l=n.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(p,S,W,Y,m,v){var T=this,d=T.gv,J=d.getEditPointSize(),j=J/2,x=d.sm(),a=d.isDirectionEditable;if(a&&1===x.size()){var R=x.ld();if(a=a.bind(d),R instanceof e){if(!a(R,Y))return!1;if("east"===Y){if(a(R,"northeast")&&a(R,"southeast")&&2*J>=v)return!1}else if("west"===Y){if(a(R,"northwest")&&a(R,"southwest")&&2*J>=v)return!1}else if("north"===Y){if(a(R,"northwest")&&a(R,"northeast")&&2*J>=m)return!1}else if("south"===Y&&a(R,"southwest")&&a(R,"southeast")&&2*J>=m)return!1}}else{if(2*J>=m&&("north"===Y||"south"===Y))return!1;if(2*J>=v&&("east"===Y||"west"===Y))return!1}if(q({x:W.x-j,y:W.y-j,width:J,height:J},p)){if(T.$10l!==Y){var i=180*T.$7l/c,l="";i>=337.5||22.5>i?l="north":i>=22.5&&67.5>i?l="northeast":i>=67.5&&112.5>i?l="east":i>=112.5&&157.5>i?l="southeast":i>=157.5&&202.5>i?l="south":i>=202.5&&247.5>i?l="southwest":i>=247.5&&292.5>i?l="west":i>=292.5&&337.5>i&&(l="northwest");var E=Le.indexOf(l),l=Le[S-(1-E)+8];switch(l){case"northwest":T.$12l="nwse-resize";break;case"northeast":T.$12l="nesw-resize";break;case"southwest":T.$12l="nesw-resize";break;case"southeast":T.$12l="nwse-resize";break;case"north":T.$12l="ns-resize";break;case"east":T.$12l="ew-resize";break;case"south":T.$12l="ns-resize";break;case"west":T.$12l="ew-resize"}T.$10l=Y}return!0}return!1},$42l:function(e,D,S,b,E){var l,k=this,v=k.gv,C=v.getEditPointSize(),c=C/v.getZoom(),u=-1,O={x:D.x,y:D.y,width:0,height:0},N=function(h){"shape"===E?k._shape=e:k._edge=e,k._removePointIndex=h},g=function(p){"shape"===E?k._shape=e:k._edge=e,k.$13l=p,k.$12l="crosshair"};for(m(O,c/2),u=S.length-1,l=b.size()-1;l>=0;l--){var T=b.get(l);if(1===T||2===T)u-=1;else if(3===T){var y=S[u-1];if(q(O,y))return g(u-1),!0;u-=2}else if(4===T){var A=S[u-1],I=S[u-2];if(q(O,A))return g(u-1),!0;if(q(O,I))return g(u-2),!0;u-=3}}for(u=S.length-1,l=b.size()-1;l>=0;l--){var T=b.get(l),R=S[u];if(q(O,R))return N(u),g(u),!0;1===T||2===T?u-=1:3===T?u-=2:4===T&&(u-=3)}return!1},$41l:function($,A,h,v,d){var L=this,Q=L.gv,S=-1,u=0,w={x:A.x,y:A.y,width:0,height:0},W=function(g,T){L._hoverSegmentIndex=T,L._lp=A,"shape"===d?L._shape=$:L._edge=$};for(m(w,Q.getSegmentHoverWidth()/2/Q.getZoom()),$ instanceof f&&$.isClosePath()&&v.indexOf(5)<0&&(v=new K(v._as),v.add(5));u<v.size();u++){var U=v.get(u);if(1===U){var G=h[S],R=h[S+1];if(G){var e=xh(new dp(G.x,G.y),new dp(R.x,R.y),new dp(w.x,w.y),new dp(w.x+w.width,w.y+w.height));if(e.$62l===O&&e.points.length>0)return W(e,u),!0}S+=1}else if(2===U){var G=h[S],R=h[S+1],e=xh(new dp(G.x,G.y),new dp(R.x,R.y),new dp(w.x,w.y),new dp(w.x+w.width,w.y+w.height));if(e.$62l===O&&e.points.length>0)return W(e,u),!0;S+=1}else if(3===U){var G=h[S],k=h[S+1],Z=h[S+2],e=$r(new dp(G.x,G.y),new dp(k.x,k.y),new dp(Z.x,Z.y),new dp(w.x,w.y),new dp(w.x+w.width,w.y+w.height));if(e.$62l===O)return W(e,u),!0;S+=2}else if(4===U){var G=h[S],T=h[S+1],Y=h[S+2],Z=h[S+3],e=Gh(new dp(G.x,G.y),new dp(T.x,T.y),new dp(Y.x,Y.y),new dp(Z.x,Z.y),new dp(w.x,w.y),new dp(w.x+w.width,w.y+w.height));if(e.$62l===O)return W(e,u),!0;S+=3}else if(5===U){var G=h[S],R=h[0];if(G){var e=xh(new dp(G.x,G.y),new dp(R.x,R.y),new dp(w.x,w.y),new dp(w.x+w.width,w.y+w.height));if(e.$62l===O&&e.points.length>0)return W(e,u),!0}}}return!1},addShapePoint:function(k,M,F){var l=this,U=l.gv,j=U.dm();if(j.beginTransaction(),0===arguments.length&&(k=l._shape||l._edge,M=l._hoverSegmentIndex,F=l._lp),k instanceof f||k instanceof p){var S=vs(k,U.getDataUI(k),M);if(!isNaN(M)&&F&&!isNaN(S)){var R=F;if(k instanceof f){var C=k.p(),e=k.getRotation(),Q=k.toSegments();Q&&Q.size()||(Q=tr(k.getPoints())),k.isClosePath()&&Q.indexOf(5)<0&&(Q=new K(Q._as),Q.add(5));var g=Q.get(M),P="addPoint",_="removePointAt";if(2===g||1===g){var d={x:R.x,y:R.y};Q.add(g,M),d=nb(C,d.x-C.x,d.y-C.y,-e),k[P](d,S+1)}else if(3===g){var X=k.getPoints(),o=X.get(S),q=X.get(S+2),d={x:R.x,y:R.y};d=nb(C,d.x-C.x,d.y-C.y,-e);var m=Pm(o,d),D=Pm(d,q);Q.removeAt(M),Q.add(3,M),Q.add(3,M),k.setPoint(S+1,d),k[P](D,S+2),k[P](m,S+1)}else if(4===g){var X=k.getPoints(),o=X.get(S),q=X.get(S+3),d={x:R.x,y:R.y};d=nb(C,d.x-C.x,d.y-C.y,-e);var m=wl(o,d),D=Xf(o,d),n=wl(d,q),L=Xf(d,q);Q.removeAt(M),Q.add(4,M),Q.add(4,M),k[_](S+1),k[_](S+1),k[P](d,S+1),k[P](L,S+2),k[P](n,S+2),k[P](D,S+1),k[P](m,S+1)}else if(5===g){var d={x:R.x,y:R.y};Q.add(2,M),d=nb(C,d.x-C.x,d.y-C.y,-e),k[P](d,S+1)}k.isClosePath()&&Q.remove(5),k.setSegments(Q);var Y=k.getWidth(),s=k.getHeight(),h=k.p().x-Y/2,H=k.p().y-s/2;h-=C.x,H-=C.y;var y=Pd(k,{x:h,y:H,width:Y,height:s},e,C);k.p(y.x,y.y)}else if(k instanceof p){if("points"!==k.s("edge.type"))return j.endTransaction(),void 0;var X=k.s("edge.points");Q=k.s("edge.segments"),X=Gn(U.getDataUI(k),X),Q&&Q.size()||(Q=tr(X)),Q=new K(Q._as.slice(0)),X=new K(X._as.slice(0));var g=Q.get(M);if(2===g||1===g){var d={x:R.x,y:R.y};Q.add(g,M),X.add(d,S+1)}else if(3===g){var o=X.get(S),q=X.get(S+2),d={x:R.x,y:R.y},m=Pm(o,d),D=Pm(d,q);Q.removeAt(M),Q.add(3,M),Q.add(3,M),X.set(S+1,d),X.add(D,S+2),X.add(m,S+1)}else if(4===g){var o=X.get(S),q=X.get(S+3),d={x:R.x,y:R.y},m=wl(o,d),D=Xf(o,d),n=wl(d,q),L=Xf(d,q);Q.removeAt(M),Q.add(4,M),Q.add(4,M),X.removeAt(S+1),X.removeAt(S+1),X.add(d,S+1),X.add(L,S+2),X.add(n,S+2),X.add(D,S+1),X.add(m,S+1)}k.s("edge.points",Kp(X)),k.s("edge.segments",Q)}}}j.endTransaction()},removeShapePoint:function(y,c){var h=this,x="removeAt",o=h.gv,H=o.dm();if(H.beginTransaction(),0===arguments.length&&(y=h._shape||h._edge,c=h._removePointIndex),c>=0&&(y instanceof f||y instanceof p)){var j=ch(y,h.gv.getDataUI(y),c),n=c;if(y instanceof f){var V=y.p(),O=y.toSegments();O&&O.size()||(O=tr(y.getPoints()));var G=O.get(j),r="removePointAt";if(1===G&&0===n)if(y.getPoints().size()>1){var W=O.get(j+1);O[x](j+1),3===W?y[r](n+1):4===W&&(y[r](n+2),y[r](n+1)),y[r](n)}else y.dm().remove(y);else 2===G||1===G?(O[x](j),y[r](n)):3===G?(O[x](j),y[r](n),y[r](n-1)):4===G&&(O[x](j),y[r](n),y[r](n-1),y[r](n-2));y.setSegments(O);var D=y.getWidth(),v=y.getHeight(),C=y.p().x-D/2,Q=y.p().y-v/2;C-=V.x,Q-=V.y;var i=Pd(y,{x:C,y:Q,width:D,height:v},y.getRotation(),V);y.p(i.x,i.y)}else if(y instanceof p){if("points"!==y.s("edge.type"))return H.endTransaction(),void 0;var w=y.s("edge.points");if(O=y.s("edge.segments"),w&&(w=Gn(h.gv.getDataUI(y),w),O&&O.size()||(O=tr(w))),0===c||c===w.size()-1)return H.endTransaction(),void 0;O=new K(O._as.slice(0)),w=new K(w._as.slice(0));var G=O.get(j);2===G||1===G?(O[x](j),w[x](n)):3===G?(O[x](j),w[x](n),w[x](n-1)):4===G&&(O[x](j),w[x](n),w[x](n-1),w[x](n-2)),y.s("edge.segments",O),y.s("edge.points",Kp(w))}}H.endTransaction()},changeShapeSegment:function(y,Y,q){var O=this,s=O.gv,U=s.dm();if(U.beginTransaction(),1!==arguments.length||isNaN(y)||(q=y,y=O._shape||O._edge,Y=O._hoverSegmentIndex),y instanceof f||y instanceof p){var t=vs(y,O.gv.getDataUI(y),Y);if(!isNaN(Y)&&!isNaN(t))if(y instanceof f){var V=y.p(),k=y.toSegments();k&&k.size()||(k=tr(y.getPoints()));var W=k.get(Y),w=y.toPoints();if(1===q||2===q)1===W||2===W?k.set(Y,q):3===W?(k.set(Y,q),w.removeAt(t+1)):4===W&&(k.set(Y,q),w.removeAt(t+1),w.removeAt(t+1));else if(3===q){var I=function(){var b=w.get(t),i=w.get(t+1),v=Pm(b,i);k.set(Y,3),w.add(v,t+1)};2===W||1===W?I():4===W&&(w.removeAt(t+1),w.removeAt(t+1),I())}else if(4===q){var m=function(){var C=w.get(t),M=w.get(t+1),E=wl(C,M),N=Xf(C,M);k.set(Y,4),w.add(E,t+1),w.add(N,t+2)};2===W||1===W?m():3===W&&(w.removeAt(t+1),m())}y.setSegments(k),y.setPoints(w);var _=y.getWidth(),L=y.getHeight(),l=y.p().x-_/2,u=y.p().y-L/2;l-=V.x,u-=V.y;var M=new Pd(y,{x:l,y:u,width:_,height:L},y.getRotation(),V);y.p(M.x,M.y)}else if(y instanceof p){if("points"!==y.s("edge.type"))return U.endTransaction(),void 0;var w=y.s("edge.points");k=y.s("edge.segments"),w&&(w=Gn(O.gv.getDataUI(y),w),k&&k.size()||(k=tr(w))),k=new K(k._as.slice(0)),w=new K(w._as.slice(0));var W=k.get(Y);if(1===q||2===q)1===W||2===W?k.set(Y,q):3===W?(k.set(Y,q),w.removeAt(t+1)):4===W&&(k.set(Y,q),w.removeAt(t+1),w.removeAt(t+1));else if(3===q){var I=function(){var a=w.get(t),v=w.get(t+1),e=Pm(a,v);k.set(Y,3),w.add(e,t+1)};2===W||1===W?I():4===W&&(w.removeAt(t+1),w.removeAt(t+1),I())}else if(4===q){var m=function(){var M=w.get(t),W=w.get(t+1),N=wl(M,W),b=Xf(M,W);k.set(Y,4),w.add(N,t+1),w.add(b,t+2)};2===W||1===W?m():3===W&&(w.removeAt(t+1),m())}y.s("edge.points",Kp(w)),y.s("edge.segments",k)}}U.endTransaction()},getDefaultSegments:function(y){var X=this.gv,Y=X.getDataUI(y);if(y instanceof p){var b=y.s("edge.points");return b=Gn(Y,b),tr(b)}if(y instanceof f){var b=y.getPoints(),M=y.getSegments();return M&&M.size()>0?M:tr(b)}},$43l:function(O){var X=this;O&&(X.$5l=1),X._68I=1,X._42()},_42:function(){var i=this;if(i._68I){delete i._68I;var s=i.gv,d=i.$5l,X=s.getZoom(),P=s.getEditPointSize(),A=P/2,R=new K,w=i._view,D=i._edge,r=i._shape,F=w.getContext("2d"),N=s.tx(),T=s.ty(),h=Q,g=s.getEditPointBackground(),$=s.getControlPointBackground(),c=s.getControlPointBorderColor(),x=s.getEditPointBorderColor(),S=s.getEditRectBorderColor(),W=s.getDirectionLineColor(),j=s.getSegmentHoverColor(),u=s.getSnapPointBorderColor(),y=s.getJoinPointBackground(),k=s.getJoinPointBorderColor(),J=s.getSegmentHoverWidth(),t=[5,5],C=s.getEditRectBorderStyle();ah(s,function(t){s.isSelected(t)&&s.isVisible(t)&&R.add(t)}),F.clearRect(0,0,E(w.width),E(w.height)),F.save(),M.translateAndScale(F,N,T,1);var V=Q,B={x:0,y:0,width:0,height:0},q=0,O=0,a=0,b=0,Z=0,_=0,Ji=0,gn=0,Fc=0,nm=0,Eo=[];if(d?(delete i.$6l,delete i.$8l,delete i.$7l,delete i.$16l,delete i.$23l):(V=i.$6l,h=i.$7l),delete i.$68l,delete i.$69l,delete i.$71l,delete i.$70l,delete i.$82l,delete i.$83l,delete i._pointElevationHelperPoint,delete i.$90l,delete i.$91l,delete i.$75l,delete i.$74l,R.each(function(w){var i=s.getDataUI(w);if(i){var p=i._55O;if(s.isEditable(w))p._56O&&w instanceof e&&O++,Eo.push(w),p._42O&&w instanceof e&&q++,s.isHelperEditable(w,"host")&&b++,s.isHelperEditable(w,"parent")&&a++,s.isHelperEditable(w,"remove")&&Z++,s.isHelperEditable(w,"edge")&&_++,s.isHelperEditable(w,"source")&&Ji++,s.isHelperEditable(w,"target")&&gn++,s.isHelperEditable(w,"elevation")&&Fc++,s.isHelperEditable(w,"tall")&&nm++;else if(w instanceof n&&w.isExpanded()){var t=!0,P=s.getEditableFunc();P&&(t=P(w)),t&&(s.isHelperEditable(w,"host")&&b++,s.isHelperEditable(w,"parent")&&a++,s.isHelperEditable(w,"remove")&&Z++,s.isHelperEditable(w,"edge")&&_++,s.isHelperEditable(w,"source")&&Ji++,s.isHelperEditable(w,"target")&&gn++,s.isHelperEditable(w,"elevation")&&Fc++,s.isHelperEditable(w,"tall")&&nm++,Eo.push(w))}}}),F.beginPath(),F.lineWidth=1,F.strokeStyle=s.getNodeBorderColor(),Eo.forEach(function(j){var C=s.getDataUI(j),P=C._55O;if(d)if(h==Q&&(h=j instanceof p?0:j instanceof n&&j.isExpanded()?0:j.getRotation(),i.$7l=h),V==Q){var a,g,A;if(j instanceof n&&j.isExpanded()||j instanceof p){var M=s.getDataUIBounds(j);g=M.width,A=M.height,a={x:M.x+g/2,y:M.y+A/2}}else a=j.p(),g=j.getWidth(),A=j.getHeight();V={x:a.x,y:a.y,width:0,height:0},B.x=a.x-g/2,B.y=a.y-A/2,B.width=g,B.height=A,V=H(V,B)}else{var a,g,A,W,l=V.x+V.width/2,O=V.y+V.height/2,x={x:l,y:O};if(j instanceof n&&j.isExpanded()||j instanceof p){W=0;var M=s.getDataUIBounds(j);g=M.width,A=M.height,a={x:M.x+g/2,y:M.y+A/2}}else a=j.p(),g=j.getWidth(),A=j.getHeight(),W=j.getRotation();var t={x:a.x-g/2,y:a.y-A/2,width:g,height:A},S={x:t.x,y:t.y},k={x:t.x+t.width,y:t.y},N={x:t.x,y:t.y+t.height},T={x:t.x+t.width,y:t.y+t.height},S=nb(a,S.x-a.x,S.y-a.y,W),N=nb(a,N.x-a.x,N.y-a.y,W),T=nb(a,T.x-a.x,T.y-a.y,W),k=nb(a,k.x-a.x,k.y-a.y,W),y=-h,$=nb(x,S.x-x.x,S.y-x.y,y),U=nb(x,k.x-x.x,k.y-x.y,y),K=nb(x,N.x-x.x,N.y-x.y,y),f=nb(x,T.x-x.x,T.y-x.y,y),E=v([$,U,K,f]);V=H(V,E),V.x-=l,V.y-=O;var _=Pd(Q,V,h,x);V.x=_.x-V.width/2,V.y=_.y-V.height/2}if(q>1&&s.isEditable(j)&&s.isRectEditable(j)&&j instanceof e){var u=j.getRect(),R=P.$45l,Y=Wr(R[0],X),J=Wr(R[2],X),m=Wr(R[4],X),r=Wr(R[6],X);j.getRotation()?(F.moveTo(Y.x,Y.y),F.lineTo(J.x,J.y),F.lineTo(m.x,m.y),F.lineTo(r.x,r.y),F.lineTo(Y.x,Y.y)):F.rect(u.x*X,u.y*X,u.width*X,u.height*X)}}),F.stroke(),V){i.$6l=U(V),m(V,s.getEditRectPadding()/X);var rb={x:V.x+V.width/2,y:V.y+V.height/2},Em=jj(rb,V.width,V.height,h),ni=Em[0],$n=Em[1],Uh=Em[2],fh=Em[3],uk=Em[4],oc=Em[5],pe=Em[6],eh=Em[7];if(ni=Wr(Em[0],X),$n=Wr(Em[1],X),Uh=Wr(Em[2],X),fh=Wr(Em[3],X),uk=Wr(Em[4],X),oc=Wr(Em[5],X),pe=Wr(Em[6],X),eh=Wr(Em[7],X),i.$8l=V,q>0&&(i.$16l=[ni,uk,$n,oc,fh,pe,Uh,eh],F.beginPath(),F.lineWidth=1,F.strokeStyle=S,"dashed"===C&&F.setLineDash&&F.setLineDash(t),F.moveTo(ni.x,ni.y),F.lineTo($n.x,$n.y),F.lineTo(fh.x,fh.y),F.lineTo(Uh.x,Uh.y),F.lineTo(ni.x,ni.y),F.stroke(),"dashed"===C&&F.setLineDash&&F.setLineDash([])),F.beginPath(),F.lineWidth=1,F.fillStyle=g,F.strokeStyle=x,q>0){var Fe=oc.x-eh.x,Ur=oc.y-eh.y,Zm=z(Fe*Fe+Ur*Ur),Po=uk.x-pe.x,yj=uk.y-pe.y,$i=z(Po*Po+yj*yj),Cg=2*P;if(s.isDirectionEditable&&1===Eo.length){var qp=Eo[0],kg=s.getDataUI(qp),Hc=kg._55O,xp=s.isDirectionEditable.bind(s);if(Hc._42O){var Pk,_j,Kh,en;xp(qp,"northwest")&&(Pk=!0,F.rect(ni.x-A,ni.y-A,P,P)),xp(qp,"northeast")&&(_j=!0,F.rect($n.x-A,$n.y-A,P,P)),xp(qp,"southwest")&&(Kh=!0,F.rect(Uh.x-A,Uh.y-A,P,P)),xp(qp,"southeast")&&(en=!0,F.rect(fh.x-A,fh.y-A,P,P)),xp(qp,"north")&&(Pk&&_j?Zm>Cg&&F.rect(uk.x-A,uk.y-A,P,P):F.rect(uk.x-A,uk.y-A,P,P)),xp(qp,"south")&&(en&&Kh?Zm>Cg&&F.rect(pe.x-A,pe.y-A,P,P):F.rect(pe.x-A,pe.y-A,P,P)),xp(qp,"west")&&(Kh&&Pk?$i>Cg&&F.rect(eh.x-A,eh.y-A,P,P):F.rect(eh.x-A,eh.y-A,P,P)),xp(qp,"east")&&(en&&_j?$i>Cg&&F.rect(oc.x-A,oc.y-A,P,P):F.rect(oc.x-A,oc.y-A,P,P))}}else Zm>Cg&&(F.rect(uk.x-A,uk.y-A,P,P),F.rect(pe.x-A,pe.y-A,P,P)),$i>Cg&&(F.rect(oc.x-A,oc.y-A,P,P),F.rect(eh.x-A,eh.y-A,P,P)),F.rect(ni.x-A,ni.y-A,P,P),F.rect($n.x-A,$n.y-A,P,P),F.rect(Uh.x-A,Uh.y-A,P,P),F.rect(fh.x-A,fh.y-A,P,P)}if(O>0){var ve=i.$23l=nb(uk,0,2*-P,h);F.moveTo(ve.x+A,ve.y),F.arc(ve.x,ve.y,A,0,I,!1)}F.fill(),F.stroke(),i.$40l&&i.$44l(F,V,h);var xq,Jr,bl=s.getLeftTopHelpers(),Bo=s.getRightTopHelpers(),Jl=s.getLeftBottomHelpers(),br=s.getRightBottomHelpers(),Nb=s.getEdgeHelpers(),lg=s.getEditHelperSize(),rl=lg/2,jl=function(K,R,G,$){"leftTop"===R?(xq=V.x*X-lg-A-("h"===$?G*(lg+A):0)-1,Jr=V.y*X-lg-A-("v"===$?G*(lg+A):0)-1):"rightTop"===R?(xq=(V.x+V.width)*X+A+("h"===$?G*(lg+A):0)+1,Jr=V.y*X-lg-A-("v"===$?G*(lg+A):0)-1):"leftBottom"===R?(xq=V.x*X-lg-A-("h"===$?G*(lg+A):0)-1,Jr=(V.y+V.height)*X+A+("v"===$?G*(lg+A):0)+1):"rightBottom"===R&&(xq=(V.x+V.width)*X+A+("h"===$?G*(lg+A):0)+1,Jr=(V.y+V.height)*X+A+("v"===$?G*(lg+A):0)+1);var k=xq+rl,w=Jr+rl,r=(V.x+V.width/2)*X,y=(V.y+V.height/2)*X,E=nb({x:r,y:y},k-r,w-y,h);if("host"===K){if(b>0)return i.$77l(F,h,E),!0}else if("edge"===K){if(_>0)return i.$80l(F,h,E),!0}else if("remove"===K){if(Z>0)return Eo&&1===Eo.length&&Eo[0]instanceof p?i.$81l(F,h,{x:r+lg/2+5,y:y}):i.$81l(F,h,E),!0}else if("parent"===K){if(a>0)return Eo&&1===Eo.length&&Eo[0]instanceof p?i.$76l(F,h,{x:r-lg/2-5,y:y}):i.$76l(F,h,E),!0}else if("elevation"===K){if(Fc>0)return i.$85l(F,h,E),!0}else if("tall"===K){if(nm>0)return i.$86l(F,h,E),!0}else if("source"===K||"target"===K){var m=Eo[0],t=s.getDataUI(m),O=Pb(t,!0),L=O[0],e=O[1];if(Ji&&"source"===K)return i.$84l(F,V,L,!0,m.isLooped(),R,G,$),!0;if(gn&&"target"===K)return i.$84l(F,V,e,!1,m.isLooped(),R,G,$),!0}};if(bl&&bl.length>0){var qk=0;bl.forEach(function(l){jl(l,"leftTop",qk,s.getLeftTopHelpersAlign()||"h")&&qk++})}if(Bo&&Bo.length>0){var qk=0;Bo.forEach(function(D){jl(D,"rightTop",qk,s.getRightTopHelpersAlign()||"h")&&qk++})}if(Jl&&Jl.length>0){var qk=0;Jl.forEach(function(w){jl(w,"leftBottom",qk,s.getLeftBottomHelpersAlign()||"h")&&qk++})}if(br&&br.length>0){var qk=0;br.forEach(function(q){jl(q,"rightBottom",qk,s.getRightBottomHelpersAlign()||"h")&&qk++})}if(Nb&&Nb.length>0&&((Ji||gn)&&Eo&&1===Eo.length&&Eo[0]instanceof p?!0:!1)){var qk=0;Nb.forEach(function(O){jl(O,"edge",qk,"h")&&qk++})}if(i.$72l){var Or,Wm=i.$67l,Sj=i.$68l,Kf=i.$69l,dp=(i.$71l,i.$70l),gi=i.$82l,Ud=i.$83l;if(1===Wm?Or=Sj:2===Wm?Or=Kf:3===Wm?Or=dp:5===Wm?Or=gi:6===Wm&&(Or=Ud),Or){var Bi=s.lp(i.$72l),sb=s.getDataAt(i.$72l);if(sb&&sb instanceof e){var ed,Mo,Xl;if(i.$73l=sb,1===Wm)if(sb instanceof o.Grid)ed=i.$75l=fp(sb,Bi);else if(sb instanceof o.Shape){Xl=i.$74l=Vj(sb,Bi);var Lc=sb.getPoints();if(Xl){var rf=Xl.attachIndex,En=vs(sb,s.getDataUI(sb),rf)+1,Ko=En+1>=Lc.size()?0:En+1,li=Lc.get(En),ug=Lc.get(Ko),Jk=sb.p(),Re=sb.getRotation();li=nb(Jk,li.x-Jk.x,li.y-Jk.y,Re),ug=nb(Jk,ug.x-Jk.x,ug.y-Jk.y,Re),F.beginPath(),F.strokeStyle=j,F.lineWidth=J,F.moveTo(li.x*X,li.y*X),F.lineTo(ug.x*X,ug.y*X),F.stroke()}}ed?Mo=ed.rect:(Mo=G.clone(s.getDataUIBounds(sb)),G.grow(Mo,2)),F.beginPath(),F.rect(Mo.x*X,Mo.y*X,Mo.width*X,Mo.height*X),F.strokeStyle=1===Wm||4===Wm||6===Wm?L:Y,F.lineWidth=2,F.setLineDash&&F.setLineDash([8,8]),F.stroke()}else delete i.$73l;Bi.x=Bi.x*X,Bi.y=Bi.y*X;var ro=Xm(Or.x,Or.y,Bi.x,Bi.y),Qk=nb(Or,Bi.x-Or.x,Bi.y-Or.y,-ro),fi=Qk.x-Or.x;F.save(),F.translate(Or.x,Or.y),F.rotate(ro),l.width=fi,l.height=40;var _c=Y;(1===Wm||4===Wm||6===Wm)&&(_c=L),l.comps[0].gradientColor=_c,G.drawImage(F,l,0,-20,fi,40),F.restore()}}}if(R.each(function(T){var m=s.getDataUI(T);if(m){var H,N,Y=m._55O,n=m._78o;if(Y&&Y._43O&&T instanceof f?(H=Y.$15l,N=T.getSegments(),N&&N.size()||(N=tr(H)),T.isClosePath()&&N.indexOf(5)<0&&(N=new K(N._as),N.add(5))):Y&&n&&Y._43O&&(H=T.s("edge.points"),N=T.s("edge.segments"),H=Gn(m,H),N&&N.size()||(N=tr(H)),H&&(H=H._as)),H&&N){var v=0,V=N.size(),e=i._hoverSegmentIndex;H=H.slice(0);for(var x=0;x<H.length;x++)H[x]=Wr(H[x],X);F.beginPath(),F.strokeStyle=W,F.lineWidth=1,v=0;for(var x=0;V>x;x++){var R=N.get(x);if(1===R||2===R)v++;else if(3===R){var p=H[v-1],E=H[v],S=H[v+1];F.moveTo(p.x,p.y),F.lineTo(E.x,E.y),F.lineTo(S.x,S.y),v+=2}else if(4===R){var p=H[v-1],q=H[v],B=H[v+1],S=H[v+2];F.moveTo(p.x,p.y),F.lineTo(q.x,q.y),F.moveTo(B.x,B.y),F.lineTo(S.x,S.y),v+=3}}if(F.stroke(),r===T||D===T&&"points"===D.s("edge.type")){F.beginPath(),v=0,F.strokeStyle=j,F.lineWidth=J;for(var x=0;V>x;x++){var R=N.get(x);if(1===R||2===R){if(e===x){var p=H[v-1],S=H[v];F.moveTo(p.x,p.y),F.lineTo(S.x,S.y);break}v++}else if(3===R){if(e===x){var p=H[v-1],E=H[v],S=H[v+1];F.moveTo(p.x,p.y),F.quadraticCurveTo(E.x,E.y,S.x,S.y);break}v+=2}else if(4===R){if(e===x){var p=H[v-1],q=H[v],B=H[v+1],S=H[v+2];F.moveTo(p.x,p.y),F.bezierCurveTo(q.x,q.y,B.x,B.y,S.x,S.y);break}v+=3}else if(5===R&&e===x){var p=H[v-1],S=H[0];F.moveTo(p.x,p.y),F.lineTo(S.x,S.y);break}}F.stroke()}F.beginPath(),v=0,F.strokeStyle=k,F.lineWidth=1,F.fillStyle=y;for(var x=0;V>x;x++){var R=N.get(x);if(1===R||2===R){var S=H[v];F.moveTo(S.x+A,S.y),F.arc(S.x,S.y,A,0,I,!0),v++}else if(3===R){var S=H[v+1];F.moveTo(S.x+A,S.y),F.arc(S.x,S.y,A,0,I,!0),v+=2}else if(4===R){var S=H[v+2];F.moveTo(S.x+A,S.y),F.arc(S.x,S.y,A,0,I,!0),v+=3}}F.fill(),F.stroke(),F.beginPath(),v=0,F.strokeStyle=c,F.lineWidth=1,F.fillStyle=$;for(var x=0;V>x;x++){var R=N.get(x);if(1===R||2===R)v++;else if(3===R){var E=H[v];F.moveTo(E.x+A,E.y),F.arc(E.x,E.y,A,0,I,!0),v+=2}else if(4===R){var q=H[v],B=H[v+1];F.moveTo(q.x+A,q.y),F.arc(q.x,q.y,A,0,I,!0),F.moveTo(B.x+A,B.y),F.arc(B.x,B.y,A,0,I,!0),v+=3}}if(F.fill(),F.stroke(),F.beginPath(),v=0,F.strokeStyle=u,F.lineWidth=2,(r===T||D===T)&&i.$9l!=Q){var S=H[i.$9l];F.moveTo(S.x+A,S.y),F.arc(S.x,S.y,A,0,I,!0),F.stroke()}}}}),i.$87l&&s.sm().contains(i.$87l)){var Kp,Db=i.$87l,_b=i.$88l,lg=s.getEditHelperSize(),rl=lg/2;if(s.isHelperEditable(Db,"pointElevation"))if(Db instanceof f){var lh=Db.getPosition();Kp=G.clone(Db.getPoints().get(_b)),Kp=nb({x:lh.x,y:lh.y},Kp.x-lh.x,Kp.y-lh.y,Db.getRotation()),Kp.x*=X,Kp.y*=X,F.translate(Kp.x,Kp.y),G.drawImage(F,G.getImage("xeditinteractor_elevationIcon"),rl,-rl,lg,lg),F.translate(-Kp.x,-Kp.y),i._pointElevationHelperPoint={x:Kp.x+lg,y:Kp.y}}else if(Db instanceof p){var xc=Gn(s.getDataUI(Db),Db.s("edge.points")),Kp=G.clone(xc.get(_b));Kp.x*=X,Kp.y*=X,F.translate(Kp.x,Kp.y),G.drawImage(F,G.getImage("xeditinteractor_elevationIcon"),rl,-rl,lg,lg),F.translate(-Kp.x,-Kp.y),i._pointElevationHelperPoint={x:Kp.x+lg,y:Kp.y}}}F.restore(),i.$5l=0}},$89l:function(i,j,g,B){i.save();var p=this,S=p.gv,c=S.getEditHelperSize(),A=c/2;i.beginPath(),i.translate(g.x,g.y),i.rotate(j),G.drawImage(i,B,-A,-A,c,c),i.restore()},$85l:function(E,e,F){var j=this;j.$90l=F,j.$89l(E,e,F,G.getImage("xeditinteractor_elevationIcon"))},$86l:function(E,o,T){var N=this;N.$91l=T,N.$89l(E,o,T,G.getImage("xeditinteractor_tallIcon"))},$77l:function(Y,c,B){var T=this;T.$68l=B,T.$89l(Y,c,B,G.getImage("xeditinteractor_hostIcon"))},$80l:function(W,Y,g){var P=this;P.$70l=g,P.$89l(W,Y,g,G.getImage("xeditinteractor_edgeIcon"))},$81l:function(y,K,N){var b=this;b.$71l=N,b.$89l(y,K,N,G.getImage("xeditinteractor_removeIcon"))},$76l:function(b,S,Q){var K=this;K.$69l=Q,K.$89l(b,S,Q,G.getImage("xeditinteractor_parentIcon"))},$84l:function(o,T,e,R,I){var x,L=this,w=L.gv,W=w.getZoom(),i=w.getEditHelperSize(),s=i/2;e.x*=W,e.y*=W,I&&(R?e.x-=s+5:e.x+=s+5),e.y-=i-2,R?(L.$82l=e,x=G.getImage("xeditinteractor_sourceIcon")):(L.$83l=e,x=G.getImage("xeditinteractor_targetIcon")),o.beginPath(),o.translate(e.x,e.y),G.drawImage(o,x,-s,-s,i,i),o.translate(-e.x,-e.y)},$44l:function(v,K,r){v.save();var d=this.gv.getZoom(),Y=z(R(K.width,2)+R(K.height,2))/2*d+10,J=Y,h=J+8,j=J+18,Z=r,H=K.x+K.width/2,p=K.y+K.height/2;v.translate(H*d,p*d),v.beginPath(),v.strokeStyle="rgb(150, 150, 150)";for(var n=0,b=0,S=0,y=0,Q=0,w=0;360>w;w++)n=w*c/180,0===w%5&&(b=i(n)*J,S=D(n)*J,y=i(n)*h,Q=D(n)*h,v.moveTo(b,S),v.lineTo(y,Q)),0===w%45&&(b=i(n)*J,S=D(n)*J,y=i(n)*j,Q=D(n)*j,v.moveTo(b,S),v.lineTo(y,Q));v.stroke(),v.beginPath(),v.rotate(-A),v.beginPath(),v.fillStyle="rgba(255, 0, 0, 0.1)",v.strokeStyle="rgb(157, 157, 157)",v.moveTo(0,0),v.arc(0,0,j,0,r,!1),v.fill(),v.beginPath(),v.moveTo(0+j,0),v.arc(0,0,j,0,r,!1),v.stroke(),v.rotate(A),v.font="bold 12px Verdana, Arial";var x=20*D(Z),m=20*i(Z),u=s(180*Z/c)+"°";v.textAlign="center",v.textBaseline="middle",v.beginPath();var a=v.measureText("365.°").width;v.fillStyle="white",v.rect(x-a/2,-m-10,a,20),v.fill(),v.beginPath(),v.fillStyle="rgb(79,79,79)",v.fillText(u,x,-m),v.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);